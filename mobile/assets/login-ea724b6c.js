var B=(e,t,l)=>new Promise((i,a)=>{var r=d=>{try{v(l.next(d))}catch(p){a(p)}},f=d=>{try{v(l.throw(d))}catch(p){a(p)}},v=d=>d.done?i(d.value):Promise.resolve(d.value).then(r,f);v((l=l.apply(e,t)).next())});import{u as Me,s as Ne,i as U,l as _e,c as j,d as He,e as H,f as Z,g as I,n as Y,m as K,h as q,r as C,j as Fe,k as P,o as Ce,p as le,w as Ae,q as we,t as o,v as ae,H as ce,x as z,y as ee,z as $e,A as ke,B as Le,D as J,E as Q,L as Re,F as re,G as je,I as de,J as Ke,K as Oe,M as Ue,N as Ye,O as ze,P as qe,Q as L,R as oe,S as se,T as R,U as ue,V as Ge,X as xe,Y as Je,Z as Qe,_ as me,$ as We,a0 as Xe,a1 as Ee,a2 as Ze,a3 as et,a4 as tt,a5 as nt,a6 as fe,a7 as lt,a8 as W,a9 as ve,aa as at}from"./index-dd1416dc.js";import{B as _,F as he,R as ot,C as ge}from"./index-f951719f.js";import{N as st}from"./index-d7251874.js";import{C as ut}from"./index-2071c053.js";import{S as it}from"./index-f6d6a567.js";import"./use-route-baf767a6.js";import"./use-placeholder-e5390cdf.js";const ct=e=>B(void 0,null,function*(){U.mode==="legacy"?U.global.locale=e:U.global.locale.value=e}),rt=e=>B(void 0,null,function*(){U.global.setLocaleMessage(e,yield _e(e))}),dt=e=>B(void 0,null,function*(){yield Me().setLocale(e),yield rt(e),yield ct(e),yield Ne(e)}),mt=()=>({changeLocale:dt}),[ft,O,pe]=j("picker"),Pe=e=>e.find(t=>!t.disabled)||e[0];function vt(e,t){const l=e[0];if(l){if(Array.isArray(l))return"multiple";if(t.children in l)return"cascade"}return"default"}function te(e,t){t=Z(t,0,e.length);for(let l=t;l<e.length;l++)if(!e[l].disabled)return l;for(let l=t-1;l>=0;l--)if(!e[l].disabled)return l;return 0}const be=(e,t,l)=>t!==void 0&&!!e.find(i=>i[l.value]===t);function ne(e,t,l){const i=e.findIndex(r=>r[l.value]===t),a=te(e,i);return e[a]}function ht(e,t,l){const i=[];let a={[t.children]:e},r=0;for(;a&&a[t.children];){const f=a[t.children],v=l.value[r];if(a=He(v)?ne(f,v,t):void 0,!a&&f.length){const d=Pe(f)[t.value];a=ne(f,d,t)}r++,i.push(f)}return i}function gt(e){const{transform:t}=window.getComputedStyle(e),l=t.slice(7,t.length-1).split(", ")[5];return Number(l)}function pt(e){return H({text:"text",value:"value",children:"children"},e)}const ye=200,Se=300,bt=15,[Ie,X]=j("picker-column"),Ve=Symbol(Ie);var yt=I({name:Ie,props:{value:Y,fields:K(Object),options:q(),readonly:Boolean,allowHtml:Boolean,optionHeight:K(Number),swipeDuration:K(Y),visibleOptionNum:K(Y)},emits:["change","clickOption","scrollInto"],setup(e,{emit:t,slots:l}){let i,a,r,f,v;const d=C(),p=C(),b=C(0),y=C(0),w=Fe(),x=()=>e.options.length,V=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,k=h=>{const n=te(e.options,h),u=-n*e.optionHeight,c=()=>{const E=e.options[n][e.fields.value];E!==e.value&&t("change",E)};i&&u!==b.value?v=c:c(),b.value=u},s=()=>e.readonly||!e.options.length,m=h=>{i||s()||(v=null,y.value=ye,k(h),t("clickOption",e.options[h]))},g=h=>Z(Math.round(-h/e.optionHeight),0,x()-1),T=P(()=>g(b.value)),S=(h,n)=>{const u=Math.abs(h/n);h=b.value+u/.003*(h<0?-1:1);const c=g(h);y.value=+e.swipeDuration,k(c)},D=()=>{i=!1,y.value=0,v&&(v(),v=null)},F=h=>{if(!s()){if(w.start(h),i){const n=gt(p.value);b.value=Math.min(0,n-V())}y.value=0,a=b.value,r=Date.now(),f=a,v=null}},M=h=>{if(s())return;w.move(h),w.isVertical()&&(i=!0,ae(h,!0));const n=Z(a+w.deltaY.value,-(x()*e.optionHeight),e.optionHeight),u=g(n);u!==T.value&&t("scrollInto",e.options[u]),b.value=n;const c=Date.now();c-r>Se&&(r=c,f=n)},A=()=>{if(s())return;const h=b.value-f,n=Date.now()-r;if(n<Se&&Math.abs(h)>bt){S(h,n);return}const c=g(b.value);y.value=ye,k(c),setTimeout(()=>{i=!1},0)},N=()=>{const h={height:`${e.optionHeight}px`};return e.options.map((n,u)=>{const c=n[e.fields.text],{disabled:E}=n,$=n[e.fields.value],Be={role:"button",style:h,tabindex:E?-1:0,class:[X("item",{disabled:E,selected:$===e.value}),n.className],onClick:()=>m(u)},De={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:c};return o("li",Be,[l.option?l.option(n,u):o("div",De,null)])})};return Ce(Ve),le({stopMomentum:D}),Ae(()=>{const h=e.options.findIndex(c=>c[e.fields.value]===e.value),u=-te(e.options,h)*e.optionHeight;b.value=u}),we("touchmove",M,{target:d}),()=>o("div",{ref:d,class:X(),onTouchstartPassive:F,onTouchend:A,onTouchcancel:A},[o("ul",{ref:p,style:{transform:`translate3d(0, ${b.value+V()}px, 0)`,transitionDuration:`${y.value}ms`,transitionProperty:y.value?"all":"none"},class:X("wrapper"),onTransitionend:D},[N()])])}});const[St]=j("picker-toolbar"),G={title:String,cancelButtonText:String,confirmButtonText:String},Tt=["cancel","confirm","title","toolbar"],Ct=Object.keys(G);var wt=I({name:St,props:G,emits:["confirm","cancel"],setup(e,{emit:t,slots:l}){const i=()=>{if(l.title)return l.title();if(e.title)return o("div",{class:[O("title"),"van-ellipsis"]},[e.title])},a=()=>t("cancel"),r=()=>t("confirm"),f=()=>{const d=e.cancelButtonText||pe("cancel");return o("button",{type:"button",class:[O("cancel"),ce],onClick:a},[l.cancel?l.cancel():d])},v=()=>{const d=e.confirmButtonText||pe("confirm");return o("button",{type:"button",class:[O("confirm"),ce],onClick:r},[l.confirm?l.confirm():d])};return()=>o("div",{class:O("toolbar")},[l.toolbar?l.toolbar():[f(),i(),v()]])}});const[kt,qt]=j("picker-group"),Ot=Symbol(kt);H({tabs:q(),activeTab:z(0),nextStepText:String},G);const xt=H({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:z(44),showToolbar:ee,swipeDuration:z(1e3),visibleOptionNum:z(6)},G),Et=H({},xt,{columns:q(),modelValue:q(),toolbarPosition:$e("top"),columnsFieldNames:Object});var Pt=I({name:ft,props:Et,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:t,slots:l}){const i=C(),a=C(e.modelValue.slice(0)),{parent:r}=Ce(Ot),{children:f,linkChildren:v}=ke(Ve);v();const d=P(()=>pt(e.columnsFieldNames)),p=P(()=>Le(e.optionHeight)),b=P(()=>vt(e.columns,d.value)),y=P(()=>{const{columns:n}=e;switch(b.value){case"multiple":return n;case"cascade":return ht(n,d.value,a);default:return[n]}}),w=P(()=>y.value.some(n=>n.length)),x=P(()=>y.value.map((n,u)=>ne(n,a.value[u],d.value))),V=P(()=>y.value.map((n,u)=>n.findIndex(c=>c[d.value.value]===a.value[u]))),k=(n,u)=>{if(a.value[n]!==u){const c=a.value.slice(0);c[n]=u,a.value=c}},s=()=>({selectedValues:a.value.slice(0),selectedOptions:x.value,selectedIndexes:V.value}),m=(n,u)=>{k(u,n),b.value==="cascade"&&a.value.forEach((c,E)=>{const $=y.value[E];be($,c,d.value)||k(E,$.length?$[0][d.value.value]:void 0)}),de(()=>{t("change",H({columnIndex:u},s()))})},g=(n,u)=>{const c={columnIndex:u,currentOption:n};t("clickOption",H(s(),c)),t("scrollInto",c)},T=()=>{f.forEach(u=>u.stopMomentum());const n=s();return de(()=>{t("confirm",n)}),n},S=()=>t("cancel",s()),D=()=>y.value.map((n,u)=>o(yt,{value:a.value[u],fields:d.value,options:n,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:p.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:c=>m(c,u),onClickOption:c=>g(c,u),onScrollInto:c=>{t("scrollInto",{currentOption:c,columnIndex:u})}},{option:l.option})),F=n=>{if(w.value){const u={height:`${p.value}px`},c={backgroundSize:`100% ${(n-p.value)/2}px`};return[o("div",{class:O("mask"),style:c},null),o("div",{class:[Ke,O("frame")],style:u},null)]}},M=()=>{const n=p.value*+e.visibleOptionNum,u={height:`${n}px`};return o("div",{ref:i,class:O("columns"),style:u},[D(),F(n)])},A=()=>{if(e.showToolbar&&!r)return o(wt,je(re(e,Ct),{onConfirm:T,onCancel:S}),re(l,Tt))};J(y,n=>{n.forEach((u,c)=>{u.length&&!be(u,a.value[c],d.value)&&k(c,Pe(u)[d.value.value])})},{immediate:!0});let N;return J(()=>e.modelValue,n=>{!Q(n,a.value)&&!Q(n,N)&&(a.value=n.slice(0),N=n.slice(0))},{deep:!0}),J(a,n=>{Q(n,e.modelValue)||(N=n.slice(0),t("update:modelValue",N))},{immediate:!0}),we("touchmove",ae,{target:i}),le({confirm:T,getSelectedOptions:()=>x.value}),()=>{var n,u;return o("div",{class:O()},[e.toolbarPosition==="top"?A():null,e.loading?o(Re,{class:O("loading")},null):null,(n=l["columns-top"])==null?void 0:n.call(l),M(),(u=l["columns-bottom"])==null?void 0:u.call(l),e.toolbarPosition==="bottom"?A():null])}}});const ie=Oe(Pt),[It,Vt]=j("form"),Bt={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:Y,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:ee,showErrorMessage:ee,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var Dt=I({name:It,props:Bt,emits:["submit","failed"],setup(e,{emit:t,slots:l}){const{children:i,linkChildren:a}=ke(Ue),r=s=>s?i.filter(m=>s.includes(m.name)):i,f=s=>new Promise((m,g)=>{const T=[];r(s).reduce((D,F)=>D.then(()=>{if(!T.length)return F.validate().then(M=>{M&&T.push(M)})}),Promise.resolve()).then(()=>{T.length?g(T):m()})}),v=s=>new Promise((m,g)=>{const T=r(s);Promise.all(T.map(S=>S.validate())).then(S=>{S=S.filter(Boolean),S.length?g(S):m()})}),d=s=>{const m=i.find(g=>g.name===s);return m?new Promise((g,T)=>{m.validate().then(S=>{S?T(S):g()})}):Promise.reject()},p=s=>typeof s=="string"?d(s):e.validateFirst?f(s):v(s),b=s=>{typeof s=="string"&&(s=[s]),r(s).forEach(g=>{g.resetValidation()})},y=()=>i.reduce((s,m)=>(s[m.name]=m.getValidationStatus(),s),{}),w=(s,m)=>{i.some(g=>g.name===s?(g.$el.scrollIntoView(m),!0):!1)},x=()=>i.reduce((s,m)=>(m.name!==void 0&&(s[m.name]=m.formValue.value),s),{}),V=()=>{const s=x();p().then(()=>t("submit",s)).catch(m=>{t("failed",{values:s,errors:m}),e.scrollToError&&m[0].name&&w(m[0].name)})},k=s=>{ae(s),V()};return a({props:e}),le({submit:V,validate:p,getValues:x,scrollToField:w,resetValidation:b,getValidationStatus:y}),()=>{var s;return o("form",{class:Vt(),onSubmit:k},[(s=l.default)==null?void 0:s.call(l)])}}});const Mt=Oe(Dt);function Te(e){return typeof e=="function"?e():ze(e)}function Nt(e=!1,t={}){const{truthyValue:l=!0,falsyValue:i=!1}=t,a=Ye(e),r=C(e);function f(v){if(arguments.length)return r.value=v,r.value;{const d=Te(l);return r.value=r.value===d?Te(i):d,r.value}}return a?f:[r,f]}const _t=I({name:"LocaleSelector",setup(){const{changeLocale:e}=mt(),t=C(!1),l=qe.map(a=>({text:a.title,value:a.locale})),i=a=>{R(a),ue(a.selectedValues)&&e(Ge(a.selectedValues[0])),t.value=!1};return()=>o(se,null,[o(_,{plain:!0,hairline:!0,square:!0,type:"primary",size:"small",onClick:()=>{t.value=!0}},{default:()=>[L("语言")]}),o(oe,{show:t.value,round:!0,position:"bottom"},{default:()=>[o(ie,{columns:l,onConfirm:i,onCancel:()=>{t.value=!1}},null)]})])}}),Ht=I({name:"ThemePicker",setup(){const e=xe(),t=C(!1),l=Je.map(a=>({text:a.title,value:a.strategy})),i=a=>{if(R(a),t.value=!1,ue(a.selectedValues)){const r=Qe(a.selectedValues[0]);e.setDarkStrategy(r),e.setDark(me(r)),We(me(r))}};return()=>o(se,null,[o(_,{plain:!0,hairline:!0,type:"primary",size:"small",onClick:()=>{t.value=!0}},{default:()=>[L("深色模式")]}),o(oe,{show:t.value,round:!0,position:"bottom"},{default:()=>[o(ie,{columns:l,onConfirm:i,onCancel:()=>{t.value=!1}},null)]})])}}),Ft=I({name:"ThemeSelector",setup(){const e=xe(),t=C(!1),l=Xe.map(a=>({text:a.title,value:a.theme})),i=a=>{R(a),t.value=!1,ue(a.selectedValues)&&e.setTheme(Ze(a.selectedValues[0]))};return Ee(()=>B(this,null,function*(){R("Component <<ThemeSelector>> mounted.")})),()=>o(se,null,[o(_,{plain:!0,hairline:!0,type:"primary",size:"small",onClick:()=>{t.value=!0}},{default:()=>[L("主题")]}),o(oe,{show:t.value,round:!0,position:"bottom"},{default:()=>[o(ie,{columns:l,onConfirm:i,onCancel:()=>{t.value=!1}},null)]})])}});function At(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const Gt=I({name:"Login",setup(){const{t:e}=et(),t=tt(),l=nt(),[i,a]=Nt(!1),r=C(),f=fe(lt),v=fe({username:[{required:!0,message:"Please input username"}],password:[{required:!0,message:"Please input password"}]}),d=()=>B(this,null,function*(){yield r.value.validate(),t.login(f).then(()=>{l.push("/")})});return Ee(()=>B(this,null,function*(){R("Page <<Login>> mounted.")})),()=>{let p;return o("div",null,[o(st,{title:e("common.title")},null),o("div",{class:"mt-6"},[o(Mt,{ref:r},{default:()=>[o(ut,{inset:!0},{default:()=>[o(he,{modelValue:f.username,placeholder:e("common.user_field_username"),rules:v.username},{leftIcon:()=>o(W,null,{default:()=>[o(ve,{icon:"ion:person-outline"},null)]})}),o(he,{modelValue:f.password,placeholder:e("common.user_field_password"),rules:v.password,type:i?"password":"text"},{leftIcon:()=>o(W,null,{default:()=>[o(ve,{icon:"ion:lock-closed-outline"},null)]}),rightIcon:()=>o(W,{name:i?"closed-eye":"eye",onClick:()=>a(!i)},null)}),o("div",{class:"my-2"},[o(_,{onClick:d,type:"primary",block:!0},At(p=e("common.button_login"))?p:{default:()=>[p]})])]}),o(ot,{class:"px-4 pt-4"},{default:()=>[o(ge,{span:"12",class:"text-left"},{default:()=>[o(it,null,{default:()=>[o(_t,null,null),o(Ht,null,null),o(Ft,null,null)]})]}),o(ge,{span:"12",class:"text-right"},{default:()=>[o(_,{size:"small"},{default:()=>[L("忘记密码")]}),o(_,{size:"small"},{default:()=>[L("注册")]})]})]})]})])])}}});export{Gt as default};
