var $=(h,u,s)=>new Promise((t,e)=>{var i=a=>{try{r(s.next(a))}catch(o){e(o)}},n=a=>{try{r(s.throw(a))}catch(o){e(o)}},r=a=>a.done?t(a.value):Promise.resolve(a.value).then(i,n);r((s=s.apply(h,u)).next())});import{W as xt,X as qt,d as We,r as Se,o as je,l as K,G as It,D as Lt,a as ze,c as Ve,z as Jt,b as Q,u as Z,w as et,F as Qt}from"./index-Ca7YfF0C.js";/* empty css              */import{_ as b,a as w,u as f,b as L,c as R,s as P,V as Zt,d as T,e as ei,f as ti,U as Rt,W as be,g as O,h as N,t as ii,i as ni,j as ie,k as y,M as Me,P as z,l as F,X as A,C as ue,m as Be,n as ri,F as re,o as si,p as ai,q as x,r as At,R as oi,v as Dt,L as ne,w as X,x as ui,z as Ot,B as me,A as ve,D as li,G as de,H as ce,I as ci,J as j,K as tt,N as Nt,O as Ft,Q as hi,T as it,Y as fi,Z as di,$ as ye,a0 as nt,a1 as rt,a2 as st,a3 as at,a4 as ot,a5 as ut,a6 as He,a7 as Ue,a8 as Mt,a9 as we,aa as Bt,ab as J,ac as gi,ad as Pe,ae as Ht,af as Ye,ag as pi,ah as vi,ai as $e,aj as Te,ak as mi,al as Ke,am as Ut,an as yi,ao as _i,ap as lt,aq as Ti,ar as Ci,as as ct,at as Ie,au as ht,av as ki,aw as Si,ax as Ei,ay as bi,az as wi,aA as Pi,aB as xi,aC as Ii,aD as Li,aE as Ri,aF as Ai,aG as Di,aH as Oi,aI as Ni,aJ as Fi,aK as ft,aL as Mi,aM as Bi,aN as Hi}from"./index.min-BttqDj8_.js";/* empty css              *//* empty css              *//* empty css                                                                 *//* empty css              *//* empty css              */import{A as Le}from"./index-D4u-vQS3.js";import{C as Ui}from"./index-BFF6JTat.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";var Gt={exports:{}};(function(h){var u=Object.prototype.hasOwnProperty,s="~";function t(){}Object.create&&(t.prototype=Object.create(null),new t().__proto__||(s=!1));function e(a,o,l){this.fn=a,this.context=o,this.once=l||!1}function i(a,o,l,c,d){if(typeof l!="function")throw new TypeError("The listener must be a function");var g=new e(l,c||a,d),p=s?s+o:o;return a._events[p]?a._events[p].fn?a._events[p]=[a._events[p],g]:a._events[p].push(g):(a._events[p]=g,a._eventsCount++),a}function n(a,o){--a._eventsCount===0?a._events=new t:delete a._events[o]}function r(){this._events=new t,this._eventsCount=0}r.prototype.eventNames=function(){var o=[],l,c;if(this._eventsCount===0)return o;for(c in l=this._events)u.call(l,c)&&o.push(s?c.slice(1):c);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(l)):o},r.prototype.listeners=function(o){var l=s?s+o:o,c=this._events[l];if(!c)return[];if(c.fn)return[c.fn];for(var d=0,g=c.length,p=new Array(g);d<g;d++)p[d]=c[d].fn;return p},r.prototype.listenerCount=function(o){var l=s?s+o:o,c=this._events[l];return c?c.fn?1:c.length:0},r.prototype.emit=function(o,l,c,d,g,p){var v=s?s+o:o;if(!this._events[v])return!1;var m=this._events[v],k=arguments.length,C,S;if(m.fn){switch(m.once&&this.removeListener(o,m.fn,void 0,!0),k){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,c),!0;case 4:return m.fn.call(m.context,l,c,d),!0;case 5:return m.fn.call(m.context,l,c,d,g),!0;case 6:return m.fn.call(m.context,l,c,d,g,p),!0}for(S=1,C=new Array(k-1);S<k;S++)C[S-1]=arguments[S];m.fn.apply(m.context,C)}else{var D=m.length,I;for(S=0;S<D;S++)switch(m[S].once&&this.removeListener(o,m[S].fn,void 0,!0),k){case 1:m[S].fn.call(m[S].context);break;case 2:m[S].fn.call(m[S].context,l);break;case 3:m[S].fn.call(m[S].context,l,c);break;case 4:m[S].fn.call(m[S].context,l,c,d);break;default:if(!C)for(I=1,C=new Array(k-1);I<k;I++)C[I-1]=arguments[I];m[S].fn.apply(m[S].context,C)}}return!0},r.prototype.on=function(o,l,c){return i(this,o,l,c,!1)},r.prototype.once=function(o,l,c){return i(this,o,l,c,!0)},r.prototype.removeListener=function(o,l,c,d){var g=s?s+o:o;if(!this._events[g])return this;if(!l)return n(this,g),this;var p=this._events[g];if(p.fn)p.fn===l&&(!d||p.once)&&(!c||p.context===c)&&n(this,g);else{for(var v=0,m=[],k=p.length;v<k;v++)(p[v].fn!==l||d&&!p[v].once||c&&p[v].context!==c)&&m.push(p[v]);m.length?this._events[g]=m.length===1?m[0]:m:n(this,g)}return this},r.prototype.removeAllListeners=function(o){var l;return o?(l=s?s+o:o,this._events[l]&&n(this,l)):(this._events=new t,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prefixed=s,r.EventEmitter=r,h.exports=r})(Gt);var Wt=Gt.exports;const jt=xt(Wt);var Ge="3.0.12",dt={1:"media",2:"media",3:"media",4:"media",5:"media",6:"media"},gt={1:5101,2:5102,3:5103,4:5104,5:5105,6:5106},Ee=b(function h(u){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{errorType:"",errorCode:0,errorMessage:"",originError:"",ext:{},mediaError:null};w(this,h);var t=u&&u.i18n?u.i18n.ERROR_TYPES:null;if(u.media){var e=s.mediaError?s.mediaError:u.media.error||{},i=u.duration,n=u.currentTime,r=u.ended,a=u.src,o=u.currentSrc,l=u.media,c=l.readyState,d=l.networkState,g=s.errorCode||e.code;gt[g]&&(g=gt[g]);var p={playerVersion:Ge,currentTime:n,duration:i,ended:r,readyState:c,networkState:d,src:a||o,errorType:s.errorType,errorCode:g,message:s.errorMessage||e.message,mediaError:e,originError:s.originError?s.originError.stack:"",host:f.getHostFromUrl(a||o)};return s.ext&&Object.keys(s.ext).map(function(C){p[C]=s.ext[C]}),p}else if(arguments.length>1){for(var v={playerVersion:Ge,domain:document.domain},m=["errorType","currentTime","duration","networkState","readyState","src","currentSrc","ended","errd","errorCode","mediaError"],k=0;k<arguments.length;k++)v[m[k]]=arguments[k];return v.ex=t?(t[arguments[0]]||{}).msg:"",v}});function Re(h,u){!this||!this.emit||(h==="error"?this.errorHandler(h,u.error):this.emit(h,u))}function Gi(h,u){return function(s,t){var e={player:u,eventName:h,originalEvent:s,detail:s.detail||{},timeStamp:s.timeStamp,currentTime:u.currentTime,duration:u.duration,paused:u.paused,ended:u.ended,isInternalOp:!!u._internalOp[s.type],muted:u.muted,volume:u.volume,host:f.getHostFromUrl(u.currentSrc),vtype:u.vtype};if(u.removeInnerOP(s.type),h==="timeupdate"&&(u._currentTime=u.media&&u.media.currentTime),h==="ratechange"){var i=u.media?u.media.playbackRate:0;if(i&&u._rate===i)return;u._rate=u.media&&u.media.playbackRate}if(h==="durationchange"&&(u._duration=u.media.duration),h==="volumechange"&&(e.isMutedChange=u._lastMuted!==u.muted,u._lastMuted=u.muted),h==="error"&&(e.error=t||u.video.error),u.mediaEventMiddleware[h]){var n=Re.bind(u,h,e);try{u.mediaEventMiddleware[h].call(u,e,n)}catch(r){throw Re.call(u,h,e),r}}else Re.call(u,h,e)}}var Wi=function(h){L(s,h);var u=R(s);function s(t){var e;w(this,s),e=u.call(this,t),e._hasStart=!1,e._currentTime=0,e._duration=0,e._internalOp={},e._lastMuted=!1,e.vtype="MP4",e._rate=-1,e.mediaConfig=Object.assign({},{controls:!1,autoplay:t.autoplay,playsinline:t.playsinline,"x5-playsinline":t.playsinline,"webkit-playsinline":t.playsinline,"x5-video-player-fullscreen":t["x5-video-player-fullscreen"]||t.x5VideoPlayerFullscreen,"x5-video-orientation":t["x5-video-orientation"]||t.x5VideoOrientation,airplay:t.airplay,"webkit-airplay":t.airplay,tabindex:t.tabindex|0,mediaType:t.mediaType||"video","data-index":-1},t.videoConfig,t.videoAttributes);var i=t["x5-video-player-type"]||t.x5VideoPlayerType;return P.isWeixin&&P.os.isAndroid&&i&&(e.mediaConfig["x5-video-player-type"]=i,delete e.mediaConfig.playsinline,delete e.mediaConfig["webkit-playsinline"],delete e.mediaConfig["x5-playsinline"]),t.loop&&(e.mediaConfig.loop="loop"),t.autoplayMuted&&!Object.prototype.hasOwnProperty.call(e.mediaConfig,"muted")&&(e.mediaConfig.muted=!0),e.media=f.createDom(e.mediaConfig.mediaType,"",e.mediaConfig,""),t.defaultPlaybackRate&&(e.media.defaultPlaybackRate=e.media.playbackRate=t.defaultPlaybackRate),f.typeOf(t.volume)==="Number"&&(e.volume=t.volume),t.autoplayMuted&&(e.media.muted=!0,e._lastMuted=!0),t.autoplay&&(e.media.autoplay=!0),e._interval={},e.mediaEventMiddleware={},e.attachVideoEvents(),e}return b(s,[{key:"setEventsMiddleware",value:function(e){var i=this;Object.keys(e).map(function(n){i.mediaEventMiddleware[n]=e[n]})}},{key:"removeEventsMiddleware",value:function(e){var i=this;Object.keys(e).map(function(n){delete i.mediaEventMiddleware[n]})}},{key:"attachVideoEvents",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers||(this._evHandlers=Zt.map(function(n){var r="on".concat(n.charAt(0).toUpperCase()).concat(n.slice(1));return typeof e[r]=="function"&&e.on(n,e[r]),T({},n,Gi(n,e))})),this._evHandlers.forEach(function(n){var r=Object.keys(n)[0];i.addEventListener(r,n[r],!1)})}},{key:"detachVideoEvents",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers.forEach(function(n){var r=Object.keys(n)[0];i.removeEventListener(r,n[r],!1)}),this._evHandlers.forEach(function(n){var r=Object.keys(n)[0],a="on".concat(r.charAt(0).toUpperCase()).concat(r.slice(1));typeof e[a]=="function"&&e.off(r,e[a])}),this._evHandlers=null}},{key:"_attachSourceEvents",value:function(e,i){var n=this;e.removeAttribute("src"),e.load(),i.forEach(function(c,d){n.media.appendChild(f.createDom("source","",{src:"".concat(c.src),type:"".concat(c.type||""),"data-index":d+1}))});var r=e.children;if(r){this._videoSourceCount=r.length,this._videoSourceIndex=r.length,this._vLoadeddata=function(c){n.emit(ei,{src:c.target.currentSrc,host:f.getHostFromUrl(c.target.currentSrc)})};for(var a=null,o=0;o<this._evHandlers.length;o++)if(Object.keys(this._evHandlers[o])[0]==="error"){a=this._evHandlers[o];break}!this._sourceError&&(this._sourceError=function(c){var d=parseInt(c.target.getAttribute("data-index"),10);if(n._videoSourceIndex--,n._videoSourceIndex===0||d>=n._videoSourceCount){var g={code:4,message:"sources_load_error"};a?a.error(c,g):n.errorHandler("error",g)}var p=dt[4];n.emit(ti,new Ee(n,{errorType:p,errorCode:4,errorMessage:"sources_load_error",mediaError:{code:4,message:"sources_load_error"},src:c.target.src}))});for(var l=0;l<r.length;l++)r[l].addEventListener("error",this._sourceError);e.addEventListener("loadeddata",this._vLoadeddata)}}},{key:"_detachSourceEvents",value:function(e){var i=e.children;if(!(!i||i.length===0||!this._sourceError)){for(var n=0;n<i.length;n++)i[n].removeEventListener("error",this._sourceError);for(;i.length>0;)e.removeChild(i[0]);this._vLoadeddata&&e.removeEventListener("loadeddata",this._vLoadeddata)}}},{key:"errorHandler",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.media&&(this.media.error||i)){var n=this.media.error||i,r=n.code?dt[n.code]:"other",a=n.message;this.media.currentSrc||(a="empty_src",n={code:6,message:a}),this.emit(e,new Ee(this,{errorType:r,errorCode:n.code,errorMessage:n.message||"",mediaError:n}))}}},{key:"destroy",value:function(){this.media&&(this.media.pause&&(this.media.pause(),this.media.muted=!0),this.media.removeAttribute("src"),this.media.load()),this._currentTime=0,this._duration=0,this.mediaConfig=null;for(var e in this._interval)Object.prototype.hasOwnProperty.call(this._interval,e)&&(clearInterval(this._interval[e]),this._interval[e]=null);this.detachVideoEvents(),this.media=null,this.mediaEventMiddleware={},this.removeAllListeners()}},{key:"video",get:function(){return this.media},set:function(e){this.media=e}},{key:"play",value:function(){var e=this.media?this.media.play():null;return e}},{key:"pause",value:function(){this.media&&this.media.pause()}},{key:"load",value:function(){this.media&&this.media.load()}},{key:"canPlayType",value:function(e){return this.media?this.media.canPlayType(e):!1}},{key:"getBufferedRange",value:function(e){var i=[0,0];if(!this.media)return i;e||(e=this.media.buffered);var n=this.media.currentTime;if(e)for(var r=0,a=e.length;r<a&&(i[0]=e.start(r),i[1]=e.end(r),!(i[0]<=n&&n<=i[1]));r++);return i[0]-n<=0&&n-i[1]<=0?i:[0,0]}},{key:"autoplay",get:function(){return this.media?this.media.autoplay:!1},set:function(e){this.media&&(this.media.autoplay=e)}},{key:"buffered",get:function(){return this.media?this.media.buffered:null}},{key:"buffered2",get:function(){return this.media&&this.media.buffered?f.getBuffered2(this.media.buffered):null}},{key:"bufferedPoint",get:function(){var e={start:0,end:0};if(!this.media)return e;var i=this.media.buffered;if(!i||i.length===0)return e;for(var n=0;n<i.length;n++)if((i.start(n)<=this.currentTime||i.start(n)<.1)&&i.end(n)>=this.currentTime)return{start:i.start(n),end:i.end(n)};return e}},{key:"crossOrigin",get:function(){return this.media?this.media.crossOrigin:""},set:function(e){this.media&&(this.media.crossOrigin=e)}},{key:"currentSrc",get:function(){return this.media?this.media.currentSrc:""},set:function(e){this.media&&(this.media.currentSrc=e)}},{key:"currentTime",get:function(){return this.media?this.media.currentTime!==void 0?this.media.currentTime:this._currentTime:0},set:function(e){this.media&&(this.media.currentTime=e)}},{key:"defaultMuted",get:function(){return this.media?this.media.defaultMuted:!1},set:function(e){this.media&&(this.media.defaultMuted=e)}},{key:"duration",get:function(){return this._duration}},{key:"ended",get:function(){return this.media?this.media.ended:!1}},{key:"error",get:function(){return this.media.error}},{key:"errorNote",get:function(){var e=this.media.error;if(!e)return"";var i=["MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED"];return i[this.media.error.code-1]}},{key:"loop",get:function(){return this.media?this.media.loop:!1},set:function(e){this.media&&(this.media.loop=e)}},{key:"muted",get:function(){return this.media?this.media.muted:!1},set:function(e){!this.media||this.media.muted===e||(this._lastMuted=this.media.muted,this.media.muted=e)}},{key:"networkState",get:function(){return this.media.networkState}},{key:"paused",get:function(){return this.media?this.media.paused:!0}},{key:"playbackRate",get:function(){return this.media?this.media.playbackRate:0},set:function(e){!this.media||e===1/0||(this.media.defaultPlaybackRate=e,this.media.playbackRate=e)}},{key:"played",get:function(){return this.media?this.media.played:null}},{key:"preload",get:function(){return this.media?this.media.preload:!1},set:function(e){this.media&&(this.media.preload=e)}},{key:"readyState",get:function(){return this.media.readyState}},{key:"seekable",get:function(){return this.media?this.media.seekable:!1}},{key:"seeking",get:function(){return this.media?this.media.seeking:!1}},{key:"src",get:function(){return this.media?this.media.src:""},set:function(e){if(this.media){if(this.emit(Rt,e),this.emit(be),this._currentTime=0,this._duration=0,f.isMSE(this.media)){this.onWaiting();return}this._detachSourceEvents(this.media),f.typeOf(e)==="Array"?this._attachSourceEvents(this.media,e):e?this.media.src=e:this.media.removeAttribute("src"),this.load()}}},{key:"volume",get:function(){return this.media?this.media.volume:0},set:function(e){e===1/0||!this.media||(this.media.volume=e)}},{key:"addInnerOP",value:function(e){this._internalOp[e]=!0}},{key:"removeInnerOP",value:function(e){delete this._internalOp[e]}},{key:"emit",value:function(e,i){for(var n,r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];(n=O(N(s.prototype),"emit",this)).call.apply(n,[this,e,i].concat(a))}},{key:"on",value:function(e,i){for(var n,r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];(n=O(N(s.prototype),"on",this)).call.apply(n,[this,e,i].concat(a))}},{key:"once",value:function(e,i){for(var n,r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];(n=O(N(s.prototype),"once",this)).call.apply(n,[this,e,i].concat(a))}},{key:"off",value:function(e,i){for(var n,r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];(n=O(N(s.prototype),"off",this)).call.apply(n,[this,e,i].concat(a))}},{key:"offAll",value:function(){O(N(s.prototype),"removeAllListeners",this).call(this)}}]),s}(jt),ji=function(){function h(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{name:"xgplayer",version:1,db:null,ojstore:{name:"xg-m4a",keypath:"vid"}};w(this,h),this.indexedDB=window.indexedDB||window.webkitindexedDB,this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,this.myDB=u}return b(h,[{key:"openDB",value:function(s){var t=this,e=this,i=this.myDB.version||1,n=e.indexedDB.open(e.myDB.name,i);n.onerror=function(r){},n.onsuccess=function(r){t.myDB.db=r.target.result,s.call(e)},n.onupgradeneeded=function(r){var a=r.target.result;r.target.transaction,a.objectStoreNames.contains(e.myDB.ojstore.name)||a.createObjectStore(e.myDB.ojstore.name,{keyPath:e.myDB.ojstore.keypath})}}},{key:"deletedb",value:function(){var s=this;s.indexedDB.deleteDatabase(this.myDB.name)}},{key:"closeDB",value:function(){this.myDB.db.close()}},{key:"addData",value:function(s,t){for(var e=this.myDB.db.transaction(s,"readwrite").objectStore(s),i,n=0;n<t.length;n++)i=e.add(t[n]),i.onerror=function(){},i.onsuccess=function(){}}},{key:"putData",value:function(s,t){for(var e=this.myDB.db.transaction(s,"readwrite").objectStore(s),i,n=0;n<t.length;n++)i=e.put(t[n]),i.onerror=function(){},i.onsuccess=function(){}}},{key:"getDataByKey",value:function(s,t,e){var i=this,n=this.myDB.db.transaction(s,"readwrite").objectStore(s),r=n.get(t);r.onerror=function(){e.call(i,null)},r.onsuccess=function(a){var o=a.target.result;e.call(i,o)}}},{key:"deleteData",value:function(s,t){var e=this.myDB.db.transaction(s,"readwrite").objectStore(s);e.delete(t)}},{key:"clearData",value:function(s){var t=this.myDB.db.transaction(s,"readwrite").objectStore(s);t.clear()}}]),h}(),pt=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],vt=["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],mt=["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],te="data-xgplayerid",zi=function(){function h(){var u=this;if(w(this,h),T(this,"__trigger",function(s){var t=new Date().getTime();u.timeStamp=t;for(var e=0;e<s.length;e++)u.__runHandler(s[e].target)}),this.__handlers=[],this.timeStamp=0,this.observer=null,!!window.ResizeObserver)try{this.observer=new window.ResizeObserver(ii(this.__trigger,100,{trailing:!0})),this.timeStamp=new Date().getTime()}catch(s){console.error(s)}}return b(h,[{key:"addObserver",value:function(s,t){if(this.observer){this.observer&&this.observer.observe(s);for(var e=s.getAttribute(te),i=this.__handlers,n=-1,r=0;r<i.length;r++)i[r]&&s===i[r].target&&(n=r);n>-1?this.__handlers[n].handler=t:this.__handlers.push({target:s,handler:t,playerId:e})}}},{key:"unObserver",value:function(s){var t=-1;this.__handlers.map(function(e,i){s===e.target&&(t=i)});try{this.observer&&this.observer.unobserve(s)}catch(e){}this.observer&&this.observer.unobserve(s),t>-1&&this.__handlers.splice(t,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(s){for(var t=this.__handlers,e=0;e<t.length;e++)if(t[e]&&s===t[e].target){try{t[e].handler(s)}catch(i){console.error(i)}return!0}return!1}}]),h}(),pe=null;function Vi(h,u){return pe||(pe=new zi),pe.addObserver(h,u),pe}function Yi(h,u){pe.unObserver(h,u)}var M={pluginGroup:{},init:function(u){var s=u._pluginInfoId;s||(s=new Date().getTime(),u._pluginInfoId=s),!u.config.closeResizeObserver&&Vi(u.root,function(){u.resize()}),this.pluginGroup[s]={_originalOptions:u.config||{},_plugins:{}}},formatPluginInfo:function(u,s){var t=null,e=null;return u.plugin&&typeof u.plugin=="function"?(t=u.plugin,e=u.options):(t=u,e={}),s&&(e.config=s||{}),{PLUFGIN:t,options:e}},checkPluginIfExits:function(u,s){for(var t=0;t<s.length;t++)if(u.toLowerCase()===s[t].pluginName.toLowerCase())return!0;return!1},getRootByConfig:function(u,s){for(var t=Object.keys(s),e=null,i=0;i<t.length;i++)if(u.toLowerCase()===t[i].toLowerCase()){e=s[t[i]];break}return f.typeOf(e)==="Object"?{root:e.root,position:e.position}:{}},lazyRegister:function(u,s){var t=this,e=s.timeout||1500;return Promise.race([s.loader().then(function(i){var n;i&&i.__esModule?n=i.default:n=i,t.register(u,n,i.options)}),new Promise(function(i,n){setTimeout(function(){n(new Error("timeout"))},e)})])},register:function(u,s){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(!u||!s||typeof s!="function"||s.prototype===void 0)){var e=u._pluginInfoId;if(!(!e||!this.pluginGroup[e])){this.pluginGroup[e]._plugins||(this.pluginGroup[e]._plugins={});var i=this.pluginGroup[e]._plugins,n=this.pluginGroup[e]._originalOptions;t.player=u;var r=t.pluginName||s.pluginName;if(!r)throw new Error("The property pluginName is necessary");if(s.isSupported&&!s.isSupported(u.config.mediaType,u.config.codecType)){console.warn("not supported plugin [".concat(r,"]"));return}t.config||(t.config={});for(var a=Object.keys(n),o=0;o<a.length;o++)if(r.toLowerCase()===a[o].toLowerCase()){var l=n[a[o]];f.typeOf(l)==="Object"?t.config=Object.assign({},t.config,n[a[o]]):f.typeOf(l)==="Boolean"&&(t.config.disable=!l);break}s.defaultConfig&&Object.keys(s.defaultConfig).forEach(function(d){typeof t.config[d]=="undefined"&&(t.config[d]=s.defaultConfig[d])}),t.root?typeof t.root=="string"&&(t.root=u[t.root]):t.root=u.root,t.index=t.config.index||0;try{i[r.toLowerCase()]&&(this.unRegister(e,r.toLowerCase()),console.warn("the is one plugin with same pluginName [".concat(r,"] exist, destroy the old instance")));var c=new s(t);return i[r.toLowerCase()]=c,i[r.toLowerCase()].func=s,c&&typeof c.afterCreate=="function"&&c.afterCreate(),c}catch(d){throw console.error(d),d}}}},unRegister:function(u,s){u._pluginInfoId&&(u=u._pluginInfoId),s=s.toLowerCase();try{var t=this.pluginGroup[u]._plugins[s];t&&(t.pluginName&&t.__destroy(),delete this.pluginGroup[u]._plugins[s])}catch(e){console.error("[unRegister:".concat(s,"] cgid:[").concat(u,"] error"),e)}},deletePlugin:function(u,s){var t=u._pluginInfoId;t&&this.pluginGroup[t]&&this.pluginGroup[t]._plugins&&delete this.pluginGroup[t]._plugins[s]},getPlugins:function(u){var s=u._pluginInfoId;return s&&this.pluginGroup[s]?this.pluginGroup[s]._plugins:{}},findPlugin:function(u,s){var t=u._pluginInfoId;if(!t||!this.pluginGroup[t])return null;var e=s.toLowerCase();return this.pluginGroup[t]._plugins[e]},beforeInit:function(u){var s=this;function t(e){return!e||!e.then?new Promise(function(i){i()}):e}return new Promise(function(e){if(s.pluginGroup){var i;return u._loadingPlugins&&u._loadingPlugins.length?i=Promise.all(u._loadingPlugins):i=Promise.resolve(),i.then(function(){var n=u._pluginInfoId;if(!s.pluginGroup[n]){e();return}var r=s.pluginGroup[n]._plugins,a=[];Object.keys(r).forEach(function(o){if(r[o]&&r[o].beforePlayerInit)try{var l=r[o].beforePlayerInit();a.push(t(l))}catch(c){throw a.push(t(null)),c}}),Promise.all([].concat(a)).then(function(){e()}).catch(function(o){console.error(o),e()})})}})},afterInit:function(u){var s=u._pluginInfoId;if(!(!s||!this.pluginGroup[s])){var t=this.pluginGroup[s]._plugins;Object.keys(t).forEach(function(e){t[e]&&t[e].afterPlayerInit&&t[e].afterPlayerInit()})}},setLang:function(u,s){var t=s._pluginInfoId;if(!(!t||!this.pluginGroup[t])){var e=this.pluginGroup[t]._plugins;Object.keys(e).forEach(function(i){if(e[i].updateLang)e[i].updateLang(u);else try{e[i].lang=u}catch(n){console.warn("".concat(i," setLang"))}})}},reRender:function(u){var s=this,t=u._pluginInfoId;if(!(!t||!this.pluginGroup[t])){var e=[],i=this.pluginGroup[t]._plugins;Object.keys(i).forEach(function(n){n!=="controls"&&i[n]&&(e.push({plugin:i[n].func,options:i[n].__args}),s.unRegister(t,n))}),e.forEach(function(n){s.register(u,n.plugin,n.options)})}},onPluginsReady:function(u){var s=u._pluginInfoId;if(!(!s||!this.pluginGroup[s])){var t=this.pluginGroup[s]._plugins||{};Object.keys(t).forEach(function(e){t[e].onPluginsReady&&typeof t[e].onPluginsReady=="function"&&t[e].onPluginsReady()})}},destroy:function(u){var s=u._pluginInfoId;if(this.pluginGroup[s]){Yi(u.root);for(var t=this.pluginGroup[s]._plugins,e=0,i=Object.keys(t);e<i.length;e++){var n=i[e];this.unRegister(s,n)}var r=u.isUseActive;if(delete this.pluginGroup[s],delete u._pluginInfoId,r){var a=Object.keys(this.pluginGroup);a.length>0&&this.setCurrentUserActive(a[a.length-1],!0)}}}},_={DEFAULT:"xgplayer",DEFAULT_SKIN:"xgplayer-skin-default",ENTER:"xgplayer-is-enter",PAUSED:"xgplayer-pause",PLAYING:"xgplayer-playing",ENDED:"xgplayer-ended",CANPLAY:"xgplayer-canplay",LOADING:"xgplayer-isloading",ERROR:"xgplayer-is-error",REPLAY:"xgplayer-replay",NO_START:"xgplayer-nostart",ACTIVE:"xgplayer-active",INACTIVE:"xgplayer-inactive",FULLSCREEN:"xgplayer-is-fullscreen",CSS_FULLSCREEN:"xgplayer-is-cssfullscreen",ROTATE_FULLSCREEN:"xgplayer-rotate-fullscreen",PARENT_ROTATE_FULLSCREEN:"xgplayer-rotate-parent",PARENT_FULLSCREEN:"xgplayer-fullscreen-parent",INNER_FULLSCREEN:"xgplayer-fullscreen-inner",NO_CONTROLS:"no-controls",FLEX_CONTROLS:"flex-controls",CONTROLS_FOLLOW:"controls-follow",CONTROLS_AUTOHIDE:"controls-autohide",TOP_BAR_AUTOHIDE:"top-bar-autohide",NOT_ALLOW_AUTOPLAY:"not-allow-autoplay",SEEKING:"seeking",PC:"xgplayer-pc",MOBILE:"xgplayer-mobile",MINI:"xgplayer-mini"};function yt(){return{id:"",el:null,url:"",domEventType:"default",nullUrlStart:!1,width:600,height:337.5,fluid:!1,fitVideoSize:"fixed",videoFillMode:"auto",volume:.6,autoplay:!1,autoplayMuted:!1,loop:!1,isLive:!1,zoom:1,videoInit:!0,poster:"",isMobileSimulateMode:!1,defaultPlaybackRate:1,execBeforePluginsCall:null,allowSeekAfterEnded:!0,enableContextmenu:!0,closeVideoClick:!1,closeVideoDblclick:!1,closePlayerBlur:!1,closeDelayBlur:!1,leavePlayerTime:3e3,closePlayVideoFocus:!1,closePauseVideoFocus:!1,closeFocusVideoFocus:!0,closeControlsBlur:!0,topBarAutoHide:!0,videoAttributes:{},startTime:0,seekedStatus:"play",miniprogress:!1,disableSwipeHandler:function(){},enableSwipeHandler:function(){},preProcessUrl:null,ignores:[],whitelist:[],inactive:3e3,lang:ni(),controls:!0,marginControls:!1,fullscreenTarget:null,screenShot:!1,rotate:!1,pip:!1,download:!1,mini:!1,cssFullscreen:!0,keyShortcut:!0,presets:[],plugins:[],playbackRate:1,definition:{list:[]},playsinline:!0,customDuration:0,timeOffset:0,icons:{},i18n:[],tabindex:0,thumbnail:null,videoConfig:{},isHideTips:!1,minWaitDelay:200,commonStyle:{progressColor:"",playedColor:"",cachedColor:"",sliderBtnStyle:{},volumeColor:""}}}var $i=function(u,s){var t,e,i;s.preset&&s.options?i=new s.preset(s.options,u.config):i=new s({},u.config);var n=i,r=n.plugins,a=r===void 0?[]:r,o=n.ignores,l=o===void 0?[]:o,c=n.icons,d=c===void 0?{}:c,g=n.i18n,p=g===void 0?[]:g;u.config.plugins||(u.config.plugins=[]),u.config.ignores||(u.config.ignores=[]),(t=u.config.plugins).push.apply(t,ie(a)),(e=u.config.ignores).push.apply(e,ie(l)),Object.keys(d).map(function(m){u.config.icons[m]||(u.config.icons[m]=d[m])});var v=u.config.i18n||[];p.push.apply(p,ie(v)),u.config.i18n=p},Ki=function(h){L(s,h);var u=R(s);function s(){var t;w(this,s);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=u.call.apply(u,[this].concat(i)),T(y(t),"onMouseEnter",function(r){var a=y(t),o=a.player,l=a.playerConfig;l.closeControlsBlur&&o.focus({autoHide:!1})}),T(y(t),"onMouseLeave",function(r){var a=y(t),o=a.player;o.focus()}),t}return b(s,[{key:"beforeCreate",value:function(e){!e.config.mode&&P.device==="mobile"&&(e.config.mode="flex"),e.player.config.marginControls&&(e.config.autoHide=!1)}},{key:"afterCreate",value:function(){var e=this,i=this.config,n=i.disable,r=i.height,a=i.mode;if(!n){a==="flex"&&this.player.addClass(_.FLEX_CONTROLS);var o={height:"".concat(r,"px")};Object.keys(o).map(function(c){e.root.style[c]=o[c]}),this.left=this.find("xg-left-grid"),this.center=this.find("xg-center-grid"),this.right=this.find("xg-right-grid"),this.innerRoot=this.find("xg-inner-controls"),this.on(Me,function(c){c?f.addClass(e.root,"mini-controls"):f.removeClass(e.root,"mini-controls")});var l=this.playerConfig.isMobileSimulateMode;P.device!=="mobile"&&l!=="mobile"&&(this.bind("mouseenter",this.onMouseEnter),this.bind("mouseleave",this.onMouseLeave))}}},{key:"focus",value:function(){this.player.focus({autoHide:!1})}},{key:"focusAwhile",value:function(){this.player.focus({autoHide:!0})}},{key:"blur",value:function(){this.player.blur({ignorePaused:!0})}},{key:"recoverAutoHide",value:function(){this.config.autoHide&&f.addClass(this.root,_.CONTROLS_AUTOHIDE)}},{key:"pauseAutoHide",value:function(){f.removeClass(this.root,_.CONTROLS_AUTOHIDE)}},{key:"show",value:function(e){this.root.style.display="",this.player.focus()}},{key:"hide",value:function(){this.root.style.display="none"}},{key:"mode",get:function(){return this.config.mode}},{key:"registerPlugin",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(this.root){var r=e.defaultConfig||{};if(!i.root){var a=i.position?i.position:i.config&&i.config.position?i.config.position:r.position;switch(a){case z.CONTROLS_LEFT:i.root=this.left;break;case z.CONTROLS_RIGHT:i.root=this.right;break;case z.CONTROLS_CENTER:i.root=this.center;break;case z.CONTROLS:i.root=this.root;break;default:i.root=this.left}return O(N(s.prototype),"registerPlugin",this).call(this,e,i,n)}}}},{key:"destroy",value:function(){P.device!=="mobile"&&(this.unbind("mouseenter",this.onMouseEnter),this.unbind("mouseleave",this.onMouseLeave))}},{key:"render",value:function(){var e=this.config,i=e.mode,n=e.autoHide,r=e.initShow,a=e.disable;if(!a){var o=f.classNames({"xgplayer-controls":!0},{"flex-controls":i==="flex"},{"bottom-controls":i==="bottom"},T({},_.CONTROLS_AUTOHIDE,n),{"xgplayer-controls-initshow":r||!n});return'<xg-controls class="'.concat(o,`" unselectable="on">
    <xg-inner-controls class="xg-inner-controls xg-pos">
      <xg-left-grid class="xg-left-grid">
      </xg-left-grid>
      <xg-center-grid class="xg-center-grid"></xg-center-grid>
      <xg-right-grid class="xg-right-grid">
      </xg-right-grid>
    </xg-inner-controls>
    </xg-controls>`)}}}],[{key:"pluginName",get:function(){return"controls"}},{key:"defaultConfig",get:function(){return{disable:!1,autoHide:!0,mode:"",initShow:!1}}}]),s}(F),Xi={LANG:"en",TEXT:{ERROR_TYPES:{network:{code:1,msg:"video download error"},mse:{code:2,msg:"stream append error"},parse:{code:3,msg:"parsing error"},format:{code:4,msg:"wrong format"},decoder:{code:5,msg:"decoding error"},runtime:{code:6,msg:"grammatical errors"},timeout:{code:7,msg:"play timeout"},other:{code:8,msg:"other errors"}},HAVE_NOTHING:"There is no information on whether audio/video is ready",HAVE_METADATA:"Audio/video metadata is ready ",HAVE_CURRENT_DATA:"Data about the current play location is available, but there is not enough data to play the next frame/millisecond",HAVE_FUTURE_DATA:"Current and at least one frame of data is available",HAVE_ENOUGH_DATA:"The available data is sufficient to start playing",NETWORK_EMPTY:"Audio/video has not been initialized",NETWORK_IDLE:"Audio/video is active and has been selected for resources, but no network is used",NETWORK_LOADING:"The browser is downloading the data",NETWORK_NO_SOURCE:"No audio/video source was found",MEDIA_ERR_ABORTED:"The fetch process is aborted by the user",MEDIA_ERR_NETWORK:"An error occurred while downloading",MEDIA_ERR_DECODE:"An error occurred while decoding",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video is not supported",REPLAY:"Replay",ERROR:"Network is offline",PLAY_TIPS:"Play",PAUSE_TIPS:"Pause",PLAYNEXT_TIPS:"Play next",DOWNLOAD_TIPS:"Download",ROTATE_TIPS:"Rotate",RELOAD_TIPS:"Reload",FULLSCREEN_TIPS:"Fullscreen",EXITFULLSCREEN_TIPS:"Exit fullscreen",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Exit cssfullscreen",TEXTTRACK:"Caption",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Off",OPEN:"Open",MINI_DRAG:"Click and hold to drag",MINISCREEN:"Miniscreen",REFRESH_TIPS:"Please Try",REFRESH:"Refresh",FORWARD:"forward",LIVE_TIP:"Live"}},G={lang:{},langKeys:[],textKeys:[]};function _e(h,u){return Object.keys(u).forEach(function(s){var t=f.typeOf(u[s]),e=f.typeOf(h[s]);if(t==="Array"){var i;e!=="Array"&&(h[s]=[]),(i=h[s]).push.apply(i,ie(u[s]))}else t==="Object"?(e!=="Object"&&(h[s]={}),_e(h[s],u[s])):h[s]=u[s]}),h}function zt(){Object.keys(G.lang.en).map(function(h){G.textKeys[h]=h})}function qi(h,u){var s=[];if(u||(u=G),!!u.lang){f.typeOf(h)!=="Array"?s=Object.keys(h).map(function(i){var n=i==="zh"?"zh-cn":i;return{LANG:n,TEXT:h[i]}}):s=h;var t=u,e=t.lang;s.map(function(i){i.LANG==="zh"&&(i.LANG="zh-cn"),e[i.LANG]?_e(e[i.LANG]||{},i.TEXT||{}):Xe(i,u)}),zt()}}function Xe(h,u){var s=h.LANG;if(u||(u=G),!!u.lang){var t=h.TEXT||{};s==="zh"&&(s="zh-cn"),u.lang[s]?_e(u.lang[s],t):(u.langKeys.push(s),u.lang[s]=t),zt()}}function Ji(h){var u,s={lang:{},langKeys:[],textKeys:{},pId:h};return _e(s.lang,G.lang),(u=s.langKeys).push.apply(u,ie(G.langKeys)),_e(s.textKeys,G.textKeys),s}Xe(Xi);var le={get textKeys(){return G.textKeys},get langKeys(){return G.langKeys},get lang(){var h={};return G.langKeys.map(function(u){h[u]=G.lang[u]}),G.lang["zh-cn"]&&(h.zh=G.lang["zh-cn"]||{}),h},extend:qi,use:Xe,init:Ji},U={},Ae=null,Vt=function(h){L(s,h);var u=R(s);function s(){return w(this,s),u.apply(this,arguments)}return b(s,[{key:"add",value:function(e){e&&(U[e.playerId]=e,Object.keys(U).length===1&&this.setActive(e.playerId,!0))}},{key:"remove",value:function(e){e&&(e.isUserActive,delete U[e.playerId])}},{key:"_iterate",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(var n in U)if(Object.prototype.hasOwnProperty.call(U,n)){var r=U[n];if(i){if(e(r))break}else e(r)}}},{key:"forEach",value:function(e){this._iterate(e)}},{key:"find",value:function(e){var i=null;return this._iterate(function(n){var r=e(n);return r&&(i=n),r},!0),i}},{key:"findAll",value:function(e){var i=[];return this._iterate(function(n){e(n)&&i.push(n)}),i}},{key:"setActive",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(U[e])return i?this.forEach(function(n){e===n.playerId?(n.isUserActive=!0,n.isInstNext=!1):n.isUserActive=!1}):U[e].isUserActive=i,e}},{key:"getActiveId",value:function(){for(var e=Object.keys(U),i=0;i<e.length;i++){var n=U[e[i]];if(n&&n.isUserActive)return e[i]}return null}},{key:"setNext",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(U[e])return i?this.forEach(function(n){e===n.playerId?(n.isUserActive=!1,n.isInstNext=!0):n.isInstNext=!1}):U[e].isInstNext=i,e}}],[{key:"getInstance",value:function(){return Ae||(Ae=new s),Ae}}]),s}(Wt.EventEmitter);function Qi(h){for(var u=Object.keys(U),s=0;s<u.length;s++){var t=U[u[s]];if(t.root===h)return t}return null}var Zi=["play","pause","replay","retry"],_t=0,Tt=0,ee=null,xe=function(h){L(s,h);var u=R(s);function s(t){var e;w(this,s);var i=f.deepMerge(yt(),t);e=u.call(this,i),T(y(e),"canPlayFunc",function(){if(e.config){var p=e.config,v=p.autoplay,m=p.defaultPlaybackRate;A.logInfo("player","canPlayFunc, startTime",e.__startTime),e.__startTime>0&&e.duration>0&&(e.currentTime=e.__startTime>e.duration?e.duration:e.__startTime,e.__startTime=-1),e.playbackRate=m,(v||e._useAutoplay)&&e.mediaPlay(),e.off(ue,e.canPlayFunc),e.removeClass(_.ENTER)}}),T(y(e),"onFullscreenChange",function(p,v){var m=function(){f.setTimeout(y(e),function(){e.resize()},100)},k=f.getFullScreenEl();e._fullActionFrom?e._fullActionFrom="":e.emit(Be,{eventType:"system",action:"switch_fullscreen",pluginName:"player",currentTime:e.currentTime,duration:e.duration,props:[{prop:"fullscreen",from:!0,to:!1}]});var C=ri(k,e.playerId,te);if(v||k&&(k===e._fullscreenEl||C))m(),!e.config.closeFocusVideoFocus&&e.media.focus(),e.fullscreen=!0,e.changeFullStyle(e.root,k,_.FULLSCREEN),e.emit(re,!0,e._fullScreenOffset),e.cssfullscreen&&e.exitCssFullscreen();else if(e.fullscreen){m();var S=y(e),D=S._fullScreenOffset,I=S.config;I.needFullscreenScroll?(window.scrollTo(D.left,D.top),f.setTimeout(y(e),function(){e.fullscreen=!1,e._fullScreenOffset=null},100)):(!e.config.closeFocusVideoFocus&&e.media.focus(),e.fullscreen=!1,e._fullScreenOffset=null),e.cssfullscreen?e.removeClass(_.FULLSCREEN):e.recoverFullStyle(e.root,e._fullscreenEl,_.FULLSCREEN),e._fullscreenEl=null,e.emit(re,!1)}}),T(y(e),"_onWebkitbeginfullscreen",function(p){e._fullscreenEl=e.media,e.onFullscreenChange(p,!0)}),T(y(e),"_onWebkitendfullscreen",function(p){e.onFullscreenChange(p,!1)}),si(y(e),Zi),e.config=i,e._pluginInfoId=f.generateSessionId(),ai(y(e));var n=e.constructor.defaultPreset;if(e.config.presets.length){var r=e.config.presets.indexOf("default");r>=0&&n&&(e.config.presets[r]=n)}else n&&e.config.presets.push(n);e.userTimer=null,e.waitTimer=null,e._state=x.INITIAL,e.isError=!1,e._hasStart=!1,e.isSeeking=!1,e.isCanplay=!1,e._useAutoplay=!1,e.__startTime=-1,e.rotateDeg=0,e.isActive=!1,e.fullscreen=!1,e.cssfullscreen=!1,e.isRotateFullscreen=!1,e._fullscreenEl=null,e.timeSegments=[],e._cssfullscreenEl=null,e.curDefinition=null,e._orgCss="",e._fullScreenOffset=null,e._videoHeight=0,e._videoWidth=0,e.videoPos={pi:1,scale:0,rotate:-1,x:0,y:0,h:-1,w:-1,vy:0,vx:0},e.sizeInfo={width:0,height:0,left:0,top:0},e._accPlayed={t:0,acc:0,loopAcc:0},e._offsetInfo={currentTime:-1,duration:0},e.innerContainer=null,e.controls=null,e.topBar=null,e.root=null,e.__i18n=le.init(e._pluginInfoId),P.os.isAndroid&&P.osVersion>0&&P.osVersion<6&&(e.config.autoplay=!1),e.database=new ji,e.isUserActive=!1,e._onceSeekCanplay=null,e._isPauseBeforeSeek=0,e.innerStates={isActiveLocked:!1},e.instManager=ee;var a=e._initDOM();if(!a)return console.error(new Error("can't find the dom which id is ".concat(e.config.id," or this.config.el does not exist"))),At(e);var o=e.config,l=o.definition,c=l===void 0?{}:l,d=o.url;if(!d&&c.list&&c.list.length>0){var g=c.list.find(function(p){return p.definition&&p.definition===c.defaultDefinition});g||(c.defaultDefinition=c.list[0].definition,g=c.list[0]),e.config.url=g.url,e.curDefinition=g}return e._bindEvents(),e._registerPresets(),e._registerPlugins(),M.onPluginsReady(y(e)),e.getInitDefinition(),e.setState(x.READY),f.setTimeout(y(e),function(){e.emit(oi)},0),e.onReady&&e.onReady(),(e.config.videoInit||e.config.autoplay)&&(!e.hasStart||e.state<x.ATTACHED)&&e.start(),e}return b(s,[{key:"_initDOM",value:function(){var e,i=this;if(this.root=this.config.id?document.getElementById(this.config.id):null,!this.root){var n=this.config.el;if(n&&n.nodeType===1)this.root=n;else return this.emit(Dt,new Ee("use",this.config.vid,{line:32,handle:"Constructor",msg:"container id can't be empty"})),console.error("this.confg.id or this.config.el can't be empty"),!1}var r=Qi(this.root);r&&(A.logWarn("The is an Player instance already exists in this.root, destroy it and reinitialize"),r.destroy()),this.root.setAttribute(te,this.playerId),(e=ee)===null||e===void 0||e.add(this),M.init(this),this._initBaseDoms();var a=this.constructor.XgVideoProxy;if(a&&this.mediaConfig.mediaType===a.mediaType){var o=this.innerContainer||this.root;this.detachVideoEvents(this.media);var l=new a(o,this.config,this.mediaConfig);this.attachVideoEvents(l),this.media=l}if(this.media.setAttribute(te,this.playerId),this.config.controls){var c=this.config.controls.root||null,d=M.register(this,Ki,{root:c});this.controls=d}var g=this.config.isMobileSimulateMode==="mobile"?"mobile":P.device;if(this.addClass("".concat(_.DEFAULT," ").concat(_.INACTIVE," xgplayer-").concat(g," ").concat(this.config.controls?"":_.NO_CONTROLS)),this.config.autoplay?this.addClass(_.ENTER):this.addClass(_.NO_START),this.config.fluid){var p=this.config,v=p.width,m=p.height;(typeof v!="number"||typeof m!="number")&&(v=600,m=337.5);var k={width:"100%",height:"0","max-width":"100%","padding-top":"".concat(m*100/v,"%")};Object.keys(k).forEach(function(E){i.root.style[E]=k[E]})}else["width","height"].forEach(function(E){i.config[E]&&(typeof i.config[E]!="number"?i.root.style[E]=i.config[E]:i.root.style[E]="".concat(i.config[E],"px"))});var C=this.root.getBoundingClientRect(),S=C.width,D=C.height,I=C.left,B=C.top;return this.sizeInfo.width=S,this.sizeInfo.height=D,this.sizeInfo.left=I,this.sizeInfo.top=B,!0}},{key:"_initBaseDoms",value:function(){this.topBar=null,this.leftBar=null,this.rightBar=null,this.config.marginControls&&(this.innerContainer=f.createDom("xg-video-container","",{"data-index":-1},"xg-video-container"),this.root.appendChild(this.innerContainer))}},{key:"_bindEvents",value:function(){var e=this;["focus","blur"].forEach(function(i){e.on(i,e["on"+i.charAt(0).toUpperCase()+i.slice(1)])}),pt.forEach(function(i){document&&document.addEventListener(i,e.onFullscreenChange)}),P.os.isIos&&(this.media.addEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.addEventListener("webkitendfullscreen",this._onWebkitendfullscreen)),this.once(ne,this.resize),this.playFunc=function(){e.config.closeFocusVideoFocus||e.media.focus()},this.once(X,this.playFunc)}},{key:"_unbindEvents",value:function(){var e=this;this.root.removeEventListener("mousemove",this.mousemoveFunc),pt.forEach(function(i){document.removeEventListener(i,e.onFullscreenChange)}),this.playFunc&&this.off(X,this.playFunc),this.off(ue,this.canPlayFunc),this.media.removeEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.removeEventListener("webkitendfullscreen",this._onWebkitendfullscreen)}},{key:"_startInit",value:function(e){var i=this;if(this.media&&!((!e||e===""||f.typeOf(e)==="Array"&&e.length===0)&&(e="",this.emit(ui),A.logWarn("config.url is null, please get url and run player._startInit(url)"),this.config.nullUrlStart))){this._detachSourceEvents(this.media),f.typeOf(e)==="Array"&&e.length>0?this._attachSourceEvents(this.media,e):!this.media.src||this.media.src!==e?this.media.src=e:e||this.media.removeAttribute("src"),f.typeOf(this.config.volume)==="Number"&&(this.volume=this.config.volume);var n=this.innerContainer?this.innerContainer:this.root;this.media instanceof window.Element&&!n.contains(this.media)&&n.insertBefore(this.media,n.firstChild);var r=this.media.readyState;A.logInfo("_startInit readyState",r),this.config.autoplay&&(!f.isMSE(this.media)&&this.load(),(P.os.isIpad||P.os.isPhone)&&this.mediaPlay());var a=this.config.startTime;this.__startTime=a>0?a:-1,this.config.startTime=0,r>=2&&this.duration>0?this.canPlayFunc():this.on(ue,this.canPlayFunc),(!this.hasStart||this.state<x.ATTACHED)&&M.afterInit(this),this.hasStart=!0,this.setState(x.ATTACHED),f.setTimeout(this,function(){i.emit(Ot)},0)}}},{key:"_registerPlugins",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._loadingPlugins=[];var n=this.config.ignores||[],r=this.config.plugins||[],a=this.config.i18n||[];i&&le.extend(a,this.__i18n);var o=n.join("||").toLowerCase().split("||"),l=this.plugins;r.forEach(function(c){try{var d=c.plugin?c.plugin.pluginName:c.pluginName;if(d&&o.indexOf(d.toLowerCase())>-1)return null;if(!i&&l[d.toLowerCase()])return;if(c.lazy&&c.loader){var g=M.lazyRegister(e,c);c.forceBeforeInit&&(g.then(function(){e._loadingPlugins.splice(e._loadingPlugins.indexOf(g),1)}).catch(function(p){A.logError("_registerPlugins:loadingPlugin",p),e._loadingPlugins.splice(e._loadingPlugins.indexOf(g),1)}),e._loadingPlugins.push(g));return}return e.registerPlugin(c)}catch(p){A.logError("_registerPlugins:",p)}})}},{key:"_registerPresets",value:function(){var e=this;this.config.presets.forEach(function(i){$i(e,i)})}},{key:"_getRootByPosition",value:function(e){var i=null;switch(e){case z.ROOT_RIGHT:this.rightBar||(this.rightBar=f.createPositionBar("xg-right-bar",this.root)),i=this.rightBar;break;case z.ROOT_LEFT:this.leftBar||(this.leftBar=f.createPositionBar("xg-left-bar",this.root)),i=this.leftBar;break;case z.ROOT_TOP:this.topBar||(this.topBar=f.createPositionBar("xg-top-bar",this.root),this.config.topBarAutoHide&&f.addClass(this.topBar,_.TOP_BAR_AUTOHIDE)),i=this.topBar;break;default:i=this.innerContainer||this.root;break}return i}},{key:"registerPlugin",value:function(e,i){var n=M.formatPluginInfo(e,i),r=n.PLUFGIN,a=n.options,o=this.config.plugins,l=M.checkPluginIfExits(r.pluginName,o);!l&&o.push(r);var c=M.getRootByConfig(r.pluginName,this.config);c.root&&(a.root=c.root),c.position&&(a.position=c.position);var d=a.position?a.position:a.config&&a.config.position||r.defaultConfig&&r.defaultConfig.position;return!a.root&&typeof d=="string"&&d.indexOf("controls")>-1?this.controls&&this.controls.registerPlugin(r,a,r.pluginName):(a.root||(a.root=this._getRootByPosition(d)),M.register(this,r,a))}},{key:"deregister",value:function(e){typeof e=="string"?M.unRegister(this,e):e instanceof me&&M.unRegister(this,e.pluginName)}},{key:"unRegisterPlugin",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.deregister(e),i&&this.removePluginFromConfig(e)}},{key:"removePluginFromConfig",value:function(e){var i;if(typeof e=="string"?i=e:e instanceof me&&(i=e.pluginName),!!i)for(var n=this.config.plugins.length-1;n>-1;n--){var r=this.config.plugins[n];if(r.pluginName.toLowerCase()===i.toLowerCase()){this.config.plugins.splice(n,1);break}}}},{key:"plugins",get:function(){return M.getPlugins(this)}},{key:"getPlugin",value:function(e){var i=M.findPlugin(this,e);return i&&i.pluginName?i:null}},{key:"addClass",value:function(e){this.root&&(f.hasClass(this.root,e)||f.addClass(this.root,e))}},{key:"removeClass",value:function(e){this.root&&f.removeClass(this.root,e)}},{key:"hasClass",value:function(e){if(this.root)return f.hasClass(this.root,e)}},{key:"setAttribute",value:function(e,i){this.root&&this.root.setAttribute(e,i)}},{key:"removeAttribute",value:function(e,i){this.root&&this.root.removeAttribute(e,i)}},{key:"start",value:function(e){var i=this;if(!(this.state>x.ATTACHING))return!e&&!this.config.url&&this.getInitDefinition(),this.hasStart=!0,this.setState(x.ATTACHING),this._registerPlugins(!1),M.beforeInit(this).then(function(){if(i.config){e||(e=i.url||i.config.url);var n=i.preProcessUrl(e),r=i._startInit(n.url);return r}}).catch(function(n){throw n.fileName="player",n.lineNumber="236",A.logError("start:beforeInit:",n),n})}},{key:"switchURL",value:function(e,i){var n=this,r=e;f.typeOf(e)==="Object"&&(r=e.url),r=this.preProcessUrl(r).url;var a=this.currentTime;this.__startTime=a;var o=this.paused&&!this.isError;return this.src=r,new Promise(function(l,c){var d=function(v){n.off("timeupdate",g),n.off("canplay",g),c(v)},g=function(){n.duration>0&&n.__startTime>0&&(n.currentTime=n.__startTime,n.__startTime=-1),o&&n.pause(),n.off("error",d),l(!0)};if(n.once("error",d),!r){n.errorHandler("error",{code:6,message:"empty_src"});return}P.os.isAndroid?n.once("timeupdate",g):n.once("canplay",g),n.play()})}},{key:"videoPlay",value:function(){this.mediaPlay()}},{key:"mediaPlay",value:function(){var e=this;if(!this.hasStart&&this.state<x.ATTACHED){this.removeClass(_.NO_START),this.addClass(_.ENTER),this.start(),this._useAutoplay=!0;return}this.state<x.RUNNING&&(this.removeClass(_.NO_START),!this.isCanplay&&this.addClass(_.ENTER));var i=O(N(s.prototype),"play",this).call(this);return i!==void 0&&i&&i.then?i.then(function(){e.removeClass(_.NOT_ALLOW_AUTOPLAY),e.addClass(_.PLAYING),e.state<x.RUNNING&&(A.logInfo(">>>>playPromise.then"),e.setState(x.RUNNING),e.emit(ve))}).catch(function(n){if(A.logWarn(">>>>playPromise.catch",n.name),e.media&&e.media.error){e.onError(),e.removeClass(_.ENTER);return}n.name==="NotAllowedError"&&(e._errorTimer=f.setTimeout(e,function(){e._errorTimer=null,e.emit(li),e.addClass(_.NOT_ALLOW_AUTOPLAY),e.removeClass(_.ENTER),e.pause(),e.setState(x.NOTALLOW)},0))}):(A.logWarn("video.play not return promise"),this.state<x.RUNNING&&(this.setState(x.RUNNING),this.removeClass(_.NOT_ALLOW_AUTOPLAY),this.removeClass(_.NO_START),this.removeClass(_.ENTER),this.addClass(_.PLAYING),this.emit(ve))),i}},{key:"mediaPause",value:function(){O(N(s.prototype),"pause",this).call(this)}},{key:"videoPause",value:function(){O(N(s.prototype),"pause",this).call(this)}},{key:"play",value:function(){var e=this;return this.removeClass(_.PAUSED),de(this,"play",function(){return e.mediaPlay()})}},{key:"pause",value:function(){var e=this;de(this,"pause",function(){O(N(s.prototype),"pause",e).call(e)})}},{key:"seek",value:function(e,i){var n=this;if(!(!this.media||Number.isNaN(Number(e))||!this.hasStart)){var r=this.config,a=r.isSeekedPlay,o=r.seekedStatus,l=i||(a?"play":o);e=e<0?0:e>this.duration?parseInt(this.duration,10):e,!this._isPauseBeforeSeek&&(this._isPauseBeforeSeek=this.paused?2:1),this._onceSeekCanplay&&this.off(ce,this._onceSeekCanplay),this._onceSeekCanplay=function(){switch(n.removeClass(_.ENTER),n.isSeeking=!1,l){case"play":n.play();break;case"pause":n.pause();break;default:n._isPauseBeforeSeek>1||n.paused?n.pause():n.play()}n._isPauseBeforeSeek=0,n._onceSeekCanplay=null},this.once(ce,this._onceSeekCanplay),this.state<x.RUNNING?(this.removeClass(_.NO_START),this.currentTime=e,this.play()):this.currentTime=e}}},{key:"getInitDefinition",value:function(){var e=this,i=this.config,n=i.definition,r=i.url;!r&&n&&n.list&&n.list.length>0&&n.defaultDefinition&&n.list.map(function(a){a.definition===n.defaultDefinition&&(e.config.url=a.url,e.curDefinition=a)})}},{key:"changeDefinition",value:function(e,i){var n=this,r=this.config.definition;if(Array.isArray(r==null?void 0:r.list)&&r.list.forEach(function(o){(e==null?void 0:e.definition)===o.definition&&(n.curDefinition=o)}),e!=null&&e.bitrate&&typeof e.bitrate!="number"&&(e.bitrate=parseInt(e.bitrate,10)||0),this.emit(ci,{from:i,to:e}),!this.hasStart){this.config.url=e.url;return}var a=this.switchURL(e.url,j({seamless:r.seamless!==!1&&typeof MediaSource!="undefined"&&typeof MediaSource.isTypeSupported=="function"},e));a&&a.then?a.then(function(){n.emit(tt,{from:i,to:e})}):this.emit(tt,{from:i,to:e})}},{key:"reload",value:function(){this.load(),this.reloadFunc=function(){this.play()},this.once(ne,this.reloadFunc)}},{key:"resetState",value:function(){var e=this,i=_.NOT_ALLOW_AUTOPLAY,n=_.PLAYING,r=_.NO_START,a=_.PAUSED,o=_.REPLAY,l=_.ENTER,c=_.ENDED,d=_.ERROR,g=_.LOADING,p=[i,n,r,a,o,l,c,d,g];this.hasStart=!1,this.isError=!1,this._useAutoplay=!1,this.mediaPause(),this._accPlayed.acc=0,this._accPlayed.t=0,this._accPlayed.loopAcc=0,p.forEach(function(v){e.removeClass(v)}),this.addClass(_.NO_START),this.emit(Nt)}},{key:"reset",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;this.resetState();var r=this.plugins;if(r&&(i.map(function(o){e.deregister(o)}),n)){var a=yt();Object.keys(this.config).keys(function(o){e.config[o]!=="undefined"&&(o==="plugins"||o==="presets"||o==="el"||o==="id")&&(e.config[o]=a[o])})}}},{key:"destroy",value:function(){var e,i=this,n=this.innerContainer,r=this.root,a=this.media;if(!(!r||!a)){if(this.hasStart=!1,this._useAutoplay=!1,r.removeAttribute(te),this.updateAcc("destroy"),this._unbindEvents(),this._detachSourceEvents(this.media),f.clearAllTimers(this),this.emit(Ft),(e=ee)===null||e===void 0||e.remove(this),M.destroy(this),hi(this),O(N(s.prototype),"destroy",this).call(this),this.fullscreen&&this._fullscreenEl===this.root&&this.exitFullscreen(),n)for(var o=n.children,l=0;l<o.length;l++)n.removeChild(o[l]);!n&&a instanceof window.Node&&r.contains(a)&&r.removeChild(a),["topBar","leftBar","rightBar","innerContainer"].map(function(d){i[d]&&r.removeChild(i[d]),i[d]=null});var c=r.className.split(" ");c.length>0?r.className=c.filter(function(d){return d.indexOf("xgplayer")<0}).join(" "):r.className="",this.removeAttribute("data-xgfill"),["isSeeking","isCanplay","isActive","cssfullscreen","fullscreen"].forEach(function(d){i[d]=!1})}}},{key:"replay",value:function(){var e=this;this.removeClass(_.ENDED),this.currentTime=0,this.isSeeking=!1,de(this,"replay",function(){e.once(ce,function(){var i=e.mediaPlay();i&&i.catch&&i.catch(function(n){console.log(n)})}),e.play(),e.emit(He),e.onPlay()})}},{key:"retry",value:function(){var e=this;this.removeClass(_.ERROR),this.addClass(_.LOADING),de(this,"retry",function(){var i=e.currentTime,n=e.config.url,r=f.isMSE(e.media)?{url:n}:e.preProcessUrl(n);e.src=r.url,!e.config.isLive&&(e.currentTime=i),e.once(ue,function(){e.mediaPlay()})})}},{key:"changeFullStyle",value:function(e,i,n,r){e&&(r||(r=_.PARENT_FULLSCREEN),this._orgCss||(this._orgCss=f.filterStyleFromText(e)),f.addClass(e,n),i&&i!==e&&!this._orgPCss&&(this._orgPCss=f.filterStyleFromText(i),f.addClass(i,r),i.setAttribute(te,this.playerId)))}},{key:"recoverFullStyle",value:function(e,i,n,r){r||(r=_.PARENT_FULLSCREEN),this._orgCss&&(f.setStyleFromCsstext(e,this._orgCss),this._orgCss=""),f.removeClass(e,n),i&&i!==e&&this._orgPCss&&(f.setStyleFromCsstext(i,this._orgPCss),this._orgPCss="",f.removeClass(i,r),i.removeAttribute(te))}},{key:"getFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget,i=this.root,n=this.media;e||(e=i),this._fullScreenOffset={top:f.scrollTop(),left:f.scrollLeft()},this._fullscreenEl=e,this._fullActionFrom="get";var r=f.getFullScreenEl();if(r===this._fullscreenEl)return this.onFullscreenChange(),Promise.resolve();try{for(var a=0;a<vt.length;a++){var o=vt[a];if(e[o]){var l=o==="webkitRequestFullscreen"?e.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT):e[o]();return l&&l.then?l:Promise.resolve()}}return n.fullscreenEnabled||n.webkitSupportsFullscreen?(n.webkitEnterFullscreen(),Promise.resolve()):Promise.reject(new Error("call getFullscreen fail"))}catch(c){return Promise.reject(new Error("call getFullscreen fail"))}}},{key:"exitFullscreen",value:function(e){if(this.isRotateFullscreen&&this.exitRotateFullscreen(),!(!this._fullscreenEl&&!f.getFullScreenEl())){this.root;var i=this.media;this._fullActionFrom="exit";try{for(var n=0;n<mt.length;n++){var r=mt[n];if(document[r]){var a=document[r]();return a&&a.then?a:Promise.resolve()}}return i&&i.webkitSupportsFullscreen?(i.webkitExitFullScreen(),Promise.resolve()):Promise.reject(new Error("call exitFullscreen fail"))}catch(o){return Promise.reject(new Error("call exitFullscreen fail"))}}}},{key:"getCssFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget;this.isRotateFullscreen?this.exitRotateFullscreen():this.fullscreen&&this.exitFullscreen();var i=e?"".concat(_.INNER_FULLSCREEN," ").concat(_.CSS_FULLSCREEN):_.CSS_FULLSCREEN;this.changeFullStyle(this.root,e,i);var n=this.config.fullscreen,r=n===void 0?{}:n,a=r.useCssFullscreen===!0||typeof r.useCssFullscreen=="function"&&r.useCssFullscreen();a&&(this.fullscreen=!0,this.emit(re,!0)),this._cssfullscreenEl=e,this.cssfullscreen=!0,this.emit(it,!0)}},{key:"exitCssFullscreen",value:function(){var e=this._cssfullscreenEl?"".concat(_.INNER_FULLSCREEN," ").concat(_.CSS_FULLSCREEN):_.CSS_FULLSCREEN;if(!this.fullscreen)this.recoverFullStyle(this.root,this._cssfullscreenEl,e);else{var i=this.config.fullscreen,n=i===void 0?{}:i,r=n.useCssFullscreen===!0||typeof n.useCssFullscreen=="function"&&n.useCssFullscreen();r?(this.recoverFullStyle(this.root,this._cssfullscreenEl,e),this.fullscreen=!1,this.emit(re,!1)):this.removeClass(e)}this._cssfullscreenEl=null,this.cssfullscreen=!1,this.emit(it,!1)}},{key:"getRotateFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget;this.cssfullscreen&&this.exitCssFullscreen(e);var i=e?"".concat(_.INNER_FULLSCREEN," ").concat(_.ROTATE_FULLSCREEN):_.ROTATE_FULLSCREEN;this._fullscreenEl=e||this.root,this.changeFullStyle(this.root,e,i,_.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!0,this.fullscreen=!0,this.setRotateDeg(90),this._rootStyle=this.root.getAttribute("style"),this.root.style.width="".concat(window.innerHeight,"px"),this.emit(re,!0)}},{key:"exitRotateFullscreen",value:function(e){var i=this._fullscreenEl!==this.root?"".concat(_.INNER_FULLSCREEN," ").concat(_.ROTATE_FULLSCREEN):_.ROTATE_FULLSCREEN;this.recoverFullStyle(this.root,this._fullscreenEl,i,_.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!1,this.fullscreen=!1,this.setRotateDeg(0),this.emit(re,!1),this._rootStyle&&(this.root.style.style=this._rootStyle,this._rootStyle=!1)}},{key:"setRotateDeg",value:function(e){window.orientation===90||window.orientation===-90?this.rotateDeg=0:this.rotateDeg=e}},{key:"focus",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{autoHide:!this.config.closeDelayBlur,delay:this.config.inactive};if(this.isActive){this.onFocus(e);return}this.emit(fi,j({paused:this.paused,ended:this.ended},e))}},{key:"blur",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{ignorePaused:!1};if(!this.isActive){this.onBlur(e);return}this.emit(di,j({paused:this.paused,ended:this.ended},e))}},{key:"onFocus",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{autoHide:!0,delay:3e3},n=this.innerStates;if(this.isActive=!0,this.removeClass(_.INACTIVE),this.userTimer&&(f.clearTimeout(this,this.userTimer),this.userTimer=null),i.isLock!==void 0&&(n.isActiveLocked=i.isLock),i.autoHide===!1||i.isLock===!0||n.isActiveLocked){this.userTimer&&(f.clearTimeout(this,this.userTimer),this.userTimer=null);return}var r=i&&i.delay?i.delay:this.config.inactive;this.userTimer=f.setTimeout(this,function(){e.userTimer=null,e.blur()},r)}},{key:"onBlur",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=e.ignorePaused,n=i===void 0?!1:i;if(!(!this.isActive||this.innerStates.isActiveLocked)){var r=this.config.closePauseVideoFocus;this.isActive=!1,(n||r||!this.paused&&!this.ended)&&this.addClass(_.INACTIVE)}}},{key:"onEmptied",value:function(){this.updateAcc("emptied")}},{key:"onCanplay",value:function(){this.removeClass(_.ENTER),this.removeClass(_.ERROR),this.removeClass(_.LOADING),this.isCanplay=!0,this.waitTimer&&f.clearTimeout(this,this.waitTimer)}},{key:"onDurationchange",value:function(){this.__startTime>0&&this.duration>0&&(this.currentTime=this.__startTime,this.__startTime=-1)}},{key:"onLoadeddata",value:function(){this.isError=!1,this.isSeeking=!1}},{key:"onLoadstart",value:function(){this.removeClass(_.ERROR),this.isCanplay=!1}},{key:"onPlay",value:function(){this.state===x.ENDED&&this.setState(x.RUNNING),this.removeClass(_.PAUSED),this.ended&&this.removeClass(_.ENDED),!this.config.closePlayVideoFocus&&this.focus()}},{key:"onPause",value:function(){this.addClass(_.PAUSED),this.updateAcc("pause"),this.config.closePauseVideoFocus||(this.userTimer&&(f.clearTimeout(this,this.userTimer),this.userTimer=null),this.focus())}},{key:"onEnded",value:function(){this.updateAcc("ended"),this.addClass(_.ENDED),this.setState(x.ENDED)}},{key:"onError",value:function(){this.isError=!0,this.updateAcc("error"),this.removeClass(_.NOT_ALLOW_AUTOPLAY),this.removeClass(_.NO_START),this.removeClass(_.ENTER),this.removeClass(_.LOADING),this.addClass(_.ERROR)}},{key:"onSeeking",value:function(){this.isSeeking||this.updateAcc("seeking"),this.isSeeking=!0,this.addClass(_.SEEKING)}},{key:"onSeeked",value:function(){this.isSeeking=!1,this.waitTimer&&f.clearTimeout(this,this.waitTimer),this.removeClass(_.LOADING),this.removeClass(_.SEEKING)}},{key:"onWaiting",value:function(){var e=this;this.waitTimer&&f.clearTimeout(this,this.waitTimer),this.updateAcc("waiting"),this.waitTimer=f.setTimeout(this,function(){e.addClass(_.LOADING),f.clearTimeout(e,e.waitTimer),e.waitTimer=null},this.config.minWaitDelay)}},{key:"onPlaying",value:function(){var e=this;this.isError=!1;var i=_.NO_START,n=_.PAUSED,r=_.ENDED,a=_.ERROR,o=_.REPLAY,l=_.LOADING,c=[i,n,r,a,o,l];c.forEach(function(d){e.removeClass(d)}),!this._accPlayed.t&&!this.paused&&!this.ended&&(this._accPlayed.t=new Date().getTime())}},{key:"onTimeupdate",value:function(){!this._videoHeight&&this.media.videoHeight&&this.resize(),(this.waitTimer||this.hasClass(_.LOADING))&&this.media.readyState>2&&(this.removeClass(_.LOADING),f.clearTimeout(this,this.waitTimer),this.waitTimer=null),!this.paused&&this.state<x.RUNNING&&this.duration&&(this.setState(x.RUNNING),this.emit(ve)),!this._accPlayed.t&&!this.paused&&!this.ended&&(this._accPlayed.t=new Date().getTime())}},{key:"onVolumechange",value:function(){f.typeOf(this.config.volume)==="Number"&&(this.config.volume=this.volume)}},{key:"onRatechange",value:function(){this.config.defaultPlaybackRate=this.playbackRate}},{key:"emitUserAction",value:function(e,i,n){if(!(!this.media||!i||!e)){var r=f.typeOf(e)==="String"?e:e.type||"";n.props&&f.typeOf(n.props)!=="Array"&&(n.props=[n.props]),this.emit(Be,j({eventType:r,action:i,currentTime:this.currentTime,duration:this.duration,ended:this.ended,event:e},n))}}},{key:"updateAcc",value:function(e){if(this._accPlayed.t){var i=new Date().getTime()-this._accPlayed.t;this._accPlayed.acc+=i,this._accPlayed.t=0,(e==="ended"||this.ended)&&(this._accPlayed.loopAcc=this._accPlayed.acc)}}},{key:"checkBuffer",value:function(e){var i=this.media.buffered;if(!i||i.length===0||!this.duration)return!0;for(var n=e||this.media.currentTime||.2,r=i.length,a=0;a<r;a++)if(i.start(a)<=n&&i.end(a)>n)return!0;return!1}},{key:"resizePosition",value:function(){var e=this.videoPos,i=e.vy,n=e.vx,r=e.h,a=e.w,o=this.videoPos.rotate;if(!(o<0&&r<0&&a<0)){var l=this.videoPos._pi;if(!l&&this.media.videoHeight&&(l=this.media.videoWidth/this.media.videoHeight*100),!!l){this.videoPos.pi=l,o=o<0?0:o;var c={rotate:o},d=0,g=0,p=1,v=Math.abs(o/90),m=this.root,k=this.innerContainer,C=m.offsetWidth,S=k?k.offsetHeight:m.offsetHeight,D=S,I=C;if(v%2===0)p=r>0?100/r:a>0?100/a:1,c.scale=p,d=i>0?(100-r)/2-i:0,c.y=v===2?0-d:d,g=n>0?(100-a)/2-n:0,c.x=v===2?0-g:g,this.media.style.width="".concat(I,"px"),this.media.style.height="".concat(D,"px");else if(v%2===1){I=S,D=C;var B=S-C;g=-B/2/I*100,c.x=v===3?g+i/2:g-i/2,d=B/2/D*100,c.y=v===3?d+n/2:d-n/2,c.scale=p,this.media.style.width="".concat(I,"px"),this.media.style.height="".concat(D,"px")}var E=f.getTransformStyle(c,this.media.style.transform||this.media.style.webkitTransform);this.media.style.transform=E,this.media.style.webkitTransform=E}}}},{key:"position",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{h:0,y:0,x:0,w:0};if(!(!this.media||!e||!e.h)){var i=this.videoPos;i.h=e.h*100||0,i.w=e.w*100||0,i.vx=e.x*100||0,i.vy=e.y*100||0,this.resizePosition()}}},{key:"setConfig",value:function(e){var i=this;e&&Object.keys(e).map(function(n){if(n!=="plugins"){i.config[n]=e[n];var r=i.plugins[n.toLowerCase()];r&&f.typeOf(r.setConfig)==="Function"&&r.setConfig(e[n])}})}},{key:"playNext",value:function(e){var i=this;this.resetState(),this.setConfig(e),this._currentTime=0,this._duration=0,de(this,"playnext",function(){i.start(),i.emit(Ue,e)})}},{key:"resize",value:function(){var e=this;if(this.media){var i=this.root.getBoundingClientRect();this.sizeInfo.width=i.width,this.sizeInfo.height=i.height,this.sizeInfo.left=i.left,this.sizeInfo.top=i.top;var n=this.media,r=n.videoWidth,a=n.videoHeight,o=this.config,l=o.fitVideoSize,c=o.videoFillMode;if((c==="fill"||c==="cover"||c==="contain")&&this.setAttribute("data-xgfill",c),!(!a||!r)){this._videoHeight=a,this._videoWidth=r;var d=this.controls&&this.innerContainer?this.controls.root.getBoundingClientRect().height:0,g=i.width,p=i.height-d,v=parseInt(r/a*1e3,10),m=parseInt(g/p*1e3,10),k=g,C=p,S={};l==="auto"&&m>v||l==="fixWidth"?(C=g/v*1e3,this.config.fluid?S.paddingTop="".concat(C*100/k,"%"):S.height="".concat(C+d,"px")):(l==="auto"&&m<v||l==="fixHeight")&&(k=v*p/1e3,S.width="".concat(k,"px")),!this.fullscreen&&!this.cssfullscreen&&Object.keys(S).forEach(function(I){e.root.style[I]=S[I]}),(c==="fillHeight"&&m<v||c==="fillWidth"&&m>v)&&this.setAttribute("data-xgfill","cover");var D={videoScale:v,vWidth:k,vHeight:C,cWidth:k,cHeight:C+d};this.resizePosition(),this.emit(ye,D)}}}},{key:"updateObjectPosition",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.media.updateObjectPosition){this.media.updateObjectPosition(e,i);return}this.media.style.objectPosition="".concat(e*100,"% ").concat(i*100,"%")}},{key:"setState",value:function(e){A.logInfo("setState","state from:".concat(nt[this.state]," to:").concat(nt[e])),this._state=e}},{key:"preProcessUrl",value:function(e,i){var n=this.config.preProcessUrl;return!f.isBlob(e)&&n&&typeof n=="function"?n(e,i):{url:e}}},{key:"state",get:function(){return this._state}},{key:"isFullscreen",get:function(){return this.fullscreen}},{key:"isCssfullScreen",get:function(){return this.cssfullscreen}},{key:"hasStart",get:function(){return this._hasStart},set:function(e){typeof e=="boolean"&&(this._hasStart=e,e===!1&&this.setState(x.READY),this.emit("hasstart"))}},{key:"isPlaying",get:function(){return this._state===x.RUNNING||this._state===x.ENDED},set:function(e){e?this.setState(x.RUNNING):this._state>=x.RUNNING&&this.setState(x.ATTACHED)}},{key:"definitionList",get:function(){return!this.config||!this.config.definition?[]:this.config.definition.list||[]},set:function(e){var i=this,n=this.config.definition,r=null,a=null;n.list=e,this.emit("resourceReady",e),e.forEach(function(o){var l;((l=i.curDefinition)===null||l===void 0?void 0:l.definition)===o.definition&&(r=o),n.defaultDefinition===o.definition&&(a=o)}),!a&&e.length>0&&(a=e[0]),r?this.changeDefinition(r):a&&this.changeDefinition(a)}},{key:"videoFrameInfo",get:function(){var e={total:0,dropped:0,corrupted:0,droppedRate:0,droppedDuration:0};if(!this.media||!this.media.getVideoPlaybackQuality)return e;var i=this.media.getVideoPlaybackQuality();return e.dropped=i.droppedVideoFrames||0,e.total=i.totalVideoFrames||0,e.corrupted=i.corruptedVideoFrames||0,e.total>0&&(e.droppedRate=e.dropped/e.total*100,e.droppedDuration=parseInt(this.cumulateTime/e.total*e.dropped,0)),e}},{key:"lang",get:function(){return this.config.lang},set:function(e){var i=le.langKeys.filter(function(n){return n===e});if(i.length===0&&e!=="zh"){console.error("Sorry, set lang fail, because the language [".concat(e,"] is not supported now, list of all supported languages is [").concat(le.langKeys.join(),"] "));return}this.config.lang=e,M.setLang(e,this)}},{key:"i18n",get:function(){var e=this.config.lang;return e==="zh"&&(e="zh-cn"),this.__i18n.lang[e]||this.__i18n.lang.en}},{key:"i18nKeys",get:function(){return this.__i18n.textKeys||{}}},{key:"version",get:function(){return Ge}},{key:"playerId",get:function(){return this._pluginInfoId}},{key:"url",get:function(){return this.__url||this.config.url},set:function(e){this.__url=e}},{key:"poster",get:function(){return this.plugins.poster?this.plugins.poster.config.poster:this.config.poster},set:function(e){this.plugins.poster&&this.plugins.poster.update(e)}},{key:"readyState",get:function(){return O(N(s.prototype),"readyState",this)}},{key:"error",get:function(){var e=O(N(s.prototype),"error",this);return this.i18n[e]||e}},{key:"networkState",get:function(){return O(N(s.prototype),"networkState",this)}},{key:"fullscreenChanging",get:function(){return this._fullScreenOffset!==null}},{key:"cumulateTime",get:function(){var e=this._accPlayed,i=e.acc,n=e.t;return n?new Date().getTime()-n+i:i}},{key:"zoom",get:function(){return this.config.zoom},set:function(e){this.config.zoom=e}},{key:"videoRotateDeg",get:function(){return this.videoPos.rotate},set:function(e){e=f.convertDeg(e),!(e%90!==0||e===this.videoPos.rotate)&&(this.videoPos.rotate=e,this.resizePosition())}},{key:"avgSpeed",get:function(){return Tt},set:function(e){Tt=e}},{key:"realTimeSpeed",get:function(){return _t},set:function(e){_t=e}},{key:"offsetCurrentTime",get:function(){return this._offsetInfo.currentTime||0},set:function(e){this._offsetInfo.currentTime=e}},{key:"offsetDuration",get:function(){return this._offsetInfo.duration||0},set:function(e){this._offsetInfo.duration=e||0}},{key:"hook",value:function(e,i){return rt.call.apply(rt,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(e,i){return st.call.apply(st,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(e,i){return at.call.apply(at,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"usePluginHooks",value:function(e,i,n){for(var r=arguments.length,a=new Array(r>3?r-3:0),o=3;o<r;o++)a[o-3]=arguments[o];return ot.call.apply(ot,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removePluginHooks",value:function(e,i,n){for(var r=arguments.length,a=new Array(r>3?r-3:0),o=3;o<r;o++)a[o-3]=arguments[o];return ut.call.apply(ut,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"setUserActive",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;typeof i=="boolean"&&i!==this.muted&&(this.addInnerOP("volumechange"),this.muted=i),M.setCurrentUserActive(this.playerId,e)}}],[{key:"debugger",get:function(){return A.config.debug},set:function(e){A.config.debug=e}},{key:"instManager",get:function(){return ee},set:function(e){ee=e}},{key:"getCurrentUserActivePlayerId",value:function(){var e;return(e=ee)===null||e===void 0?void 0:e.getActiveId()}},{key:"setCurrentUserActive",value:function(e,i){var n;(n=ee)===null||n===void 0||n.setActive(e,i)}},{key:"isHevcSupported",value:function(){return P.isHevcSupported()}},{key:"probeConfigSupported",value:function(e){return P.probeConfigSupported(e)}},{key:"install",value:function(e,i){s.plugins||(s.plugins={}),s.plugins[e]||(s.plugins[e]=i)}},{key:"use",value:function(e,i){s.plugins||(s.plugins={}),s.plugins[e]=i}}]),s}(Wi);T(xe,"defaultPreset",null);T(xe,"XgVideoProxy",null);xe.instManager=Vt.getInstance();function H(){return new Date().getTime()}var q={LOAD_START:"loadstart",LOADED_DATA:"loadeddata",FIRST_FRAME:"firstFrame",WAIT_START:"waitingStart",WAIT_END:"waitingEnd",SEEK_START:"seekStart",SEEK_END:"seekEnd"},en=function(h){L(s,h);var u=R(s);function s(){var t;w(this,s);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=u.call.apply(u,[this].concat(i)),T(y(t),"_onTimeupdate",function(){t._state.isTimeUpdate=!0,t._state.autoplayStart&&(A.logInfo("[xgLogger]".concat(t.player.playerId," _onTimeupdate")),t._sendFF("onTimeupdate"))}),T(y(t),"_onAutoplayStart",function(){A.logInfo("[xgLogger]".concat(t.player.playerId," _onAutoplayStart")),t._state.autoplayStart=!0,t.vt&&t._sendFF("onAutoplayStart")}),T(y(t),"_onReset",function(){t._state={autoplayStart:!1,isFFLoading:!1,isTimeUpdate:!1,isFFSend:!1,isLs:!1},t.vt=0,t.pt=0,t.fvt=0,t.newPointTime=H(),t.loadedCostTime=0,t.startCostTime=0,t._isSeeking=!1,t.seekingStart=0,t.waitingStart=0,t.fixedWaitingStart=0,t._isWaiting=!1,t._waitTimer&&f.clearTimeout(y(t),t._waitTimer),t._waittTimer&&f.clearTimeout(y(t),t._waittTimer),t._waitTimer=null,t._waittTimer=null,t._waitType=0}),T(y(t),"_onSeeking",function(){t.seekingStart||(t.suspendWaitingStatus("seek"),t.seekingStart=H(),t.emitLog(q.SEEK_START,{start:H()}))}),T(y(t),"_onSeeked",function(){t.suspendSeekingStatus("seeked")}),T(y(t),"_onWaitingLoadStart",function(){t._isWaiting||t.vt||(t._isWaiting=!0,t.waitingStart=H(),t.fixedWaitingStart=H(),t._waitType=1,t.emitLog(q.WAIT_START,{fixedStart:t.fixedWaitingStart,start:t.waitingStart,type:1,endType:"loadstart"}))}),T(y(t),"_onWaiting",function(){t._isWaiting||!t.vt||(t._isWaiting=!0,t.vt?t.seekingStart?t._waitType=2:t._waitType=0:t._waitType=1,t.fixedWaitingStart=H(),t._waitTimer=f.setTimeout(y(t),function(){t._isWaiting&&(t.waitingStart=H(),f.clearTimeout(y(t),t._waitTimer),t._waitTimer=null,t._startWaitTimeout(),t.emitLog(q.WAIT_START,{fixedStart:t.fixedWaitingStart,start:t.waitingStart,type:t._waitType,endType:t._waitType===2?"seek":"playing"}))},200))}),T(y(t),"_onError",function(){t.suspendSeekingStatus("error"),t.suspendWaitingStatus("error")}),T(y(t),"_onPlaying",function(){t._isWaiting&&t.suspendWaitingStatus("playing")}),t}return b(s,[{key:"afterCreate",value:function(){var e=this;this._onReset(),this._waitType="firstFrame",this._initOnceEvents(),this.newPointTime=H(),this.loadedCostTime=0,this.startCostTime=0,this.on(Mt,function(){var i=e._state,n=i.autoplayStart,r=i.isFFSend;e.startCostTime=H()-e.newPointTime,A.logInfo("[xgLogger]".concat(e.player.playerId," LOAD_START"),"autoplayStart:".concat(n," isFFSend:").concat(r," startCostTime:").concat(e.startCostTime," newPointTime").concat(e.newPointTime)),!r&&(!i.isLs&&e.emitLog(q.LOAD_START,{}),i.isLs=!0,i.isTimeUpdate=!1,i.isFFLoading=!0,e.pt=H(),e.vt=0,e.fvt=0,e._initOnceEvents(),e._onWaitingLoadStart())}),this.on(ne,function(){e.vt=H(),e.fvt=e.vt-e.pt,e.loadedCostTime=e.vt-e.newPointTime;var i=e._state,n=i.isTimeUpdate,r=i.isFFSend,a=i.autoplayStart;A.logInfo("[xgLogger]".concat(e.player.playerId," LOADED_DATA"),"fvt:".concat(e.fvt," isTimeUpdate:").concat(e._state.isTimeUpdate," loadedCostTime:").concat(e.loadedCostTime)),(n||a)&&e._sendFF("loadedData"),r||e.emitLog(q.LOADED_DATA,{}),e.suspendWaitingStatus("loadeddata")}),this.on(we,this._onSeeking),this.on(ce,this._onSeeked),this.on(Ft,function(){e.endState("destroy")}),this.on(Rt,function(){e.endState("urlChange"),A.logInfo("[xgLogger]".concat(e.player.playerId," URL_CHANGE")),e._state.isFFSend&&e._onReset()}),this.on([Bt,ue],this._onPlaying),this.on(be,this._onWaiting),this.on(Dt,this._onError),this.on(Nt,function(){A.logInfo("[xgLogger]".concat(e.player.playerId," RESET")),e.endState("reset"),e._initOnceEvents(),e._onReset()})}},{key:"_initOnceEvents",value:function(){this.off(ve,this._onAutoplayStart),this.off(J,this._onTimeupdate),this.once(ve,this._onAutoplayStart),this.once(J,this._onTimeupdate)}},{key:"_sendFF",value:function(e){this.s=H();var i=this._state,n=i.isFFLoading,r=i.isFFSend;A.logInfo("[xgLogger]".concat(this.player.playerId," _sendFF"),"".concat(e," fvt:").concat(this.fvt," isFFLoading:").concat(n," !isFFSend:").concat(!r)),this.vt>0&&n&&!r&&(A.logInfo("[xgLogger]".concat(this.player.playerId," emitLog_firstFrame"),e),this._state.isFFLoading=!1,this._state.isFFSend=!0,this.emitLog(q.FIRST_FRAME,{fvt:this.fvt,costTime:this.fvt,vt:this.vt,startCostTime:this.startCostTime,loadedCostTime:this.loadedCostTime}))}},{key:"_startWaitTimeout",value:function(){var e=this;this._waittTimer&&f.clearTimeout(this,this._waittTimer),this._waittTimer=f.setTimeout(this,function(){e.suspendWaitingStatus("timeout"),f.clearTimeout(e,e._waittTimer),e._waittTimer=null},this.config.waitTimeout)}},{key:"endState",value:function(e){this.suspendWaitingStatus(e),this.suspendSeekingStatus(e)}},{key:"suspendSeekingStatus",value:function(e){if(this.seekingStart){var i=H(),n=i-this.seekingStart;this.seekingStart=0,this.emitLog(q.SEEK_END,{end:i,costTime:n,endType:e})}}},{key:"suspendWaitingStatus",value:function(e){if(this._waitTimer&&(f.clearTimeout(this,this._waitTimer),this._waitTimer=null),this._waittTimer&&(f.clearTimeout(this,this._waittTimer),this._waittTimer=null),this._isWaiting=!1,!!this.waitingStart){var i=H(),n=i-this.waitingStart,r=i-this.fixedWaitingStart,a=this.config.waitTimeout;this._isWaiting=!1,this.waitingStart=0,this.fixedWaitingStart=0,this.emitLog(q.WAIT_END,{fixedCostTime:r>a?a:r,costTime:n>a?a:n,type:e==="loadeddata"?1:this._waitType,endType:this._waitType===2?"seek":e})}}},{key:"emitLog",value:function(e,i){var n=this.player;this.emit(gi,j({t:H(),host:f.getHostFromUrl(n.currentSrc),vtype:n.vtype,eventType:e,currentTime:this.player.currentTime,readyState:n.video.readyState,networkState:n.video.networkState},i))}}],[{key:"pluginName",get:function(){return"xgLogger"}},{key:"defaultConfig",get:function(){return{waitTimeout:1e4}}}]),s}(F);function tn(){return new DOMParser().parseFromString(`<svg class="xgplayer-replay-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 78 78" width="78" height="78">
  <path fill="#fff" transform="translate(20, 20)" d="M8.22708362,13.8757234 L11.2677371,12.6472196 C11.7798067,12.4403301 12.3626381,12.6877273 12.5695276,13.1997969 L12.9441342,14.1269807 C13.1510237,14.6390502 12.9036264,15.2218816 12.3915569,15.4287712 L6.8284538,17.6764107 L5.90126995,18.0510173 C5.38920044,18.2579068 4.80636901,18.0105096 4.5994795,17.49844 L1.97723335,11.0081531 C1.77034384,10.4960836 2.0177411,9.91325213 2.52981061,9.70636262 L3.45699446,9.33175602 C3.96906396,9.12486652 4.5518954,9.37226378 4.75878491,9.88433329 L5.67885163,12.1615783 C7.99551726,6.6766934 13.3983951,3 19.5,3 C27.7842712,3 34.5,9.71572875 34.5,18 C34.5,26.2842712 27.7842712,33 19.5,33 C15.4573596,33 11.6658607,31.3912946 8.87004692,28.5831991 C8.28554571,27.9961303 8.28762719,27.0463851 8.87469603,26.4618839 C9.46176488,25.8773827 10.4115101,25.8794641 10.9960113,26.466533 C13.2344327,28.7147875 16.263503,30 19.5,30 C26.127417,30 31.5,24.627417 31.5,18 C31.5,11.372583 26.127417,6 19.5,6 C14.4183772,6 9.94214483,9.18783811 8.22708362,13.8757234 Z"></path>
</svg>
`,"image/svg+xml").firstChild}var nn=function(h){L(s,h);var u=R(s);function s(){return w(this,s),u.apply(this,arguments)}return b(s,[{key:"registerIcons",value:function(){return{replay:tn}}},{key:"afterCreate",value:function(){var e=this;F.insert(this.icons.replay,this.root,0),this.__handleReplay=this.hook("replayClick",function(){e.player.replay()},{pre:function(n){n.preventDefault(),n.stopPropagation()}}),this.bind(".xgplayer-replay",["click","touchend"],this.__handleReplay),this.on(Pe,function(){if(e.playerConfig.loop||f.addClass(e.player.root,"replay"),!e.config.disable){e.show();var i=e.root.querySelector("path");if(i){var n=window.getComputedStyle(i).getPropertyValue("transform");if(typeof n=="string"&&n.indexOf("none")>-1)return null;i.setAttribute("transform",n)}}}),this.on(X,function(){e.hide()})}},{key:"handleReplay",value:function(e){e.preventDefault(),e.stopPropagation(),this.player.replay(),f.removeClass(this.player.root,"replay")}},{key:"show",value:function(e){this.config.disable||(this.root.style.display="flex")}},{key:"enable",value:function(){this.config.disable=!1}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){this.unbind(".xgplayer-replay",["click","touchend"],this.__handleReplay)}},{key:"render",value:function(){return`<xg-replay class="xgplayer-replay">
      <xg-replay-txt class="xgplayer-replay-txt" lang-key="`.concat(this.i18nKeys.REPLAY,'">').concat(this.i18n.REPLAY,`</xg-replay-txt>
    </xg-replay>`)}}],[{key:"pluginName",get:function(){return"replay"}},{key:"defaultConfig",get:function(){return{disable:!1}}}]),s}(F),Ct=function(h){L(s,h);var u=R(s);function s(){return w(this,s),u.apply(this,arguments)}return b(s,[{key:"afterCreate",value:function(){this.getMini=this.getMini.bind(this),this.exitMini=this.exitMini.bind(this),this.bind("click",this.getMini)}},{key:"getMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"exitMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.getMini)}},{key:"render",value:function(){var e="MINISCREEN";return`
      <xg-icon class="xgplayer-miniicon">
      <div class="xgplayer-icon btn-text"><span class="icon-text" lang-key="`.concat(this.i18nKeys[e],'">').concat(this.i18n[e],`</span></div>
      </xg-icon>`)}}],[{key:"pluginName",get:function(){return"miniscreenIcon"}},{key:"defaultConfig",get:function(){return{position:z.CONTROLS_RIGHT,index:10}}}]),s}(F);function kt(h){var u=parseFloat(h),s=h.indexOf("%")===-1&&!Number.isNaN(u);return s&&u}var qe=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],Yt=qe.length;function rn(){for(var h={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},u=0;u<Yt;u++){var s=qe[u];h[s]=0}return h}function sn(h){var u=window.getComputedStyle(h);return u}function St(h){if(typeof h=="string"&&(h=document.querySelector(h)),!(!h||Ht(h)!=="object"||!h.nodeType)){var u=sn(h);if(u.display==="none")return rn();var s={};s.width=h.offsetWidth,s.height=h.offsetHeight;for(var t=s.isBorderBox=u.boxSizing==="border-box",e=0;e<Yt;e++){var i=qe[e],n=u[i],r=parseFloat(n);s[i]=Number.isNaN(r)?0:r}var a=s.paddingLeft+s.paddingRight,o=s.paddingTop+s.paddingBottom,l=s.marginLeft+s.marginRight,c=s.marginTop+s.marginBottom,d=s.borderLeftWidth+s.borderRightWidth,g=s.borderTopWidth+s.borderBottomWidth,p=t,v=kt(u.width);v!==!1&&(s.width=v+(p?0:a+d));var m=kt(u.height);return m!==!1&&(s.height=m+(p?0:o+g)),s.innerWidth=s.width-(a+d),s.innerHeight=s.height-(o+g),s.outerWidth=s.width+l,s.outerHeight=s.height+c,s}}function De(h,u){for(var s=0;s<h.length;s++){var t=h[s];if(t.identifier===u)return t}}var Oe={START:"dragStart",MOVE:"dragMove",ENDED:"dragEnded"},Et={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]},an=function(h){L(s,h);var u=R(s);function s(t){var e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return w(this,s),e=u.call(this),e.isEnabled=!0,e.isDragging=!1,e.isDown=!1,e.position={},e.downPoint={},e.dragPoint={x:0,y:0},e.startPos={x:0,y:0},e._root=t instanceof Element?t:document.querySelector(t),e._handlerDom=i.handle instanceof Element?i.handle:document.querySelector(i.handle),!e._root||!e._handlerDom?At(e):(e._bindStartEvent(),e)}return b(s,[{key:"_bindStartEvent",value:function(){var e=this;"ontouchstart"in window?this._startKey="touchstart":this._startKey="mousedown",this["on".concat(this._startKey)]=this["on".concat(this._startKey)].bind(this),this._handlerDom.addEventListener(this._startKey,this["on".concat(this._startKey)]),Et[this._startKey].map(function(i){e["on".concat(i)]=e["on".concat(i)].bind(e)})}},{key:"_unbindStartEvent",value:function(){this._handlerDom.removeEventListener(this._startKey,this["on".concat(this._startKey)])}},{key:"_bindPostStartEvents",value:function(e){var i=this;if(e){var n=Et[this._startKey];n.map(function(r){window.addEventListener(r,i["on".concat(r)])}),this._boundPointerEvents=n}}},{key:"_unbindPostStartEvents",value:function(){var e=this;this._boundPointerEvents&&(this._boundPointerEvents.map(function(i){window.removeEventListener(i,e["on".concat(i)])}),delete this._boundPointerEvents)}},{key:"enable",value:function(){this.isEnabled=!0}},{key:"disable",value:function(){this.isEnabled=!1,this.isDragging&&this.onUp()}},{key:"onDocUp",value:function(e){this.onUp()}},{key:"animate",value:function(){var e=this;this.isDragging&&(this.positionDrag(),window.requestAnimationFrame(function(){e.animate()}))}},{key:"positionDrag",value:function(){var e="translate3d(".concat(this.dragPoint.x,"px, ").concat(this.dragPoint.y,"px, 0)");this._root.style.transform=e,this._root.style.webKitTransform=e}},{key:"setLeftTop",value:function(){this._root.style.left=this.position.x+"px",this._root.style.top=this.position.y+"px"}},{key:"onmousedown",value:function(e){this.dragStart(e,e)}},{key:"onmousemove",value:function(e){this.dragMove(e,e)}},{key:"onmouseup",value:function(e){this.dragEnd(e,e)}},{key:"ontouchstart",value:function(e){var i=e.changedTouches[0];this.dragStart(e,i),this.touchIdentifier=i.pointerId!==void 0?i.pointerId:i.identifier,e.preventDefault()}},{key:"ontouchmove",value:function(e){var i=De(e.changedTouches,this.touchIdentifier);i&&this.dragMove(e,i)}},{key:"ontouchend",value:function(e){var i=De(e.changedTouches,this.touchIdentifier);i&&this.dragEnd(e,i),e.preventDefault()}},{key:"ontouchcancel",value:function(e){var i=De(e.changedTouches,this.touchIdentifier);i&&this.dragCancel(e,i)}},{key:"dragStart",value:function(e,i){if(!(!this._root||this.isDown||!this.isEnabled)){this.downPoint=i,this.dragPoint.x=0,this.dragPoint.y=0,this._getPosition();var n=St(this._root);this.startPos.x=this.position.x,this.startPos.y=this.position.y,this.startPos.maxY=window.innerHeight-n.height,this.startPos.maxX=window.innerWidth-n.width,this.setLeftTop(),this.isDown=!0,this._bindPostStartEvents(e)}}},{key:"dragRealStart",value:function(e,i){this.isDragging=!0,this.animate(),this.emit(Oe.START,this.startPos)}},{key:"dragEnd",value:function(e,i){this._root&&(this._unbindPostStartEvents(),this.isDragging&&(this._root.style.transform="",this.setLeftTop(),this.emit(Oe.ENDED)),this.presetInfo())}},{key:"_dragPointerMove",value:function(e,i){var n={x:i.pageX-this.downPoint.pageX,y:i.pageY-this.downPoint.pageY};return!this.isDragging&&this.hasDragStarted(n)&&this.dragRealStart(e,i),n}},{key:"dragMove",value:function(e,i){if(e=e||window.event,!!this.isDown){var n=this.startPos,r=n.x,a=n.y,o=this._dragPointerMove(e,i),l=o.x,c=o.y;l=this.checkContain("x",l,r),c=this.checkContain("y",c,a),this.position.x=r+l,this.position.y=a+c,this.dragPoint.x=l,this.dragPoint.y=c,this.emit(Oe.MOVE,this.position)}}},{key:"dragCancel",value:function(e,i){this.dragEnd(e,i)}},{key:"presetInfo",value:function(){this.isDragging=!1,this.startPos={x:0,y:0},this.dragPoint={x:0,y:0},this.isDown=!1}},{key:"destroy",value:function(){this._unbindStartEvent(),this._unbindPostStartEvents(),this.isDragging&&this.dragEnd(),this.removeAllListeners(),this._handlerDom=null}},{key:"hasDragStarted",value:function(e){return Math.abs(e.x)>3||Math.abs(e.y)>3}},{key:"checkContain",value:function(e,i,n){return i+n<0?0-n:e==="x"&&i+n>this.startPos.maxX?this.startPos.maxX-n:e==="y"&&i+n>this.startPos.maxY?this.startPos.maxY-n:i}},{key:"_getPosition",value:function(){var e=window.getComputedStyle(this._root),i=this._getPositionCoord(e.left,"width"),n=this._getPositionCoord(e.top,"height");this.position.x=Number.isNaN(i)?0:i,this.position.y=Number.isNaN(n)?0:n,this._addTransformPosition(e)}},{key:"_addTransformPosition",value:function(e){var i=e.transform;if(i.indexOf("matrix")===0){var n=i.split(","),r=i.indexOf("matrix3d")===0?12:4,a=parseInt(n[r],10),o=parseInt(n[r+1],10);this.position.x+=a,this.position.y+=o}}},{key:"_getPositionCoord",value:function(e,i){if(e.indexOf("%")!==-1){var n=St(this._root.parentNode);return n?parseFloat(e)/100*n[i]:0}return parseInt(e,10)}}]),s}(jt),on=function(h){L(s,h);var u=R(s);function s(t){var e;w(this,s),e=u.call(this,t),T(y(e),"onCancelClick",function(r){e.exitMini(),e.isClose=!0}),T(y(e),"onCenterClick",function(r){var a=y(e),o=a.player;o.paused?o.play():o.pause()}),T(y(e),"onScroll",function(r){if(!(!window.scrollY&&window.scrollY!==0||Math.abs(window.scrollY-e.pos.scrollY)<50)){var a=parseInt(f.getCss(e.player.root,"height"));a+=e.config.scrollTop,e.pos.scrollY=window.scrollY,window.scrollY>a+5?!e.isMini&&!e.isClose&&e.getMini():window.scrollY<=a&&(e.isMini&&e.exitMini(),e.isClose=!1)}}),e.isMini=!1,e.isClose=!1;var i=y(e),n=i.config;return e.pos={left:n.left<0?window.innerWidth-n.width-20:n.left,top:n.top<0?window.innerHeight-n.height-20:n.top,height:e.config.height,width:e.config.width,scrollY:window.scrollY||0},e.lastStyle=null,e}return b(s,[{key:"beforeCreate",value:function(e){typeof e.player.config.mini=="boolean"&&(e.config.isShowIcon=e.player.config.mini)}},{key:"afterCreate",value:function(){var e=this;this.initIcons(),this.on(Ye,function(){e.setAttr("data-state","pause")}),this.on(X,function(){e.setAttr("data-state","play")})}},{key:"onPluginsReady",value:function(){var e=this,i=this.player,n=this.config;if(!n.disable){if(this.config.isShowIcon){var r={config:{onClick:function(){e.getMini()}}};i.controls.registerPlugin(Ct,r,Ct.pluginName)}var a=f.checkTouchSupport()?"touchend":"click";this.bind(".mini-cancel-btn",a,this.onCancelClick),this.bind(".play-icon",a,this.onCenterClick),this.config.disableDrag||(this._draggabilly=new an(this.player.root,{handle:this.root})),this.config.isScrollSwitch&&window.addEventListener("scroll",this.onScroll)}}},{key:"registerIcons",value:function(){return{play:{icon:pi,class:"xg-icon-play"},pause:{icon:vi,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".play-icon",e.play),this.appendChild(".play-icon",e.pause)}},{key:"getMini",value:function(){var e=this;if(!this.isMini){var i=this.player,n=this.playerConfig,r=this.config.target||this.player.root;this.lastStyle={},f.addClass(i.root,"xgplayer-mini"),["width","height","top","left"].map(function(a){e.lastStyle[a]=r.style[a],r.style[a]="".concat(e.pos[a],"px")}),n.fluid&&(r.style["padding-top"]=""),this.emit(Me,!0),i.isMini=this.isMini=!0}}},{key:"exitMini",value:function(){var e=this;if(!this.isMini)return!1;var i=this.player,n=this.playerConfig,r=this.config.target||this.player.root;f.removeClass(i.root,"xgplayer-mini"),this.lastStyle&&Object.keys(this.lastStyle).map(function(a){r.style[a]=e.lastStyle[a]}),this.lastStyle=null,n.fluid&&(i.root.style.width="100%",i.root.style.height="0",i.root.style["padding-top"]="".concat(n.height*100/n.width,"%")),this.emit(Me,!1),this.isMini=i.isMini=!1}},{key:"destroy",value:function(){window.removeEventListener("scroll",this.onScroll);var e=f.checkTouchSupport()?"touchend":"click";this.unbind(".mini-cancel-btn",e,this.onCancelClick),this.unbind(".play-icon",e,this.onCenterClick),this._draggabilly&&this._draggabilly.destroy(),this._draggabilly=null,this.exitMini()}},{key:"render",value:function(){if(!this.config.disable)return`
      <xg-mini-layer class="xg-mini-layer">
      <xg-mini-header class="xgplayer-mini-header">
      `.concat($e(this,"MINI_DRAG",this.playerConfig.isHideTips),`
      </xg-mini-header>
      <div class="mini-cancel-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
          <path fill="#fff" fill-rule="evenodd" d="M3.99 3.49a1 1 0 0 1 1.414 0L10 8.085l4.596-4.595a1 1 0 1 1 1.414 1.414L11.414 9.5l4.596 4.596a1 1 0 0 1 .084 1.32l-.084.094a1 1 0 0 1-1.414 0L10 10.914 5.404 15.51a1 1 0 0 1-1.414-1.414L8.585 9.5 3.99 4.904a1 1 0 0 1-.084-1.32z"></path>
        </svg>
      </div>
      <div class="play-icon">
      </div>
      </xg-mini-layer>`)}}],[{key:"pluginName",get:function(){return"miniscreen"}},{key:"defaultConfig",get:function(){return{index:10,disable:!1,width:320,height:180,left:-1,top:-1,isShowIcon:!1,isScrollSwitch:!1,scrollTop:0,disableDrag:!1}}}]),s}(F),un=[{tag:"xg-cache",className:"xgplayer-progress-cache",styleKey:"cachedColor"},{tag:"xg-played",className:"xgplayer-progress-played",styleKey:"playedColor"}],ln=function(){function h(u){w(this,h),this.fragments=u.fragments||[],this.fragments.length===0&&this.fragments.push({percent:1}),this._callBack=u.actionCallback,this.fragConfig={fragFocusClass:u.fragFocusClass||"inner-focus-point",fragAutoFocus:!!u.fragAutoFocus,fragClass:u.fragClass||""},this.style=u.style||{playedColor:"",cachedColor:"",progressColor:""},this.duration=0,this.cachedIndex=0,this.playedIndex=0,this.focusIndex=-1}return b(h,[{key:"updateDuration",value:function(s){var t=this;this.duration=s;var e=0,i=this.fragments;this.fragments=i.map(function(n){return n.start=parseInt(e,10),n.end=parseInt(e+n.percent*t.duration,10),n.duration=parseInt(n.percent*t.duration,10),e+=n.percent*t.duration,n})}},{key:"updateProgress",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"played",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{newIndex:0,curIndex:0,millisecond:0},e=this.progressList,i=this.fragments;if(!(e.length<1)){var n=t.newIndex,r=t.curIndex,a=t.millisecond;n!==r&&e.map(function(c,d){d<n?c[s].style.width="100%":d>n&&(c[s].style.width=0)});var o=i[n],l=a===0?0:(a-o.start)/o.duration;e[n][s].style.width=l<0?0:"".concat(l*100,"%")}}},{key:"updateFocus",value:function(s){if(!(!this.fragConfig.fragAutoFocus||this.fragments.length<2)){if(!s){if(this.focusIndex>-1){this.unHightLight(this.focusIndex);var t={index:-1,preIndex:this.focusIndex,fragment:null};this._callBack&&this._callBack(t),this.focusIndex=-1}return}var e=this.findIndex(s.currentTime*1e3,this.focusIndex);if(e>=0&&e!==this.focusIndex){this.focusIndex>-1&&this.unHightLight(this.focusIndex),this.setHightLight(e);var i={index:e,preIndex:this.focusIndex,fragment:this.fragments[this.focusIndex]};this.focusIndex=e,this._callBack&&this._callBack(i)}}}},{key:"update",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0},t=arguments.length>1?arguments[1]:void 0;if(!this.duration||parseInt(t*1e3,10)!==this.duration){if(!t&&t!==0)return;this.updateDuration(parseInt(t*1e3,10))}var e=this.playedIndex,i=this.cachedIndex;if(f.typeOf(s.played)!=="Undefined"){var n=this.findIndex(s.played*1e3,e);if(n<0)return;this.updateProgress("played",{newIndex:n,curIndex:e,millisecond:parseInt(s.played*1e3,10)}),this.playedIndex=n}if(f.typeOf(s.cached)!=="Undefined"){var r=this.findIndex(s.cached*1e3,i);if(r<0)return;this.updateProgress("cached",{newIndex:r,curIndex:i,millisecond:parseInt(s.cached*1e3,10)}),this.cachedIndex=r}}},{key:"findIndex",value:function(s,t){var e=this.fragments;if(!e||e.length===0)return-1;if(e.length===1)return 0;if(t>-1&&t<e.length&&s>e[t].start&&s<e[t].end)return t;if(s>e[e.length-1].start)return e.length-1;for(var i=0;i<e.length;i++)if(s>e[i].start&&s<=e[i].end){t=i;break}return t}},{key:"findHightLight",value:function(){for(var s=this.root.children,t=0;t<s.length;t++)if(f.hasClass(s[t],this.fragConfig.fragFocusClass))return{dom:s[t],pos:s[t].getBoundingClientRect()}}},{key:"findFragment",value:function(s){var t=this.root.children;return s<0||s>=t.length?null:{dom:t[s],pos:t[s].getBoundingClientRect()}}},{key:"unHightLight",value:function(){for(var s=this.root.children,t=0;t<s.length;t++)f.removeClass(s[t],this.fragConfig.fragFocusClass)}},{key:"setHightLight",value:function(s){var t=this.root.children;if(s<t.length)return f.addClass(t[s],this.fragConfig.fragFocusClass),{dom:t[s],pos:t[s].getBoundingClientRect()}}},{key:"destroy",value:function(){this.progressList=null,this.fragments=null,this.root.innerHTML=""}},{key:"reset",value:function(s){var t=this;if(Object.keys(this.fragConfig).forEach(function(i){s[i]!==void 0&&(t.fragConfig[i]=s[i])}),s.fragments){if(this.fragments=s.fragments.length===0?[{percent:1}]:s.fragments,this.updateDuration(this.duration),this.playedIndex=0,this.cachedIndex=0,this.root)for(var e=this.root.children;e.length>0;)this.root.removeChild(e[0]);this.render()}}},{key:"render",value:function(){var s=this,t=this.style.progressColor;if(this.root||(this.root=f.createDom("xg-inners","",{},"progress-list")),this.fragments){var e=this.fragConfig,i=e.fragClass,n=e.fragFocusClass;this.progressList=this.fragments.map(function(r){var a=f.createDom("xg-inner","",{style:t?"background:".concat(t,"; flex: ").concat(r.percent):"flex: ".concat(r.percent)},"".concat(r.isFocus?n:""," xgplayer-progress-inner ").concat(i));return s.root.appendChild(a),un.forEach(function(o){a.appendChild(f.createDom(o.tag,"",{style:o.styleKey?"background: ".concat(s.style[o.styleKey],"; width:0;"):"width:0;"},o.className))}),{cached:a.children[0],played:a.children[1]}})}return this.root}}]),h}(),bt={POINT:"inner-focus-point",HIGHLIGHT:"inner-focus-highlight"},cn=function(h){L(s,h);var u=R(s);function s(t){var e;return w(this,s),e=u.call(this,t),T(y(e),"onMoveOnly",function(i,n){var r=y(e),a=r.pos,o=r.config,l=r.player,c=n;if(i){f.event(i);var d=f.getEventPos(i,l.zoom),g=l.rotateDeg===90?d.clientY:d.clientX;if(a.moving&&Math.abs(a.x-g)<o.miniMoveStep)return;a.moving=!0,a.x=g,c=e.computeTime(i,g)}e.triggerCallbacks("dragmove",c,i),e._updateInnerFocus(c)}),T(y(e),"onBodyClick",function(i){e.pos.isLocked&&(e.pos.isLocked=!1,i.preventDefault(),i.stopPropagation())}),T(y(e),"_mouseDownHandler",function(i,n){e._state.time=n.currentTime,e.updateWidth(n.currentTime,n.seekTime,n.percent,0),e._updateInnerFocus(n)}),T(y(e),"_mouseUpHandler",function(i,n){var r=y(e),a=r.pos;a.moving&&e.updateWidth(n.currentTime,n.seekTime,n.percent,2)}),T(y(e),"_mouseMoveHandler",function(i,n){var r=y(e),a=r._state,o=r.pos,l=r.config,c=r.player;a.time<n.currentTime?n.forward=!0:n.forward=!1,a.time=n.currentTime,o.isDown&&!o.moving&&(o.moving=!0,l.isPauseMoving&&c.pause(),e.triggerCallbacks("dragstart",n,i),e.emitUserAction("drag","dragstart",n)),e.updateWidth(n.currentTime,n.seekTime,n.percent,1),e.triggerCallbacks("dragmove",n,i),e._updateInnerFocus(n)}),T(y(e),"onMouseDown",function(i){var n=y(e),r=n._state,a=n.player,o=n.pos,l=n.config,c=n.playerConfig,d=f.getEventPos(i,a.zoom),g=a.rotateDeg===90?d.clientY:d.clientX;if(!(a.isMini||l.closeMoveSeek||!c.allowSeekAfterEnded&&a.ended)){if(!a.duration&&!a.isPlaying){a.play();return}i.stopPropagation(),e.focus(),f.checkIsFunction(c.disableSwipeHandler)&&c.disableSwipeHandler(),f.checkIsFunction(l.onMoveStart)&&l.onMoveStart(),f.event(i),o.x=g,o.isDown=!0,o.moving=!1,r.prePlayTime=a.currentTime,a.focus({autoHide:!1}),e.isProgressMoving=!0,f.addClass(e.progressBtn,"active");var p=e.computeTime(i,g);p.prePlayTime=r.prePlayTime,e._mouseDownHandlerHook(i,p);var v=i.type;return v==="touchstart"?(e.root.addEventListener("touchmove",e.onMouseMove),e.root.addEventListener("touchend",e.onMouseUp)):(e.unbind("mousemove",e.onMoveOnly),document.addEventListener("mousemove",e.onMouseMove,!1),document.addEventListener("mouseup",e.onMouseUp,!1)),!0}}),T(y(e),"onMouseUp",function(i){var n=y(e),r=n.player,a=n.config,o=n.pos,l=n.playerConfig,c=n._state;i.stopPropagation(),i.preventDefault(),f.checkIsFunction(l.enableSwipeHandler)&&l.enableSwipeHandler(),f.checkIsFunction(a.onMoveEnd)&&a.onMoveEnd(),f.event(i),f.removeClass(e.progressBtn,"active");var d=e.computeTime(i,o.x);d.prePlayTime=c.prePlayTime,o.moving?(e.triggerCallbacks("dragend",d,i),e.emitUserAction("drag","dragend",d)):(e.triggerCallbacks("click",d,i),e.emitUserAction("click","click",d)),e._mouseUpHandlerHook(i,d),o.moving=!1,o.isDown=!1,o.x=0,o.y=0,o.isLocked=!0,c.prePlayTime=0,c.time=0;var g=i.type;g==="touchend"?(e.root.removeEventListener("touchmove",e.onMouseMove),e.root.removeEventListener("touchend",e.onMouseUp),e.blur()):(document.removeEventListener("mousemove",e.onMouseMove,!1),document.removeEventListener("mouseup",e.onMouseUp,!1),o.isEnter?l.isMobileSimulateMode!=="mobile"&&e.bind("mousemove",e.onMoveOnly):e.onMouseLeave(i)),f.setTimeout(y(e),function(){e.resetSeekState()},10),r.focus()}),T(y(e),"onMouseMove",function(i){var n=y(e),r=n._state,a=n.pos,o=n.player,l=n.config;f.checkTouchSupport()&&i.preventDefault(),f.event(i);var c=f.getEventPos(i,o.zoom),d=o.rotateDeg===90?c.clientY:c.clientX,g=Math.abs(a.x-d);if(!(a.moving&&g<l.miniMoveStep||!a.moving&&g<l.miniStartStep)){a.x=d;var p=e.computeTime(i,d);p.prePlayTime=r.prePlayTime,e._mouseMoveHandlerHook(i,p)}}),T(y(e),"onMouseOut",function(i){e.triggerCallbacks("mouseout",null,i)}),T(y(e),"onMouseOver",function(i){e.triggerCallbacks("mouseover",null,i)}),T(y(e),"onMouseEnter",function(i){var n=y(e),r=n.player,a=n.pos;if(!(a.isDown||a.isEnter||r.isMini||!r.config.allowSeekAfterEnded&&r.ended)){a.isEnter=!0,e.bind("mousemove",e.onMoveOnly),e.bind("mouseleave",e.onMouseLeave),f.event(i);var o=f.getEventPos(i,r.zoom),l=r.rotateDeg===90?o.clientY:o.clientX,c=e.computeTime(i,l);e.triggerCallbacks("mouseenter",c,i),e.focus()}}),T(y(e),"onMouseLeave",function(i){e.triggerCallbacks("mouseleave",null,i),e.unlock(),e._updateInnerFocus(null)}),T(y(e),"onVideoResize",function(){var i=e.pos,n=i.x,r=i.isDown,a=i.isEnter;if(a&&!r){var o=e.computeTime(null,n);e.onMoveOnly(null,o)}}),e.useable=!1,e.isProgressMoving=!1,e.__dragCallBacks=[],e._state={now:-1,direc:0,time:0,prePlayTime:-1},e._disableBlur=!1,e}return b(s,[{key:"offsetDuration",get:function(){return this.playerConfig.customDuration||this.player.offsetDuration||this.player.duration}},{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"currentTime",get:function(){var e=this.player,i=e.offsetCurrentTime,n=e.currentTime;return i>=0?i:n+this.timeOffset}},{key:"changeState",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.useable=e}},{key:"show",value:function(e){this.root&&(this.root.style.display="flex")}},{key:"_initInner",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(!i||i.length===0)&&(i=[{percent:1}]);var r=j(j({fragments:i},n),{},{actionCallback:function(o){e.emitUserAction("fragment_focus","fragment_focus",o)}});this.innerList?this.innerList.reset(r):(this.innerList=new ln(r),this.outer.insertBefore(this.innerList.render(),this.outer.children[0]),["findHightLight","unHightLight","setHightLight","findFragment"].map(function(a){e[a]=e.innerList[a].bind(e.innerList)}))}},{key:"_updateInnerFocus",value:function(e){this.innerList&&this.innerList.updateFocus(e)}},{key:"afterCreate",value:function(){var e=this;if(!(this.config.disable||this.playerConfig.isLive)){this.pos={x:0,y:0,moving:!1,isDown:!1,isEnter:!1,isLocked:!1},this.outer=this.find("xg-outer");var i=this.config,n=i.fragFocusClass,r=i.fragAutoFocus,a=i.fragClass;this._initInner(this.config.fragments,{fragFocusClass:n,fragAutoFocus:r,fragClass:a,style:this.playerConfig.commonStyle||{}}),P.device==="mobile"&&(this.config.isDragingSeek=!1,this.isMobile=!0),this.progressBtn=this.find(".xgplayer-progress-btn"),this.on(Te,function(){e.onMouseLeave()}),this.on(J,function(){e.onTimeupdate()}),this.on(ce,function(){e.onTimeupdate(),e.onCacheUpdate()}),this.on(mi,function(){e.onCacheUpdate()}),this.on(Pe,function(){e.onCacheUpdate(!0),e.onTimeupdate(!0),e._state.now=0}),this.on(Ke,function(){e.onReset()}),this.on(ye,function(){e.onVideoResize()}),this.bindDomEvents(),this.initCustomStyle()}}},{key:"setConfig",value:function(e){var i=this,n=null;Object.keys(e).forEach(function(r){i.config[r]=e[r],r==="fragments"&&(n=e[r])}),n&&this._initInner(n,e)}},{key:"initCustomStyle",value:function(){var e=this.playerConfig||{},i=e.commonStyle,n=i.sliderBtnStyle,r=this.progressBtn;n&&(typeof n=="string"?r.style.boxShadow=n:Ht(n)==="object"&&Object.keys(n).map(function(a){r.style[a]=n[a]}))}},{key:"triggerCallbacks",value:function(e,i,n){this.__dragCallBacks.length>0&&this.__dragCallBacks.map(function(r){if(r&&r.handler&&r.type===e)try{r.handler(i,n)}catch(a){console.error("[XGPLAYER][triggerCallbacks] ".concat(r," error"),a)}})}},{key:"addCallBack",value:function(e,i){i&&typeof i=="function"&&this.__dragCallBacks.push({type:e,handler:i})}},{key:"removeCallBack",value:function(e,i){var n=this.__dragCallBacks,r=-1;n.map(function(a,o){a&&a.type===e&&a.handler===i&&(r=o)}),r>-1&&n.splice(r,1)}},{key:"unlock",value:function(){var e=this.player,i=this.pos;if(i.isEnter=!1,i.isLocked=!1,!e.isMini){if(this.unbind("mousemove",this.onMoveOnly),i.isDown){this.unbind("mouseleave",this.onMouseLeave);return}this.blur()}}},{key:"bindDomEvents",value:function(){var e=this.player,i=e.controls,n=e.config;this._mouseDownHandlerHook=this.hook("dragstart",this._mouseDownHandler),this._mouseUpHandlerHook=this.hook("dragend",this._mouseUpHandler),this._mouseMoveHandlerHook=this.hook("drag",this._mouseMoveHandler),(this.domEventType==="touch"||this.domEventType==="compatible")&&(this.root.addEventListener("touchstart",this.onMouseDown),i&&(i.root&&i.root.addEventListener("touchmove",f.stopPropagation),i.center&&i.center.addEventListener("touchend",f.stopPropagation))),(this.domEventType==="mouse"||this.domEventType==="compatible")&&(this.bind("mousedown",this.onMouseDown),n.isMobileSimulateMode!=="mobile"&&this.bind("mouseenter",this.onMouseEnter),this.bind("mouseover",this.onMouseOver),this.bind("mouseout",this.onMouseOut),this.player.root.addEventListener("click",this.onBodyClick,!0))}},{key:"focus",value:function(){this.player.controls.pauseAutoHide(),f.addClass(this.root,"active")}},{key:"blur",value:function(){this._disableBlur||(this.player.controls.recoverAutoHide(),f.removeClass(this.root,"active"))}},{key:"disableBlur",value:function(){this._disableBlur=!0}},{key:"enableBlur",value:function(){this._disableBlur=!1}},{key:"updateWidth",value:function(e,i,n,r){var a=this.config,o=this.player;if(!(a.isCloseClickSeek&&r===0)){var l=i=i>=o.duration?o.duration-a.endedDiff:Number(i).toFixed(1);this.updatePercent(n),this.updateTime(e),!(r===1&&(!a.isDragingSeek||o.config.mediaType==="audio"))&&(this._state.now=l,this._state.direc=l>o.currentTime?0:1,o.seek(l))}}},{key:"computeTime",value:function(e,i){var n=this.player,r=this.root.getBoundingClientRect(),a=r.width,o=r.height,l=r.top,c=r.left,d,g,p=i;n.rotateDeg===90?(d=o,g=l):(d=a,g=c);var v=p-g;v=v>d?d:v<0?0:v;var m=v/d;m=m<0?0:m>1?1:m;var k=parseInt(m*this.offsetDuration*1e3,10)/1e3,C=f.getCurrentTimeByOffset(k,n.timeSegments);return{percent:m,currentTime:k,seekTime:C,offset:v,width:d,left:g,e}}},{key:"updateTime",value:function(e){var i=this.player,n=this.duration;e>n?e=n:e<0&&(e=0);var r=i.plugins.time;r&&r.updateTime(e)}},{key:"resetSeekState",value:function(){this.isProgressMoving=!1;var e=this.player.plugins.time;e&&e.resetActive()}},{key:"updatePercent",value:function(e,i){if(this.isProgressMoving=!0,!this.config.disable){e=e>1?1:e<0?0:e,this.progressBtn.style.left="".concat(e*100,"%"),this.innerList.update({played:e*this.offsetDuration},this.offsetDuration);var n=this.player.plugins.miniprogress;n&&n.update({played:e*this.offsetDuration},this.offsetDuration)}}},{key:"onTimeupdate",value:function(e){var i=this.player,n=this._state,r=this.offsetDuration;if(!(i.isSeeking&&i.media.seeking||this.isProgressMoving||!i.hasStart)){if(n.now>-1){var a=parseInt(n.now*1e3,10)-parseInt(i.currentTime*1e3,10);if(n.direc===0&&a>300||n.direc===1&&a>-300){n.now=-1;return}else n.now=-1}var o=this.currentTime;o=f.adjustTimeByDuration(o,r,e),this.innerList.update({played:o},r),this.progressBtn.style.left="".concat(o/r*100,"%");var l=this.player.plugins.miniprogress;l&&l.update({played:o},r)}}},{key:"onCacheUpdate",value:function(e){var i=this.player,n=this.duration;if(i){var r=i.bufferedPoint.end;r=f.adjustTimeByDuration(r,n,e),this.innerList.update({cached:r},n);var a=this.player.plugins.miniprogress;a&&a.update({cached:r},n)}}},{key:"onReset",value:function(){this.innerList.update({played:0,cached:0},0),this.progressBtn.style.left="0%";var e=this.player.plugins.miniprogress;e&&e.update({cached:0,played:0},0),this.progressBtn.style.left="0%"}},{key:"destroy",value:function(){var e=this.player,i=e.controls;this.thumbnailPlugin=null,this.innerList.destroy(),this.innerList=null;var n=this.domEventType;(n==="touch"||n==="compatible")&&(this.root.removeEventListener("touchstart",this.onMouseDown),this.root.removeEventListener("touchmove",this.onMouseMove),this.root.removeEventListener("touchend",this.onMouseUp),i&&(i.root&&i.root.removeEventListener("touchmove",f.stopPropagation),i.center&&i.center.removeEventListener("touchend",f.stopPropagation))),(n==="mouse"||n==="compatible")&&(this.unbind("mousedown",this.onMouseDown),this.unbind("mouseenter",this.onMouseEnter),this.unbind("mousemove",this.onMoveOnly),this.unbind("mouseleave",this.onMouseLeave),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),e.root.removeEventListener("click",this.onBodyClick,!0))}},{key:"render",value:function(){if(!(this.config.disable||this.playerConfig.isLive)){var e=this.player.controls?this.player.controls.config.mode:"",i=e==="bottom"?"xgplayer-progress-bottom":"";return`
    <xg-progress class="xgplayer-progress `.concat(i,`">
      <xg-outer class="xgplayer-progress-outer">
        <xg-progress-btn class="xgplayer-progress-btn"></xg-progress-btn>
      </xg-outer>
    </xg-progress>
    `)}}}],[{key:"pluginName",get:function(){return"progress"}},{key:"defaultConfig",get:function(){return{position:z.CONTROLS_CENTER,index:0,disable:!1,isDragingSeek:!0,closeMoveSeek:!1,isPauseMoving:!1,isCloseClickSeek:!1,fragments:[{percent:1}],fragFocusClass:bt.POINT,fragClass:"",fragAutoFocus:!1,miniMoveStep:5,miniStartStep:2,onMoveStart:function(){},onMoveEnd:function(){},endedDiff:.2}}},{key:"FRAGMENT_FOCUS_CLASS",get:function(){return bt}}]),s}(F),hn=function(h){L(s,h);var u=R(s);function s(){var t;w(this,s);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=u.call.apply(u,[this].concat(i)),T(y(t),"_onDurationChange",function(){t.updateSegments();var r=t.player,a=r.currentTime,o=r.timeSegments;if(t._checkIfEnabled(o)){var l=f.getIndexByTime(a,o),c=f.getOffsetCurrentTime(a,o,l);t.player.offsetCurrentTime=c,t.changeIndex(l,o)}}),T(y(t),"_onLoadedData",function(){var r=t.player.timeSegments;if(t._checkIfEnabled(r)){var a=f.getOffsetCurrentTime(0,r);t.player.offsetCurrentTime=a,t.changeIndex(0,r),t.curPos.start>0&&(t.player.currentTime=t.curPos.start)}}),T(y(t),"_onTimeupdate",function(){var r=t.player,a=r.currentTime,o=r.timeSegments;if(t._checkIfEnabled(o)){var l=o.length;t.lastCurrentTime=a;var c=f.getIndexByTime(a,o);c!==t.curIndex&&t.changeIndex(c,o);var d=f.getOffsetCurrentTime(a,o,c);if(t.player.offsetCurrentTime=d,!!t.curPos){var g=t.curPos,p=g.start,v=g.end;a<p?t.player.currentTime=p:a>v&&c>=l-1&&t.player.pause()}}}),T(y(t),"_onSeeking",function(){var r=t.player,a=r.currentTime,o=r.timeSegments;if(t._checkIfEnabled(o))if(a<o[0].start)t.player.currentTime=o[0].start;else if(a>o[o.length-1].end)t.player.currentTime=o[o.length-1].end;else{var l=f.getIndexByTime(a,o);if(l>=0){var c=t.getSeekTime(a,t.lastCurrentTime,l,o);c>=0&&(t.player.currentTime=c)}}}),T(y(t),"_onPlay",function(){var r=t.player,a=r.currentTime,o=r.timeSegments;t._checkIfEnabled(o)&&a>=o[o.length-1].end&&(t.player.currentTime=o[0].start)}),t}return b(s,[{key:"afterCreate",value:function(){this.curIndex=-1,this.curPos=null,this.lastCurrentTime=0,this.updateSegments(),this.on(Te,this._onDurationChange),this.on(ne,this._onLoadedData),this.on(J,this._onTimeupdate),this.on(we,this._onSeeking),this.on(X,this._onPlay)}},{key:"setConfig",value:function(e){var i=this;if(e){var n=Object.keys(e);n.length<1||(n.forEach(function(r){i.config[r]=e[r]}),this.updateSegments())}}},{key:"updateSegments",value:function(){var e=this.config,i=e.disable,n=e.segments,r=this.player;if(i||!n||n.length===0)r.timeSegments=[],r.offsetDuration=0,r.offsetCurrentTime=-1;else{var a=this.formatTimeSegments(n,r.duration);r.timeSegments=a,r.offsetDuration=a.length>0?a[a.length-1].duration:0}}},{key:"formatTimeSegments",value:function(e,i){var n=[];return e?(e.sort(function(r,a){return r.start-a.start}),e.forEach(function(r,a){var o={};if(o.start=r.start<0?0:r.start,o.end=i>0&&r.end>i?i:r.end,!(i>0&&o.start>i)){n.push(o);var l=o.end-o.start;if(a===0)o.offset=r.start,o.cTime=0,o.segDuration=l,o.duration=l;else{var c=n[a-1];o.offset=c.offset+(o.start-c.end),o.cTime=c.duration+c.cTime,o.segDuration=l,o.duration=c.duration+l}}}),n):[]}},{key:"getSeekTime",value:function(e,i,n,r){var a=-1,o=r[n],l=o.start,c=o.end;if(e>=l&&e<=c)return a;var d=e-i;if(d<0&&e<l){var g=i>l?i-l:0;return a=n-1>=0?r[n-1].end+d+g:0,a}return-1}},{key:"_checkIfEnabled",value:function(e){return!(!e||e.length<1)}},{key:"changeIndex",value:function(e,i){this.curIndex=e,e>=0&&i.length>0?this.curPos=i[e]:this.curPos=null}}],[{key:"pluginName",get:function(){return"TimeSegmentsControls"}},{key:"defaultConfig",get:function(){return{disable:!0,segments:[]}}}]),s}(me);function fn(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="40" viewBox="10 0 24 40">
  <path transform="scale(0.038 0.028)" d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z"></path>
</svg>
`,"image/svg+xml").firstChild}var dn=function(h){L(s,h);var u=R(s);function s(t){var e;return w(this,s),e=u.call(this,t),T(y(e),"playNext",function(i){var n=y(e),r=n.player;i.preventDefault(),i.stopPropagation(),e.idx+1<e.config.urlList.length?(e.idx++,e.nextHandler(e.config.urlList[e.idx],e.idx),r.emit(Ue,e.idx+1)):(e.nextHandler(),r.emit(Ue))}),e.idx=-1,e}return b(s,[{key:"afterCreate",value:function(){!this.config.urlList||this.config.urlList.length===0||(this.appendChild(".xgplayer-icon",this.icons.playNext),this.initEvents())}},{key:"registerIcons",value:function(){return{playNext:fn}}},{key:"initEvents",value:function(){this.nextHandler=this.hook("nextClick",this.changeSrc);var e=P.device==="mobile"?"touchend":"click";this.bind(e,this.playNext),this.show()}},{key:"changeSrc",value:function(e){var i=this.player;e&&(i.pause(),i.currentTime=0,i.switchURL?i.switchURL(e):i.src=e,i.config.url=e,i.play())}},{key:"destroy",value:function(){this.unbind(["touchend","click"],this.playNext)}},{key:"render",value:function(){if(!(!this.config.urlList||this.config.urlList.length===0))return`
     <xg-icon class="xgplayer-playnext">
      <div class="xgplayer-icon">
      </div>
      `.concat($e(this,"PLAYNEXT_TIPS",this.playerConfig.isHideTips),`
     </xg-icon>
    `)}}],[{key:"pluginName",get:function(){return"playNext"}},{key:"defaultConfig",get:function(){return{position:z.CONTROLS_LEFT,index:1,url:null,urlList:[]}}}]),s}(F),$t={exports:{}};(function(h,u){(function(s,t){h.exports=t()})(qt,function(){return function s(t,e,i){var n=window,r="application/octet-stream",a=i||r,o=t,l=!e&&!i&&o,c=document.createElement("a"),d=function(E){return String(E)},g=n.Blob||n.MozBlob||n.WebKitBlob||d,p=e||"download",v,m;if(g=g.call?g.bind(n):Blob,String(this)==="true"&&(o=[o,a],a=o[0],o=o[1]),l&&l.length<2048&&(p=l.split("/").pop().split("?")[0],c.href=l,c.href.indexOf(l)!==-1)){var k=new XMLHttpRequest;return k.open("GET",l,!0),k.responseType="blob",k.onload=function(E){s(E.target.response,p,r)},setTimeout(function(){k.send()},0),k}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(o))if(o.length>1024*1024*1.999&&g!==d)o=I(o),a=o.type||r;else return navigator.msSaveBlob?navigator.msSaveBlob(I(o),p):B(o);else if(/([\x80-\xff])/.test(o)){var C=0,S=new Uint8Array(o.length),D=S.length;for(C;C<D;++C)S[C]=o.charCodeAt(C);o=new g([S],{type:a})}v=o instanceof g?o:new g([o],{type:a});function I(E){var W=E.split(/[:;,]/),V=W[1],he=W[2]=="base64"?atob:decodeURIComponent,Je=he(W.pop()),Qe=Je.length,fe=0,Ze=new Uint8Array(Qe);for(fe;fe<Qe;++fe)Ze[fe]=Je.charCodeAt(fe);return new g([Ze],{type:V})}function B(E,W){if("download"in c)return c.href=E,c.setAttribute("download",p),c.className="download-js-link",c.innerHTML="downloading...",c.style.display="none",document.body.appendChild(c),setTimeout(function(){c.click(),document.body.removeChild(c),W===!0&&setTimeout(function(){n.URL.revokeObjectURL(c.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(E)&&(E="data:"+E.replace(/^data:([\w\/\-\+]+)/,r)),window.open(E)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=E),!0;var V=document.createElement("iframe");document.body.appendChild(V),!W&&/^data:/.test(E)&&(E="data:"+E.replace(/^data:([\w\/\-\+]+)/,r)),V.src=E,setTimeout(function(){document.body.removeChild(V)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(v,p);if(n.URL)B(n.URL.createObjectURL(v),!0);else{if(typeof v=="string"||v.constructor===d)try{return B("data:"+a+";base64,"+n.btoa(v))}catch(E){return B("data:"+a+","+encodeURIComponent(v))}m=new FileReader,m.onload=function(E){B(this.result)},m.readAsDataURL(v)}return!0}})})($t);var gn=$t.exports;const pn=xt(gn);function vn(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
    <g transform="translate(-488.000000, -340.000000)" fill="#FFFFFF">
      <g id="Group-2">
        <g id="volme_big-copy" transform="translate(488.000000, 340.000000)">
          <rect id="Rectangle-18" x="11" y="4" width="2" height="12" rx="1"></rect>
          <rect id="Rectangle-2" x="3" y="18" width="18" height="2" rx="1"></rect>
          <rect id="Rectangle-2" transform="translate(4.000000, 17.500000) rotate(90.000000) translate(-4.000000, -17.500000) " x="1.5" y="16.5" width="5" height="2" rx="1"></rect><rect id="Rectangle-2-Copy-3" transform="translate(20.000000, 17.500000) rotate(90.000000) translate(-20.000000, -17.500000) " x="17.5" y="16.5" width="5" height="2" rx="1"></rect>
          <path d="M9.48791171,8.26502656 L9.48791171,14.2650266 C9.48791171,14.8173113 9.04019646,15.2650266 8.48791171,15.2650266 C7.93562696,15.2650266 7.48791171,14.8173113 7.48791171,14.2650266 L7.48791171,7.26502656 C7.48791171,6.71274181 7.93562696,6.26502656 8.48791171,6.26502656 L15.4879117,6.26502656 C16.0401965,6.26502656 16.4879117,6.71274181 16.4879117,7.26502656 C16.4879117,7.81731131 16.0401965,8.26502656 15.4879117,8.26502656 L9.48791171,8.26502656 Z" id="Combined-Shape" transform="translate(11.987912, 10.765027) scale(1, -1) rotate(45.000000) translate(-11.987912, -10.765027) "></path>
        </g>
      </g>
    </g>
  </g>
</svg>
`,"image/svg+xml").firstChild}var mn=function(h){L(s,h);var u=R(s);function s(t){var e;return w(this,s),e=u.call(this,t),T(y(e),"download",function(i){if(!e.isLock){e.emitUserAction(i,"download");var n=e.playerConfig.url,r="";f.typeOf(n)==="String"?r=n:f.typeOf(n)==="Array"&&n.length>0&&(r=n[0].src);var a=e.getAbsoluteURL(r);pn(a),e.isLock=!0,e.timer=window.setTimeout(function(){e.isLock=!1,window.clearTimeout(e.timer),e.timer=null},300)}}),e.timer=null,e.isLock=!1,e}return b(s,[{key:"afterCreate",value:function(){O(N(s.prototype),"afterCreate",this).call(this),!this.config.disable&&(this.appendChild(".xgplayer-icon",this.icons.download),this._handler=this.hook("click",this.download,{pre:function(i){i.preventDefault(),i.stopPropagation()}}),this.bind(["click","touchend"],this._handler))}},{key:"registerIcons",value:function(){return{download:vn}}},{key:"getAbsoluteURL",value:function(e){if(!e.match(/^https?:\/\//)){var i=document.createElement("div");i.innerHTML='<a href="'.concat(e,'">x</a>'),e=i.firstChild.href}return e}},{key:"destroy",value:function(){O(N(s.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.download),window.clearTimeout(this.timer),this.timer=null}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-download">
   <div class="xgplayer-icon">
   </div>
   `.concat($e(this,"DOWNLOAD_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"download"}},{key:"defaultConfig",get:function(){return{position:z.CONTROLS_RIGHT,index:3,disable:!0}}}]),s}(Ut),yn=function(h){L(s,h);var u=R(s);function s(){return w(this,s),u.apply(this,arguments)}return b(s,[{key:"beforeCreate",value:function(e){typeof e.player.config.screenShot=="boolean"&&(e.config.disable=!e.player.config.screenShot)}},{key:"afterCreate",value:function(){O(N(s.prototype),"afterCreate",this).call(this),this.appendChild(".xgplayer-icon",this.icons.screenshotIcon);var e=this.config;this.initSize=function(i){e.fitVideo&&(e.width=i.vWidth,e.height=i.vHeight)},this.once(ye,this.initSize)}},{key:"onPluginsReady",value:function(){this.show(),this.onClickBtn=this.onClickBtn.bind(this),this.bind(["click","touchend"],this.onClickBtn)}},{key:"saveScreenShot",value:function(e,i){var n=document.createElement("a");n.href=e,n.download=i;var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(r)}},{key:"createCanvas",value:function(e,i){var n=document.createElement("canvas"),r=n.getContext("2d");this.canvasCtx=r,this.canvas=n,n.width=e||this.config.width,n.height=i||this.config.height,r.imageSmoothingEnabled=!0,r.imageSmoothingEnabled&&(r.imageSmoothingQuality="high")}},{key:"onClickBtn",value:function(e){var i=this;e.preventDefault(),e.stopPropagation(),this.emitUserAction(e,"shot");var n=this.config;this.shot(n.width,n.height).then(function(r){i.emit(yi,r),n.saveImg&&i.saveScreenShot(r,n.name+n.format)})}},{key:"shot",value:function(e,i){var n=this,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{quality:.92,type:"image/png"},a=this.config,o=this.player,l=r.quality||a.quality,c=r.type||a.type;return new Promise(function(d,g){var p=null,v;if(o.media.canvas)p=o.media.canvas;else{n.canvas?(n.canvas.width=e||a.width,n.canvas.height=i||a.height):n.createCanvas(e,i),p=n.canvas,v=n.canvasCtx;var m=o.media.videoWidth/o.media.videoHeight,k=p.width/p.height,C=0,S=0,D=o.media.videoWidth,I=o.media.videoHeight,B,E,W,V;m>k?(W=p.width,V=p.width/m,B=0,E=Math.round((p.height-V)/2)):m===k?(W=p.width,V=p.height,B=0,E=0):m<k&&(W=p.height*m,V=p.height,B=Math.round((p.width-W)/2),E=0),v.drawImage(o.media,C,S,D,I,B,E,W,V)}var he=p.toDataURL(c,l).replace(c,"image/octet-stream");he=he.replace(/^data:image\/[^;]+/,"data:application/octet-stream"),d(he)})}},{key:"registerIcons",value:function(){return{screenshotIcon:null}}},{key:"destroy",value:function(){O(N(s.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.onClickBtn),this.off(ye,this.initSize)}},{key:"render",value:function(){if(!this.config.disable){var e=this.icons.screenshotIcon?"xgplayer-icon":"xgplayer-icon btn-text",i="SCREENSHOT";return`
      <xg-icon class="xgplayer-shot">
      <div class="`.concat(e,`">
      `).concat(this.icons.screenshotIcon?"":'<span lang-key="'.concat(this.i18nKeys[i],'">').concat(this.i18n[i],"</span>"),`
      </div>
    </xg-icon>`)}}}],[{key:"pluginName",get:function(){return"screenShot"}},{key:"defaultConfig",get:function(){return{position:z.CONTROLS_RIGHT,index:5,quality:.92,type:"image/png",format:".png",width:600,height:337,saveImg:!0,fitVideo:!0,disable:!1,name:"screenshot"}}}]),s}(Ut),_n=function(h){L(s,h);var u=R(s);function s(){return w(this,s),u.apply(this,arguments)}return b(s,[{key:"afterCreate",value:function(){var e=this;this.intervalId=0,this.customConfig=null,this.bind(".highlight",["click","touchend"],function(i){(e.config.onClick||e.customOnClick)&&(i.preventDefault(),i.stopPropagation(),e.customOnClick?e.customOnClick(i):e.config.onClick(i))}),this.player.showPrompt=function(){e.showPrompt.apply(e,arguments)},this.player.hidePrompt=function(){e.hide()}}},{key:"setStyle",value:function(e){var i=this;Object.keys(e).map(function(n){i.root.style[n]=e[n]})}},{key:"showPrompt",value:function(e){var i=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){};if(e){this.customOnClick=r;var a=this.config.interval;this.intervalId&&(clearTimeout(this.intervalId),this.intervalId=null),f.addClass(this.root,"show"),n.mode==="arrow"&&f.addClass(this.root,"arrow"),typeof e=="string"?this.find(".xgplayer-prompt-detail").innerHTML=e:this.find(".xgplayer-prompt-detail").innerHTML="".concat(e.text||"")+"".concat(e.highlight?'<i class="highlight">'.concat(e.highlight,"</i>"):""),n.style&&this.setStyle(n.style);var o=typeof n.autoHide=="boolean"?n.autoHide:this.config.autoHide;if(o){var l=n.interval||a;this.intervalId=setTimeout(function(){i.hide()},l)}}}},{key:"hide",value:function(){f.removeClass(this.root,"show"),f.removeClass(this.root,"arrow"),this.root.removeAttribute("style"),this.customOnClick=null}},{key:"render",value:function(){return'<xg-prompt class="xgplayer-prompt '.concat(_.CONTROLS_FOLLOW,`">
    <span class="xgplayer-prompt-detail"></span>
    </xg-prompt>`)}}],[{key:"pluginName",get:function(){return"prompt"}},{key:"defaultConfig",get:function(){return{interval:3e3,style:{},mode:"arrow",autoHide:!0,detail:{text:"",highlight:""},onClick:function(){}}}}]),s}(F),wt={time:0,text:"",id:1,duration:1,color:"#fff",style:{},width:6,height:6};function Kt(h){Object.keys(wt).map(function(u){h[u]===void 0&&(h[u]=wt[u])})}var Pt={_updateDotDom:function(u,s){if(s){var t=this.calcuPosition(u.time,u.duration),e=u.style||{};e.left="".concat(t.left,"%"),e.width="".concat(t.width,"%"),s.setAttribute("data-text",u.text),s.setAttribute("data-time",u.time),t.isMini?f.addClass(s,"mini"):f.removeClass(s,"mini"),Object.keys(e).map(function(i){s.style[i]=e[i]})}},initDots:function(){var u=this;this._ispots.map(function(s){u.createDot(s,!1)}),this.ispotsInit=!0},createDot:function(u){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this.player.plugins.progress;if(t&&(s&&(Kt(u),this._ispots.push(u)),!(!this.ispotsInit&&s))){var e=this.calcuPosition(u.time,u.duration),i=u.style||{};i.left="".concat(e.left,"%"),i.width="".concat(e.width,"%");var n="xgspot_".concat(u.id," xgplayer-spot");e.isMini&&(n+=" mini");var r=u.template?'<div class="xgplayer-spot-pop">'.concat(u.template,"</div>"):"",a=f.createDom("xg-spot",r,{"data-text":u.text,"data-time":u.time,"data-id":u.id},n);Object.keys(i).map(function(o){a.style[o]=i[o]}),t.outer&&t.outer.appendChild(a),this.positionDot(a,u.id)}},findDot:function(u){if(this.player.plugins.progress){var s=this._ispots.filter(function(t,e){return t.id===u});return s.length>0?s[0]:null}},updateDot:function(u){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=this.player.plugins.progress;if(t){var e=this.findDot(u.id);if(e&&Object.keys(u).map(function(n){e[n]=u[n]}),!!this.ispotsInit){var i=t.find('xg-spot[data-id="'.concat(u.id,'"]'));i&&(this._updateDotDom(u,i),s&&this.showDot(u.id))}}},deleteDot:function(u){var s=this._ispots,t=this.player.plugins.progress;if(t){for(var e=[],i=0;i<s.length;i++)s[i].id===u&&e.push(i);for(var n=e.length,r=n-1;r>=0;r--)if(s.splice(e[r],1),this.ispotsInit){var a=t.find('xg-spot[data-id="'.concat(u,'"]'));a&&a.parentElement.removeChild(a)}}},deleteAllDots:function(){var u=this.player.plugins.progress;if(u){if(!this.ispotsInit){this._ispots=[];return}for(var s=u.root.getElementsByTagName("xg-spot"),t=s.length-1;t>=0;t--)u.outer.removeChild(s[t]);this._ispots=[]}},updateAllDots:function(){var u=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=this.player.plugins.progress;if(t){if(!this.ispotsInit){this._ispots=s;return}this._ispots=[];var e=t.root.getElementsByTagName("xg-spot"),i=e.length;if(i>s.length)for(var n=i-1;n>s.length-1;n--)t.outer.removeChild(e[n]);s.forEach(function(r,a){a<i?(e[a].setAttribute("data-id","".concat(r.id)),u._ispots.push(r),u.updateDot(r)):u.createDot(r)})}},positionDots:function(){var u=this,s=this._ispots,t=this.playerSize,e=this.player.sizeInfo,i=this.player.plugins.progress;!i||e.width===t.width||(t.width=e.width,t.left=e.left,s.forEach(function(n){var r=i.find('xg-spot[data-id="'.concat(n.id,'"]'));r&&u.positionDot(r,n.id)}))},positionDot:function(u,s){var t=f.findDom(u,".xgplayer-spot-pop");if(t){var e=this.playerSize,i=u.getBoundingClientRect(),n=t.getBoundingClientRect(),r=i.left-e.left,a=e.width-r-i.width/2;if(r<n.width/2||e.width<n.width){var o=n.width/2-r;t.style.left="".concat(o,"px")}else if(a<n.width/2){var l=a-n.width/2+i.width/2;t.style.left="".concat(l,"px")}else t.style.left="50%"}},updateDuration:function(){var u=this,s=this.player.plugins.progress;if(s){var t=this._ispots;t.forEach(function(e){var i=s.find('xg-spot[data-id="'.concat(e.id,'"]'));u._updateDotDom(e,i)})}},getAllDotsDom:function(){var u=this.player.plugins.progress;if(!u)return[];var s=u.root.getElementsByTagName("xg-spot");return s},getDotDom:function(u){var s=this.player.plugins.progress;if(s)return s.find('xg-spot[data-id="'.concat(u,'"]'))}};function Tn(h){var u=h.config,s=h.player;Object.keys(Pt).map(function(e){h[e]=Pt[e].bind(h)});var t=s.config.progressDot||u.ispots||[];h._ispots=t.map(function(e){return Kt(e),e}),h.ispotsInit=!1,h.playerSize={left:s.sizeInfo.left,width:s.sizeInfo.width},h.on(Te,function(){h.ispotsInit?h.updateDuration():h.initDots()}),h.on(ye,function(){h.positionDots()})}var se={dragmove:"onProgressMove",dragstart:"onProgressDragStart",dragend:"onProgressDragEnd",click:"onProgressClick",mouseover:"onProgressMouseOver",mouseenter:"onProgressMouseOver"},Cn=function(h){L(s,h);var u=R(s);function s(t){var e;return w(this,s),e=u.call(this,t),T(y(e),"onMousemove",function(i){if(!e.config.disable){if(f.hasClass(i.target,"xg-spot-content")&&e.config.isHideThumbnailHover){e.player.plugins.progress.onMouseLeave(i);return}(e._state.f||f.hasClass(i.target,"xg-spot-content"))&&(f.event(i),i.stopPropagation())}}),T(y(e),"onMousedown",function(i){e.config.disable||(e._state.f||f.hasClass(i.target,"xg-spot-content"))&&(f.event(i),i.stopPropagation())}),T(y(e),"onMouseup",function(i){if(e.isDrag){var n=e.player.plugins.progress;n&&n.pos&&(n.onMouseUp(i),!n.pos.isEnter&&n.onMouseLeave(i))}}),T(y(e),"onDotMouseLeave",function(i){if(!e.config.disable){e._curDot.removeEventListener("mouseleave",e.onDotMouseLeave),e.blurDot(i.target),e._curDot=null;var n=e.player.plugins.progress;n&&n.enableBlur(),e.show()}}),T(y(e),"onProgressMouseOver",function(i,n){if(!e.config.disable&&f.hasClass(n.target,"xgplayer-spot")&&!e._curDot){e._curDot=n.target,e.focusDot(n.target),e._curDot.children.length>0&&e.hide();var r=e.player.plugins.progress;r&&r.disableBlur(),e._curDot.addEventListener("mouseleave",e.onDotMouseLeave)}}),e._ispots=[],e.videoPreview=null,e.videothumbnail=null,e.thumbnail=null,e.timeStr="",e._state={now:0,f:!1},e}return b(s,[{key:"beforeCreate",value:function(e){var i=e.player.plugins.progress;i&&(e.root=i.root)}},{key:"afterCreate",value:function(){var e=this;this._curDot=null,this.handlerSpotClick=this.hook("spotClick",function(i,n){n.seekTime&&e.player.seek(n.seekTime)}),this.transformTimeHook=this.hook("transformTime",function(i){e.setTimeContent(f.format(i))}),Tn(this),this.on(Te,function(){e.show()}),this.config.disable&&this.disable(),this.extTextRoot=this.find(".xg-spot-ext-text")}},{key:"setConfig",value:function(e){var i=this;e&&Object.keys(e).map(function(n){i.config[n]=e[n]})}},{key:"onPluginsReady",value:function(){var e=this.player;e.plugins.progress&&(this.previewLine=this.find(".xg-spot-line"),this.timePoint=this.find(".xgplayer-progress-point"),this.timeText=this.find(".xg-spot-time"),this.tipText=this.find(".spot-inner-text"),this._hasThumnail=!1,this.registerThumbnail(),this.bindEvents())}},{key:"bindEvents",value:function(){var e=this,i=this.player.plugins.progress;if(i&&(Object.keys(se).map(function(r){e[se[r]]=e[se[r]].bind(e),i.addCallBack(r,e[se[r]])}),P.device!=="mobile")){this.bind(".xg-spot-info","mousemove",this.onMousemove),this.bind(".xg-spot-info","mousedown",this.onMousedown),this.bind(".xg-spot-info","mouseup",this.onMouseup);var n=this.hook("previewClick",function(){});this.handlerPreviewClick=function(r){r.stopPropagation(),n(parseInt(e._state.now*1e3,10)/1e3,r)},this.bind(".xg-spot-content","mouseup",this.handlerPreviewClick)}}},{key:"onProgressMove",value:function(e,i){this.config.disable||!this.player.duration||this.updatePosition(e.offset,e.width,e.currentTime,e.e)}},{key:"onProgressDragStart",value:function(e){this.config.disable||!this.player.duration||(this.isDrag=!0,this.videoPreview&&f.addClass(this.videoPreview,"show"))}},{key:"onProgressDragEnd",value:function(e){this.config.disable||!this.player.duration||(this.isDrag=!1,this.videoPreview&&f.removeClass(this.videoPreview,"show"))}},{key:"onProgressClick",value:function(e,i){this.config.disable||f.hasClass(i.target,"xgplayer-spot")&&(i.stopPropagation(),i.preventDefault(),["time","id","text"].map(function(n){e[n]=i.target.getAttribute("data-".concat(n))}),e.time&&(e.time=Number(e.time)),this.handlerSpotClick(i,e))}},{key:"updateLinePos",value:function(e,i){var n=this.root,r=this.previewLine,a=this.player,o=this.config,l=a.controls.mode,c=l==="flex",d=n.getBoundingClientRect().width;if(!(!d&&this._hasThumnail)){d=this._hasThumnail&&d<o.width?o.width:d;var g=e-d/2,p;g<0&&!c?(g=0,p=e-d/2):g>i-d&&!c?(p=g-(i-d),g=i-d):p=0,p!==void 0&&(r.style.transform="translateX(".concat(p.toFixed(2),"px)")),n.style.transform="translateX(".concat(g.toFixed(2),"px) translateZ(0)")}}},{key:"updateTimeText",value:function(e){var i=this.timeText,n=this.timePoint;i.innerHTML=e,!this.thumbnail&&(n.innerHTML=e)}},{key:"updatePosition",value:function(e,i,n,r){var a=this.root,o=this.config,l=this._state;if(a){l.now=n,this.transformTimeHook(n);var c=this.timeStr;r&&r.target&&f.hasClass(r.target,"xgplayer-spot")?(this.showTips(r.target.getAttribute("data-text"),!1,c),this.focusDot(r.target),l.f=!0,o.isFocusDots&&l.f&&(l.now=parseInt(r.target.getAttribute("data-time"),10))):o.defaultText?(l.f=!1,this.showTips(o.defaultText,!0,c)):(l.f=!1,this.hideTips("")),this.updateTimeText(c),this.updateThumbnails(l.now),this.updateLinePos(e,i)}}},{key:"setTimeContent",value:function(e){this.timeStr=e}},{key:"updateThumbnails",value:function(e){var i=this.player,n=this.videoPreview,r=this.config,a=i.plugins.thumbnail;if(a&&a.usable){this.thumbnail&&a.update(this.thumbnail,e,r.width,r.height);var o=n&&n.getBoundingClientRect();this.videothumbnail&&a.update(this.videothumbnail,e,o.width,o.height)}}},{key:"registerThumbnail",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(P.device!=="mobile"){var i=this.player,n=this.config,r=i.getPlugin("thumbnail");if(r&&r.setConfig(e),!r||!r.usable||!n.isShowThumbnail){f.addClass(this.root,"short-line no-thumbnail");return}else f.removeClass(this.root,"short-line no-thumbnail");n.mode==="short"&&f.addClass(this.root,"short-line"),this._hasThumnail=!0;var a=this.find(".xg-spot-thumbnail");this.thumbnail=r.createThumbnail(a,"progress-thumbnail"),n.isShowCoverPreview&&(this.videoPreview=f.createDom("xg-video-preview","",{},"xgvideo-preview"),i.root.appendChild(this.videoPreview),this.videothumbnail=r.createThumbnail(this.videoPreview,"xgvideo-thumbnail")),this.updateThumbnails(0)}}},{key:"calcuPosition",value:function(e,i){var n=this.player.plugins.progress,r=this.player,a=n.root.getBoundingClientRect().width,o=r.duration/a*6;return e+i>r.duration&&(i=r.duration-e),e/r.duration*100,i/r.duration,{left:e/r.duration*100,width:i/r.duration*100,isMini:i<o}}},{key:"showDot",value:function(e){var i=this.findDot(e);if(i){var n=this.root.getBoundingClientRect(),r=n.width,a=i.time/this.player.duration*r;this.updatePosition(a,r,i.time)}}},{key:"focusDot",value:function(e,i){e&&(i||(i=e.getAttribute("data-id")),f.addClass(e,"active"),this._activeDotId=i)}},{key:"blurDot",value:function(e){if(!e){var i=this._activeDotId;e=this.getDotDom(i)}e&&(f.removeClass(e,"active"),this._activeDotId=null)}},{key:"showTips",value:function(e,i){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";f.addClass(this.root,"no-timepoint"),e&&(f.addClass(this.find(".xg-spot-content"),"show-text"),i&&this.config.mode==="production"?(f.addClass(this.root,"product"),this.tipText.textContent=e):(f.removeClass(this.root,"product"),this.tipText.textContent=this._hasThumnail?e:"".concat(n," ").concat(e)))}},{key:"hideTips",value:function(){f.removeClass(this.root,"no-timepoint"),this.tipText.textContent="",f.removeClass(this.find(".xg-spot-content"),"show-text"),f.removeClass(this.root,"product")}},{key:"hide",value:function(){f.addClass(this.root,"hide")}},{key:"show",value:function(e){f.removeClass(this.root,"hide")}},{key:"enable",value:function(){var e=this.config,i=this.playerConfig;this.config.disable=!1,this.show(),!this.thumbnail&&e.isShowThumbnail&&this.registerThumbnail(i.thumbnail||{})}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){var e=this,i=this.player.plugins.progress;i&&Object.keys(se).map(function(n){i.removeCallBack(n,e[se[n]])}),this.videothumbnail=null,this.thumbnail=null,this.videoPreview&&this.player.root.removeChild(this.videoPreview),this.unbind(".xg-spot-info","mousemove",this.onMousemove),this.unbind(".xg-spot-info","mousedown",this.onMousedown),this.unbind(".xg-spot-info","mouseup",this.onMouseup),this.unbind(".xg-spot-content","mouseup",this.handlerPreviewClick)}},{key:"render",value:function(){return P.device==="mobile"||this.playerConfig.isMobileSimulateMode==="mobile"?"":'<div class="xg-spot-info hide '.concat(this.config.mode==="short"?"short-line":"",`">
      <div class="xg-spot-content">
        <div class="xg-spot-thumbnail">
          <span class="xg-spot-time"></span>
        </div>
        <div class="xg-spot-text"><span class="spot-inner-text"></span></div>
      </div>
      <div class="xgplayer-progress-point">00:00</div>
      <div class="xg-spot-ext-text"></div>
      <div class="xg-spot-line"></div>
    </div>`)}}],[{key:"pluginName",get:function(){return"progresspreview"}},{key:"defaultConfig",get:function(){return{index:1,miniWidth:6,ispots:[],defaultText:"",isFocusDots:!0,isHideThumbnailHover:!0,isShowThumbnail:!0,isShowCoverPreview:!1,mode:"",disable:!1,width:160,height:90}}}]),s}(F),kn=function(h){L(s,h);var u=R(s);function s(t){var e;return w(this,s),e=u.call(this,t),e.ratio=1,e.interval=null,e._preloadMark={},e}return b(s,[{key:"afterCreate",value:function(){var e=this;this.usable&&this.initThumbnail(),this.on([Te],function(){var i=e.config,n=i.pic_num,r=i.interval;e.usable&&(e.interval=r>0?r:Math.round(e.player.duration*1e3/n)/1e3)})}},{key:"setConfig",value:function(e){var i=this;if(e){var n=Object.keys(e);n.length<1||(n.forEach(function(r){i.config[r]=e[r]}),this.usable&&this.initThumbnail())}}},{key:"usable",get:function(){var e=this.config,i=e.urls,n=e.pic_num;return i&&i.length>0&&n>0}},{key:"initThumbnail",value:function(){var e=this.config,i=e.width,n=e.height,r=e.pic_num,a=e.interval;this.ratio=i/n*100,this.interval=a||Math.round(this.player.duration/r),this._preloadMark={}}},{key:"getUrlByIndex",value:function(e){return e>=0&&e<this.config.urls.length?this.config.urls[e]:""}},{key:"preload",value:function(e){var i=this;if(!this._preloadMark[e]){var n=this.config.urls,r=n.length,a=[];e>0&&a.push(e-1),a.push(e),e>0&&e<r-1&&a.push(e+1),a.map(function(o){!i._preloadMark[o]&&o>=0&&o<r&&(i._preloadMark[o]=1,f.preloadImg(n[o],function(){i._preloadMark[o]=2}))})}}},{key:"getPosition",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=this.config,a=r.pic_num,o=r.row,l=r.col,c=r.width,d=r.height;this.interval=Math.round(this.player.duration/a);var g=Math.ceil(e/this.interval);g=g>a?a:g;var p=g<o*l?0:Math.ceil(g/(o*l))-1,v=g-p*(l*o),m=v>0?Math.ceil(v/l)-1:0,k=v>0?v-m*l-1:0,C=0,S=0;if(i&&n){var D=i/n;D<c/d?(S=n,C=S*(c/d)):(C=i,S=C/(c/d))}else n?i||(S=n||d,C=S*(c/d)):(C=i||c,S=C/(c/d));var I=this.getUrlByIndex(p);return{urlIndex:p,rowIndex:m,colIndex:k,url:I,height:S,width:C,style:{backgroundImage:"url(".concat(I,")"),backgroundSize:"".concat(C*l,"px auto"),backgroundPosition:"-".concat(k*C,"px -").concat(m*S,"px"),width:"".concat(C,"px"),height:"".concat(S,"px")}}}},{key:"update",value:function(e,i){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",o=this.config,l=o.pic_num,c=o.urls;if(!(l<=0||!c||c.length===0)){var d=this.getPosition(i,n,r);this.preload(d.urlIndex),Object.keys(d.style).map(function(g){e.style[g]=d.style[g]}),Object.keys(a).map(function(g){e.style[g]=a[g]})}}},{key:"changeConfig",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.setConfig(e)}},{key:"createThumbnail",value:function(e,i){var n=f.createDom("xg-thumbnail","",{},"thumbnail ".concat(i));return e&&e.appendChild(n),n}}],[{key:"pluginName",get:function(){return"thumbnail"}},{key:"defaultConfig",get:function(){return{isShow:!1,urls:[],pic_num:0,col:0,row:0,height:90,width:160,scale:1,className:"",hidePortrait:!1}}}]),s}(F);function Ne(h){return h?"background:".concat(h,";"):""}var Sn=function(h){L(s,h);var u=R(s);function s(){return w(this,s),u.apply(this,arguments)}return b(s,[{key:"afterCreate",value:function(){}},{key:"update",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0},i=arguments.length>1?arguments[1]:void 0;!i||!this.root||(e.cached&&(this.find("xg-mini-progress-cache").style.width="".concat(e.cached/i*100,"%")),e.played&&(this.find("xg-mini-progress-played").style.width="".concat(e.played/i*100,"%")))}},{key:"render",value:function(){if(!(!this.playerConfig.progress||!this.playerConfig.miniprogress)){var e=this.playerConfig.commonStyle,i={cached:Ne(e.cachedColor),played:Ne(e.playedColor),progress:Ne(e.progressColor)};return'<xg-mini-progress class="xg-mini-progress" style="'.concat(i.progress,`">
    <xg-mini-progress-cache class="xg-mini-progress-cache" style="`).concat(i.cached,`"></xg-mini-progress-cache>
    <xg-mini-progress-played class="xg-mini-progress-played" style="`).concat(i.played,`"></xg-mini-progress-played>
    </xg-mini-progress>`)}}}],[{key:"pluginName",get:function(){return"MiniProgress"}},{key:"defaultConfig",get:function(){return{}}}]),s}(F),ae={REAL_TIME:"realtime",FIRST_FRAME:"firstframe",FRAME_RATE:"framerate",POSTER:"poster"};function En(){try{return parseInt(window.performance.now(),10)}catch(h){return new Date().getTime()}}function bn(){try{var h=document.createElement("canvas").getContext;return!!h}catch(u){return!1}}var Ce=null,wn=function(h){L(s,h);var u=R(s);function s(){var t;w(this,s);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=u.call.apply(u,[this].concat(i)),T(y(t),"onLoadedData",function(r){t.player&&(t._frameCount=t.config.startFrameCount,t.stop(),t.renderOnTimeupdate(r),t.off(J,t.renderOnTimeupdate),t.on(J,t.renderOnTimeupdate))}),T(y(t),"onVisibilitychange",function(r){document.visibilityState==="visible"?t._checkIfCanStart()&&t.start():document.visibilityState==="hidden"&&t.stop()}),T(y(t),"renderOnTimeupdate",function(r){if(t._frameCount>0)t.renderOnce(),t._frameCount--;else{t._isLoaded=!0,t.off(J,t.renderOnTimeupdate);var a=t.config.startInterval;!t.player.paused&&t._checkIfCanStart()&&t.start(0,a)}}),T(y(t),"start",function(r,a){var o=t.player.video,l=En(),c=t.checkVideoIsSupport(o);!c||!t.canvasCtx||(a||(a=t.interval),t.stop(),o.videoWidth&&o.videoHeight&&(t.videoPI=o.videoHeight>0?parseInt(o.videoWidth/o.videoHeight*100,10):0,(t.config.mode===ae.REAL_TIME||l-t.preTime>=a)&&(o&&o.videoWidth&&t.update(c,t.videoPI),t.preTime=l)),t.frameId=t._loopType==="timer"?f.setTimeout(y(t),t.start,a):f.requestAnimationFrame(t.start))}),T(y(t),"stop",function(){t.frameId&&(t._loopType==="timer"?f.clearTimeout(y(t),t.frameId):f.cancelAnimationFrame(t.frameId),t.frameId=null)}),t}return b(s,[{key:"afterCreate",value:function(){var e=this;this.playerConfig.dynamicBg===!0&&(this.config.disable=!1),s.isSupport||(this.config.disable=!0);var i=this.config,n=i.disable,r=i.mode,a=i.frameRate;n||(this._pos={width:0,height:0,rwidth:0,rheight:0,x:0,y:0,pi:0},this.isStart=!1,this._isLoaded=!1,this.videoPI=0,this.preTime=0,this.interval=parseInt(1e3/a,10),this.canvas=null,this.canvasCtx=null,this._frameCount=0,this._loopType=this.config.mode!==ae.REAL_TIME&&this.interval>=1e3?"timer":"animation",this.once(Ot,function(){e.player&&(e.init(),e.renderByPoster(),e.player.paused||e.start())}),r!==ae.POSTER&&(r!==ae.FIRST_FRAME&&(this.on(Ke,function(){e.stop()}),this.on(X,function(){var o=e.config.startInterval;e._checkIfCanStart()&&e.start(0,o)}),this.on(Ye,function(){e.stop()})),this.on(ne,this.onLoadedData),this.on(Mt,function(){e._isLoaded=!1,e.stop()}),document.addEventListener("visibilitychange",this.onVisibilitychange)))}},{key:"setConfig",value:function(e){var i=this;Object.keys(e).forEach(function(n){n==="root"&&e[n]!==i.config[n]?i.reRender(e[n]):n==="frameRate"?i.interval=parseInt(1e3/e[n],10):n==="disable"&&e[n]&&i.stop(),i.config[n]=e[n]})}},{key:"init",value:function(e){var i=this.player,n=this.config;this.canvasFilter=s.supportCanvasFilter();try{var r=e||n.root;r||(r=n.isInnerRender&&i.innerContainer||i.root),r.insertAdjacentHTML("afterbegin",'<div class="xgplayer-dynamic-bg" data-index="'.concat(n.index,`"><canvas>
        </canvas><xgmask></xgmask></div>`)),this.root=r.children[0],this.canvas=this.find("canvas"),this.canvasFilter||(this.canvas.style.filter=n.filter,this.canvas.style.webkitFilter=n.filter),this.mask=this.find("xgmask"),n.addMask&&(this.mask.style.background=n.maskBg),this.canvasCtx=this.canvas.getContext("2d")}catch(a){A.logError("plugin:DynamicBg",a)}}},{key:"reRender",value:function(e){var i=this.config.disable;if(!(!i&&!this.root)){this.stop();var n=this.root?this.root.parentElement:null;if(n!==e&&n.removeChild(this.root),!e){this.root=null;return}this.init(e),this.renderOnce();var r=this.config.startInterval;this._checkIfCanStart()&&this.start(0,r)}}},{key:"checkVideoIsSupport",value:function(e){if(!e)return null;var i=e&&e instanceof window.HTMLVideoElement?e:e.canvas?e.canvas:e.flyVideo?e.flyVideo:null;if(i&&!(P.browser==="safari"&&f.isMSE(i)))return i;var n=i?i.tagName.toLowerCase():"";return n==="canvas"||n==="img"?i:null}},{key:"renderByPoster",value:function(){var e=this.playerConfig.poster;if(e){var i=f.typeOf(e)==="String"?e:f.typeOf(e.poster)==="String"?e.poster:null;this.updateImg(i)}}},{key:"_checkIfCanStart",value:function(){var e=this.config.mode;return this._isLoaded&&!this.player.paused&&e!==ae.FIRST_FRAME&&e!==ae.POSTER}},{key:"renderOnce",value:function(){var e=this.player.video;if(!(!e.videoWidth||!e.videoHeight)){this.videoPI=parseInt(e.videoWidth/e.videoHeight*100,10);var i=this.checkVideoIsSupport(e);i&&this.update(i,this.videoPI)}}},{key:"updateImg",value:function(e){var i=this;if(e){var n=this.canvas.getBoundingClientRect(),r=n.width,a=n.height,o=new window.Image;o.onload=function(){if(!(!i.canvas||i.frameId||i.isStart)){i.canvas.height=a,i.canvas.width=r;var l=parseInt(r/a*100,10);i.update(o,l),o=null}},o.src=e}}},{key:"update",value:function(e,i){if(!(!this.canvas||!this.canvasCtx||!i))try{var n=this._pos,r=this.config,a=this.canvas.getBoundingClientRect(),o=a.width,l=a.height;if(o!==n.width||l!==n.height||n.pi!==i){var c=parseInt(o/l*100,10);n.pi=i,n.width!==o&&(n.width=this.canvas.width=o),n.height!==l&&(n.height=this.canvas.height=l);var d=l,g=o;c<i?g=parseInt(l*i/100,10):c>i&&(d=parseInt(o*100/i,10)),n.rwidth=g*r.multiple,n.rheight=d*r.multiple,n.x=(o-n.rwidth)/2,n.y=(l-n.rheight)/2}this.canvasFilter&&(this.canvasCtx.filter=r.filter),this.canvasCtx.drawImage(e,n.x,n.y,n.rwidth,n.rheight)}catch(p){A.logError("plugin:DynamicBg",p)}}},{key:"destroy",value:function(){this.stop(),document.removeEventListener("visibilitychange",this.onVisibilitychange),this.canvasCtx=null,this.canvas=null}},{key:"render",value:function(){return""}}],[{key:"pluginName",get:function(){return"dynamicBg"}},{key:"defaultConfig",get:function(){return{isInnerRender:!1,disable:!0,index:-1,mode:"framerate",frameRate:10,filter:"blur(50px)",startFrameCount:2,startInterval:0,addMask:!0,multiple:1.2,maskBg:"rgba(0,0,0,0.7)"}}},{key:"isSupport",get:function(){return typeof Ce=="boolean"||(Ce=bn()),Ce}},{key:"supportCanvasFilter",value:function(){return!(P.browser==="safari"||P.browser==="firefox")}}]),s}(F),ge="info",Fe=_i,Pn=function(h){L(s,h);var u=R(s);function s(){var t;w(this,s);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=u.call.apply(u,[this].concat(i)),T(y(t),"_recordUserActions",function(r){var a=t._getTime(),o=Object.assign({},r,{msg:r.msg||r.action});t._stats[ge].push(j(j({type:"userAction"},a),{},{payload:o}))}),T(y(t),"_onReset",function(){t.reset()}),T(y(t),"_recordInfo",function(r){t.info(r)}),T(y(t),"_downloadStats",function(){var r=t.getStats(),a=new Blob([JSON.stringify(r)],{type:"application/json"}),o=window.URL.createObjectURL(a),l=document.createElement("a");l.style.display="none",l.href=o,l.download="player.txt",l.disabled=!1,l.click()}),t}return b(s,[{key:"_getTime",value:function(){return{timestamp:Date.now(),timeFormat:new Date().toISOString()}}},{key:"afterCreate",value:function(){this.reset(),this.on(Be,this._recordUserActions),this.on(Fe.STATS_INFO,this._recordInfo),this.on(Fe.STATS_DOWNLOAD,this._downloadStats),this.on(Fe.STATS_RESET,this._onReset)}},{key:"destroy",value:function(){this.offAll()}},{key:"downloadStats",value:function(){this._downloadStats()}},{key:"info",value:function(e){e.profile?this._infoProfile(e):this._info(e)}},{key:"_info",value:function(e){var i=this._getTime();this._stats[ge].push(j(j({},i),{},{payload:e}))}},{key:"_infoProfile",value:function(e){if(e&&e.startMs){var i=Date.now(),n=i-e.startMs,r=j({cat:"function",dur:n,name:e.name||e.msg,ph:"X",pid:0,tid:0,ts:e.startMs,profile:!0},e);this._info(r)}else console.warn("infoProfile need object data, include startMs")}},{key:"reset",value:function(){var e;this._stats=(e={},T(e,ge,[]),T(e,"media",{}),e)}},{key:"getStats",value:function(){for(var e=this.player,i=e.media,n=[],r=0;r<i.buffered.length;r++)n.push({start:i.buffered.start(r),end:i.buffered.end(r)});var a={currentTime:i.currentTime,readyState:i.readyState,buffered:n,paused:i.paused,ended:i.ended};return this._stats.media=a,{raw:this._stats,timestat:this._getTimeStats(),profile:this._getProfile()}}},{key:"_getTimeStats",value:function(){var e=this._stats[ge],i=e.map(function(n){var r=n.payload.data,a="";try{r instanceof Error?a=r.msg:r!==void 0&&(a=JSON.stringify(r))}catch(o){console.log("err",o)}return"[".concat(n.timeFormat,"] : ").concat(n.payload.msg," ").concat(a," ")});return i}},{key:"_getProfile",value:function(){var e={traceEvents:[]},i=this._stats[ge];return i.forEach(function(n){n.payload.profile&&e.traceEvents.push(n.payload)}),e}}],[{key:"pluginName",get:function(){return"stats"}},{key:"defaultConfig",get:function(){return{}}}]),s}(me),Xt=function(h){L(s,h);var u=R(s);function s(){var t;w(this,s);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=u.call.apply(u,[this].concat(i)),T(y(t),"onGapJump",function(){var r=y(t),a=r.player,o=r.config;if(a.media.readyState!==HTMLMediaElement.HAVE_NOTHING){if(a.media.seeking){if(!t.seekingEventReceived)return}else t.seekingEventReceived=!1;if(!(a.media.paused&&a.media.currentTime!==0&&t.hasPlayed)){var l=a.media.buffered,c=o.smallGapLimit||.5,d=o.gapDetectionThreshold||.3,g=a.media.currentTime,p=t._getIndex(l,g,d);if(!(p===null||p===0)){console.log("GapJump  bufferRange ",l.start(p),l.end(p));var v=l.start(p)+.1,m=a.media.duration;if(!(v>m)){var k=v-g,C=k<=c;k<s.BROWSER_GAP_TOLERANCE||C&&(o.useGapJump!==!1&&(a.media.currentTime=t.isSafari?v+.1:v),t.player&&t.player.emit("detectGap"),console.log("gapJump gapIndex",p," isGapSamll:",C," currentTime:",a.media.currentTime," jumpSize:",g-a.media.currentTime),v!==.08&&a&&a.emit("log",{type:"oneevent",end_type:"gap",vid:a.config.vid,ext:{video_postion:Math.floor(v*1e3)}}))}}}}}),t}return b(s,[{key:"afterCreate",value:function(){var e=this,i=this.config.useGapJump;i!==!1&&(this.hasPlayed=!1,this.seekingEventReceived=!1,this.isSafari=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),this.on(be,this.onGapJump),this.on(X,function(){e.hasPlayed=!0}),this.on(we,function(){e.seekingEventReceived=!0}))}},{key:"_getIndex",value:function(e,i,n){if(!e||!e.length||e.length===1&&e.end(0)-e.start(0)<1e-6)return null;for(var r=this._getBuffered(e),a=null,o=0;o<r.length;o++){var l=r[o];if(l.start>i&&(o===0||r[o-1].end-i<=n)){a=o;break}}return a}},{key:"_getBuffered",value:function(e){if(!e)return[];for(var i=[],n=0;n<e.length;n++)i.push({start:e.start(n),end:e.end(n)});return i}}],[{key:"pluginName",get:function(){return"gapJump"}},{key:"defaultConfig",get:function(){return{useGapJump:!1,smallGapLimit:.5,gapDetectionThreshold:.3}}}]),s}(F);Xt.BROWSER_GAP_TOLERANCE=.001;var xn=function(h){L(s,h);var u=R(s);function s(){var t;w(this,s);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=u.call.apply(u,[this].concat(i)),T(y(t),"onWaiting",function(){var r=y(t),a=r.config;t.jumpCnt>a.jumpCntMax||t.timer||a.useWaitingTimeoutJump===!1||(t.timer=setTimeout(t.onJump,a.waitingTime*1e3))}),T(y(t),"onJump",function(){var r=y(t),a=r.player,o=r.config;if(clearTimeout(t.timer),t.timer=null,!(t.jumpCnt>o.jumpCntMax||o.useWaitingTimeoutJump===!1)&&!(a.media.paused&&a.media.currentTime!==0&&t.hasPlayed)){t.jumpSize=o.jumpSize*(t.jumpCnt+1),t.jumpCnt===o.jumpSize&&t.jumpSize<6&&(t.jumpSize=6);var l=a.currentTime+t.jumpSize,c=a.media.duration;l>c||(console.log("waitintTimeout, currentTime:",a.currentTime,", jumpTo:",l),t.jumpCnt++,a.currentTime=l)}}),t}return b(s,[{key:"afterCreate",value:function(){var e=this,i=this.config,n=i.useWaitingTimeoutJump,r=i.jumpSize;n!==!1&&(this.hasPlayed=!1,this.jumpCnt=0,this.timer=null,this.jumpSize=r,this.on(be,this.onWaiting),this.on([Bt,ue],function(){clearTimeout(e.timer),e.timer=null,e.jumpSize=e.config.jumpSize}),this.on(X,function(){e.hasPlayed=!0}))}}],[{key:"pluginName",get:function(){return"waitingTimeoutJump"}},{key:"defaultConfig",get:function(){return{useWaitingTimeoutJump:!1,waitingTime:15,jumpSize:2,jumpCntMax:4}}}]),s}(F),oe="cdn",ke=["cdn"],In=function(h){L(s,h);var u=R(s);function s(){var t;w(this,s);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=u.call.apply(u,[this].concat(i)),T(y(t),"getSpeed",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:oe;if(!t.speedListCache||!t.speedListCache[r]||t.speedListCache[r].length<=0)return 0;var a=0;return t.speedListCache[r].map(function(o){a+=o}),Math.floor(a/t.speedListCache[r].length)}),T(y(t),"startTimer",function(){f.isMSE(t.player.video)||(t.initSpeedList(),t.cnt=0,t.timer=setTimeout(t.testSpeed,t.config.testTimeStep))}),T(y(t),"initSpeedList",function(){t.speedListCache={},ke.forEach(function(r){t.speedListCache[r]=[]})}),T(y(t),"_onRealSpeedChange",function(r){r.speed&&t.appendList(r.speed,r.type||oe)}),T(y(t),"testSpeed",function(){if(clearTimeout(t.timer),t.timer=null,!(!t.player||!t.config.openSpeed)){var r=t.config,a=r.url,o=r.loadSize,l=r.testCnt,c=r.testTimeStep,d=a+(a.indexOf("?")<0?"?testst=":"&testst=")+Date.now();if(!(t.cnt>=l)){t.cnt++;try{var g=new Date().getTime(),p=null,v=new XMLHttpRequest;t.xhr=v,v.open("GET",d);var m={},k=Math.floor(Math.random()*10);m.Range="bytes="+k+"-"+(o+k),m&&Object.keys(m).forEach(function(C){v.setRequestHeader(C,m[C])}),v.onreadystatechange=function(){if(v.readyState===4){t.xhr=null,p=new Date().getTime();var C=v.getResponseHeader("Content-Length")/1024*8,S=Math.round(C*1e3/(p-g));t.appendList(S),t.timer=setTimeout(t.testSpeed,c)}},v.send()}catch(C){console.error(C)}}}}),T(y(t),"appendList",function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:oe;if(!(!t.speedListCache||!t.speedListCache[a])){var o=t.config.saveSpeedMax;t.speedListCache[a].length>=o&&t.speedListCache[a].shift(),t.speedListCache[a].push(r);var l=y(t),c=l.player;c&&(a===oe?c.realTimeSpeed=r:c[t.getSpeedName("realTime",a)]=r),t.updateSpeed(a)}}),T(y(t),"updateSpeed",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:oe,a=t.getSpeed(r),o=y(t),l=o.player;if(l)if(r===oe)(!l.avgSpeed||a!==l.avgSpeed)&&(l.avgSpeed=a,l.emit(lt,{speed:a,realTimeSpeed:l.realTimeSpeed}));else{var c=t.getSpeedName("avg",r);(!l[c]||a!==l[c])&&(l[c]=a,l.emit(lt,{speed:a,realTimeSpeed:l.realTimeSpeed}))}}),t}return b(s,[{key:"afterCreate",value:function(){var e=this.config,i=e.openSpeed,n=e.addSpeedTypeList;(n==null?void 0:n.length)>0&&ke.push.apply(ke,ie(n)),this.initSpeedList(),this.on("real_time_speed",this._onRealSpeedChange),this.timer=null,this.cnt=0,this.xhr=null,i&&this.on([ne,He],this.startTimer)}},{key:"getSpeedName",value:function(e,i){return e+"Speed"+i.toUpperCase()}},{key:"openSpeed",get:function(){return this.config.openSpeed},set:function(e){if(this.config.openSpeed=e,!e&&this.timer){clearTimeout(this.timer),this.timer=null;return}if(this.config.openSpeed){if(this.timer)return;this.timer=setTimeout(this.testSpeed,this.config.testTimeStep)}}},{key:"destroy",value:function(){var e=this;this.off("real_time_speed",this._onRealSpeedChange),this.off([ne,He],this.startTimer),ke.forEach(function(i){e.speedListCache&&e.speedListCache[i]&&(e.speedListCache[i]=[])}),this.speedListCache&&(this.speedListCache={}),clearTimeout(this.timer),this.timer=null,this.xhr&&this.xhr.readyState!==4&&(this.xhr.cancel&&this.xhr.cancel(),this.xhr=null)}}],[{key:"pluginName",get:function(){return"testspeed"}},{key:"defaultConfig",get:function(){return{openSpeed:!1,testCnt:3,loadSize:200*1024,testTimeStep:3e3,url:"",saveSpeedMax:5,addSpeedTypeList:[]}}}]),s}(F),Ln=function(h){L(s,h);var u=R(s);function s(){return w(this,s),u.apply(this,arguments)}return b(s,[{key:"afterCreate",value:function(){var e=this,i=this.player,n=this.config;if(this.timer=null,this._lastDecodedFrames=0,this._currentStuckCount=0,this._lastCheckPoint=null,this._payload=[],!n.disabled){var r=i.media.getVideoPlaybackQuality;r&&(this.on(X,function(){e._startTick()}),this.on(Ye,function(){e._stopTick()}),this.on(Pe,function(){e._stopTick()}),this.on(Ke,function(){e._stopTick()}))}}},{key:"_startTick",value:function(){var e=this;this._stopTick(),this._timer=setTimeout(function(){e._checkDecodeFPS(),e._startTick()},this.config.tick)}},{key:"_stopTick",value:function(){clearTimeout(this._timer),this._timer=null}},{key:"_checkStuck",value:function(e,i,n,r){var a=this.player.media,o=document.hidden,l=a.paused;if(typeof o=="boolean"&&!o&&!l){for(var c=a.currentTime,d=a.buffered,g=!1,p=[],v=0;v<d.length;v++){var m=d.start(v),k=d.end(v);if(p.push({start:m,end:k}),m<=c&&c<=k-1){g=!0;break}}a.readyState===4&&g&&(this._currentStuckCount>this.config.stuckCount?(this.emit(Ti,this._payload),this._reset()):e<=this.config.reportFrame?(this._currentStuckCount++,this._payload.push({bufs:p,currentTime:a.currentTime,curDecodedFrames:e,totalVideoFrames:i,droppedVideoFrames:n,checkInterval:r})):this._reset())}}},{key:"_reset",value:function(){this._payload=[],this._currentStuckCount=0}},{key:"_checkDecodeFPS",value:function(){if(this.player.media){var e=this.player.media.getVideoPlaybackQuality(),i=e.totalVideoFrames,n=e.droppedVideoFrames,r=performance.now();if(i&&this._lastCheckPoint){var a=i-this._lastDecodedFrames,o=r-this._lastCheckPoint;this._checkStuck(a,i,n,o)}this._lastDecodedFrames=i,this._lastCheckPoint=r}}},{key:"destroy",value:function(){this._stopTick()}}],[{key:"pluginName",get:function(){return"FpsDetect"}},{key:"defaultConfig",get:function(){return{disabled:!1,tick:1e3,stuckCount:3,reportFrame:0}}}]),s}(F);le.use(Ci);var Rn=b(function h(u,s){var t,e,i;w(this,h);var n=s&&s.isMobileSimulateMode==="mobile",r=s.isLive,a=r?[]:[hn,cn,Sn,Cn,Ni],o=[].concat(a,[xi,Ii,Li,dn,Ri,Ai,mn,yn,Di,Oi]),l=[nn,Si,Ei,bi,wi,Pi,_n,kn,on];this.plugins=[Pn,en].concat(ie(o),l,[Xt,xn]);var c=n?"mobile":P.device;switch(c){case"pc":(t=this.plugins).push.apply(t,[ct,Ie,ht,In,Ln]);break;case"mobile":(e=this.plugins).push.apply(e,[ki]);break;default:(i=this.plugins).push.apply(i,[ct,Ie,ht])}(P.os.isIpad||c==="pc")&&this.plugins.push(wn),P.os.isIpad&&this.plugins.push(Ie),this.ignores=[],this.i18n=[]}),Y=function(h){L(s,h);var u=R(s);function s(){return w(this,s),u.apply(this,arguments)}return b(s)}(xe);T(Y,"defaultPreset",Rn);T(Y,"Util",f);T(Y,"Sniffer",P);T(Y,"Errors",Ee);T(Y,"Events",Fi);T(Y,"Plugin",F);T(Y,"BasePlugin",me);T(Y,"I18N",le);T(Y,"STATE_CLASS",_);T(Y,"InstManager",Vt);const An=We({__name:"VPlayer",props:{options:{type:Object,default(){return{}}}},setup(h){const u=h;let s=null,t=Se();const e=()=>$(this,null,function*(){K("VPlayer setup..."),ft.registerComponent("fullscreenButton",Mi)}),i=n=>$(this,null,function*(){const r=a=>{n.debug&&K(a)};n=Bi(n),s=ft(t.value,n,()=>{n.disablePictureInPicture&&s.getChild("ControlBar").removeChild("PictureInPictureToggle"),s.getChild("ControlBar").addChild("fullscreenButton"),s.on("seeking",()=>{r(`VPlayer seeking. ${s.currentTime()}`)}),s.on("seeked",()=>{r(`VPlayer seeked. ${s.currentTime()}`)}),s.on("ended",()=>{r(`VPlayer ended. ${s.currentTime()}`)}),s.on("timeupdate",()=>{r(`VPlayer timeupdate. ${s.currentTime()}`)})})});return je(()=>$(this,null,function*(){K("Component <<VPlayer>> mounted."),yield e(),yield i(u.options).then()})),It(()=>$(this,null,function*(){K("Component <<VPlayer>> onBeforeUnmount."),Lt(s)||s.dispose()})),(n,r)=>(ze(),Ve("video",{ref_key:"playerRef",ref:t,class:"video-js vjs-16-9 app-video-player","webkit-playsinline":"",playsinline:"","x5-playsinline":"","x5-video-player-fullscreen":"true","x5-video-player-type":"h5","x5-video-orientation":"portrait",preload:"metadata"},null,512))}}),Dn=We({__name:"XPlayer",props:{options:{type:Object,default(){return{}}}},setup(h){const u=h;let s=null,t=Se();const e=()=>$(this,null,function*(){K("XPlayer setup...")}),i=n=>$(this,null,function*(){const r=a=>{n.debug&&K(a)};n=Jt({el:t.value,url:n.src},n),s=new Y(Hi(n)),s.on(we,()=>{r(`XPlayer seeking. ${s.currentTime}`)}),s.on(ce,()=>{r(`XPlayer seeked. ${s.currentTime}`)}),s.on(Pe,()=>{r(`XPlayer ended. ${s.currentTime}`)}),s.on(J,()=>{r(`XPlayer timeupdate. ${s.currentTime}`)})});return je(()=>$(this,null,function*(){K("Component <<XPlayer>> mounted."),yield e(),yield i(u.options).then()})),It(()=>$(this,null,function*(){K("Component <<XPlayer>> onBeforeUnmount."),Lt(s)||s.destroy()})),(n,r)=>(ze(),Ve("div",{class:"app-video-player",ref_key:"playerRef",ref:t},null,512))}}),Yn=We({__name:"player",setup(h){const u=Se({debug:!1,src:"https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/xgplayer_doc_video/mp4/xgplayer-demo-360p.mp4"}),s=Se({debug:!1,src:"https://sf1-cdn-tos.huoshanstatic.com/obj/media-fe/xgplayer_doc_video/mp4/xgplayer-demo-360p.mp4"});return je(()=>$(this,null,function*(){K("Page <<PlayerDemoPage>> mounted.")})),(t,e)=>{const i=Ui;return ze(),Ve(Qt,null,[Q(Z(Le)),Q(i,{border:!1,class:"app-bg-transparent !mx-4"},{default:et(()=>[Q(Z(An),{options:Z(u)},null,8,["options"])]),_:1}),Q(Z(Le)),Q(i,{border:!1,class:"app-bg-transparent !mx-4"},{default:et(()=>[Q(Z(Dn),{options:Z(s)},null,8,["options"])]),_:1}),Q(Z(Le))],64)}}});export{Yn as default};
