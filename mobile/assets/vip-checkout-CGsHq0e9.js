var U=(n,c,o)=>new Promise((r,y)=>{var T=u=>{try{C(o.next(u))}catch(g){y(g)}},_=u=>{try{C(o.throw(u))}catch(g){y(g)}},C=u=>u.done?r(u.value):Promise.resolve(u.value).then(T,_);C((o=o.apply(n,c)).next())});import{e as q,aG as le,b6 as re,aE as $,b7 as ue,aD as H,b8 as pe,d as z,b as t,aY as de,b9 as me,aw as ve,av as K,ba as _e,bb as fe,aU as be,y as J,m as he,r as x,bc as ge,al as ye,an as Ce,g as E,o as ke,l as Se,a as m,c as B,w as p,u as l,F as P,H as b,a9 as O,ae as F,ac as Y,ad as xe,ag as N,ai as S,b3 as Te,ah as we}from"./index-Cs_FMidO.js";/* empty css              *//* empty css              *//* empty css                                                                      *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{N as Ae}from"./index-BKwx2S7p.js";import{C as Be,a as Ie}from"./core.service-B4vr53h-.js";import{A as j}from"./Divider-DJl0EX64.js";import{_ as Pe}from"./Icon.vue_vue_type_script_setup_true_lang-BFh0rrDK.js";import{v as Le,p as Ne,T as $e,a as Oe}from"./mall-CQTUTS6L.js";import{S as Ve}from"./index-CtyOXCjU.js";import{S as De,a as Re}from"./index-GLpn4MZH.js";import{I as Ue}from"./index-s-XCXPwz.js";import{C as Ee}from"./index-lcW-tyaF.js";import{C as Fe}from"./index-BhQ2y305.js";import{_ as He}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-id-DKEk-Xni.js";import"./use-tab-status-kfh2rJV-.js";const[Ke,v]=q("action-sheet"),ze=le({},re,{title:String,round:$,actions:ue(),closeIcon:H("cross"),closeable:$,cancelText:String,description:String,closeOnPopstate:$,closeOnClickAction:Boolean,safeAreaInsetBottom:$}),Ge=[...pe,"round","closeOnPopstate","safeAreaInsetBottom"];var Me=z({name:Ke,props:ze,emits:["select","cancel","update:show"],setup(n,{slots:c,emit:o}){const r=e=>o("update:show",e),y=()=>{r(!1),o("cancel")},T=()=>{if(n.title)return t("div",{class:v("header")},[n.title,n.closeable&&t(K,{name:n.closeIcon,class:[v("close"),_e],onClick:y},null)])},_=()=>{if(c.cancel||n.cancelText)return[t("div",{class:v("gap")},null),t("button",{type:"button",class:v("cancel"),onClick:y},[c.cancel?c.cancel():n.cancelText])]},C=e=>{if(e.icon)return t(K,{class:v("item-icon"),name:e.icon},null)},u=(e,f)=>e.loading?t(fe,{class:v("loading-icon")},null):c.action?c.action({action:e,index:f}):[t("span",{class:v("name")},[e.name]),e.subname&&t("div",{class:v("subname")},[e.subname])],g=(e,f)=>{const{color:L,loading:d,callback:w,disabled:A,className:I}=e,V=()=>{A||d||(w&&w(e),n.closeOnClickAction&&r(!1),be(()=>o("select",e,f)))};return t("button",{type:"button",style:{color:L},class:[v("item",{loading:d,disabled:A}),I],onClick:V},[C(e),u(e,f)])},i=()=>{if(n.description||c.description){const e=c.description?c.description():n.description;return t("div",{class:v("description")},[e])}};return()=>t(ve,de({class:v(),position:"bottom","onUpdate:show":r},me(n,Ge)),{default:()=>{var e;return[T(),i(),t("div",{class:v("content")},[n.actions.map(g),(e=c.default)==null?void 0:e.call(c)]),_()]}})}});const Ye=J(Me),[je,h,qe]=q("submit-bar"),Je={tip:String,label:String,price:Number,tipIcon:String,loading:Boolean,currency:H("¥"),disabled:Boolean,textAlign:String,buttonText:String,buttonType:H("danger"),buttonColor:String,suffixLabel:String,placeholder:Boolean,decimalLength:he(2),safeAreaInsetBottom:$};var Qe=z({name:je,props:Je,emits:["submit"],setup(n,{emit:c,slots:o}){const r=x(),y=ge(r,h),T=()=>{const{price:i,label:e,currency:f,textAlign:L,suffixLabel:d,decimalLength:w}=n;if(typeof i=="number"){const A=(i/100).toFixed(+w).split("."),I=w?`.${A[1]}`:"";return t("div",{class:h("text"),style:{textAlign:L}},[t("span",null,[e||qe("label")]),t("span",{class:h("price")},[f,t("span",{class:h("price-integer")},[A[0]]),I]),d&&t("span",{class:h("suffix-label")},[d])])}},_=()=>{var i;const{tip:e,tipIcon:f}=n;if(o.tip||e)return t("div",{class:h("tip")},[f&&t(K,{class:h("tip-icon"),name:f},null),e&&t("span",{class:h("tip-text")},[e]),(i=o.tip)==null?void 0:i.call(o)])},C=()=>c("submit"),u=()=>o.button?o.button():t(ye,{round:!0,type:n.buttonType,text:n.buttonText,class:h("button",n.buttonType),color:n.buttonColor,loading:n.loading,disabled:n.disabled,onClick:C},null),g=()=>{var i,e;return t("div",{ref:r,class:[h(),{"van-safe-area-bottom":n.safeAreaInsetBottom}]},[(i=o.top)==null?void 0:i.call(o),_(),t("div",{class:h("bar")},[(e=o.default)==null?void 0:e.call(o),T(),u()])])};return()=>n.placeholder?y(g):g()}});const We=J(Qe),Xe={class:"mx-4"},Ze={class:"flex"},et={class:"flex-none p-4 text-center"},tt={class:"flex-1 py-4"},nt={class:"app-text-primary"},at={class:"vip-item-container"},ot=["onClick"],st=["onClick"],ct=z({__name:"vip-checkout",setup(n){const{user:c,isAuthenticated:o}=Ce(),r=x([]),y=E(()=>r.value.length&&r.value.length>0),T=x(),_=x(0),C=s=>{u.value.swipeTo(s),e.value=0},u=x(),g=s=>{_.value=s},i=E(()=>r.value.at(_.value)),e=x(0),f=(s=0)=>e.value===s?"vip-item vip-item-active":"vip-item",L=(s=0)=>{e.value=s},d=x(!1),w=()=>{d.value=!1},A=()=>{d.value=!1},I=x([]),V=E(()=>{var s,k;return((k=(s=i==null?void 0:i.value)==null?void 0:s.items)==null?void 0:k.at(e.value).price)*100}),Q=()=>{d.value=!0},W=(s="")=>{alert(s)};return ke(()=>U(this,null,function*(){Se("Page <<VipOrderCheckout>> mounted."),yield Be.initialize().then(()=>U(this,null,function*(){yield Le().then(s=>{r.value=s.data}),yield Ne().then(s=>{I.value=s.data})}))})),(s,k)=>{var G,M;const X=$e,Z=Oe,ee=Ae,te=Ve,ne=Ue,D=Ee,ae=Re,oe=De,se=We,ce=Fe,ie=Ye;return m(),B(P,null,[t(te,null,{default:p(()=>[t(ee,{border:!1,"left-arrow":"",onClickLeft:k[1]||(k[1]=a=>l(xe)())},{title:p(()=>[l(y)?(m(),N(Z,{key:0,ref_key:"vipTypeTabsRef",ref:T,active:l(_),"onUpdate:active":k[0]||(k[0]=a=>Y(_)?_.value=a:null),"line-width":20,onChange:C},{default:p(()=>[(m(!0),B(P,null,O(l(r),a=>(m(),N(X,{key:a.code},{title:p(()=>[b("div",Xe,S(a.title),1)]),_:2},1024))),128))]),_:1},8,["active"])):F("",!0)]),_:1})]),_:1}),t(l(j)),t(oe,{ref_key:"vipTypeSwipeRef",ref:u,"indicator-color":"white",onChange:g},{default:p(()=>[(m(!0),B(P,null,O(l(r),a=>(m(),N(ae,{key:a.code},{default:p(()=>[l(o)?(m(),N(D,{key:0,inset:""},{default:p(()=>[b("div",Ze,[b("div",et,[t(ne,{round:"",class:"!align-middle",width:"3.2rem",height:"3.2rem",src:l(Ie)},null,8,["src"])]),b("div",tt,[b("div",nt,S(l(c).username)+" - "+S(a.code),1)])])]),_:2},1024)):F("",!0)]),_:2},1024))),128))]),_:1},512),((M=(G=l(i))==null?void 0:G.items)==null?void 0:M.length)>0?(m(),B(P,{key:0},[t(l(j)),b("div",at,[(m(!0),B(P,null,O(l(i).items,(a,R)=>(m(),B("div",{key:a.code,class:Te(f(R)),onClick:it=>L(R)},[t(D,{border:!0,inset:"",class:"app-no-margin p-2"},{default:p(()=>[b("div",null,S(a.code),1),b("div",null,S(a.title),1),b("div",null,S(a.listPrice),1),b("div",null,S(a.price),1)]),_:2},1024)],10,ot))),128))])],64)):F("",!0),t(se,{price:l(V),"button-text":s.$t("common.button_renew"),onSubmit:Q},{tip:p(()=>[we(" 开通会员代表接受会员服务协议 ")]),_:1},8,["price","button-text"]),t(ie,{show:l(d),"onUpdate:show":k[2]||(k[2]=a=>Y(d)?d.value=a:null),"cancel-text":s.$t("common.button_cancel"),"close-on-click-action":"",closeable:"",title:"请选择支付方式",onCancel:w,onSelect:A},{default:p(()=>[t(D,{inset:"",class:"!my-4"},{default:p(()=>[(m(!0),B(P,null,O(l(I),a=>(m(),N(ce,{key:a.code,"is-link":""},{icon:p(()=>[t(l(Pe),{icon:a.icon},null,8,["icon"])]),title:p(()=>[b("div",{class:"app-text ml-4",onClick:R=>W(a.code)},S(a.title),9,st)]),_:2},1024))),128))]),_:1})]),_:1},8,["show","cancel-text"])],64)}}}),Pt=He(ct,[["__scopeId","data-v-4f962db9"]]);export{Pt as default};
