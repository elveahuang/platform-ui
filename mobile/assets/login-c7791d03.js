var N=(e,l,a)=>new Promise((d,r)=>{var n=i=>{try{u(a.next(i))}catch(v){r(v)}},s=i=>{try{u(a.throw(i))}catch(v){r(v)}},u=i=>i.done?d(i.value):Promise.resolve(i.value).then(n,s);u((a=a.apply(e,l)).next())});import{J as qe,e as J,d as A,K as ye,L as we,b as o,n as j,M as ae,q as Y,N as ke,x as Q,O as je,P as Ue,Q as Ke,R as Ge,S as Ye,T as F,m as le,U as He,V as Je,D as oe,r as $,W as Se,f as M,g as ge,X as Qe,Y as Xe,Z as G,o as Ve,i as Ze,_ as D,$ as ve,a0 as et,a1 as z,a2 as tt,a3 as nt,a4 as H,a5 as at,a6 as ot,a as X,y as Z,w as _,E as k,a7 as W,F as se,a8 as re,a9 as lt,aa as ie,ab as st,ac as rt,ad as it,ae as ut,G as ct,af as dt,ag as ft,ah as mt,l as gt,A as he,ai as te,B as vt,aj as ht}from"./index-f3936587.js";import{S as pt}from"./index-20deb666.js";/* empty css              *//* empty css              */import{C as _t}from"./index-20e0c5b1.js";/* empty css              */import{N as bt}from"./index-99ac67ed.js";/* empty css                                                                 *//* empty css              *//* empty css              */import{P as ue,u as yt,a as wt,b as kt}from"./useTheme-f529ece2.js";import{B as ee}from"./index-35659196.js";import{c as St,C as Vt}from"./index-bb7c5ee9.js";import"./use-placeholder-268dcae4.js";import"./use-route-34d35db1.js";let Ct=0;function xt(){const e=qe(),{name:l="unknown"}=(e==null?void 0:e.type)||{};return`${l}-${++Ct}`}const[It,Pt]=J("form"),$t={colon:Boolean,disabled:Boolean,readonly:Boolean,required:[Boolean,String],showError:Boolean,labelWidth:j,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:ae,showErrorMessage:ae,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var Et=A({name:It,props:$t,emits:["submit","failed"],setup(e,{emit:l,slots:a}){const{children:d,linkChildren:r}=ye(ke),n=c=>c?d.filter(h=>c.includes(h.name)):d,s=c=>new Promise((h,y)=>{const C=[];n(c).reduce((L,O)=>L.then(()=>{if(!C.length)return O.validate().then(q=>{q&&C.push(q)})}),Promise.resolve()).then(()=>{C.length?y(C):h()})}),u=c=>new Promise((h,y)=>{const C=n(c);Promise.all(C.map(S=>S.validate())).then(S=>{S=S.filter(Boolean),S.length?y(S):h()})}),i=c=>{const h=d.find(y=>y.name===c);return h?new Promise((y,C)=>{h.validate().then(S=>{S?C(S):y()})}):Promise.reject()},v=c=>typeof c=="string"?i(c):e.validateFirst?s(c):u(c),g=c=>{typeof c=="string"&&(c=[c]),n(c).forEach(y=>{y.resetValidation()})},p=()=>d.reduce((c,h)=>(c[h.name]=h.getValidationStatus(),c),{}),E=(c,h)=>{d.some(y=>y.name===c?(y.$el.scrollIntoView(h),!0):!1)},I=()=>d.reduce((c,h)=>(h.name!==void 0&&(c[h.name]=h.formValue.value),c),{}),R=()=>{const c=I();v().then(()=>l("submit",c)).catch(h=>{l("failed",{values:c,errors:h}),e.scrollToError&&h[0].name&&E(h[0].name)})},B=c=>{Y(c),R()};return r({props:e}),we({submit:R,validate:v,getValues:I,scrollToField:E,resetValidation:g,getValidationStatus:p}),()=>{var c;return o("form",{class:Pt(),onSubmit:B},[(c=a.default)==null?void 0:c.call(a)])}}});const Tt=Q(Et);function Ce(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function Mt(e,l){if(Ce(e)){if(l.required)return!1;if(l.validateEmpty===!1)return!0}return!(l.pattern&&!l.pattern.test(String(e)))}function Bt(e,l){return new Promise(a=>{const d=l.validator(e,l);if(Ge(d)){d.then(a);return}a(d)})}function pe(e,l){const{message:a}=l;return Ye(a)?a(e,l):a||""}function Lt({target:e}){e.composing=!0}function _e({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function At(e,l){const a=je();e.style.height="auto";let d=e.scrollHeight;if(Ke(l)){const{maxHeight:r,minHeight:n}=l;r!==void 0&&(d=Math.min(d,r)),n!==void 0&&(d=Math.max(d,n))}d&&(e.style.height=`${d}px`,Ue(a))}function Rt(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function T(e){return[...e].length}function ne(e,l){return[...e].slice(0,l).join("")}const[Nt,x]=J("field"),zt={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:j,formatter:Function,clearIcon:F("clear"),modelValue:le(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:F("focus"),formatTrigger:F("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},Dt=He({},St,zt,{rows:j,type:F("text"),rules:Array,autosize:[Boolean,Object],labelWidth:j,labelClass:Je,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Ft=A({name:Nt,props:Dt,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:l,slots:a}){const d=xt(),r=oe({status:"unvalidated",focused:!1,validateMessage:""}),n=$(),s=$(),u=$(),{parent:i}=Se(ke),v=()=>{var t;return String((t=e.modelValue)!=null?t:"")},g=t=>{if(D(e[t]))return e[t];if(i&&D(i.props[t]))return i.props[t]},p=M(()=>{const t=g("readonly");if(e.clearable&&!t){const f=v()!=="",m=e.clearTrigger==="always"||e.clearTrigger==="focus"&&r.focused;return f&&m}return!1}),E=M(()=>u.value&&a.input?u.value():e.modelValue),I=M(()=>{var t;const f=g("required");return f==="auto"?(t=e.rules)==null?void 0:t.some(m=>m.required):f}),R=t=>t.reduce((f,m)=>f.then(()=>{if(r.status==="failed")return;let{value:b}=E;if(m.formatter&&(b=m.formatter(b,m)),!Mt(b,m)){r.status="failed",r.validateMessage=pe(b,m);return}if(m.validator)return Ce(b)&&m.validateEmpty===!1?void 0:Bt(b,m).then(w=>{w&&typeof w=="string"?(r.status="failed",r.validateMessage=w):w===!1&&(r.status="failed",r.validateMessage=pe(b,m))})}),Promise.resolve()),B=()=>{r.status="unvalidated",r.validateMessage=""},c=()=>l("endValidate",{status:r.status,message:r.validateMessage}),h=(t=e.rules)=>new Promise(f=>{B(),t?(l("startValidate"),R(t).then(()=>{r.status==="failed"?(f({name:e.name,message:r.validateMessage}),c()):(r.status="passed",f(),c())})):f()}),y=t=>{if(i&&e.rules){const{validateTrigger:f}=i.props,m=ve(f).includes(t),b=e.rules.filter(w=>w.trigger?ve(w.trigger).includes(t):m);b.length&&h(b)}},C=t=>{var f;const{maxlength:m}=e;if(D(m)&&T(t)>+m){const b=v();if(b&&T(b)===+m)return b;const w=(f=n.value)==null?void 0:f.selectionEnd;if(r.focused&&w){const V=[...t],P=V.length-+m;return V.splice(w-P,P),V.join("")}return ne(t,+m)}return t},S=(t,f="onChange")=>{const m=t;t=C(t);const b=T(m)-T(t);if(e.type==="number"||e.type==="digit"){const V=e.type==="number";t=et(t,V,V)}let w=0;if(e.formatter&&f===e.formatTrigger){const{formatter:V,maxlength:P}=e;if(t=V(t),D(P)&&T(t)>+P&&(t=ne(t,+P)),n.value&&r.focused){const{selectionEnd:K}=n.value,me=ne(m,K);w=T(V(me))-T(me)}}if(n.value&&n.value.value!==t)if(r.focused){let{selectionStart:V,selectionEnd:P}=n.value;if(n.value.value=t,D(V)&&D(P)){const K=T(t);b?(V-=b,P-=b):w&&(V+=w,P+=w),n.value.setSelectionRange(Math.min(V,K),Math.min(P,K))}}else n.value.value=t;t!==e.modelValue&&l("update:modelValue",t)},L=t=>{t.target.composing||S(t.target.value)},O=()=>{var t;return(t=n.value)==null?void 0:t.blur()},q=()=>{var t;return(t=n.value)==null?void 0:t.focus()},U=()=>{const t=n.value;e.type==="textarea"&&e.autosize&&t&&At(t,e.autosize)},Pe=t=>{r.focused=!0,l("focus",t),G(U),g("readonly")&&O()},$e=t=>{r.focused=!1,S(v(),"onBlur"),l("blur",t),!g("readonly")&&(y("onBlur"),G(U),at())},ce=t=>l("clickInput",t),Ee=t=>l("clickLeftIcon",t),Te=t=>l("clickRightIcon",t),Me=t=>{Y(t),l("update:modelValue",""),l("clear",t)},de=M(()=>{if(typeof e.error=="boolean")return e.error;if(i&&i.props.showError&&r.status==="failed")return!0}),Be=M(()=>{const t=g("labelWidth"),f=g("labelAlign");if(t&&f!=="top")return{width:ge(t)}}),Le=t=>{t.keyCode===13&&(!(i&&i.props.submitOnEnter)&&e.type!=="textarea"&&Y(t),e.type==="search"&&O()),l("keypress",t)},fe=()=>e.id||`${d}-input`,Ae=()=>r.status,Re=()=>{const t=x("control",[g("inputAlign"),{error:de.value,custom:!!a.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(a.input)return o("div",{class:t,onClick:ce},[a.input()]);const f={id:fe(),ref:n,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:g("disabled"),readonly:g("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${d}-label`:void 0,onBlur:$e,onFocus:Pe,onInput:L,onClick:ce,onChange:_e,onKeypress:Le,onCompositionend:_e,onCompositionstart:Lt};return e.type==="textarea"?o("textarea",f,null):o("input",nt(Rt(e.type),f),null)},Ne=()=>{const t=a["left-icon"];if(e.leftIcon||t)return o("div",{class:x("left-icon"),onClick:Ee},[t?t():o(z,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},ze=()=>{const t=a["right-icon"];if(e.rightIcon||t)return o("div",{class:x("right-icon"),onClick:Te},[t?t():o(z,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},De=()=>{if(e.showWordLimit&&e.maxlength){const t=T(v());return o("div",{class:x("word-limit")},[o("span",{class:x("word-num")},[t]),H("/"),e.maxlength])}},Fe=()=>{if(i&&i.props.showErrorMessage===!1)return;const t=e.errorMessage||r.validateMessage;if(t){const f=a["error-message"],m=g("errorMessageAlign");return o("div",{class:x("error-message",m)},[f?f({message:t}):t])}},We=()=>{const t=g("labelWidth"),f=g("labelAlign"),m=g("colon")?":":"";if(a.label)return[a.label(),m];if(e.label)return o("label",{id:`${d}-label`,for:a.input?void 0:fe(),onClick:b=>{Y(b),q()},style:f==="top"&&t?{width:ge(t)}:void 0},[e.label+m])},Oe=()=>[o("div",{class:x("body")},[Re(),p.value&&o(z,{ref:s,name:e.clearIcon,class:x("clear")},null),ze(),a.button&&o("div",{class:x("button")},[a.button()])]),De(),Fe()];return we({blur:O,focus:q,validate:h,formValue:E,resetValidation:B,getValidationStatus:Ae}),Qe(tt,{customValue:u,resetValidation:B,validateWithTrigger:y}),Xe(()=>e.modelValue,()=>{S(v()),B(),y("onChange"),G(U)}),Ve(()=>{S(v(),e.formatTrigger),G(U)}),Ze("touchstart",Me,{target:M(()=>{var t;return(t=s.value)==null?void 0:t.$el})}),()=>{const t=g("disabled"),f=g("labelAlign"),m=Ne(),b=()=>{const w=We();return f==="top"?[m,w].filter(Boolean):w||[]};return o(Vt,{size:e.size,class:x({error:de.value,disabled:t,[`label-${f}`]:f}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:Be.value,valueClass:x("value"),titleClass:[x("label",[f,{required:I.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:m&&f!=="top"?()=>m:null,title:b,value:Oe,extra:a.extra})}}});const Wt=Q(Ft),[xe,Ot]=J("row"),Ie=Symbol(xe),qt={tag:F("div"),wrap:ae,align:String,gutter:le(0),justify:String};var jt=A({name:xe,props:qt,setup(e,{slots:l}){const{children:a,linkChildren:d}=ye(Ie),r=M(()=>{const s=[[]];let u=0;return a.forEach((i,v)=>{u+=Number(i.span),u>24?(s.push([v]),u-=24):s[s.length-1].push(v)}),s}),n=M(()=>{const s=Number(e.gutter),u=[];return s&&r.value.forEach(i=>{const v=s*(i.length-1)/i.length;i.forEach((g,p)=>{if(p===0)u.push({right:v});else{const E=s-u[g-1].right,I=v-E;u.push({left:E,right:I})}})}),u});return d({spaces:n}),()=>{const{tag:s,wrap:u,align:i,justify:v}=e;return o(s,{class:Ot({[`align-${i}`]:i,[`justify-${v}`]:v,nowrap:!u})},{default:()=>{var g;return[(g=l.default)==null?void 0:g.call(l)]}})}}});const[Ut,Kt]=J("col"),Gt={tag:F("div"),span:le(0),offset:j};var Yt=A({name:Ut,props:Gt,setup(e,{slots:l}){const{parent:a,index:d}=Se(Ie),r=M(()=>{if(!a)return;const{spaces:n}=a;if(n&&n.value&&n.value[d.value]){const{left:s,right:u}=n.value[d.value];return{paddingLeft:s?`${s}px`:null,paddingRight:u?`${u}px`:null}}});return()=>{const{tag:n,span:s,offset:u}=e;return o(n,{style:r.value,class:Kt({[s]:s,[`offset-${u}`]:u})},{default:()=>{var i;return[(i=l.default)==null?void 0:i.call(l)]}})}}});const Ht=Q(Yt),Jt=Q(jt),Qt=A({__name:"DarkModePicker",setup(e){const{setDarkMode:l}=yt(),a=$(!1),d=$(ot.map(n=>({text:n.title,value:n.mode}))),r=n=>N(this,null,function*(){if(a.value=!1,re(n.selectedValues)){const s=lt(n.selectedValues[0]);yield l(s).then()}});return(n,s)=>{const u=z,i=ee,v=ue,g=ie;return X(),Z(se,null,[o(i,{plain:"",hairline:"",type:"primary",size:"small",onClick:s[0]||(s[0]=p=>a.value=!0)},{icon:_(()=>[o(u,null,{default:_(()=>[o(k(W),{icon:"line-md:light-dark-loop"})]),_:1})]),_:1}),o(g,{show:a.value,"onUpdate:show":s[2]||(s[2]=p=>a.value=p),round:"",position:"bottom"},{default:_(()=>[o(v,{columns:d.value,onConfirm:r,onCancel:s[1]||(s[1]=p=>a.value=!1)},null,8,["columns"])]),_:1},8,["show"])],64)}}}),Xt=A({__name:"LocalePicker",setup(e){const{setLocale:l}=wt(),a=$(!1),d=$(st.map(n=>({text:n.title,value:n.locale}))),r=n=>N(this,null,function*(){a.value=!1,re(n.selectedValues)&&(yield l(rt(n.selectedValues[0])).then())});return(n,s)=>{const u=z,i=ee,v=ue,g=ie;return X(),Z(se,null,[o(i,{plain:"",hairline:"",type:"primary",size:"small",onClick:s[0]||(s[0]=p=>a.value=!0)},{icon:_(()=>[o(u,null,{default:_(()=>[o(k(W),{icon:"mdi:translate"})]),_:1})]),_:1}),o(g,{show:a.value,"onUpdate:show":s[2]||(s[2]=p=>a.value=p),round:"",position:"bottom"},{default:_(()=>[o(v,{columns:d.value,onConfirm:r,onCancel:s[1]||(s[1]=p=>a.value=!1)},null,8,["columns"])]),_:1},8,["show"])],64)}}}),Zt=A({__name:"ThemePicker",setup(e){const{setTheme:l}=kt(),a=$(!1),d=$(it.map(n=>({text:n.title,value:n.theme}))),r=n=>N(this,null,function*(){a.value=!1,re(n.selectedValues)&&(yield l(ut(n.selectedValues[0])).then())});return(n,s)=>{const u=z,i=ee,v=ue,g=ie;return X(),Z(se,null,[o(i,{plain:"",hairline:"",type:"primary",size:"small",onClick:s[0]||(s[0]=p=>a.value=!0)},{icon:_(()=>[o(u,null,{default:_(()=>[o(k(W),{icon:"ant-design:skin-outlined"})]),_:1})]),_:1}),o(g,{show:a.value,"onUpdate:show":s[2]||(s[2]=p=>a.value=p),round:"",position:"bottom"},{default:_(()=>[o(v,{columns:d.value,onConfirm:r,onCancel:s[1]||(s[1]=p=>a.value=!1)},null,8,["columns"])]),_:1},8,["show"])],64)}}});function be(e){return typeof e=="function"?e():k(e)}typeof WorkerGlobalScope!="undefined"&&globalThis instanceof WorkerGlobalScope;function en(e=!1,l={}){const{truthyValue:a=!0,falsyValue:d=!1}=l,r=ct(e),n=$(e);function s(u){if(arguments.length)return n.value=u,n.value;{const i=be(a);return n.value=n.value===i?be(d):i,n.value}}return r?s:[n,s]}const tn={class:"mt-6"},nn={class:"m-4"},yn=A({__name:"login",setup(e){const{t:l}=dt(),a=ft(),d=mt(),[r,n]=en(!1),s=$(),u=oe(ht),i=oe({username:[{required:!0,message:"Please input username"}],password:[{required:!0,message:"Please input password"}]}),v=()=>N(this,null,function*(){yield s.value.validate(),a.login(u).then(()=>N(this,null,function*(){yield a.getUserInfo().then(),d.push("/").then()}))});return Ve(()=>N(this,null,function*(){gt("Page <<Login>> mounted.")})),(g,p)=>{const E=bt,I=z,R=Wt,B=_t,c=ee,h=pt,y=Ht,C=Jt,S=Tt;return X(),Z("div",null,[o(E,{title:k(l)("common.title")},null,8,["title"]),he("div",tn,[o(S,{ref_key:"form",ref:s},{default:_(()=>[o(B,{inset:""},{default:_(()=>[o(R,{modelValue:u.username,"onUpdate:modelValue":p[0]||(p[0]=L=>u.username=L),placeholder:k(l)("common.user_field_username"),rules:i.username},{default:_(()=>[te(g.$slots,"left-icon",{},()=>[o(I,null,{default:_(()=>[o(k(W),{icon:"ion:person-outline"})]),_:1})])]),_:3},8,["modelValue","placeholder","rules"]),o(R,{modelValue:u.password,"onUpdate:modelValue":p[2]||(p[2]=L=>u.password=L),placeholder:k(l)("common.user_field_password"),rules:i.password,type:k(r)?"password":"text"},{default:_(()=>[te(g.$slots,"left-icon",{},()=>[o(I,null,{default:_(()=>[o(k(W),{icon:"ion:lock-closed-outline"})]),_:1})]),te(g.$slots,"right-icon",{},()=>[o(I,{name:k(r)?"closed-eye":"eye",onClick:p[1]||(p[1]=L=>k(n)(!k(r)))},null,8,["name"]),o(I,null,{default:_(()=>[o(k(W),{icon:"ion:lock-closed-outline"})]),_:1})])]),_:3},8,["modelValue","placeholder","rules","type"])]),_:3}),he("div",nn,[o(c,{onClick:v,type:"primary",block:""},{default:_(()=>[H(vt(k(l)("common.button_login")),1)]),_:1})]),o(C,{class:"px-4 pt-4"},{default:_(()=>[o(y,{span:"12",class:"text-left"},{default:_(()=>[o(h,null,{default:_(()=>[o(k(Xt)),o(k(Qt)),o(k(Zt))]),_:1})]),_:1}),o(y,{span:"12",class:"text-right"},{default:_(()=>[o(c,{size:"small"},{default:_(()=>[H("忘记密码")]),_:1}),o(c,{size:"small"},{default:_(()=>[H("注册")]),_:1})]),_:1})]),_:1})]),_:3},512)])])}}});export{yn as default};
