const __vite__fileDeps=["assets/web-CHnK4NlO.js","assets/index-DXhqT14h.js","assets/index-aWFJIpRI.css","assets/web-Cl_TTwm2.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var s=(o,e,r)=>new Promise((t,a)=>{var n=u=>{try{c(r.next(u))}catch(d){a(d)}},l=u=>{try{c(r.throw(u))}catch(d){a(d)}},c=u=>u.done?t(u.value):Promise.resolve(u.value).then(n,l);c((r=r.apply(o,e)).next())});import{bA as re,l as i,aG as ie,aI as f,aE as F,bB as C,bC as be,bD as q}from"./index-DXhqT14h.js";const He="/ui/mobile/assets/avatar-Bg7uMTF0.png";/*! Capacitor: https://capacitorjs.com/ - MIT License */const Pe=o=>{const e=new Map;e.set("web",{name:"web"});const r=o.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},t=(n,l)=>{r.platforms.set(n,l)},a=n=>{r.platforms.has(n)&&(r.currentPlatform=r.platforms.get(n))};return r.addPlatform=t,r.setPlatform=a,r},Se=o=>o.CapacitorPlatforms=Pe(o),ne=Se(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});ne.addPlatform;ne.setPlatform;var U;(function(o){o.Unimplemented="UNIMPLEMENTED",o.Unavailable="UNAVAILABLE"})(U||(U={}));class T extends Error{constructor(e,r,t){super(e),this.message=e,this.code=r,this.data=t}}const ye=o=>{var e,r;return o!=null&&o.androidBridge?"android":!((r=(e=o==null?void 0:o.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},Ce=o=>{var e,r,t,a,n;const l=o.CapacitorCustomPlatform||null,c=o.Capacitor||{},u=c.Plugins=c.Plugins||{},d=o.CapacitorPlatforms,L=()=>l!==null?l.name:ye(o),W=((e=d==null?void 0:d.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||L,M=()=>W()!=="web",ce=((r=d==null?void 0:d.currentPlatform)===null||r===void 0?void 0:r.isNativePlatform)||M,le=m=>{const h=Q.get(m);return!!(h!=null&&h.platforms.has(W())||G(m))},de=((t=d==null?void 0:d.currentPlatform)===null||t===void 0?void 0:t.isPluginAvailable)||le,ue=m=>{var h;return(h=c.PluginHeaders)===null||h===void 0?void 0:h.find(x=>x.name===m)},G=((a=d==null?void 0:d.currentPlatform)===null||a===void 0?void 0:a.getPluginHeader)||ue,me=m=>o.console.error(m),he=(m,h,x)=>Promise.reject(`${x} does not have an implementation of "${h}".`),Q=new Map,fe=(m,h={})=>{const x=Q.get(m);if(x)return console.warn(`Capacitor plugin "${m}" already registered. Cannot register plugins twice.`),x.proxy;const k=W(),E=G(m);let P;const pe=()=>s(void 0,null,function*(){return!P&&k in h?P=typeof h[k]=="function"?P=yield h[k]():P=h[k]:l!==null&&!P&&"web"in h&&(P=typeof h.web=="function"?P=yield h.web():P=h.web),P}),ve=(g,p)=>{var b,S;if(E){const y=E==null?void 0:E.methods.find(w=>p===w.name);if(y)return y.rtype==="promise"?w=>c.nativePromise(m,p.toString(),w):(w,D)=>c.nativeCallback(m,p.toString(),w,D);if(g)return(b=g[p])===null||b===void 0?void 0:b.bind(g)}else{if(g)return(S=g[p])===null||S===void 0?void 0:S.bind(g);throw new T(`"${m}" plugin is not implemented on ${k}`,U.Unimplemented)}},B=g=>{let p;const b=(...S)=>{const y=pe().then(w=>{const D=ve(w,g);if(D){const O=D(...S);return p=O==null?void 0:O.remove,O}else throw new T(`"${m}.${g}()" is not implemented on ${k}`,U.Unimplemented)});return g==="addListener"&&(y.remove=()=>s(void 0,null,function*(){return p()})),y};return b.toString=()=>`${g.toString()}() { [capacitor code] }`,Object.defineProperty(b,"name",{value:g,writable:!1,configurable:!1}),b},K=B("addListener"),V=B("removeListener"),we=(g,p)=>{const b=K({eventName:g},p),S=()=>s(void 0,null,function*(){const w=yield b;V({eventName:g,callbackId:w},p)}),y=new Promise(w=>b.then(()=>w({remove:S})));return y.remove=()=>s(void 0,null,function*(){console.warn("Using addListener() without 'await' is deprecated."),yield S()}),y},z=new Proxy({},{get(g,p){switch(p){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return E?we:K;case"removeListener":return V;default:return B(p)}}});return u[m]=z,Q.set(m,{name:m,proxy:z,platforms:new Set([...Object.keys(h),...E?[k]:[]])}),z},ge=((n=d==null?void 0:d.currentPlatform)===null||n===void 0?void 0:n.registerPlugin)||fe;return c.convertFileSrc||(c.convertFileSrc=m=>m),c.getPlatform=W,c.handleError=me,c.isNativePlatform=ce,c.isPluginAvailable=de,c.pluginMethodNoop=he,c.registerPlugin=ge,c.Exception=T,c.DEBUG=!!c.DEBUG,c.isLoggingEnabled=!!c.isLoggingEnabled,c.platform=c.getPlatform(),c.isNative=c.isNativePlatform(),c},ke=o=>o.Capacitor=Ce(o),v=ke(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{}),_=v.registerPlugin;v.Plugins;class N{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,r){let t=!1;this.listeners[e]||(this.listeners[e]=[],t=!0),this.listeners[e].push(r);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n),t&&this.sendRetainedArgumentsForEvent(e);const l=()=>s(this,null,function*(){return this.removeListener(e,r)});return Promise.resolve({remove:l})}removeAllListeners(){return s(this,null,function*(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}})}notifyListeners(e,r,t){const a=this.listeners[e];if(!a){if(t){let n=this.retainedEventArguments[e];n||(n=[]),n.push(r),this.retainedEventArguments[e]=n}return}a.forEach(n=>n(r))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,r){this.windowListeners[r]={registered:!1,windowEventName:e,pluginEventName:r,handler:t=>{this.notifyListeners(r,t)}}}unimplemented(e="not implemented"){return new v.Exception(e,U.Unimplemented)}unavailable(e="not available"){return new v.Exception(e,U.Unavailable)}removeListener(e,r){return s(this,null,function*(){const t=this.listeners[e];if(!t)return;const a=t.indexOf(r);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])})}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const r=this.retainedEventArguments[e];r&&(delete this.retainedEventArguments[e],r.forEach(t=>{this.notifyListeners(e,t)}))}}const J=o=>encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),X=o=>o.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Le extends N{getCookies(){return s(this,null,function*(){const e=document.cookie,r={};return e.split(";").forEach(t=>{if(t.length<=0)return;let[a,n]=t.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=X(a).trim(),n=X(n).trim(),r[a]=n}),r})}setCookie(e){return s(this,null,function*(){try{const r=J(e.key),t=J(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,n=(e.path||"/").replace("path=",""),l=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${r}=${t||""}${a}; path=${n}; ${l};`}catch(r){return Promise.reject(r)}})}deleteCookie(e){return s(this,null,function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}})}clearCookies(){return s(this,null,function*(){try{const e=document.cookie.split(";")||[];for(const r of e)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})}clearAllCookies(){return s(this,null,function*(){try{yield this.clearCookies()}catch(e){return Promise.reject(e)}})}}_("CapacitorCookies",{web:()=>new Le});const We=o=>s(void 0,null,function*(){return new Promise((e,r)=>{const t=new FileReader;t.onload=()=>{const a=t.result;e(a.indexOf(",")>=0?a.split(",")[1]:a)},t.onerror=a=>r(a),t.readAsDataURL(o)})}),xe=(o={})=>{const e=Object.keys(o);return Object.keys(o).map(a=>a.toLocaleLowerCase()).reduce((a,n,l)=>(a[n]=o[e[l]],a),{})},Ee=(o,e=!0)=>o?Object.entries(o).reduce((t,a)=>{const[n,l]=a;let c,u;return Array.isArray(l)?(u="",l.forEach(d=>{c=e?encodeURIComponent(d):d,u+=`${n}=${c}&`}),u.slice(0,-1)):(c=e?encodeURIComponent(l):l,u=`${n}=${c}`),`${t}&${u}`},"").substr(1):null,Re=(o,e={})=>{const r=Object.assign({method:o.method||"GET",headers:o.headers},e),a=xe(o.headers)["content-type"]||"";if(typeof o.data=="string")r.body=o.data;else if(a.includes("application/x-www-form-urlencoded")){const n=new URLSearchParams;for(const[l,c]of Object.entries(o.data||{}))n.set(l,c);r.body=n.toString()}else if(a.includes("multipart/form-data")||o.data instanceof FormData){const n=new FormData;if(o.data instanceof FormData)o.data.forEach((c,u)=>{n.append(u,c)});else for(const c of Object.keys(o.data))n.append(c,o.data[c]);r.body=n;const l=new Headers(r.headers);l.delete("content-type"),r.headers=l}else(a.includes("application/json")||typeof o.data=="object")&&(r.body=JSON.stringify(o.data));return r};class Te extends N{request(e){return s(this,null,function*(){const r=Re(e,e.webFetchExtra),t=Ee(e.params,e.shouldEncodeUrlParams),a=t?`${e.url}?${t}`:e.url,n=yield fetch(a,r),l=n.headers.get("content-type")||"";let{responseType:c="text"}=n.ok?e:{};l.includes("application/json")&&(c="json");let u,d;switch(c){case"arraybuffer":case"blob":d=yield n.blob(),u=yield We(d);break;case"json":u=yield n.json();break;case"document":case"text":default:u=yield n.text()}const L={};return n.headers.forEach((W,M)=>{L[M]=W}),{data:u,headers:L,status:n.status,url:n.url}})}get(e){return s(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))})}post(e){return s(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))})}put(e){return s(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))})}patch(e){return s(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})}delete(e){return s(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})}}_("CapacitorHttp",{web:()=>new Te});const $=_("Browser",{web:()=>re(()=>import("./web-CHnK4NlO.js"),__vite__mapDeps([0,1,2])).then(o=>new o.BrowserWeb)});class Ue{available(){return s(this,null,function*(){return!0})}open(e,r,t){return s(this,null,function*(){if(v.isNativePlatform())yield $.open({url:e}),yield $.addListener("browserFinished",r),yield $.addListener("browserPageLoaded",t);else return new Promise(a=>{window.open(e,"_self"),a()})})}close(){return s(this,null,function*(){yield $.removeAllListeners()})}}const oe=new Ue;class Ie{available(){return s(this,null,function*(){return!0})}isDingTalk(){return window.navigator.userAgent.toLowerCase().indexOf("lark")!==-1}getSignature(e){return s(this,null,function*(){i(e),i("DingTalkService getSignature...")})}config(){return s(this,null,function*(){return i("DingTalkService config..."),new Promise((e,r)=>{this.getSignature("url").then(t=>{t.data?(i("DingTalkService config..."),dd.config({agentId:t.data.agentId,corpId:t.data.corpId,timeStamp:t.data.timestamp,nonceStr:t.data.nonceStr,signature:t.data.signature,jsApiList:["runtime.info","biz.contact.choose","device.notification.confirm","device.notification.alert","device.notification.prompt","biz.ding.post","biz.util.openLink","biz.navigation.close","biz.util.share","biz.util.chooseImage","biz.util.scan"],onSuccess:a=>{i("DingTalkService config onSuccess."),i(a),e()},onFail:a=>{i("DingTalkService config onFail."),i(a),r()}}),dd.error(a=>{i("DingTalkService config error."),i(a)}),dd.ready(()=>{i("DingTalkService config ready.")})):r()})})})}getPhoto(){return s(this,null,function*(){return i("DingTalkService getPhoto..."),this.takePhotos("camera",1)})}choosePhotos(e=1){return s(this,null,function*(){return i("DingTalkService choosePhotos..."),this.takePhotos("album",e)})}takePhotos(e="",r=1){return s(this,null,function*(){return i("DingTalkService takePhotos..."),new Promise((t,a)=>{dd?(i("DingTalkService dd available."),dd.ready(()=>{dd.chooseImage({sourceType:[e],count:r,position:["back"],onSuccess:n=>{i("DingTalkService takePhotos success."),console.log(n.tempFilePaths,n.tempFiles),t()},onFail:n=>{i("DingTalkService takePhotos fail."),i(n),a()}})})):(i("DingTalkService dd not available."),a())})})}scanQRCode(){return i("DingTalkService scanQRCode..."),new Promise((e,r)=>{dd?(i("DingTalkService dd available."),dd.ready(()=>{i("DingTalkService dd ready."),dd.biz.util.scan({type:"all",onSuccess:t=>{i("DingTalkService scanQRCode onSuccess."),i(t),e(t.text)},onFail:t=>{i("DingTalkService scanQRCode onFail."),i(t),r()}})})):(i("DingTalkService dd not available."),r())})}}const Y=new Ie;class Ae{available(){return s(this,null,function*(){return!0})}isLark(){return window.navigator.userAgent.toLowerCase().indexOf("lark")!==-1}getSignature(e){return s(this,null,function*(){i(e),i("LarkService getSignature...")})}config(){return s(this,null,function*(){return this.isLark()?(i("LarkService getSignature..."),new Promise((e,r)=>{this.getSignature("url").then(t=>{t.data?(i("LarkService config..."),h5sdk.config({appId:t.data.appId,timestamp:+t.data.timestamp,nonceStr:t.data.nonceStr,signature:t.data.signature,jsApiList:["biz.navigation.close","biz.util.share"],onSuccess:a=>{i("LarkService config onSuccess."),i(a),e()},onFail:a=>{i("LarkService config onFail."),i(a),r()}}),h5sdk.error(a=>{i("LarkService config error."),i(a)}),h5sdk.ready(()=>{i("LarkService config ready.")})):r()})})):Promise.resolve()})}getPhoto(){return s(this,null,function*(){return i("LarkService getPhoto..."),this.takePhotos("camera",1)})}choosePhotos(e=1){return s(this,null,function*(){return i("LarkService choosePhotos..."),this.takePhotos("album",e)})}takePhotos(e="",r=1){return s(this,null,function*(){return i("LarkService takePhotos..."),new Promise((t,a)=>{h5sdk?(i("LarkService h5sdk available."),h5sdk.ready(()=>{tt.chooseImage({sourceType:[e],count:r,sizeType:["original","compressed"],success:n=>{i("LarkService takePhotos success."),i(n),t(n.tempFilePaths)},fail:n=>{i("LarkService takePhotos success."),i(n),a()}})})):(i("LarkService h5sdk not available."),a())})})}scanQRCode(){return i("LarkService scanQRCode..."),new Promise((e,r)=>{h5sdk?(i("LarkService h5sdk available."),h5sdk.ready(()=>{i("LarkService h5sdk ready."),tt.scanCode({scanType:["barCode","qrCode"],barCodeInput:!0,success:t=>{i("LarkService scanQRCode success."),i(t),e(t.result)},fail:t=>{i("LarkService scanQRCode fail."),i(t),r()}})})):(i("LarkService h5sdk not available."),r())})}}const Z=new Ae,H=_("BarcodeScanner",{web:()=>re(()=>import("./web-Cl_TTwm2.js"),__vite__mapDeps([3,1,2])).then(o=>new o.BarcodeScannerWeb)});var R;(function(o){o.Prompt="PROMPT",o.Camera="CAMERA",o.Photos="PHOTOS"})(R||(R={}));var I;(function(o){o.Rear="REAR",o.Front="FRONT"})(I||(I={}));var j;(function(o){o.Uri="uri",o.Base64="base64",o.DataUrl="dataUrl"})(j||(j={}));class se extends N{getPhoto(e){return s(this,null,function*(){return new Promise((r,t)=>s(this,null,function*(){if(e.webUseInput||e.source===R.Photos)this.fileInputExperience(e,r,t);else if(e.source===R.Prompt){let a=document.querySelector("pwa-action-sheet");a||(a=document.createElement("pwa-action-sheet"),document.body.appendChild(a)),a.header=e.promptLabelHeader||"Photo",a.cancelable=!1,a.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],a.addEventListener("onSelection",n=>s(this,null,function*(){n.detail===0?this.fileInputExperience(e,r,t):this.cameraExperience(e,r,t)}))}else this.cameraExperience(e,r,t)}))})}pickImages(e){return s(this,null,function*(){return new Promise((r,t)=>s(this,null,function*(){this.multipleFileInputExperience(r,t)}))})}cameraExperience(e,r,t){return s(this,null,function*(){if(customElements.get("pwa-camera-modal")){const a=document.createElement("pwa-camera-modal");a.facingMode=e.direction===I.Front?"user":"environment",document.body.appendChild(a);try{yield a.componentOnReady(),a.addEventListener("onPhoto",n=>s(this,null,function*(){const l=n.detail;l===null?t(new T("User cancelled photos app")):l instanceof Error?t(l):r(yield this._getCameraPhoto(l,e)),a.dismiss(),document.body.removeChild(a)})),a.present()}catch(n){this.fileInputExperience(e,r,t)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(e,r,t)})}fileInputExperience(e,r,t){let a=document.querySelector("#_capacitor-camera-input");const n=()=>{var l;(l=a.parentNode)===null||l===void 0||l.removeChild(a)};a||(a=document.createElement("input"),a.id="_capacitor-camera-input",a.type="file",a.hidden=!0,document.body.appendChild(a),a.addEventListener("change",l=>{const c=a.files[0];let u="jpeg";if(c.type==="image/png"?u="png":c.type==="image/gif"&&(u="gif"),e.resultType==="dataUrl"||e.resultType==="base64"){const d=new FileReader;d.addEventListener("load",()=>{if(e.resultType==="dataUrl")r({dataUrl:d.result,format:u});else if(e.resultType==="base64"){const L=d.result.split(",")[1];r({base64String:L,format:u})}n()}),d.readAsDataURL(c)}else r({webPath:URL.createObjectURL(c),format:u}),n()}),a.addEventListener("cancel",l=>{t(new T("User cancelled photos app")),n()})),a.accept="image/*",a.capture=!0,e.source===R.Photos||e.source===R.Prompt?a.removeAttribute("capture"):e.direction===I.Front?a.capture="user":e.direction===I.Rear&&(a.capture="environment"),a.click()}multipleFileInputExperience(e,r){let t=document.querySelector("#_capacitor-camera-input-multiple");const a=()=>{var n;(n=t.parentNode)===null||n===void 0||n.removeChild(t)};t||(t=document.createElement("input"),t.id="_capacitor-camera-input-multiple",t.type="file",t.hidden=!0,t.multiple=!0,document.body.appendChild(t),t.addEventListener("change",n=>{const l=[];for(let c=0;c<t.files.length;c++){const u=t.files[c];let d="jpeg";u.type==="image/png"?d="png":u.type==="image/gif"&&(d="gif"),l.push({webPath:URL.createObjectURL(u),format:d})}e({photos:l}),a()}),t.addEventListener("cancel",n=>{r(new T("User cancelled photos app")),a()})),t.accept="image/*",t.click()}_getCameraPhoto(e,r){return new Promise((t,a)=>{const n=new FileReader,l=e.type.split("/")[1];r.resultType==="uri"?t({webPath:URL.createObjectURL(e),format:l,saved:!1}):(n.readAsDataURL(e),n.onloadend=()=>{const c=n.result;r.resultType==="dataUrl"?t({dataUrl:c,format:l,saved:!1}):t({base64String:c.split(",")[1],format:l,saved:!1})},n.onerror=c=>{a(c)})})}checkPermissions(){return s(this,null,function*(){if(typeof navigator=="undefined"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch(e){throw this.unavailable("Camera permissions are not available in this browser")}})}requestPermissions(){return s(this,null,function*(){throw this.unimplemented("Not implemented on web.")})}pickLimitedLibraryPhotos(){return s(this,null,function*(){throw this.unavailable("Not implemented on web.")})}getLimitedLibraryPhotos(){return s(this,null,function*(){throw this.unavailable("Not implemented on web.")})}}new se;const _e=_("Camera",{web:()=>new se});class De{available(){return s(this,null,function*(){return!0})}isNative(){return v.isNativePlatform()}isIos(){return v.getPlatform()==="ios"}isAndroid(){return v.getPlatform()==="android"}isWeb(){return v.getPlatform()==="web"}config(){return s(this,null,function*(){i("NativeService config...")})}takePhotos(e="",r=1){return s(this,null,function*(){return i("NativeService takePhotos..."),i(e),i(r),new Promise((t,a)=>s(this,null,function*(){v.isPluginAvailable("Camera")?(i("NativeService Camera available."),yield _e.getPhoto({quality:90,allowEditing:!0,resultType:j.Uri}),t("")):(i("NativeService Camera not available."),a())}))})}scanQRCode(){return i("NativeService scanQRCode..."),new Promise((e,r)=>s(this,null,function*(){if(v.isPluginAvailable("BarcodeScanner")){i("NativeService BarcodeScanner available."),yield H.checkPermission({force:!0}),yield H.hideBackground();const a=yield H.startScan();a.hasContent?(i("LarkService scanQRCode success."),i(a),e(a.content)):(i("LarkService scanQRCode fail."),i(a),r())}else i("NativeService BarcodeScanner not available."),r()}))}}const ee=new De,Oe=o=>ie("/api/oapis/wecom/signature",o),$e=o=>ie("/api/oapis/wechat/signature",o);class Fe{available(){return s(this,null,function*(){return!0})}isWeCom(){const e=window.navigator.userAgent.toLowerCase();return e.indexOf("micromessenger")!=-1&&e.indexOf("wxwork")!=-1}isWeComEnabled(){return f.wechat.cp.enabled}auth(e="",r=!1){return s(this,null,function*(){i("WeComService auth...");let t;A.isWebPlatform()&&!F(f.wechat.cp.webappRedirectUrl)?(i(`WeComService webapp auth. ${f.wechat.cp.webappRedirectUrl}`),t=r?e:C(f.wechat.cp.webappRedirectUrl,e)):A.isWapPlatform()&&!F(f.wechat.cp.mobileRedirectUrl)?(i(`WeComService mobile auth. ${f.wechat.cp.mobileRedirectUrl}`),t=r?e:C(f.wechat.cp.mobileRedirectUrl,e)):(i(`WeComService auth. ${f.wechat.cp.redirectUrl}`),t=r?e:C(f.wechat.cp.redirectUrl,e)),i(`WeComService auth redirectUrl. ${t}`);const a=C(f.wechat.cp.oauthUrl,f.wechat.cp.appId,encodeURIComponent(t),f.wechat.cp.agentId,f.wechat.cp.oauthPrivateEnabled?"snsapi_privateinfo":"snsapi_base");i(`WeComService redirect to ${a}.`),be(a),yield oe.open(a,()=>{},()=>{})})}getSignature(e){return s(this,null,function*(){return i("WeComService getSignature..."),yield Oe({url:e})})}config(){return s(this,null,function*(){i("WeComService config...");const e=location.href.split("#")[0];return new Promise((r,t)=>{this.getSignature(e).then(a=>{a.data?(i("WeComService config signature."),wx.config({debug:!1,appId:a.data.appId,timestamp:a.data.timestamp,nonceStr:a.data.nonceStr,signature:a.data.signature,jsApiList:["chooseImage","getLocalImgData","previewImage","scanQRCode","getLocation","uploadImage","downloadImage","onMenuShareTimeline","onMenuShareAppMessage","updateAppMessageShareData","updateTimelineShareData","onMenuShareWeibo","invoke"]}),wx.ready(()=>{i("WeComService config ready."),r()}),wx.error(n=>{i("WeComService config error."),console.log(n)})):t()}).catch(a=>{i("WeComService config ready."),i(a),t()})})})}getPhoto(){return s(this,null,function*(){return i("WeComService getPhoto..."),this.takePhotos("camera",1)})}choosePhotos(e=1){return s(this,null,function*(){return i("WeComService choosePhotos..."),this.takePhotos("album",e)})}takePhotos(e="",r=1){return s(this,null,function*(){return i("WeComService takePhotos..."),new Promise((t,a)=>{wx?(i("WeComService wx available."),wx.ready(()=>{wx.chooseImage({sourceType:[e],count:r,sizeType:["original","compressed"],success:n=>{i("WeComService takePhotos success."),i(n),t(n.localIds)},fail:()=>{i("WeComService takePhotos fail."),a()}})})):(i("WeComService not available."),a())})})}scanQRCode(){return i("WeComService scanQRCode..."),new Promise((e,r)=>{console.log(wx),wx?(i("WeComService wx available."),wx.ready(()=>{i("WeComService wx ready."),wx.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:t=>{i("WeComService scanQRCode success."),i(t),e(t.resultStr)},cancel:t=>{i("WeComService scanQRCode cancel."),i(t),r(t)},error:t=>{i("WeComService scanQRCode error."),i(t),t.errMsg.indexOf("function_not_exist")>0&&console.log("版本过低请升级"),r(t)}})})):(i("WeComService wx not available."),r())})}}const te=new Fe;class Me{getPlatform(){return v.getPlatform()}isWapPlatform(){const e=navigator.userAgent.toLowerCase();return/mobile|android|iphone|ipad|phone/i.test(e)}isWebPlatform(){return!this.isWapPlatform()}initialize(){return s(this,null,function*(){i("PlatformService initialize..."),ee.isNative()?yield ee.config():te.isWeCom()?yield te.config():ae.isWeChat()?yield ae.config():Z.isLark()?yield Z.config():Y.isDingTalk()&&(yield Y.config())})}}const A=new Me;class Qe{available(){return s(this,null,function*(){return!0})}isWeChat(){const e=window.navigator.userAgent.toLowerCase();return e.indexOf("micromessenger")!=-1&&e.indexOf("wxwork")!=-1}auth(e,r=!1){return s(this,null,function*(){i("WeChatService auth...");let t;A.isWebPlatform()&&!F(f.wechat.mp.webappRedirectUrl)?t=r?e:C(f.wechat.mp.webappRedirectUrl,q(e,"code")):A.isWapPlatform()&&!F(f.wechat.mp.mobileRedirectUrl)?t=r?e:C(f.wechat.mp.mobileRedirectUrl,q(e,"code")):t=r?e:C(f.wechat.mp.redirectUrl,q(e,"code"));const a=C(f.wechat.mp.appId,encodeURIComponent(t));i(`WeChatService redirect to ${a}.`),yield oe.open(a,()=>{},()=>{})})}getSignature(e){return s(this,null,function*(){return i("WeChatService getSignature..."),yield $e({url:e})})}config(){return s(this,null,function*(){i("WeChatService config...");const e=location.href.split("#")[0];return new Promise((r,t)=>{this.getSignature(e).then(a=>{a.data?(i("WeChatService config..."),wx.config({debug:!1,appId:a.data.appId,timestamp:a.data.timestamp,nonceStr:a.data.nonceStr,signature:a.data.signature,jsApiList:["chooseImage","getLocalImgData","previewImage","scanQRCode","getLocation","uploadImage","downloadImage","onMenuShareTimeline","onMenuShareAppMessage","updateAppMessageShareData","updateTimelineShareData","onMenuShareWeibo","invoke"]}),wx.ready(()=>{i("WeChatService config ready."),r()}),wx.error(n=>{i("WeChatService config error."),console.log(n)})):t()}).catch(a=>{i("WeChatService config ready."),i(a),t()})})})}getPhoto(){return s(this,null,function*(){return i("WeChatService getPhoto..."),this.takePhotos("camera",1)})}choosePhotos(e=1){return s(this,null,function*(){return i("WeChatService choosePhotos..."),this.takePhotos("album",e)})}takePhotos(e="",r=1){return s(this,null,function*(){return i("WeChatService takePhotos..."),new Promise((t,a)=>{wx?(i("WeChatService available."),wx.ready(()=>{wx.chooseImage({sourceType:[e],count:r,sizeType:["original","compressed"],success:n=>{i("WeChatService takePhotos success."),i(n),t(n.localIds)},fail:()=>{i("WeChatService takePhotos fail."),a()}})})):(i("WeChatService not available."),a())})})}scanQRCode(){return i("WeChatService scanQRCode..."),new Promise((e,r)=>{console.log(wx),wx?(i("WeChatService wx available."),wx.ready(()=>{i("WeChatService wx ready."),wx.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:t=>{i("WeChatService scanQRCode success."),i(t),e(t.resultStr)},cancel:t=>{i("WeChatService scanQRCode cancel."),i(t),r(t)},error:t=>{i("WeChatService scanQRCode error."),i(t),t.errMsg.indexOf("function_not_exist")>0&&console.log("版本过低请升级"),r(t)}})})):(i("WeChatService wx not available."),r())})}}const ae=new Qe;class Be{initialize(){return s(this,null,function*(){A.initialize().then(()=>{i("PlatformService initialize successfully.")})})}}const je=new Be;export{je as C,N as W,He as a};
