import{e as y,m as f,n as N,d as $,r as D,b2 as w,H as A,u as L,C as p,i as B,b as c,aW as C,N as I,a_ as M,q as R,x as U}from"./index-pyS-jaTs.js";const[Y,r,q]=y("pull-refresh"),x=50,F=["pulling","loosing","success"],G={disabled:Boolean,modelValue:Boolean,headHeight:f(x),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:N,successDuration:f(500),animationDuration:f(300)};var W=$({name:Y,props:G,emits:["change","refresh","update:modelValue"],setup(s,{emit:d,slots:u}){let o;const g=D(),T=D(),H=w(g),e=A({status:"normal",distance:0,duration:0}),i=L(),P=()=>{if(s.headHeight!==x)return{height:`${s.headHeight}px`}},h=()=>e.status!=="loading"&&e.status!=="success"&&!s.disabled,b=t=>{const a=+(s.pullDistance||s.headHeight);return t>a&&(t<a*2?t=a+(t-a)/2:t=a*1.5+(t-a*2)/4),Math.round(t)},n=(t,a)=>{const l=+(s.pullDistance||s.headHeight);e.distance=t,a?e.status="loading":t===0?e.status="normal":t<l?e.status="pulling":e.status="loosing",d("change",{status:e.status,distance:t})},m=()=>{const{status:t}=e;return t==="normal"?"":s[`${t}Text`]||q(t)},k=()=>{const{status:t,distance:a}=e;if(u[t])return u[t]({distance:a});const l=[];return F.includes(t)&&l.push(c("div",{class:r("text")},[m()])),t==="loading"&&l.push(c(C,{class:r("loading")},{default:m})),l},E=()=>{e.status="success",setTimeout(()=>{n(0)},+s.successDuration)},v=t=>{o=M(H.value)===0,o&&(e.duration=0,i.start(t))},V=t=>{h()&&v(t)},_=t=>{if(h()){o||v(t);const{deltaY:a}=i;i.move(t),o&&a.value>=0&&i.isVertical()&&(R(t),n(b(a.value)))}},S=()=>{o&&i.deltaY.value&&h()&&(e.duration=+s.animationDuration,e.status==="loosing"?(n(+s.headHeight,!0),d("update:modelValue",!0),I(()=>d("refresh"))):n(0))};return p(()=>s.modelValue,t=>{e.duration=+s.animationDuration,t?n(+s.headHeight,!0):u.success||s.successText?E():n(0,!1)}),B("touchmove",_,{target:T}),()=>{var t;const a={transitionDuration:`${e.duration}ms`,transform:e.distance?`translate3d(0,${e.distance}px, 0)`:""};return c("div",{ref:g,class:r()},[c("div",{ref:T,class:r("track"),style:a,onTouchstartPassive:V,onTouchend:S,onTouchcancel:S},[c("div",{class:r("head"),style:P()},[k()]),(t=u.default)==null?void 0:t.call(u)])])}}});const j=U(W);export{j as P};
