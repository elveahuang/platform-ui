var Q=Object.defineProperty;var W=(e,t,a)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var T=(e,t,a)=>(W(e,typeof t!="symbol"?t+"":t,a),a);var z=(e,t,a)=>new Promise((r,o)=>{var c=n=>{try{i(a.next(n))}catch(l){o(l)}},u=n=>{try{i(a.throw(n))}catch(l){o(l)}},i=n=>n.done?r(n.value):Promise.resolve(n.value).then(c,u);i((a=a.apply(e,t)).next())});import{c as V,L as E,M as Z,t as J,d as b,r as y,N as A,O as C,Q as N,R as ee,D as R,a as te,S as q,b as f,T as I,U as w,V as ne,W as F,w as M,n as ae,B as G,X as ie,p as se,Y as oe,E as Y,o as H,Z as O,g as S,h,I as re,H as le,l as ue,f as X,_ as de,i as j,G as ce,K as fe,$ as ge,a0 as he,a1 as me}from"./index-71b8ca85.js";/* empty css              */import{N as pe}from"./index-8787eadf.js";/* empty css              *//* empty css              */import{C as ve}from"./index-7cfbb533.js";import{u as xe}from"./use-tab-status-ccbbd16d.js";import{a as De}from"./announcement-30185b7e.js";import"./use-placeholder-98cfd667.js";import"./use-route-2d377f03.js";const[Te,_,_e]=V("list"),Se={error:Boolean,offset:E(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:Z("down"),loadingText:String,finishedText:String,immediateCheck:J};var ye=b({name:Te,props:Se,emits:["load","update:error","update:loading"],setup(e,{emit:t,slots:a}){const r=y(e.loading),o=y(),c=y(),u=xe(),i=A(o),n=C(()=>e.scroller||i.value),l=()=>{I(()=>{if(r.value||e.finished||e.disabled||e.error||(u==null?void 0:u.value)===!1)return;const{direction:m}=e,D=+e.offset,v=w(n);if(!v.height||ne(o))return;let k=!1;const $=w(c);m==="up"?k=v.top-$.top<=D:k=$.bottom-v.bottom<=D,k&&(r.value=!0,t("update:loading",!0),t("load"))})},d=()=>{if(e.finished){const m=a.finished?a.finished():e.finishedText;if(m)return f("div",{class:_("finished-text")},[m])}},P=()=>{t("update:error",!1),l()},p=()=>{if(e.error){const m=a.error?a.error():e.errorText;if(m)return f("div",{role:"button",class:_("error-text"),tabindex:0,onClick:P},[m])}},x=()=>{if(r.value&&!e.finished&&!e.disabled)return f("div",{class:_("loading")},[a.loading?a.loading():f(F,{class:_("loading-icon")},{default:()=>[e.loadingText||_e("loading")]})])};return N(()=>[e.loading,e.finished,e.error],l),u&&N(u,m=>{m&&l()}),ee(()=>{r.value=e.loading}),R(()=>{e.immediateCheck&&l()}),te({check:l}),q("scroll",l,{target:n,passive:!0}),()=>{var m;const D=(m=a.default)==null?void 0:m.call(a),v=f("div",{ref:c,class:_("placeholder")},null);return f("div",{ref:o,role:"feed",class:_(),"aria-busy":r.value},[e.direction==="down"?D:v,x(),d(),p(),e.direction==="up"?D:v])}}});const Pe=M(ye),[ke,L,Be]=V("pull-refresh"),K=50,Le=["pulling","loosing","success"],be={disabled:Boolean,modelValue:Boolean,headHeight:E(K),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:ae,successDuration:E(500),animationDuration:E(300)};var $e=b({name:ke,props:be,emits:["change","refresh","update:modelValue"],setup(e,{emit:t,slots:a}){let r;const o=y(),c=y(),u=A(o),i=G({status:"normal",distance:0,duration:0}),n=ie(),l=()=>{if(e.headHeight!==K)return{height:`${e.headHeight}px`}},d=()=>i.status!=="loading"&&i.status!=="success"&&!e.disabled,P=s=>{const g=+(e.pullDistance||e.headHeight);return s>g&&(s<g*2?s=g+(s-g)/2:s=g*1.5+(s-g*2)/4),Math.round(s)},p=(s,g)=>{const B=+(e.pullDistance||e.headHeight);i.distance=s,g?i.status="loading":s===0?i.status="normal":s<B?i.status="pulling":i.status="loosing",t("change",{status:i.status,distance:s})},x=()=>{const{status:s}=i;return s==="normal"?"":e[`${s}Text`]||Be(s)},m=()=>{const{status:s,distance:g}=i;if(a[s])return a[s]({distance:g});const B=[];return Le.includes(s)&&B.push(f("div",{class:L("text")},[x()])),s==="loading"&&B.push(f(F,{class:L("loading")},{default:x})),B},D=()=>{i.status="success",setTimeout(()=>{p(0)},+e.successDuration)},v=s=>{r=oe(u.value)===0,r&&(i.duration=0,n.start(s))},k=s=>{d()&&v(s)},$=s=>{if(d()){r||v(s);const{deltaY:g}=n;n.move(s),r&&g.value>=0&&n.isVertical()&&(se(s),p(P(g.value)))}},U=()=>{r&&n.deltaY.value&&d()&&(i.duration=+e.animationDuration,i.status==="loosing"?(p(+e.headHeight,!0),t("update:modelValue",!0),I(()=>t("refresh"))):p(0))};return N(()=>e.modelValue,s=>{i.duration=+e.animationDuration,s?p(+e.headHeight,!0):a.success||e.successText?D():p(0,!1)}),q("touchmove",$,{target:c}),()=>{var s;const g={transitionDuration:`${i.duration}ms`,transform:i.distance?`translate3d(0,${i.distance}px, 0)`:""};return f("div",{ref:o,class:L()},[f("div",{ref:c,class:L("track"),style:g,onTouchstartPassive:k,onTouchend:U,onTouchcancel:U},[f("div",{class:L("head"),style:l()},[m()]),(s=a.default)==null?void 0:s.call(a)])])}}});const ze=M($e),Ee=b({__name:"DataList",props:{refreshing:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!1},finished:{type:Boolean,require:!0,default:!1},page:{type:Number,require:!0,default:1},size:{type:Number,require:!0,default:10},list:{type:Array,require:!0,default:()=>[]},offset:{type:Number,default:500},refreshDisabled:{type:Boolean,default:!1},loadDisabled:{type:Boolean,default:!1}},emits:["update:refreshing","update:loading","update:finished","update:isFirstPull","update:page","update:size","getDataList"],setup(e,{emit:t}){const a=e,r=C({get:()=>a.loading,set:n=>{t("update:loading",n)}}),o=C({get:()=>a.refreshing,set:n=>{t("update:refreshing",n)}}),c=()=>{a.refreshing&&(t("update:finished",!1),t("update:loading",!1),t("update:page",1)),t("getDataList")};let u;const i=()=>{t("update:refreshing",!0),t("update:loading",!0),u&&clearTimeout(u),u=setTimeout(c,1e3)};return R(()=>z(this,null,function*(){Y("Component <<DataList>> mounted.")})),(n,l)=>{const d=Pe,P=ue,p=ze;return H(),O(p,{"model-value":o.value,"onUpdate:modelValue":l[1]||(l[1]=x=>o.value=x),onRefresh:i,disabled:e.refreshDisabled},{loading:S(()=>[f(P,null,{default:S(()=>[f(h(re),{icon:"ep:loading"})]),_:1})]),default:S(()=>[f(d,{loading:r.value,"onUpdate:loading":l[0]||(l[0]=x=>r.value=x),finished:e.finished,onLoad:c,offset:e.offset},{default:S(()=>[le(n.$slots,"default")]),_:3},8,["loading","finished","offset"])]),_:3},8,["model-value","disabled"])}}}),He=b({__name:"announcement-list",props:{items:Array},setup(e){const t=e,a=r=>{ge.push({path:"/announcement/details",query:{id:r}})};return(r,o)=>{const c=ve;return H(!0),X(j,null,de(t.items,u=>(H(),O(c,{key:u.id,onClick:i=>a(u.id)},{title:S(()=>[ce("p",null,fe(u.title),1)]),_:2},1032,["onClick"]))),128)}}});class Ce{constructor(){T(this,"refreshing",!1);T(this,"loading",!1);T(this,"finished",!1);T(this,"pagination",{page:0,size:10,total:0});T(this,"items",[])}}const Ne=()=>new Ce,Re=(e,t,a)=>{var r,o,c,u,i,n,l;if((r=t==null?void 0:t.data)!=null&&r.content.length)for(const d of t.data.content)a&&he(a)?e.items.push(a(d)):e.items.push(d);return e.pagination.page=((c=(o=t==null?void 0:t.data)==null?void 0:o.pageable)==null?void 0:c.pageNumber)+1,e.pagination.size=(i=(u=t==null?void 0:t.data)==null?void 0:u.pageable)==null?void 0:i.pageSize,e.pagination.total=(n=t==null?void 0:t.data)==null?void 0:n.totalElements,e.loading=!1,e.refreshing=!1,(l=t==null?void 0:t.data)!=null&&l.last&&(e.finished=!0),e},Ue=e=>(e.loading=!0,e.refreshing&&(e.items=[]),{page:e.pagination.page<=0?1:e.pagination.page+1,size:e.pagination.size}),we=()=>({initialize:Ne,handleResult:Re,handleParams:Ue}),Ke=b({__name:"index",setup(e){const{initialize:t,handleResult:a,handleParams:r}=we(),o=G(t()),c=y([]),u=()=>z(this,null,function*(){const i=yield De(r(o));i&&(a(o,i),c.value=o.items)});return R(()=>z(this,null,function*(){Y("Page <<AnnouncementIndexPage>> mounted.")})),(i,n)=>{const l=pe;return H(),X(j,null,[f(l,{title:"Announcement","left-arrow":"",onClickLeft:n[0]||(n[0]=d=>h(me)())}),f(h(Ee),{finished:h(o).finished,"onUpdate:finished":n[1]||(n[1]=d=>h(o).finished=d),refreshing:h(o).refreshing,"onUpdate:refreshing":n[2]||(n[2]=d=>h(o).refreshing=d),loading:h(o).loading,"onUpdate:loading":n[3]||(n[3]=d=>h(o).loading=d),page:h(o).pagination.page,"onUpdate:page":n[4]||(n[4]=d=>h(o).pagination.page=d),size:h(o).pagination.size,"onUpdate:size":n[5]||(n[5]=d=>h(o).pagination.size=d),onGetDataList:u},{default:S(()=>[f(h(He),{items:h(c)},null,8,["items"])]),_:1},8,["finished","refreshing","loading","page","size"])],64)}}});export{Ke as default};
