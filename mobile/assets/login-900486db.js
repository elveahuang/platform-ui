var M=(e,t,a)=>new Promise((c,o)=>{var d=u=>{try{f(a.next(u))}catch(_){o(_)}},h=u=>{try{f(a.throw(u))}catch(_){o(_)}},f=u=>u.done?c(u.value):Promise.resolve(u.value).then(d,h);f((a=a.apply(e,t)).next())});import{u as Me,s as Ne,i as z,l as He,c as K,a as $e,e as F,b as oe,d as D,n as q,m as Y,f as W,r as E,g as Fe,h as I,j as Te,k as se,w as Ae,o as ke,p as l,q as ie,H as me,t as j,v as ae,x as Le,y as Ce,z as Re,A as X,B as Z,L as Ue,C as fe,D as Ke,E as ve,F as Ye,G as Oe,I as ze,J as qe,K as w,M as je,N,P as ce,O as ue,Q as U,R as re,S as Ge,T as xe,U as We,V as Je,W as he,X as Qe,Y as Xe,Z as Ee,_ as Ze,$ as et,a0 as tt,a1 as nt,a2 as ge,a3 as ot,a4 as at,a5 as lt,a6 as pe,a7 as k,a8 as ee,a9 as te,aa as st,ab as it}from"./index-4080eaf9.js";import{B as J,F as ct,C as ut,R as rt}from"./index-383dd079.js";import{S as dt}from"./index-783d9724.js";import{C as mt}from"./index-5ae7be3e.js";/* empty css              */import"./index-717ed3e5.js";import{N as ft}from"./index-c7a5b856.js";import"./use-route-83d6a30e.js";import"./use-placeholder-9214fa7d.js";const vt=e=>M(void 0,null,function*(){z.mode==="legacy"?z.global.locale=e:z.global.locale.value=e}),ht=e=>M(void 0,null,function*(){z.global.setLocaleMessage(e,yield He(e))}),gt=e=>M(void 0,null,function*(){yield Me().setLocale(e),yield ht(e),yield vt(e),yield Ne(e)}),pt=()=>({changeLocale:gt}),[bt,V,be]=K("picker"),Pe=e=>e.find(t=>!t.disabled)||e[0];function _t(e,t){const a=e[0];if(a){if(Array.isArray(a))return"multiple";if(t.children in a)return"cascade"}return"default"}function G(e,t){t=oe(t,0,e.length);for(let a=t;a<e.length;a++)if(!e[a].disabled)return a;for(let a=t-1;a>=0;a--)if(!e[a].disabled)return a;return 0}const _e=(e,t,a)=>t!==void 0&&!!e.find(c=>c[a.value]===t);function le(e,t,a){const c=e.findIndex(d=>d[a.value]===t),o=G(e,c);return e[o]}function yt(e,t,a){const c=[];let o={[t.children]:e},d=0;for(;o&&o[t.children];){const h=o[t.children],f=a.value[d];if(o=$e(f)?le(h,f,t):void 0,!o&&h.length){const u=Pe(h)[t.value];o=le(h,u,t)}d++,c.push(h)}return c}function St(e){const{transform:t}=window.getComputedStyle(e),a=t.slice(7,t.length-1).split(", ")[5];return Number(a)}function wt(e){return F({text:"text",value:"value",children:"children"},e)}const ye=200,Se=300,Tt=15,[Ve,ne]=K("picker-column"),Be=Symbol(Ve);var kt=D({name:Ve,props:{value:q,fields:Y(Object),options:W(),readonly:Boolean,allowHtml:Boolean,optionHeight:Y(Number),swipeDuration:Y(q),visibleOptionNum:Y(q)},emits:["change","clickOption","scrollInto"],setup(e,{emit:t,slots:a}){let c,o,d,h,f;const u=E(),_=E(),b=E(0),g=E(0),x=Fe(),T=()=>e.options.length,P=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,C=v=>{let n=G(e.options,v);const i=-n*e.optionHeight,r=()=>{n>T()-1&&(n=G(e.options,v));const B=e.options[n][e.fields.value];B!==e.value&&t("change",B)};c&&i!==b.value?f=r:r(),b.value=i},s=()=>e.readonly||!e.options.length,m=v=>{c||s()||(f=null,g.value=ye,C(v),t("clickOption",e.options[v]))},p=v=>oe(Math.round(-v/e.optionHeight),0,T()-1),S=I(()=>p(b.value)),y=(v,n)=>{const i=Math.abs(v/n);v=b.value+i/.003*(v<0?-1:1);const r=p(v);g.value=+e.swipeDuration,C(r)},O=()=>{c=!1,g.value=0,f&&(f(),f=null)},A=v=>{if(!s()){if(x.start(v),c){const n=St(_.value);b.value=Math.min(0,n-P())}g.value=0,o=b.value,d=Date.now(),h=o,f=null}},H=v=>{if(s())return;x.move(v),x.isVertical()&&(c=!0,ie(v,!0));const n=oe(o+x.deltaY.value,-(T()*e.optionHeight),e.optionHeight),i=p(n);i!==S.value&&t("scrollInto",e.options[i]),b.value=n;const r=Date.now();r-d>Se&&(d=r,h=n)},L=()=>{if(s())return;const v=b.value-h,n=Date.now()-d;if(n<Se&&Math.abs(v)>Tt){y(v,n);return}const r=p(b.value);g.value=ye,C(r),setTimeout(()=>{c=!1},0)},$=()=>{const v={height:`${e.optionHeight}px`};return e.options.map((n,i)=>{const r=n[e.fields.text],{disabled:B}=n,R=n[e.fields.value],Ie={role:"button",style:v,tabindex:B?-1:0,class:[ne("item",{disabled:B,selected:R===e.value}),n.className],onClick:()=>m(i)},De={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:r};return l("li",Ie,[a.option?a.option(n,i):l("div",De,null)])})};return Te(Be),se({stopMomentum:O}),Ae(()=>{const v=c?Math.floor(-b.value/e.optionHeight):e.options.findIndex(r=>r[e.fields.value]===e.value),n=G(e.options,v),i=-n*e.optionHeight;c&&n<v&&O(),b.value=i}),ke("touchmove",H,{target:u}),()=>l("div",{ref:u,class:ne(),onTouchstartPassive:A,onTouchend:L,onTouchcancel:L},[l("ul",{ref:_,style:{transform:`translate3d(0, ${b.value+P()}px, 0)`,transitionDuration:`${g.value}ms`,transitionProperty:g.value?"all":"none"},class:ne("wrapper"),onTransitionend:O},[$()])])}});const[Ct]=K("picker-toolbar"),Q={title:String,cancelButtonText:String,confirmButtonText:String},Ot=["cancel","confirm","title","toolbar"],xt=Object.keys(Q);var Et=D({name:Ct,props:Q,emits:["confirm","cancel"],setup(e,{emit:t,slots:a}){const c=()=>{if(a.title)return a.title();if(e.title)return l("div",{class:[V("title"),"van-ellipsis"]},[e.title])},o=()=>t("cancel"),d=()=>t("confirm"),h=()=>{const u=e.cancelButtonText||be("cancel");return l("button",{type:"button",class:[V("cancel"),me],onClick:o},[a.cancel?a.cancel():u])},f=()=>{const u=e.confirmButtonText||be("confirm");return l("button",{type:"button",class:[V("confirm"),me],onClick:d},[a.confirm?a.confirm():u])};return()=>l("div",{class:V("toolbar")},[a.toolbar?a.toolbar():[h(),c(),f()]])}});const[Pt,tn]=K("picker-group"),Vt=Symbol(Pt);F({tabs:W(),activeTab:j(0),nextStepText:String},Q);const Bt=F({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:j(44),showToolbar:ae,swipeDuration:j(1e3),visibleOptionNum:j(6)},Q),It=F({},Bt,{columns:W(),modelValue:W(),toolbarPosition:Le("top"),columnsFieldNames:Object});var Dt=D({name:bt,props:It,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:t,slots:a}){const c=E(),o=E(e.modelValue.slice(0)),{parent:d}=Te(Vt),{children:h,linkChildren:f}=Ce(Be);f();const u=I(()=>wt(e.columnsFieldNames)),_=I(()=>Re(e.optionHeight)),b=I(()=>_t(e.columns,u.value)),g=I(()=>{const{columns:n}=e;switch(b.value){case"multiple":return n;case"cascade":return yt(n,u.value,o);default:return[n]}}),x=I(()=>g.value.some(n=>n.length)),T=I(()=>g.value.map((n,i)=>le(n,o.value[i],u.value))),P=I(()=>g.value.map((n,i)=>n.findIndex(r=>r[u.value.value]===o.value[i]))),C=(n,i)=>{if(o.value[n]!==i){const r=o.value.slice(0);r[n]=i,o.value=r}},s=()=>({selectedValues:o.value.slice(0),selectedOptions:T.value,selectedIndexes:P.value}),m=(n,i)=>{C(i,n),b.value==="cascade"&&o.value.forEach((r,B)=>{const R=g.value[B];_e(R,r,u.value)||C(B,R.length?R[0][u.value.value]:void 0)}),ve(()=>{t("change",F({columnIndex:i},s()))})},p=(n,i)=>{const r={columnIndex:i,currentOption:n};t("clickOption",F(s(),r)),t("scrollInto",r)},S=()=>{h.forEach(i=>i.stopMomentum());const n=s();return ve(()=>{t("confirm",n)}),n},y=()=>t("cancel",s()),O=()=>g.value.map((n,i)=>l(kt,{value:o.value[i],fields:u.value,options:n,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:_.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:r=>m(r,i),onClickOption:r=>p(r,i),onScrollInto:r=>{t("scrollInto",{currentOption:r,columnIndex:i})}},{option:a.option})),A=n=>{if(x.value){const i={height:`${_.value}px`},r={backgroundSize:`100% ${(n-_.value)/2}px`};return[l("div",{class:V("mask"),style:r},null),l("div",{class:[Ye,V("frame")],style:i},null)]}},H=()=>{const n=_.value*+e.visibleOptionNum,i={height:`${n}px`};return l("div",{ref:c,class:V("columns"),style:i},[O(),A(n)])},L=()=>{if(e.showToolbar&&!d)return l(Et,Ke(fe(e,xt),{onConfirm:S,onCancel:y}),fe(a,Ot))};X(g,n=>{n.forEach((i,r)=>{i.length&&!_e(i,o.value[r],u.value)&&C(r,Pe(i)[u.value.value])})},{immediate:!0});let $;return X(()=>e.modelValue,n=>{!Z(n,o.value)&&!Z(n,$)&&(o.value=n.slice(0),$=n.slice(0))},{deep:!0}),X(o,n=>{Z(n,e.modelValue)||($=n.slice(0),t("update:modelValue",$))},{immediate:!0}),ke("touchmove",ie,{target:c}),se({confirm:S,getSelectedOptions:()=>T.value}),()=>{var n,i;return l("div",{class:V()},[e.toolbarPosition==="top"?L():null,e.loading?l(Ue,{class:V("loading")},null):null,(n=a["columns-top"])==null?void 0:n.call(a),H(),(i=a["columns-bottom"])==null?void 0:i.call(a),e.toolbarPosition==="bottom"?L():null])}}});const de=Oe(Dt),[Mt,Nt]=K("form"),Ht={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:q,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:ae,showErrorMessage:ae,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var $t=D({name:Mt,props:Ht,emits:["submit","failed"],setup(e,{emit:t,slots:a}){const{children:c,linkChildren:o}=Ce(ze),d=s=>s?c.filter(m=>s.includes(m.name)):c,h=s=>new Promise((m,p)=>{const S=[];d(s).reduce((O,A)=>O.then(()=>{if(!S.length)return A.validate().then(H=>{H&&S.push(H)})}),Promise.resolve()).then(()=>{S.length?p(S):m()})}),f=s=>new Promise((m,p)=>{const S=d(s);Promise.all(S.map(y=>y.validate())).then(y=>{y=y.filter(Boolean),y.length?p(y):m()})}),u=s=>{const m=c.find(p=>p.name===s);return m?new Promise((p,S)=>{m.validate().then(y=>{y?S(y):p()})}):Promise.reject()},_=s=>typeof s=="string"?u(s):e.validateFirst?h(s):f(s),b=s=>{typeof s=="string"&&(s=[s]),d(s).forEach(p=>{p.resetValidation()})},g=()=>c.reduce((s,m)=>(s[m.name]=m.getValidationStatus(),s),{}),x=(s,m)=>{c.some(p=>p.name===s?(p.$el.scrollIntoView(m),!0):!1)},T=()=>c.reduce((s,m)=>(m.name!==void 0&&(s[m.name]=m.formValue.value),s),{}),P=()=>{const s=T();_().then(()=>t("submit",s)).catch(m=>{t("failed",{values:s,errors:m}),e.scrollToError&&m[0].name&&x(m[0].name)})},C=s=>{ie(s),P()};return o({props:e}),se({submit:P,validate:_,getValues:T,scrollToField:x,resetValidation:b,getValidationStatus:g}),()=>{var s;return l("form",{class:Nt(),onSubmit:C},[(s=a.default)==null?void 0:s.call(a)])}}});const Ft=Oe($t);function we(e){return typeof e=="function"?e():w(e)}function At(e=!1,t={}){const{truthyValue:a=!0,falsyValue:c=!1}=t,o=qe(e),d=E(e);function h(f){if(arguments.length)return d.value=f,d.value;{const u=we(a);return d.value=d.value===u?we(c):u,d.value}}return o?h:[d,h]}const Lt=D({name:"LocaleSelector",setup(){const{changeLocale:e}=pt(),t=E(!1),a=je.map(o=>({text:o.title,value:o.locale})),c=o=>{U(o),re(o.selectedValues)&&e(Ge(o.selectedValues[0])),t.value=!1};return()=>l(ue,null,[l(J,{plain:!0,hairline:!0,square:!0,type:"primary",size:"small",onClick:()=>{t.value=!0}},{default:()=>[N("语言")]}),l(ce,{show:t.value,round:!0,position:"bottom"},{default:()=>[l(de,{columns:a,onConfirm:c,onCancel:()=>{t.value=!1}},null)]})])}}),Rt=D({name:"ThemePicker",setup(){const e=xe(),t=E(!1),a=We.map(o=>({text:o.title,value:o.strategy})),c=o=>{if(U(o),t.value=!1,re(o.selectedValues)){const d=Je(o.selectedValues[0]);e.setDarkStrategy(d),e.setDark(he(d)),Qe(he(d))}};return()=>l(ue,null,[l(J,{plain:!0,hairline:!0,type:"primary",size:"small",onClick:()=>{t.value=!0}},{default:()=>[N("深色模式")]}),l(ce,{show:t.value,round:!0,position:"bottom"},{default:()=>[l(de,{columns:a,onConfirm:c,onCancel:()=>{t.value=!1}},null)]})])}}),Ut=D({name:"ThemeSelector",setup(){const e=xe(),t=E(!1),a=Xe.map(o=>({text:o.title,value:o.theme})),c=o=>{U(o),t.value=!1,re(o.selectedValues)&&e.setTheme(Ze(o.selectedValues[0]))};return Ee(()=>M(this,null,function*(){U("Component <<ThemeSelector>> mounted.")})),()=>l(ue,null,[l(J,{plain:!0,hairline:!0,type:"primary",size:"small",onClick:()=>{t.value=!0}},{default:()=>[N("主题")]}),l(ce,{show:t.value,round:!0,position:"bottom"},{default:()=>[l(de,{columns:a,onConfirm:c,onCancel:()=>{t.value=!1}},null)]})])}}),Kt={class:"mt-6"},Yt={class:"my-2"},nn=D({__name:"login",setup(e){const{t}=et(),a=tt(),c=nt(),[o,d]=At(!1),h=E(),f=ge(ot),u=ge({username:[{required:!0,message:"Please input username"}],password:[{required:!0,message:"Please input password"}]}),_=()=>M(this,null,function*(){yield h.value.validate(),a.login(f).then(()=>{c.push("/")})});return Ee(()=>M(this,null,function*(){U("Page <<Login>> mounted.")})),(b,g)=>{const x=ft,T=it,P=ct,C=J,s=mt,m=dt,p=ut,S=rt,y=Ft;return at(),lt("div",null,[l(x,{title:w(t)("common.title")},null,8,["title"]),pe("div",Kt,[l(y,{ref_key:"form",ref:h},{default:k(()=>[l(s,{inset:""},{default:k(()=>[l(P,{modelValue:f.username,"onUpdate:modelValue":g[0]||(g[0]=O=>f.username=O),placeholder:w(t)("common.user_field_username"),rules:u.username},{default:k(()=>[ee(b.$slots,"left-icon",{},()=>[l(T,null,{default:k(()=>[l(w(te),{icon:"ion:person-outline"})]),_:1})])]),_:3},8,["modelValue","placeholder","rules"]),l(P,{modelValue:f.password,"onUpdate:modelValue":g[2]||(g[2]=O=>f.password=O),placeholder:w(t)("common.user_field_password"),rules:u.password,type:w(o)?"password":"text"},{default:k(()=>[ee(b.$slots,"left-icon",{},()=>[l(T,null,{default:k(()=>[l(w(te),{icon:"ion:lock-closed-outline"})]),_:1})]),ee(b.$slots,"right-icon",{},()=>[l(T,{name:w(o)?"closed-eye":"eye",onClick:g[1]||(g[1]=O=>w(d)(!w(o)))},null,8,["name"]),N(" , "),l(T,null,{default:k(()=>[l(w(te),{icon:"ion:lock-closed-outline"})]),_:1})])]),_:3},8,["modelValue","placeholder","rules","type"]),pe("div",Yt,[l(C,{onClick:_,type:"primary",block:""},{default:k(()=>[N(st(w(t)("common.button_login")),1)]),_:1})])]),_:3}),l(S,{class:"px-4 pt-4"},{default:k(()=>[l(p,{span:"12",class:"text-left"},{default:k(()=>[l(m,null,{default:k(()=>[l(w(Lt)),l(w(Rt)),l(w(Ut))]),_:1})]),_:1}),l(p,{span:"12",class:"text-right"},{default:k(()=>[l(C,{size:"small"},{default:k(()=>[N("忘记密码")]),_:1}),l(C,{size:"small"},{default:k(()=>[N("注册")]),_:1})]),_:1})]),_:1})]),_:3},512)])])}}});export{nn as default};
