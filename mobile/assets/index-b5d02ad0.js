import{ax as e,ay as t,az as a,aA as r,aB as l,c as n,aa as s,n as o,_ as i,aC as u,d as c,J as d,r as g,af as f,B as p,T as v,e as m,aD as h,aE as y,V as b,Z as x,K as w,ah as k,f as S,ak as C,F as V,U as M,aF as I,aG as B,p as E,O as A,a1 as $,i as j,aH as T,w as z,u as L,t as P}from"./index-d5a04a8e.js";import{c as W,C as F}from"./index-cfe844c6.js";import{u as R}from"./index-1bb3047b.js";function H(e){return Array.isArray(e)?!e.length:0!==e&&!e}function q(e,t){const{message:a}=t;return l(a)?a(e,t):a||""}function D({target:e}){e.composing=!0}function O({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function K(e){return[...e].length}function N(e,t){return[...e].slice(0,t).join("")}const[G,J]=n("field"),U={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:o,formatter:Function,clearIcon:i("clear"),modelValue:C(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:i("focus"),formatTrigger:i("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}};const Z=z(c({name:G,props:s({},W,U,{rows:o,type:i("text"),rules:Array,autosize:[Boolean,Object],labelWidth:o,labelClass:u,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}}),emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(l,{emit:n,slots:s}){const o=R(),i=d({status:"unvalidated",focused:!1,validateMessage:""}),u=g(),c=g(),C=g(),{parent:z}=f(V),L=()=>{var e;return String(null!=(e=l.modelValue)?e:"")},P=e=>M(l[e])?l[e]:z&&M(z.props[e])?z.props[e]:void 0,W=p((()=>{const e=P("readonly");if(l.clearable&&!e){const e=""!==L(),t="always"===l.clearTrigger||"focus"===l.clearTrigger&&i.focused;return e&&t}return!1})),G=p((()=>C.value&&s.input?C.value():l.modelValue)),U=e=>e.reduce(((e,t)=>e.then((()=>{if("failed"===i.status)return;let{value:e}=G;if(t.formatter&&(e=t.formatter(e,t)),!function(e,t){if(H(e)){if(t.required)return!1;if(!1===t.validateEmpty)return!0}return!(t.pattern&&!t.pattern.test(String(e)))}(e,t))return i.status="failed",void(i.validateMessage=q(e,t));if(t.validator){if(H(e)&&!1===t.validateEmpty)return;return function(e,t){return new Promise((a=>{const l=t.validator(e,t);r(l)?l.then(a):a(l)}))}(e,t).then((a=>{a&&"string"==typeof a?(i.status="failed",i.validateMessage=a):!1===a&&(i.status="failed",i.validateMessage=q(e,t))}))}}))),Promise.resolve()),Z=()=>{i.status="unvalidated",i.validateMessage=""},_=()=>n("endValidate",{status:i.status,message:i.validateMessage}),Q=(e=l.rules)=>new Promise((t=>{Z(),e?(n("startValidate"),U(e).then((()=>{"failed"===i.status?(t({name:l.name,message:i.validateMessage}),_()):(i.status="passed",t(),_())}))):t()})),X=e=>{if(z&&l.rules){const{validateTrigger:t}=z.props,a=I(t).includes(e),r=l.rules.filter((t=>t.trigger?I(t.trigger).includes(e):a));r.length&&Q(r)}},Y=(e,t="onChange")=>{const a=e;e=(e=>{var t;const{maxlength:a}=l;if(M(a)&&K(e)>+a){const r=L();if(r&&K(r)===+a)return r;const l=null==(t=u.value)?void 0:t.selectionEnd;if(i.focused&&l){const t=[...e],r=t.length-+a;return t.splice(l-r,r),t.join("")}return N(e,+a)}return e})(e);const r=K(a)-K(e);if("number"===l.type||"digit"===l.type){const t="number"===l.type;e=B(e,t,t)}let s=0;if(l.formatter&&t===l.formatTrigger){const{formatter:t,maxlength:r}=l;if(e=t(e),M(r)&&K(e)>+r&&(e=N(e,+r)),u.value&&i.focused){const{selectionEnd:e}=u.value,r=N(a,e);s=K(t(r))-K(r)}}if(u.value&&u.value.value!==e)if(i.focused){let{selectionStart:t,selectionEnd:a}=u.value;if(u.value.value=e,M(t)&&M(a)){const l=K(e);r?(t-=r,a-=r):s&&(t+=s,a+=s),u.value.setSelectionRange(Math.min(t,l),Math.min(a,l))}}else u.value.value=e;e!==l.modelValue&&n("update:modelValue",e)},ee=e=>{e.target.composing||Y(e.target.value)},te=()=>{var e;return null==(e=u.value)?void 0:e.blur()},ae=()=>{const r=u.value;"textarea"===l.type&&l.autosize&&r&&function(r,l){const n=e();r.style.height="auto";let s=r.scrollHeight;if(a(l)){const{maxHeight:e,minHeight:t}=l;void 0!==e&&(s=Math.min(s,e)),void 0!==t&&(s=Math.max(s,t))}s&&(r.style.height=`${s}px`,t(n))}(r,l.autosize)},re=e=>{i.focused=!0,n("focus",e),x(ae),P("readonly")&&te()},le=e=>{i.focused=!1,Y(L(),"onBlur"),n("blur",e),P("readonly")||(X("onBlur"),x(ae),T())},ne=e=>n("clickInput",e),se=e=>n("clickLeftIcon",e),oe=e=>n("clickRightIcon",e),ie=p((()=>"boolean"==typeof l.error?l.error:!(!z||!z.props.showError||"failed"!==i.status)||void 0)),ue=p((()=>{const e=P("labelWidth"),t=P("labelAlign");if(e&&"top"!==t)return{width:v(e)}})),ce=e=>{if(13===e.keyCode){z&&z.props.submitOnEnter||"textarea"===l.type||E(e),"search"===l.type&&te()}n("keypress",e)},de=()=>l.id||`${o}-input`,ge=()=>{const e=J("control",[P("inputAlign"),{error:ie.value,custom:!!s.input,"min-height":"textarea"===l.type&&!l.autosize}]);if(s.input)return S("div",{class:e,onClick:ne},[s.input()]);const t={id:de(),ref:u,name:l.name,rows:void 0!==l.rows?+l.rows:void 0,class:e,disabled:P("disabled"),readonly:P("readonly"),autofocus:l.autofocus,placeholder:l.placeholder,autocomplete:l.autocomplete,enterkeyhint:l.enterkeyhint,"aria-labelledby":l.label?`${o}-label`:void 0,onBlur:le,onFocus:re,onInput:ee,onClick:ne,onChange:O,onKeypress:ce,onCompositionend:O,onCompositionstart:D};return"textarea"===l.type?S("textarea",t,null):S("input",$("number"===(a=l.type)?{type:"text",inputmode:"decimal"}:"digit"===a?{type:"tel",inputmode:"numeric"}:{type:a},t),null);var a},fe=()=>{const e=s["right-icon"];if(l.rightIcon||e)return S("div",{class:J("right-icon"),onClick:oe},[e?e():S(A,{name:l.rightIcon,classPrefix:l.iconPrefix},null)])},pe=()=>{if(l.showWordLimit&&l.maxlength){const e=K(L());return S("div",{class:J("word-limit")},[S("span",{class:J("word-num")},[e]),j("/"),l.maxlength])}},ve=()=>{if(z&&!1===z.props.showErrorMessage)return;const e=l.errorMessage||i.validateMessage;if(e){const t=s["error-message"],a=P("errorMessageAlign");return S("div",{class:J("error-message",a)},[t?t({message:e}):e])}},me=()=>[S("div",{class:J("body")},[ge(),W.value&&S(A,{ref:c,name:l.clearIcon,class:J("clear")},null),fe(),s.button&&S("div",{class:J("button")},[s.button()])]),pe(),ve()];return m({blur:te,focus:()=>{var e;return null==(e=u.value)?void 0:e.focus()},validate:Q,formValue:G,resetValidation:Z,getValidationStatus:()=>i.status}),h(y,{customValue:C,resetValidation:Z,validateWithTrigger:X}),b((()=>l.modelValue),(()=>{Y(L()),Z(),X("onChange"),x(ae)})),w((()=>{Y(L(),l.formatTrigger),x(ae)})),k("touchstart",(e=>{E(e),n("update:modelValue",""),n("clear",e)}),{target:p((()=>{var e;return null==(e=c.value)?void 0:e.$el}))}),()=>{const e=P("disabled"),t=P("labelAlign"),a=(()=>{const e=s["left-icon"];if(l.leftIcon||e)return S("div",{class:J("left-icon"),onClick:se},[e?e():S(A,{name:l.leftIcon,classPrefix:l.iconPrefix},null)])})();return S(F,{size:l.size,class:J({error:ie.value,disabled:e,[`label-${t}`]:t}),center:l.center,border:l.border,isLink:l.isLink,clickable:l.clickable,titleStyle:ue.value,valueClass:J("value"),titleClass:[J("label",[t,{required:l.required}]),l.labelClass],arrowDirection:l.arrowDirection},{icon:a&&"top"!==t?()=>a:null,title:()=>{const e=(()=>{const e=P("labelWidth"),t=P("labelAlign"),a=P("colon")?":":"";return s.label?[s.label(),a]:l.label?S("label",{id:`${o}-label`,for:de(),style:"top"===t&&e?{width:v(e)}:void 0},[l.label+a]):void 0})();return"top"===t?[a,e].filter(Boolean):e||[]},value:me,extra:s.extra})}}})),[_,Q]=n("row"),X=Symbol(_);var Y=c({name:_,props:{tag:i("div"),wrap:P,align:String,gutter:C(0),justify:String},setup(e,{slots:t}){const{children:a,linkChildren:r}=L(X),l=p((()=>{const e=[[]];let t=0;return a.forEach(((a,r)=>{t+=Number(a.span),t>24?(e.push([r]),t-=24):e[e.length-1].push(r)})),e}));return r({spaces:p((()=>{const t=Number(e.gutter),a=[];return t?(l.value.forEach((e=>{const r=t*(e.length-1)/e.length;e.forEach(((e,l)=>{if(0===l)a.push({right:r});else{const l=t-a[e-1].right,n=r-l;a.push({left:l,right:n})}}))})),a):a}))}),()=>{const{tag:a,wrap:r,align:l,justify:n}=e;return S(a,{class:Q({[`align-${l}`]:l,[`justify-${n}`]:n,nowrap:!r})},{default:()=>{var e;return[null==(e=t.default)?void 0:e.call(t)]}})}}});const[ee,te]=n("col");const ae=z(c({name:ee,props:{tag:i("div"),span:C(0),offset:o},setup(e,{slots:t}){const{parent:a,index:r}=f(X),l=p((()=>{if(!a)return;const{spaces:e}=a;if(e&&e.value&&e.value[r.value]){const{left:t,right:a}=e.value[r.value];return{paddingLeft:t?`${t}px`:null,paddingRight:a?`${a}px`:null}}}));return()=>{const{tag:a,span:r,offset:n}=e;return S(a,{style:l.value,class:te({[r]:r,[`offset-${n}`]:n})},{default:()=>{var e;return[null==(e=t.default)?void 0:e.call(t)]}})}}})),re=z(Y);export{ae as C,Z as F,re as R,U as f};
