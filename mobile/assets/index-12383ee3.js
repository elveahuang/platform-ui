import{ax as e,ay as t,az as a,aA as r,aB as n,c as l,aa as s,n as o,_ as i,aC as u,d as c,J as d,r as g,af as f,B as p,T as v,e as m,aD as h,aE as y,V as b,Z as x,K as k,ah as w,f as S,ak as C,F as V,U as M,aF as I,aG as B,p as E,O as $,a1 as A,i as j,aH as T,w as z,u as L,t as P}from"./index-09966b71.js";import{c as F,C as R}from"./index-fc5d2d5a.js";import{u as W}from"./index-cd81b2ea.js";function H(e){return Array.isArray(e)?!e.length:0!==e&&!e}function q(e,t){const{message:a}=t;return n(a)?a(e,t):a||""}function D({target:e}){e.composing=!0}function O({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function K(e){return[...e].length}function N(e,t){return[...e].slice(0,t).join("")}const[G,J]=l("field"),U={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:o,formatter:Function,clearIcon:i("clear"),modelValue:C(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:i("focus"),formatTrigger:i("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}};const Z=z(c({name:G,props:s({},F,U,{rows:o,type:i("text"),rules:Array,autosize:[Boolean,Object],labelWidth:o,labelClass:u,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}}),emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(n,{emit:l,slots:s}){const o=W(),i=d({status:"unvalidated",focused:!1,validateMessage:""}),u=g(),c=g(),C=g(),{parent:z}=f(V),L=()=>{var e;return String(null!=(e=n.modelValue)?e:"")},P=e=>M(n[e])?n[e]:z&&M(z.props[e])?z.props[e]:void 0,F=p((()=>{const e=P("readonly");if(n.clearable&&!e){const e=""!==L(),t="always"===n.clearTrigger||"focus"===n.clearTrigger&&i.focused;return e&&t}return!1})),G=p((()=>C.value&&s.input?C.value():n.modelValue)),U=e=>e.reduce(((e,t)=>e.then((()=>{if("failed"===i.status)return;let{value:e}=G;if(t.formatter&&(e=t.formatter(e,t)),!function(e,t){if(H(e)){if(t.required)return!1;if(!1===t.validateEmpty)return!0}return!(t.pattern&&!t.pattern.test(String(e)))}(e,t))return i.status="failed",void(i.validateMessage=q(e,t));if(t.validator){if(H(e)&&!1===t.validateEmpty)return;return function(e,t){return new Promise((a=>{const n=t.validator(e,t);r(n)?n.then(a):a(n)}))}(e,t).then((a=>{a&&"string"==typeof a?(i.status="failed",i.validateMessage=a):!1===a&&(i.status="failed",i.validateMessage=q(e,t))}))}}))),Promise.resolve()),Z=()=>{i.status="unvalidated",i.validateMessage=""},_=()=>l("endValidate",{status:i.status,message:i.validateMessage}),Q=(e=n.rules)=>new Promise((t=>{Z(),e?(l("startValidate"),U(e).then((()=>{"failed"===i.status?(t({name:n.name,message:i.validateMessage}),_()):(i.status="passed",t(),_())}))):t()})),X=e=>{if(z&&n.rules){const{validateTrigger:t}=z.props,a=I(t).includes(e),r=n.rules.filter((t=>t.trigger?I(t.trigger).includes(e):a));r.length&&Q(r)}},Y=(e,t="onChange")=>{const a=e;e=(e=>{var t;const{maxlength:a}=n;if(M(a)&&K(e)>a){const r=L();if(r&&K(r)===+a)return r;const n=null==(t=u.value)?void 0:t.selectionEnd;if(i.focused&&n){const t=[...e],r=t.length-+a;return t.splice(n-r,r),t.join("")}return N(e,+a)}return e})(e);const r=K(a)-K(e);if("number"===n.type||"digit"===n.type){const t="number"===n.type;e=B(e,t,t)}let s=0;if(n.formatter&&t===n.formatTrigger){const{formatter:t,maxlength:r}=n;if(e=t(e),M(r)&&K(e)>r&&(e=N(e,+r)),u.value&&i.focused){const{selectionEnd:e}=u.value,r=N(a,e);s=K(t(r))-K(r)}}if(u.value&&u.value.value!==e)if(i.focused){let{selectionStart:t,selectionEnd:a}=u.value;if(u.value.value=e,M(t)&&M(a)){const n=K(e);r?(t-=r,a-=r):s&&(t+=s,a+=s),u.value.setSelectionRange(Math.min(t,n),Math.min(a,n))}}else u.value.value=e;e!==n.modelValue&&l("update:modelValue",e)},ee=e=>{e.target.composing||Y(e.target.value)},te=()=>{var e;return null==(e=u.value)?void 0:e.blur()},ae=()=>{const r=u.value;"textarea"===n.type&&n.autosize&&r&&function(r,n){const l=e();r.style.height="auto";let s=r.scrollHeight;if(a(n)){const{maxHeight:e,minHeight:t}=n;void 0!==e&&(s=Math.min(s,e)),void 0!==t&&(s=Math.max(s,t))}s&&(r.style.height=`${s}px`,t(l))}(r,n.autosize)},re=e=>{i.focused=!0,l("focus",e),x(ae),P("readonly")&&te()},ne=e=>{P("readonly")||(i.focused=!1,Y(L(),"onBlur"),l("blur",e),X("onBlur"),x(ae),T())},le=e=>l("clickInput",e),se=e=>l("clickLeftIcon",e),oe=e=>l("clickRightIcon",e),ie=p((()=>"boolean"==typeof n.error?n.error:!(!z||!z.props.showError||"failed"!==i.status)||void 0)),ue=p((()=>{const e=P("labelWidth");if(e)return{width:v(e)}})),ce=e=>{if(13===e.keyCode){z&&z.props.submitOnEnter||"textarea"===n.type||E(e),"search"===n.type&&te()}l("keypress",e)},de=()=>n.id||`${o}-input`,ge=()=>{const e=J("control",[P("inputAlign"),{error:ie.value,custom:!!s.input,"min-height":"textarea"===n.type&&!n.autosize}]);if(s.input)return S("div",{class:e,onClick:le},[s.input()]);const t={id:de(),ref:u,name:n.name,rows:void 0!==n.rows?+n.rows:void 0,class:e,disabled:P("disabled"),readonly:P("readonly"),autofocus:n.autofocus,placeholder:n.placeholder,autocomplete:n.autocomplete,enterkeyhint:n.enterkeyhint,"aria-labelledby":n.label?`${o}-label`:void 0,onBlur:ne,onFocus:re,onInput:ee,onClick:le,onChange:O,onKeypress:ce,onCompositionend:O,onCompositionstart:D};return"textarea"===n.type?S("textarea",t,null):S("input",A("number"===(a=n.type)?{type:"text",inputmode:"decimal"}:"digit"===a?{type:"tel",inputmode:"numeric"}:{type:a},t),null);var a},fe=()=>{const e=s["right-icon"];if(n.rightIcon||e)return S("div",{class:J("right-icon"),onClick:oe},[e?e():S($,{name:n.rightIcon,classPrefix:n.iconPrefix},null)])},pe=()=>{if(n.showWordLimit&&n.maxlength){const e=K(L());return S("div",{class:J("word-limit")},[S("span",{class:J("word-num")},[e]),j("/"),n.maxlength])}},ve=()=>{if(z&&!1===z.props.showErrorMessage)return;const e=n.errorMessage||i.validateMessage;if(e){const t=s["error-message"],a=P("errorMessageAlign");return S("div",{class:J("error-message",a)},[t?t({message:e}):e])}},me=()=>[S("div",{class:J("body")},[ge(),F.value&&S($,{ref:c,name:n.clearIcon,class:J("clear")},null),fe(),s.button&&S("div",{class:J("button")},[s.button()])]),pe(),ve()];return m({blur:te,focus:()=>{var e;return null==(e=u.value)?void 0:e.focus()},validate:Q,formValue:G,resetValidation:Z,getValidationStatus:()=>i.status}),h(y,{customValue:C,resetValidation:Z,validateWithTrigger:X}),b((()=>n.modelValue),(()=>{Y(L()),Z(),X("onChange"),x(ae)})),k((()=>{Y(L(),n.formatTrigger),x(ae)})),w("touchstart",(e=>{E(e),l("update:modelValue",""),l("clear",e)}),{target:p((()=>{var e;return null==(e=c.value)?void 0:e.$el}))}),()=>{const e=P("disabled"),t=P("labelAlign"),a=(()=>{const e=s["left-icon"];if(n.leftIcon||e)return S("div",{class:J("left-icon"),onClick:se},[e?e():S($,{name:n.leftIcon,classPrefix:n.iconPrefix},null)])})();return S(R,{size:n.size,class:J({error:ie.value,disabled:e,[`label-${t}`]:t}),center:n.center,border:n.border,isLink:n.isLink,clickable:n.clickable,titleStyle:ue.value,valueClass:J("value"),titleClass:[J("label",[t,{required:n.required}]),n.labelClass],arrowDirection:n.arrowDirection},{icon:a&&"top"!==t?()=>a:null,title:()=>{const e=(()=>{const e=P("colon")?":":"";return s.label?[s.label(),e]:n.label?S("label",{id:`${o}-label`,for:de()},[n.label+e]):void 0})();return"top"===t?[a,e].filter(Boolean):e||[]},value:me,extra:s.extra})}}})),[_,Q]=l("row"),X=Symbol(_);var Y=c({name:_,props:{tag:i("div"),wrap:P,align:String,gutter:C(0),justify:String},setup(e,{slots:t}){const{children:a,linkChildren:r}=L(X),n=p((()=>{const e=[[]];let t=0;return a.forEach(((a,r)=>{t+=Number(a.span),t>24?(e.push([r]),t-=24):e[e.length-1].push(r)})),e}));return r({spaces:p((()=>{const t=Number(e.gutter),a=[];return t?(n.value.forEach((e=>{const r=t*(e.length-1)/e.length;e.forEach(((e,n)=>{if(0===n)a.push({right:r});else{const n=t-a[e-1].right,l=r-n;a.push({left:n,right:l})}}))})),a):a}))}),()=>{const{tag:a,wrap:r,align:n,justify:l}=e;return S(a,{class:Q({[`align-${n}`]:n,[`justify-${l}`]:l,nowrap:!r})},{default:()=>{var e;return[null==(e=t.default)?void 0:e.call(t)]}})}}});const[ee,te]=l("col");const ae=z(c({name:ee,props:{tag:i("div"),span:C(0),offset:o},setup(e,{slots:t}){const{parent:a,index:r}=f(X),n=p((()=>{if(!a)return;const{spaces:e}=a;if(e&&e.value&&e.value[r.value]){const{left:t,right:a}=e.value[r.value];return{paddingLeft:t?`${t}px`:null,paddingRight:a?`${a}px`:null}}}));return()=>{const{tag:a,span:r,offset:l}=e;return S(a,{style:n.value,class:te({[r]:r,[`offset-${l}`]:l})},{default:()=>{var e;return[null==(e=t.default)?void 0:e.call(t)]}})}}})),re=z(Y);export{ae as C,Z as F,re as R,U as f};
