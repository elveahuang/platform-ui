var E=Object.defineProperty;var N=(e,a,n)=>a in e?E(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n;var m=(e,a,n)=>(N(e,typeof a!="symbol"?a+"":a,n),n);var b=(e,a,n)=>new Promise((o,l)=>{var t=r=>{try{f(n.next(r))}catch(s){l(s)}},d=r=>{try{f(n.throw(r))}catch(s){l(s)}},f=r=>r.done?o(r.value):Promise.resolve(r.value).then(t,d);f((n=n.apply(e,a)).next())});import{e as I,m as L,al as U,am as $,d as k,r as R,b2 as j,g as F,C as y,by as O,o as B,av as V,j as q,b as g,O as A,p as S,b8 as H,aW as M,y as W,bz as G,I as J,l as v,a as K,R as Q,w as x,u as X,ab as Y,bA as Z,ae as ee}from"./index-dv1co9BN.js";/* empty css                                                              *//* empty css              */import{t as ae}from"./toNumber-CbI3llai.js";import{u as ne}from"./use-tab-status-BVI1qAOq.js";import{P as te}from"./index-DuNLSilu.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";const[oe,h,se]=I("list"),re={error:Boolean,offset:L(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:U("down"),loadingText:String,finishedText:String,immediateCheck:$};var de=k({name:oe,props:re,emits:["load","update:error","update:loading"],setup(e,{emit:a,slots:n}){const o=R(e.loading),l=R(),t=R(),d=ne(),f=j(l),r=F(()=>e.scroller||f.value),s=()=>{A(()=>{if(o.value||e.finished||e.disabled||e.error||(d==null?void 0:d.value)===!1)return;const{direction:i}=e,p=+e.offset,u=S(r);if(!u.height||H(l))return;let P=!1;const T=S(t);i==="up"?P=u.top-T.top<=p:P=T.bottom-u.bottom<=p,P&&(o.value=!0,a("update:loading",!0),a("load"))})},c=()=>{if(e.finished){const i=n.finished?n.finished():e.finishedText;if(i)return g("div",{class:h("finished-text")},[i])}},D=()=>{a("update:error",!1),s()},_=()=>{if(e.error){const i=n.error?n.error():e.errorText;if(i)return g("div",{role:"button",class:h("error-text"),tabindex:0,onClick:D},[i])}},z=()=>{if(o.value&&!e.finished&&!e.disabled)return g("div",{class:h("loading")},[n.loading?n.loading():g(M,{class:h("loading-icon")},{default:()=>[e.loadingText||se("loading")]})])};return y(()=>[e.loading,e.finished,e.error],s),d&&y(d,i=>{i&&s()}),O(()=>{o.value=e.loading}),B(()=>{e.immediateCheck&&s()}),V({check:s}),q("scroll",s,{target:r,passive:!0}),()=>{var i;const p=(i=n.default)==null?void 0:i.call(n),u=g("div",{ref:t,class:h("placeholder")},null);return g("div",{ref:l,role:"feed",class:h(),"aria-busy":o.value},[e.direction==="down"?p:u,z(),c(),_(),e.direction==="up"?p:u])}}});const le=W(de);let C=class{constructor(){m(this,"refreshing",!1);m(this,"loading",!1);m(this,"finished",!1);m(this,"pagination",{page:0,size:10,total:0});m(this,"items",[])}};const w=(e={size:12})=>{const a=new C;return e.size>0&&(a.pagination.size=e.size),a},fe=(e,a,n)=>{var o,l,t,d,f,r,s;if((o=a==null?void 0:a.data)!=null&&o.content.length)for(const c of a.data.content)n&&G(n)?e.items.push(n(c)):e.items.push(c);return e.pagination.page=((t=(l=a==null?void 0:a.data)==null?void 0:l.pageable)==null?void 0:t.pageNumber)+1,e.pagination.size=(f=(d=a==null?void 0:a.data)==null?void 0:d.pageable)==null?void 0:f.pageSize,e.pagination.total=ae((r=a==null?void 0:a.data)==null?void 0:r.totalElements),e.loading=!1,e.refreshing=!1,e.finished=(s=a==null?void 0:a.data)==null?void 0:s.last,e},ce=e=>(e.loading=!0,e.refreshing&&(e.items=[]),{page:e.pagination.page+1,size:e.pagination.size}),ze=()=>({initialize:w,handleResult:fe,handleParams:ce}),ge=k({__name:"DataList",props:{model:{type:C,require:!0,default:()=>w()},offset:{type:Number,default:100},refreshDisabled:{type:Boolean,default:!1},loadDisabled:{type:Boolean,default:!1}},emits:["getDataList","resetData","cleanDataList"],setup(e,{expose:a,emit:n}){const o=n,t=J(e.model),d=()=>b(this,null,function*(){v("onLoad..."),t.refreshing&&(v("refreshing"),t.pagination.page=0,t.finished=!1,t.loading=!1),o("getDataList")}),f=()=>{v("onRefresh..."),d()};return a({dataRefresh:()=>b(this,null,function*(){o("resetData"),o("getDataList")})}),B(()=>b(this,null,function*(){v("Component <<DataList>> mounted.")})),(s,c)=>{const D=ee,_=le,z=te;return K(),Q(z,{"model-value":t.refreshing,"onUpdate:modelValue":c[1]||(c[1]=i=>t.refreshing=i),onRefresh:f,disabled:e.refreshDisabled},{loading:x(()=>[g(D,null,{default:x(()=>[g(X(Y),{icon:"ep:loading"})]),_:1})]),default:x(()=>[g(_,{loading:t.loading,"onUpdate:loading":c[0]||(c[0]=i=>t.loading=i),finished:t.finished,offset:e.offset,onLoad:d},{default:x(()=>[Z(s.$slots,"default",{},void 0,!0)]),_:3},8,["loading","finished","offset"])]),_:3},8,["model-value","disabled"])}}}),Pe=ie(ge,[["__scopeId","data-v-990cdf66"]]);export{Pe as D,ze as u};
