var E=Object.defineProperty;var N=(e,a,n)=>a in e?E(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n;var m=(e,a,n)=>(N(e,typeof a!="symbol"?a+"":a,n),n);var v=(e,a,n)=>new Promise((i,d)=>{var t=r=>{try{f(n.next(r))}catch(s){d(s)}},l=r=>{try{f(n.throw(r))}catch(s){d(s)}},f=r=>r.done?i(r.value):Promise.resolve(r.value).then(t,l);f((n=n.apply(e,a)).next())});import{aT as I,M as L,S as U,Q as j,R as V,d as B,j as P,aU as $,O as q,ad as z,aV as A,g as k,a2 as F,af as M,a as g,ae as O,aW as y,aX as W,aJ as Y,W as G,aY as H,f as J,l as b,o as K,q as Q,w as x,u as X,I as Z,aZ as ee,G as ae}from"./index-NS3bFuoT.js";/* empty css                                                                 *//* empty css              */import{t as ne}from"./toNumber-FiTFfB40.js";import{P as te}from"./index-dVxbU6Do.js";import{_ as oe}from"./_plugin-vue_export-helper-x3n3nnut.js";const ie=Symbol(),se=()=>I(ie,null),[re,h,le]=L("list"),de={error:Boolean,offset:U(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:j("down"),loadingText:String,finishedText:String,immediateCheck:V};var fe=B({name:re,props:de,emits:["load","update:error","update:loading"],setup(e,{emit:a,slots:n}){const i=P(e.loading),d=P(),t=P(),l=se(),f=$(d),r=q(()=>e.scroller||f.value),s=()=>{O(()=>{if(i.value||e.finished||e.disabled||e.error||(l==null?void 0:l.value)===!1)return;const{direction:o}=e,p=+e.offset,u=y(r);if(!u.height||W(d))return;let S=!1;const R=y(t);o==="up"?S=u.top-R.top<=p:S=R.bottom-u.bottom<=p,S&&(i.value=!0,a("update:loading",!0),a("load"))})},c=()=>{if(e.finished){const o=n.finished?n.finished():e.finishedText;if(o)return g("div",{class:h("finished-text")},[o])}},_=()=>{a("update:error",!1),s()},D=()=>{if(e.error){const o=n.error?n.error():e.errorText;if(o)return g("div",{role:"button",class:h("error-text"),tabindex:0,onClick:_},[o])}},T=()=>{if(i.value&&!e.finished&&!e.disabled)return g("div",{class:h("loading")},[n.loading?n.loading():g(Y,{class:h("loading-icon")},{default:()=>[e.loadingText||le("loading")]})])};return z(()=>[e.loading,e.finished,e.error],s),l&&z(l,o=>{o&&s()}),A(()=>{i.value=e.loading}),k(()=>{e.immediateCheck&&s()}),F({check:s}),M("scroll",s,{target:r,passive:!0}),()=>{var o;const p=(o=n.default)==null?void 0:o.call(n),u=g("div",{ref:t,class:h("placeholder")},null);return g("div",{ref:d,role:"feed",class:h(),"aria-busy":i.value},[e.direction==="down"?p:u,T(),c(),D(),e.direction==="up"?p:u])}}});const ce=G(fe);let w=class{constructor(){m(this,"refreshing",!1);m(this,"loading",!1);m(this,"finished",!1);m(this,"pagination",{page:0,size:10,total:0});m(this,"items",[])}};const C=(e={size:12})=>{const a=new w;return e.size>0&&(a.pagination.size=e.size),a},ge=(e,a,n)=>{var i,d,t,l,f,r,s;if((i=a==null?void 0:a.data)!=null&&i.content.length)for(const c of a.data.content)n&&H(n)?e.items.push(n(c)):e.items.push(c);return e.pagination.page=((t=(d=a==null?void 0:a.data)==null?void 0:d.pageable)==null?void 0:t.pageNumber)+1,e.pagination.size=(f=(l=a==null?void 0:a.data)==null?void 0:l.pageable)==null?void 0:f.pageSize,e.pagination.total=ne((r=a==null?void 0:a.data)==null?void 0:r.totalElements),e.loading=!1,e.refreshing=!1,e.finished=(s=a==null?void 0:a.data)==null?void 0:s.last,e},ue=e=>(e.loading=!0,e.refreshing&&(e.items=[]),{page:e.pagination.page+1,size:e.pagination.size}),Se=()=>({initialize:C,handleResult:ge,handleParams:ue}),me=B({__name:"DataList",props:{model:{type:w,require:!0,default:()=>C()},offset:{type:Number,default:100},refreshDisabled:{type:Boolean,default:!1},loadDisabled:{type:Boolean,default:!1}},emits:["getDataList","resetData","cleanDataList"],setup(e,{expose:a,emit:n}){const i=n,t=J(e.model),l=()=>v(this,null,function*(){b("onLoad..."),t.refreshing&&(b("refreshing"),t.pagination.page=0,t.finished=!1,t.loading=!1),i("getDataList")}),f=()=>{b("onRefresh..."),l()};return a({dataRefresh:()=>v(this,null,function*(){i("resetData"),i("getDataList")})}),k(()=>v(this,null,function*(){b("Component <<DataList>> mounted.")})),(s,c)=>{const _=ae,D=ce,T=te;return K(),Q(T,{"model-value":t.refreshing,"onUpdate:modelValue":c[1]||(c[1]=o=>t.refreshing=o),onRefresh:f,disabled:e.refreshDisabled},{loading:x(()=>[g(_,null,{default:x(()=>[g(X(Z),{icon:"ep:loading"})]),_:1})]),default:x(()=>[g(D,{loading:t.loading,"onUpdate:loading":c[0]||(c[0]=o=>t.loading=o),finished:t.finished,offset:e.offset,onLoad:l},{default:x(()=>[ee(s.$slots,"default",{},void 0,!0)]),_:3},8,["loading","finished","offset"])]),_:3},8,["model-value","disabled"])}}}),Pe=oe(me,[["__scopeId","data-v-990cdf66"]]);export{Pe as D,Se as u};
