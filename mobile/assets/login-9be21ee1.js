var D=(e,n,l)=>new Promise((i,o)=>{var c=d=>{try{h(l.next(d))}catch(p){o(p)}},v=d=>{try{h(l.throw(d))}catch(p){o(p)}},h=d=>d.done?i(d.value):Promise.resolve(d.value).then(c,v);h((l=l.apply(e,n)).next())});import{u as Me,s as Ne,i as U,l as _e,c as j,a as He,e as H,b as ee,d as I,n as Y,m as K,f as G,r as C,g as Fe,h as P,j as Ce,k as le,w as Ae,o as we,p as a,q as oe,H as re,t as z,v as te,x as $e,y as ke,z as Le,A as J,B as Q,L as Re,C as ce,D as je,E as de,F as Ke,G as Oe,I as Ue,J as Ye,K as ze,M as qe,N as L,P as ae,O as se,Q as R,R as ue,S as Ge,T as xe,U as We,V as Je,W as me,X as Qe,Y as Xe,Z as Ee,_ as Ze,$ as et,a0 as tt,a1 as nt,a2 as fe,a3 as lt,a4 as X,a5 as ve,a6 as ot}from"./index-fff6f175.js";import{B as _,F as he,R as at,C as ge}from"./index-30761343.js";import{N as st}from"./index-8c07dc1c.js";import{C as ut}from"./index-3e40d541.js";import{S as it}from"./index-e54ece81.js";import"./use-route-15bd8bbe.js";import"./index-e11e42cb.js";import"./use-placeholder-abade3ca.js";const rt=e=>D(void 0,null,function*(){U.mode==="legacy"?U.global.locale=e:U.global.locale.value=e}),ct=e=>D(void 0,null,function*(){U.global.setLocaleMessage(e,yield _e(e))}),dt=e=>D(void 0,null,function*(){yield Me().setLocale(e),yield ct(e),yield rt(e),yield Ne(e)}),mt=()=>({changeLocale:dt}),[ft,x,pe]=j("picker"),Pe=e=>e.find(n=>!n.disabled)||e[0];function vt(e,n){const l=e[0];if(l){if(Array.isArray(l))return"multiple";if(n.children in l)return"cascade"}return"default"}function q(e,n){n=ee(n,0,e.length);for(let l=n;l<e.length;l++)if(!e[l].disabled)return l;for(let l=n-1;l>=0;l--)if(!e[l].disabled)return l;return 0}const be=(e,n,l)=>n!==void 0&&!!e.find(i=>i[l.value]===n);function ne(e,n,l){const i=e.findIndex(c=>c[l.value]===n),o=q(e,i);return e[o]}function ht(e,n,l){const i=[];let o={[n.children]:e},c=0;for(;o&&o[n.children];){const v=o[n.children],h=l.value[c];if(o=He(h)?ne(v,h,n):void 0,!o&&v.length){const d=Pe(v)[n.value];o=ne(v,d,n)}c++,i.push(v)}return i}function gt(e){const{transform:n}=window.getComputedStyle(e),l=n.slice(7,n.length-1).split(", ")[5];return Number(l)}function pt(e){return H({text:"text",value:"value",children:"children"},e)}const ye=200,Se=300,bt=15,[Ie,Z]=j("picker-column"),Ve=Symbol(Ie);var yt=I({name:Ie,props:{value:Y,fields:K(Object),options:G(),readonly:Boolean,allowHtml:Boolean,optionHeight:K(Number),swipeDuration:K(Y),visibleOptionNum:K(Y)},emits:["change","clickOption","scrollInto"],setup(e,{emit:n,slots:l}){let i,o,c,v,h;const d=C(),p=C(),b=C(0),y=C(0),w=Fe(),k=()=>e.options.length,V=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,O=f=>{let t=q(e.options,f);const u=-t*e.optionHeight,r=()=>{t>k()-1&&(t=q(e.options,f));const E=e.options[t][e.fields.value];E!==e.value&&n("change",E)};i&&u!==b.value?h=r:r(),b.value=u},s=()=>e.readonly||!e.options.length,m=f=>{i||s()||(h=null,y.value=ye,O(f),n("clickOption",e.options[f]))},g=f=>ee(Math.round(-f/e.optionHeight),0,k()-1),T=P(()=>g(b.value)),S=(f,t)=>{const u=Math.abs(f/t);f=b.value+u/.003*(f<0?-1:1);const r=g(f);y.value=+e.swipeDuration,O(r)},B=()=>{i=!1,y.value=0,h&&(h(),h=null)},F=f=>{if(!s()){if(w.start(f),i){const t=gt(p.value);b.value=Math.min(0,t-V())}y.value=0,o=b.value,c=Date.now(),v=o,h=null}},M=f=>{if(s())return;w.move(f),w.isVertical()&&(i=!0,oe(f,!0));const t=ee(o+w.deltaY.value,-(k()*e.optionHeight),e.optionHeight),u=g(t);u!==T.value&&n("scrollInto",e.options[u]),b.value=t;const r=Date.now();r-c>Se&&(c=r,v=t)},A=()=>{if(s())return;const f=b.value-v,t=Date.now()-c;if(t<Se&&Math.abs(f)>bt){S(f,t);return}const r=g(b.value);y.value=ye,O(r),setTimeout(()=>{i=!1},0)},N=()=>{const f={height:`${e.optionHeight}px`};return e.options.map((t,u)=>{const r=t[e.fields.text],{disabled:E}=t,$=t[e.fields.value],Be={role:"button",style:f,tabindex:E?-1:0,class:[Z("item",{disabled:E,selected:$===e.value}),t.className],onClick:()=>m(u)},De={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:r};return a("li",Be,[l.option?l.option(t,u):a("div",De,null)])})};return Ce(Ve),le({stopMomentum:B}),Ae(()=>{const f=i?Math.floor(-b.value/e.optionHeight):e.options.findIndex(r=>r[e.fields.value]===e.value),t=q(e.options,f),u=-t*e.optionHeight;i&&t<f&&B(),b.value=u}),we("touchmove",M,{target:d}),()=>a("div",{ref:d,class:Z(),onTouchstartPassive:F,onTouchend:A,onTouchcancel:A},[a("ul",{ref:p,style:{transform:`translate3d(0, ${b.value+V()}px, 0)`,transitionDuration:`${y.value}ms`,transitionProperty:y.value?"all":"none"},class:Z("wrapper"),onTransitionend:B},[N()])])}});const[St]=j("picker-toolbar"),W={title:String,cancelButtonText:String,confirmButtonText:String},Tt=["cancel","confirm","title","toolbar"],Ct=Object.keys(W);var wt=I({name:St,props:W,emits:["confirm","cancel"],setup(e,{emit:n,slots:l}){const i=()=>{if(l.title)return l.title();if(e.title)return a("div",{class:[x("title"),"van-ellipsis"]},[e.title])},o=()=>n("cancel"),c=()=>n("confirm"),v=()=>{const d=e.cancelButtonText||pe("cancel");return a("button",{type:"button",class:[x("cancel"),re],onClick:o},[l.cancel?l.cancel():d])},h=()=>{const d=e.confirmButtonText||pe("confirm");return a("button",{type:"button",class:[x("confirm"),re],onClick:c},[l.confirm?l.confirm():d])};return()=>a("div",{class:x("toolbar")},[l.toolbar?l.toolbar():[v(),i(),h()]])}});const[kt,Gt]=j("picker-group"),Ot=Symbol(kt);H({tabs:G(),activeTab:z(0),nextStepText:String},W);const xt=H({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:z(44),showToolbar:te,swipeDuration:z(1e3),visibleOptionNum:z(6)},W),Et=H({},xt,{columns:G(),modelValue:G(),toolbarPosition:$e("top"),columnsFieldNames:Object});var Pt=I({name:ft,props:Et,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:n,slots:l}){const i=C(),o=C(e.modelValue.slice(0)),{parent:c}=Ce(Ot),{children:v,linkChildren:h}=ke(Ve);h();const d=P(()=>pt(e.columnsFieldNames)),p=P(()=>Le(e.optionHeight)),b=P(()=>vt(e.columns,d.value)),y=P(()=>{const{columns:t}=e;switch(b.value){case"multiple":return t;case"cascade":return ht(t,d.value,o);default:return[t]}}),w=P(()=>y.value.some(t=>t.length)),k=P(()=>y.value.map((t,u)=>ne(t,o.value[u],d.value))),V=P(()=>y.value.map((t,u)=>t.findIndex(r=>r[d.value.value]===o.value[u]))),O=(t,u)=>{if(o.value[t]!==u){const r=o.value.slice(0);r[t]=u,o.value=r}},s=()=>({selectedValues:o.value.slice(0),selectedOptions:k.value,selectedIndexes:V.value}),m=(t,u)=>{O(u,t),b.value==="cascade"&&o.value.forEach((r,E)=>{const $=y.value[E];be($,r,d.value)||O(E,$.length?$[0][d.value.value]:void 0)}),de(()=>{n("change",H({columnIndex:u},s()))})},g=(t,u)=>{const r={columnIndex:u,currentOption:t};n("clickOption",H(s(),r)),n("scrollInto",r)},T=()=>{v.forEach(u=>u.stopMomentum());const t=s();return de(()=>{n("confirm",t)}),t},S=()=>n("cancel",s()),B=()=>y.value.map((t,u)=>a(yt,{value:o.value[u],fields:d.value,options:t,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:p.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:r=>m(r,u),onClickOption:r=>g(r,u),onScrollInto:r=>{n("scrollInto",{currentOption:r,columnIndex:u})}},{option:l.option})),F=t=>{if(w.value){const u={height:`${p.value}px`},r={backgroundSize:`100% ${(t-p.value)/2}px`};return[a("div",{class:x("mask"),style:r},null),a("div",{class:[Ke,x("frame")],style:u},null)]}},M=()=>{const t=p.value*+e.visibleOptionNum,u={height:`${t}px`};return a("div",{ref:i,class:x("columns"),style:u},[B(),F(t)])},A=()=>{if(e.showToolbar&&!c)return a(wt,je(ce(e,Ct),{onConfirm:T,onCancel:S}),ce(l,Tt))};J(y,t=>{t.forEach((u,r)=>{u.length&&!be(u,o.value[r],d.value)&&O(r,Pe(u)[d.value.value])})},{immediate:!0});let N;return J(()=>e.modelValue,t=>{!Q(t,o.value)&&!Q(t,N)&&(o.value=t.slice(0),N=t.slice(0))},{deep:!0}),J(o,t=>{Q(t,e.modelValue)||(N=t.slice(0),n("update:modelValue",N))},{immediate:!0}),we("touchmove",oe,{target:i}),le({confirm:T,getSelectedOptions:()=>k.value}),()=>{var t,u;return a("div",{class:x()},[e.toolbarPosition==="top"?A():null,e.loading?a(Re,{class:x("loading")},null):null,(t=l["columns-top"])==null?void 0:t.call(l),M(),(u=l["columns-bottom"])==null?void 0:u.call(l),e.toolbarPosition==="bottom"?A():null])}}});const ie=Oe(Pt),[It,Vt]=j("form"),Bt={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:Y,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:te,showErrorMessage:te,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var Dt=I({name:It,props:Bt,emits:["submit","failed"],setup(e,{emit:n,slots:l}){const{children:i,linkChildren:o}=ke(Ue),c=s=>s?i.filter(m=>s.includes(m.name)):i,v=s=>new Promise((m,g)=>{const T=[];c(s).reduce((B,F)=>B.then(()=>{if(!T.length)return F.validate().then(M=>{M&&T.push(M)})}),Promise.resolve()).then(()=>{T.length?g(T):m()})}),h=s=>new Promise((m,g)=>{const T=c(s);Promise.all(T.map(S=>S.validate())).then(S=>{S=S.filter(Boolean),S.length?g(S):m()})}),d=s=>{const m=i.find(g=>g.name===s);return m?new Promise((g,T)=>{m.validate().then(S=>{S?T(S):g()})}):Promise.reject()},p=s=>typeof s=="string"?d(s):e.validateFirst?v(s):h(s),b=s=>{typeof s=="string"&&(s=[s]),c(s).forEach(g=>{g.resetValidation()})},y=()=>i.reduce((s,m)=>(s[m.name]=m.getValidationStatus(),s),{}),w=(s,m)=>{i.some(g=>g.name===s?(g.$el.scrollIntoView(m),!0):!1)},k=()=>i.reduce((s,m)=>(m.name!==void 0&&(s[m.name]=m.formValue.value),s),{}),V=()=>{const s=k();p().then(()=>n("submit",s)).catch(m=>{n("failed",{values:s,errors:m}),e.scrollToError&&m[0].name&&w(m[0].name)})},O=s=>{oe(s),V()};return o({props:e}),le({submit:V,validate:p,getValues:k,scrollToField:w,resetValidation:b,getValidationStatus:y}),()=>{var s;return a("form",{class:Vt(),onSubmit:O},[(s=l.default)==null?void 0:s.call(l)])}}});const Mt=Oe(Dt);function Te(e){return typeof e=="function"?e():ze(e)}function Nt(e=!1,n={}){const{truthyValue:l=!0,falsyValue:i=!1}=n,o=Ye(e),c=C(e);function v(h){if(arguments.length)return c.value=h,c.value;{const d=Te(l);return c.value=c.value===d?Te(i):d,c.value}}return o?v:[c,v]}const _t=I({name:"LocaleSelector",setup(){const{changeLocale:e}=mt(),n=C(!1),l=qe.map(o=>({text:o.title,value:o.locale})),i=o=>{R(o),ue(o.selectedValues)&&e(Ge(o.selectedValues[0])),n.value=!1};return()=>a(se,null,[a(_,{plain:!0,hairline:!0,square:!0,type:"primary",size:"small",onClick:()=>{n.value=!0}},{default:()=>[L("语言")]}),a(ae,{show:n.value,round:!0,position:"bottom"},{default:()=>[a(ie,{columns:l,onConfirm:i,onCancel:()=>{n.value=!1}},null)]})])}}),Ht=I({name:"ThemePicker",setup(){const e=xe(),n=C(!1),l=We.map(o=>({text:o.title,value:o.strategy})),i=o=>{if(R(o),n.value=!1,ue(o.selectedValues)){const c=Je(o.selectedValues[0]);e.setDarkStrategy(c),e.setDark(me(c)),Qe(me(c))}};return()=>a(se,null,[a(_,{plain:!0,hairline:!0,type:"primary",size:"small",onClick:()=>{n.value=!0}},{default:()=>[L("深色模式")]}),a(ae,{show:n.value,round:!0,position:"bottom"},{default:()=>[a(ie,{columns:l,onConfirm:i,onCancel:()=>{n.value=!1}},null)]})])}}),Ft=I({name:"ThemeSelector",setup(){const e=xe(),n=C(!1),l=Xe.map(o=>({text:o.title,value:o.theme})),i=o=>{R(o),n.value=!1,ue(o.selectedValues)&&e.setTheme(Ze(o.selectedValues[0]))};return Ee(()=>D(this,null,function*(){R("Component <<ThemeSelector>> mounted.")})),()=>a(se,null,[a(_,{plain:!0,hairline:!0,type:"primary",size:"small",onClick:()=>{n.value=!0}},{default:()=>[L("主题")]}),a(ae,{show:n.value,round:!0,position:"bottom"},{default:()=>[a(ie,{columns:l,onConfirm:i,onCancel:()=>{n.value=!1}},null)]})])}});function At(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!ot(e)}const Wt=I({name:"Login",setup(){const{t:e}=et(),n=tt(),l=nt(),[i,o]=Nt(!1),c=C(),v=fe(lt),h=fe({username:[{required:!0,message:"Please input username"}],password:[{required:!0,message:"Please input password"}]}),d=()=>D(this,null,function*(){yield c.value.validate(),n.login(v).then(()=>{l.push("/")})});return Ee(()=>D(this,null,function*(){R("Page <<Login>> mounted.")})),()=>{let p;return a("div",null,[a(st,{title:e("common.title")},null),a("div",{class:"mt-6"},[a(Mt,{ref:c},{default:()=>[a(ut,{inset:!0},{default:()=>[a(he,{modelValue:v.username,placeholder:e("common.user_field_username"),rules:h.username},{leftIcon:()=>a(X,null,{default:()=>[a(ve,{icon:"ion:person-outline"},null)]})}),a(he,{modelValue:v.password,placeholder:e("common.user_field_password"),rules:h.password,type:i?"password":"text"},{leftIcon:()=>a(X,null,{default:()=>[a(ve,{icon:"ion:lock-closed-outline"},null)]}),rightIcon:()=>a(X,{name:i?"closed-eye":"eye",onClick:()=>o(!i)},null)}),a("div",{class:"my-2"},[a(_,{onClick:d,type:"primary",block:!0},At(p=e("common.button_login"))?p:{default:()=>[p]})])]}),a(at,{class:"px-4 pt-4"},{default:()=>[a(ge,{span:"12",class:"text-left"},{default:()=>[a(it,null,{default:()=>[a(_t,null,null),a(Ht,null,null),a(Ft,null,null)]})]}),a(ge,{span:"12",class:"text-right"},{default:()=>[a(_,{size:"small"},{default:()=>[L("忘记密码")]}),a(_,{size:"small"},{default:()=>[L("注册")]})]})]})]})])])}}});export{Wt as default};
