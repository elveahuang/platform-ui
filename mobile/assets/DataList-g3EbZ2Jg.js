var E=Object.defineProperty;var N=(e,a,n)=>a in e?E(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n;var m=(e,a,n)=>(N(e,typeof a!="symbol"?a+"":a,n),n);var b=(e,a,n)=>new Promise((o,d)=>{var t=r=>{try{f(n.next(r))}catch(s){d(s)}},l=r=>{try{f(n.throw(r))}catch(s){d(s)}},f=r=>r.done?o(r.value):Promise.resolve(r.value).then(t,l);f((n=n.apply(e,a)).next())});import{a_ as L,e as U,m as I,a2 as $,a3 as A,d as y,r as P,a$ as j,f as F,am as R,b0 as O,o as B,ad as V,i as q,b as g,an as H,k,b1 as K,aO as M,x as X,b2 as Y,D as G,l as v,a as J,c as Q,w as x,A as W,U as Z,b3 as ee,X as ae}from"./index-q8XU2Mr1.js";/* empty css                                                                 *//* empty css              */import{t as ne}from"./toNumber-aFkVNKAW.js";import{P as te}from"./index-L9tu-Wm3.js";import{_ as ie}from"./_plugin-vue_export-helper-x3n3nnut.js";const oe=Symbol(),se=()=>L(oe,null),[re,h,le]=U("list"),de={error:Boolean,offset:I(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:$("down"),loadingText:String,finishedText:String,immediateCheck:A};var fe=y({name:re,props:de,emits:["load","update:error","update:loading"],setup(e,{emit:a,slots:n}){const o=P(e.loading),d=P(),t=P(),l=se(),f=j(d),r=F(()=>e.scroller||f.value),s=()=>{H(()=>{if(o.value||e.finished||e.disabled||e.error||(l==null?void 0:l.value)===!1)return;const{direction:i}=e,p=+e.offset,u=k(r);if(!u.height||K(d))return;let S=!1;const z=k(t);i==="up"?S=u.top-z.top<=p:S=z.bottom-u.bottom<=p,S&&(o.value=!0,a("update:loading",!0),a("load"))})},c=()=>{if(e.finished){const i=n.finished?n.finished():e.finishedText;if(i)return g("div",{class:h("finished-text")},[i])}},_=()=>{a("update:error",!1),s()},D=()=>{if(e.error){const i=n.error?n.error():e.errorText;if(i)return g("div",{role:"button",class:h("error-text"),tabindex:0,onClick:_},[i])}},T=()=>{if(o.value&&!e.finished&&!e.disabled)return g("div",{class:h("loading")},[n.loading?n.loading():g(M,{class:h("loading-icon")},{default:()=>[e.loadingText||le("loading")]})])};return R(()=>[e.loading,e.finished,e.error],s),l&&R(l,i=>{i&&s()}),O(()=>{o.value=e.loading}),B(()=>{e.immediateCheck&&s()}),V({check:s}),q("scroll",s,{target:r,passive:!0}),()=>{var i;const p=(i=n.default)==null?void 0:i.call(n),u=g("div",{ref:t,class:h("placeholder")},null);return g("div",{ref:d,role:"feed",class:h(),"aria-busy":o.value},[e.direction==="down"?p:u,T(),c(),D(),e.direction==="up"?p:u])}}});const ce=X(fe);let w=class{constructor(){m(this,"refreshing",!1);m(this,"loading",!1);m(this,"finished",!1);m(this,"pagination",{page:0,size:10,total:0});m(this,"items",[])}};const C=(e={size:12})=>{const a=new w;return e.size>0&&(a.pagination.size=e.size),a},ge=(e,a,n)=>{var o,d,t,l,f,r,s;if((o=a==null?void 0:a.data)!=null&&o.content.length)for(const c of a.data.content)n&&Y(n)?e.items.push(n(c)):e.items.push(c);return e.pagination.page=((t=(d=a==null?void 0:a.data)==null?void 0:d.pageable)==null?void 0:t.pageNumber)+1,e.pagination.size=(f=(l=a==null?void 0:a.data)==null?void 0:l.pageable)==null?void 0:f.pageSize,e.pagination.total=ne((r=a==null?void 0:a.data)==null?void 0:r.totalElements),e.loading=!1,e.refreshing=!1,e.finished=(s=a==null?void 0:a.data)==null?void 0:s.last,e},ue=e=>(e.loading=!0,e.refreshing&&(e.items=[]),{page:e.pagination.page+1,size:e.pagination.size}),Se=()=>({initialize:C,handleResult:ge,handleParams:ue}),me=y({__name:"DataList",props:{model:{type:w,require:!0,default:()=>C()},offset:{type:Number,default:100},refreshDisabled:{type:Boolean,default:!1},loadDisabled:{type:Boolean,default:!1}},emits:["getDataList","resetData","cleanDataList"],setup(e,{expose:a,emit:n}){const o=n,t=G(e.model),l=()=>b(this,null,function*(){v("onLoad..."),t.refreshing&&(v("refreshing"),t.pagination.page=0,t.finished=!1,t.loading=!1),o("getDataList")}),f=()=>{v("onRefresh..."),l()};return a({dataRefresh:()=>b(this,null,function*(){o("resetData"),o("getDataList")})}),B(()=>b(this,null,function*(){v("Component <<DataList>> mounted.")})),(s,c)=>{const _=ae,D=ce,T=te;return J(),Q(T,{"model-value":t.refreshing,"onUpdate:modelValue":c[1]||(c[1]=i=>t.refreshing=i),onRefresh:f,disabled:e.refreshDisabled},{loading:x(()=>[g(_,null,{default:x(()=>[g(W(Z),{icon:"ep:loading"})]),_:1})]),default:x(()=>[g(D,{loading:t.loading,"onUpdate:loading":c[0]||(c[0]=i=>t.loading=i),finished:t.finished,offset:e.offset,onLoad:l},{default:x(()=>[ee(s.$slots,"default",{},void 0,!0)]),_:3},8,["loading","finished","offset"])]),_:3},8,["model-value","disabled"])}}}),Pe=ie(me,[["__scopeId","data-v-990cdf66"]]);export{Pe as D,Se as u};
