var X=Object.defineProperty;var q=(e,t,n)=>t in e?X(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var p=(e,t,n)=>(q(e,typeof t!="symbol"?t+"":t,n),n);var w=(e,t,n)=>new Promise((l,i)=>{var f=s=>{try{o(n.next(s))}catch(r){i(r)}},g=s=>{try{o(n.throw(s))}catch(r){i(r)}},o=s=>s.done?l(s.value):Promise.resolve(s.value).then(f,g);o((n=n.apply(e,t)).next())});import{R as K,S as V,T as $,U as O,V as W,d as z,k as P,W as U,C as Z,G as B,X as J,g as I,Y as Q,Z as N,h as u,_ as A,$ as C,a0 as ee,a1 as Y,a2 as F,a3 as te,f as L,a4 as ae,a5 as ne,a6 as oe,a7 as se,l as y,o as ie,a as le,w as H,I as re,u as ce,a8 as de,n as ue}from"./index-9yh00f_X.js";/* empty css              *//* empty css                                                                 *//* empty css              */import{t as fe}from"./toNumber-_GecnYDJ.js";import{_ as ge}from"./_plugin-vue_export-helper-x3n3nnut.js";const he=Symbol(),me=()=>K(he,null),[ve,x,Te]=V("list"),pe={error:Boolean,offset:$(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:O("down"),loadingText:String,finishedText:String,immediateCheck:W};var xe=z({name:ve,props:pe,emits:["load","update:error","update:loading"],setup(e,{emit:t,slots:n}){const l=P(e.loading),i=P(),f=P(),g=me(),o=U(i),s=Z(()=>e.scroller||o.value),r=()=>{A(()=>{if(l.value||e.finished||e.disabled||e.error||(g==null?void 0:g.value)===!1)return;const{direction:d}=e,T=+e.offset,v=C(s);if(!v.height||ee(i))return;let S=!1;const E=C(f);d==="up"?S=v.top-E.top<=T:S=E.bottom-v.bottom<=T,S&&(l.value=!0,t("update:loading",!0),t("load"))})},m=()=>{if(e.finished){const d=n.finished?n.finished():e.finishedText;if(d)return u("div",{class:x("finished-text")},[d])}},D=()=>{t("update:error",!1),r()},h=()=>{if(e.error){const d=n.error?n.error():e.errorText;if(d)return u("div",{role:"button",class:x("error-text"),tabindex:0,onClick:D},[d])}},k=()=>{if(l.value&&!e.finished&&!e.disabled)return u("div",{class:x("loading")},[n.loading?n.loading():u(Y,{class:x("loading-icon")},{default:()=>[e.loadingText||Te("loading")]})])};return B(()=>[e.loading,e.finished,e.error],r),g&&B(g,d=>{d&&r()}),J(()=>{l.value=e.loading}),I(()=>{e.immediateCheck&&r()}),Q({check:r}),N("scroll",r,{target:s,passive:!0}),()=>{var d;const T=(d=n.default)==null?void 0:d.call(n),v=u("div",{ref:f,class:x("placeholder")},null);return u("div",{ref:i,role:"feed",class:x(),"aria-busy":l.value},[e.direction==="down"?T:v,k(),m(),h(),e.direction==="up"?T:v])}}});const De=F(xe),[Se,_,be]=V("pull-refresh"),M=50,_e=["pulling","loosing","success"],Pe={disabled:Boolean,modelValue:Boolean,headHeight:$(M),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:te,successDuration:$(500),animationDuration:$(300)};var ke=z({name:Se,props:Pe,emits:["change","refresh","update:modelValue"],setup(e,{emit:t,slots:n}){let l;const i=P(),f=P(),g=U(i),o=L({status:"normal",distance:0,duration:0}),s=ae(),r=()=>{if(e.headHeight!==M)return{height:`${e.headHeight}px`}},m=()=>o.status!=="loading"&&o.status!=="success"&&!e.disabled,D=a=>{const c=+(e.pullDistance||e.headHeight);return a>c&&(a<c*2?a=c+(a-c)/2:a=c*1.5+(a-c*2)/4),Math.round(a)},h=(a,c)=>{const b=+(e.pullDistance||e.headHeight);o.distance=a,c?o.status="loading":a===0?o.status="normal":a<b?o.status="pulling":o.status="loosing",t("change",{status:o.status,distance:a})},k=()=>{const{status:a}=o;return a==="normal"?"":e[`${a}Text`]||be(a)},d=()=>{const{status:a,distance:c}=o;if(n[a])return n[a]({distance:c});const b=[];return _e.includes(a)&&b.push(u("div",{class:_("text")},[k()])),a==="loading"&&b.push(u(Y,{class:_("loading")},{default:k})),b},T=()=>{o.status="success",setTimeout(()=>{h(0)},+e.successDuration)},v=a=>{l=oe(g.value)===0,l&&(o.duration=0,s.start(a))},S=a=>{m()&&v(a)},E=a=>{if(m()){l||v(a);const{deltaY:c}=s;s.move(a),l&&c.value>=0&&s.isVertical()&&(ne(a),h(D(c.value)))}},R=()=>{l&&s.deltaY.value&&m()&&(o.duration=+e.animationDuration,o.status==="loosing"?(h(+e.headHeight,!0),t("update:modelValue",!0),A(()=>t("refresh"))):h(0))};return B(()=>e.modelValue,a=>{o.duration=+e.animationDuration,a?h(+e.headHeight,!0):n.success||e.successText?T():h(0,!1)}),N("touchmove",E,{target:f}),()=>{var a;const c={transitionDuration:`${o.duration}ms`,transform:o.distance?`translate3d(0,${o.distance}px, 0)`:""};return u("div",{ref:i,class:_()},[u("div",{ref:f,class:_("track"),style:c,onTouchstartPassive:S,onTouchend:R,onTouchcancel:R},[u("div",{class:_("head"),style:r()},[d()]),(a=n.default)==null?void 0:a.call(n)])])}}});const Ee=F(ke);let j=class{constructor(){p(this,"refreshing",!1);p(this,"loading",!1);p(this,"finished",!1);p(this,"pagination",{page:1,size:10,total:0});p(this,"items",[])}};const G=(e={page:1,size:12})=>{const t=new j;return e.page>0&&(t.pagination.page=e.page),e.size>0&&(t.pagination.size=e.size),t},He=(e,t,n)=>{var l,i,f,g,o,s,r;if((l=t==null?void 0:t.data)!=null&&l.content.length)for(const m of t.data.content)n&&se(n)?e.items.push(n(m)):e.items.push(m);return e.pagination.page=((f=(i=t==null?void 0:t.data)==null?void 0:i.pageable)==null?void 0:f.pageNumber)+1,e.pagination.size=(o=(g=t==null?void 0:t.data)==null?void 0:g.pageable)==null?void 0:o.pageSize,e.pagination.total=fe((s=t==null?void 0:t.data)==null?void 0:s.totalElements),e.loading=!1,e.refreshing=!1,(r=t==null?void 0:t.data)!=null&&r.last&&(e.finished=!0),e},$e=e=>(e.loading=!0,e.refreshing&&(e.items=[]),{page:e.pagination.page<=0?1:e.pagination.page+1,size:e.pagination.size}),Ne=()=>({initialize:G,handleResult:He,handleParams:$e}),ye=z({__name:"DataList",props:{model:{type:j,require:!0,default:()=>G()},offset:{type:Number,default:100},refreshDisabled:{type:Boolean,default:!1},loadDisabled:{type:Boolean,default:!1}},emits:["getDataList"],setup(e,{emit:t}){const n=t,i=L(e.model),f=()=>{y("onLoad..."),i.refreshing&&(i.pagination.page=1,i.finished=!1,i.loading=!1),n("getDataList")},g=()=>{y("onRefresh..."),f()};return I(()=>w(this,null,function*(){y("Component <<DataList>> mounted.")})),(o,s)=>{const r=ue,m=De,D=Ee;return ie(),le(D,{"model-value":i.refreshing,"onUpdate:modelValue":s[1]||(s[1]=h=>i.refreshing=h),onRefresh:g,disabled:e.refreshDisabled},{loading:H(()=>[u(r,null,{default:H(()=>[u(ce(re),{icon:"ep:loading"})]),_:1})]),default:H(()=>[u(m,{loading:i.loading,"onUpdate:loading":s[0]||(s[0]=h=>i.loading=h),finished:i.finished,offset:e.offset,onLoad:f},{default:H(()=>[de(o.$slots,"default",{},void 0,!0)]),_:3},8,["loading","finished","offset"])]),_:3},8,["model-value","disabled"])}}}),Ae=ge(ye,[["__scopeId","data-v-ef0e2366"]]);export{Ae as D,Ne as u};
