var N=Object.defineProperty;var L=(e,a,n)=>a in e?N(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n;var m=(e,a,n)=>L(e,typeof a!="symbol"?a+"":a,n);var v=(e,a,n)=>new Promise((o,l)=>{var t=r=>{try{f(n.next(r))}catch(s){l(s)}},d=r=>{try{f(n.throw(r))}catch(s){l(s)}},f=r=>r.done?o(r.value):Promise.resolve(r.value).then(t,d);f((n=n.apply(e,a)).next())});import{e as I,m as U,aD as j,aE as $,d as B,r as z,bj as F,g as V,C as y,bR as q,o as C,aK as H,j as K,b as g,aU as M,p as k,bp as O,bb as A,y as G,bS as J,ab as Q,l as x,a as W,ag as X,w as D,u as h,at as Y,bT as Z,av as ee}from"./index-CeLFf6qY.js";/* empty css              *//* empty css                                                                      *//* empty css              */import{t as ae}from"./toNumber-HqCGrJHJ.js";import{u as ne}from"./use-tab-status-DDhQd1RK.js";import{P as te}from"./index-DUdUq8sb.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";const[oe,p,se]=I("list"),re={error:Boolean,offset:U(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:j("down"),loadingText:String,finishedText:String,immediateCheck:$};var de=B({name:oe,props:re,emits:["load","update:error","update:loading"],setup(e,{emit:a,slots:n}){const o=z(e.loading),l=z(),t=z(),d=ne(),f=F(l),r=V(()=>e.scroller||f.value),s=()=>{M(()=>{if(o.value||e.finished||e.disabled||e.error||(d==null?void 0:d.value)===!1)return;const{direction:i}=e,b=+e.offset,u=k(r);if(!u.height||O(l))return;let R=!1;const S=k(t);i==="up"?R=u.top-S.top<=b:R=S.bottom-u.bottom<=b,R&&(o.value=!0,a("update:loading",!0),a("load"))})},c=()=>{if(e.finished){const i=n.finished?n.finished():e.finishedText;if(i)return g("div",{class:p("finished-text")},[i])}},_=()=>{a("update:error",!1),s()},T=()=>{if(e.error){const i=n.error?n.error():e.errorText;if(i)return g("div",{role:"button",class:p("error-text"),tabindex:0,onClick:_},[i])}},P=()=>{if(o.value&&!e.finished&&!e.disabled)return g("div",{class:p("loading")},[n.loading?n.loading():g(A,{class:p("loading-icon")},{default:()=>[e.loadingText||se("loading")]})])};return y(()=>[e.loading,e.finished,e.error],s),d&&y(d,i=>{i&&s()}),q(()=>{o.value=e.loading}),C(()=>{e.immediateCheck&&s()}),H({check:s}),K("scroll",s,{target:r,passive:!0}),()=>{var i;const b=(i=n.default)==null?void 0:i.call(n),u=g("div",{ref:t,class:p("placeholder")},null);return g("div",{ref:l,role:"feed",class:p(),"aria-busy":o.value},[e.direction==="down"?b:u,P(),c(),T(),e.direction==="up"?b:u])}}});const le=G(de);let w=class{constructor(){m(this,"refreshing",!1);m(this,"loading",!1);m(this,"finished",!1);m(this,"pagination",{page:0,size:10,total:0});m(this,"items",[])}};const E=(e={size:12})=>{const a=new w;return e.size>0&&(a.pagination.size=e.size),a},fe=(e,a,n)=>{var o,l,t,d,f,r,s;if((o=a==null?void 0:a.data)!=null&&o.content.length)for(const c of a.data.content)n&&J(n)?e.items.push(n(c)):e.items.push(c);return e.pagination.page=((t=(l=a==null?void 0:a.data)==null?void 0:l.pageable)==null?void 0:t.pageNumber)+1,e.pagination.size=(f=(d=a==null?void 0:a.data)==null?void 0:d.pageable)==null?void 0:f.pageSize,e.pagination.total=ae((r=a==null?void 0:a.data)==null?void 0:r.totalElements),e.loading=!1,e.refreshing=!1,e.finished=(s=a==null?void 0:a.data)==null?void 0:s.last,e},ce=e=>(e.loading=!0,e.refreshing&&(e.items=[]),{page:e.pagination.page+1,size:e.pagination.size}),Pe=()=>({initialize:E,handleResult:fe,handleParams:ce}),ge=B({__name:"DataList",props:{model:{type:w,require:!0,default:()=>E()},offset:{type:Number,default:100},refreshDisabled:{type:Boolean,default:!1},loadDisabled:{type:Boolean,default:!1}},emits:["getDataList","resetData","cleanDataList"],setup(e,{expose:a,emit:n}){const o=n,t=Q(e.model),d=()=>v(this,null,function*(){x("onLoad..."),t.refreshing&&(x("refreshing"),t.pagination.page=0,t.finished=!1,t.loading=!1),o("getDataList")}),f=()=>{x("onRefresh..."),d()};return a({dataRefresh:()=>v(this,null,function*(){o("resetData"),o("getDataList")})}),C(()=>v(this,null,function*(){x("Component <<DataList>> mounted.")})),(s,c)=>{const _=ee,T=le,P=te;return W(),X(P,{"model-value":h(t).refreshing,"onUpdate:modelValue":c[1]||(c[1]=i=>h(t).refreshing=i),disabled:e.refreshDisabled,onRefresh:f},{loading:D(()=>[g(_,null,{default:D(()=>[g(h(Y),{icon:"ep:loading"})]),_:1})]),default:D(()=>[g(T,{loading:h(t).loading,"onUpdate:loading":c[0]||(c[0]=i=>h(t).loading=i),finished:h(t).finished,offset:e.offset,onLoad:d},{default:D(()=>[Z(s.$slots,"default",{},void 0,!0)]),_:3},8,["loading","finished","offset"])]),_:3},8,["model-value","disabled"])}}}),Re=ie(ge,[["__scopeId","data-v-0f7b5eb1"]]);export{Re as D,Pe as u};
