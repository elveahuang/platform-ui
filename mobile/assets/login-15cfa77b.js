var R=(e,t,n)=>new Promise((c,o)=>{var i=u=>{try{f(n.next(u))}catch(y){o(y)}},d=u=>{try{f(n.throw(u))}catch(y){o(y)}},f=u=>u.done?c(u.value):Promise.resolve(u.value).then(i,d);f((n=n.apply(e,t)).next())});import{u as Ye,s as qe,i as W,l as Ge,n as L,t as A,a as Be,o as We,b as De,c as Ze,w as F,g as Je,p as q,r as k,d as H,e as D,f as ee,h as l,T as _e,j as $,k as Qe,m as fe,q as Ve,v as Ne,x as te,y as Z,z as V,A as ce,B as me,C as Xe,D as et,E as tt,F as ne,G as nt,H as Ae,I as ie,J as G,K as X,L as Me,M as ot,N as J,O as Le,P as at,Q as le,R as ye,S as lt,U as st,V as ct,W as U,X as Y,Y as ve,Z as it,_ as $e,$ as rt,a0 as ut,a1 as be,a2 as dt,a3 as ft,a4 as mt,a5 as vt,a6 as ht,a7 as gt,a8 as pe,a9 as Ce,aa as yt,ab as bt}from"./index-c9df18ac.js";import{u as Re,a as oe,L as pt,B as z,F as we,R as Ct,C as Se}from"./index-36973933.js";import{P as wt,H as re,I as Q,B as St,F as Ot}from"./index-c327874a.js";import{c as kt}from"./interceptor-8607a858.js";import{N as Tt}from"./index-b6ab489f.js";import{C as It}from"./index-87e7894e.js";import{S as xt}from"./index-58813b36.js";import"./use-route-80960c03.js";import"./use-placeholder-8e03f396.js";const Pt=e=>R(void 0,null,function*(){W.mode==="legacy"?W.global.locale=e:W.global.locale.value=e}),Et=e=>R(void 0,null,function*(){W.global.setLocaleMessage(e,yield Ge(e))}),Bt=e=>R(void 0,null,function*(){yield Ye().setLocale(e),yield Et(e),yield Pt(e),yield qe(e)}),Dt=()=>({changeLocale:Bt}),_t={show:Boolean,zIndex:L,overlay:A,duration:L,teleport:[String,Object],lockScroll:A,lazyRender:A,beforeClose:Function,overlayStyle:Object,overlayClass:Be,transitionAppear:Boolean,closeOnClickOverlay:A};let j=0;const Oe="van-overflow-hidden";function Vt(e,t){const n=Re(),c="01",o="10",i=g=>{n.move(g);const b=n.deltaY.value>0?o:c,x=Je(g.target,e.value),{scrollHeight:T,offsetHeight:P,scrollTop:I}=x;let s="11";I===0?s=P>=T?"00":"01":I+P>=T&&(s="10"),s!=="11"&&n.isVertical()&&!(parseInt(s,2)&parseInt(b,2))&&q(g,!0)},d=()=>{document.addEventListener("touchstart",n.start),document.addEventListener("touchmove",i,{passive:!1}),j||document.body.classList.add(Oe),j++},f=()=>{j&&(document.removeEventListener("touchstart",n.start),document.removeEventListener("touchmove",i),j--,j||document.body.classList.remove(Oe))},u=()=>t()&&d(),y=()=>t()&&f();We(u),De(y),Ze(y),F(t,g=>{g?d():f()})}function He(e){const t=k(!1);return F(e,n=>{n&&(t.value=n)},{immediate:!0}),n=>()=>t.value?n():null}const[Nt,At]=H("overlay"),Mt={show:Boolean,zIndex:L,duration:L,className:Be,lockScroll:A,lazyRender:A,customStyle:Object};var Lt=D({name:Nt,props:Mt,setup(e,{slots:t}){const n=k(),c=He(()=>e.show||!e.lazyRender),o=d=>{e.lockScroll&&q(d,!0)},i=c(()=>{var d;const f=$(Qe(e.zIndex),e.customStyle);return fe(e.duration)&&(f.animationDuration=`${e.duration}s`),Ve(l("div",{ref:n,style:f,class:[At(),e.className]},[(d=t.default)==null?void 0:d.call(t)]),[[Ne,e.show]])});return ee("touchmove",o,{target:n}),()=>l(_e,{name:"van-fade",appear:!0},{default:i})}});const $t=te(Lt),Rt=$({},_t,{round:Boolean,position:Z("center"),closeIcon:Z("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:Z("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Ht,ke]=H("popup");var Ft=D({name:Ht,inheritAttrs:!1,props:Rt,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:n,slots:c}){let o,i;const d=k(),f=k(),u=He(()=>e.show||!e.lazyRender),y=V(()=>{const p={zIndex:d.value};if(fe(e.duration)){const O=e.position==="center"?"animationDuration":"transitionDuration";p[O]=`${e.duration}s`}return p}),g=()=>{o||(o=!0,d.value=e.zIndex!==void 0?+e.zIndex:nt(),t("open"))},b=()=>{o&&kt(e.beforeClose,{done(){o=!1,t("close"),t("update:show",!1)}})},x=p=>{t("clickOverlay",p),e.closeOnClickOverlay&&b()},T=()=>{if(e.overlay)return l($t,{show:e.show,class:e.overlayClass,zIndex:d.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:x},{default:c["overlay-content"]})},P=p=>{t("clickCloseIcon",p),b()},I=()=>{if(e.closeable)return l(Q,{role:"button",tabindex:0,name:e.closeIcon,class:[ke("close-icon",e.closeIconPosition),re],classPrefix:e.iconPrefix,onClick:P},null)};let s;const v=()=>{s&&clearTimeout(s),s=setTimeout(()=>{t("opened")})},C=()=>t("closed"),S=p=>t("keydown",p),w=u(()=>{var p;const{round:O,position:E,safeAreaInsetTop:B,safeAreaInsetBottom:h}=e;return Ve(l("div",Ae({ref:f,style:y.value,role:"dialog",tabindex:0,class:[ke({round:O,[E]:E}),{"van-safe-area-top":B,"van-safe-area-bottom":h}],onKeydown:S},n),[(p=c.default)==null?void 0:p.call(c),I()]),[[Ne,e.show]])}),_=()=>{const{position:p,transition:O,transitionAppear:E}=e,B=p==="center"?"van-fade":`van-popup-slide-${p}`;return l(_e,{name:O||B,appear:E,onAfterEnter:v,onAfterLeave:C},{default:w})};return F(()=>e.show,p=>{p&&!o&&(g(),n.tabindex===0&&ce(()=>{var O;(O=f.value)==null||O.focus()})),!p&&o&&(o=!1,t("close"))}),oe({popupRef:f}),Vt(f,()=>e.show&&e.lockScroll),ee("popstate",()=>{e.closeOnPopstate&&(b(),i=!1)}),me(()=>{e.show&&g()}),Xe(()=>{i&&(t("update:show",!0),i=!1)}),De(()=>{e.show&&e.teleport&&(b(),i=!0)}),et(wt,()=>e.show),()=>e.teleport?l(tt,{to:e.teleport},{default:()=>[T(),_()]}):l(ne,null,[T(),_()])}});const he=te(Ft),[zt,N,Te]=H("picker"),Fe=e=>e.find(t=>!t.disabled)||e[0];function Kt(e,t){const n=e[0];if(n){if(Array.isArray(n))return"multiple";if(t.children in n)return"cascade"}return"default"}function ue(e,t){t=ie(t,0,e.length);for(let n=t;n<e.length;n++)if(!e[n].disabled)return n;for(let n=t-1;n>=0;n--)if(!e[n].disabled)return n;return 0}const Ie=(e,t,n)=>t!==void 0&&!!e.find(c=>c[n.value]===t);function de(e,t,n){const c=e.findIndex(i=>i[n.value]===t),o=ue(e,c);return e[o]}function jt(e,t,n){const c=[];let o={[t.children]:e},i=0;for(;o&&o[t.children];){const d=o[t.children],f=n.value[i];if(o=fe(f)?de(d,f,t):void 0,!o&&d.length){const u=Fe(d)[t.value];o=de(d,u,t)}i++,c.push(d)}return c}function Ut(e){const{transform:t}=window.getComputedStyle(e),n=t.slice(7,t.length-1).split(", ")[5];return Number(n)}function Yt(e){return $({text:"text",value:"value",children:"children"},e)}const xe=200,Pe=300,qt=15,[ze,se]=H("picker-column"),Ke=Symbol(ze);var Gt=D({name:ze,props:{value:L,fields:G(Object),options:X(),readonly:Boolean,allowHtml:Boolean,optionHeight:G(Number),swipeDuration:G(L),visibleOptionNum:G(L)},emits:["change","clickOption","scrollInto"],setup(e,{emit:t,slots:n}){let c,o,i,d,f;const u=k(),y=k(),g=k(0),b=k(0),x=Re(),T=()=>e.options.length,P=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,I=h=>{const a=ue(e.options,h),r=-a*e.optionHeight,m=()=>{const M=e.options[a][e.fields.value];M!==e.value&&t("change",M)};c&&r!==g.value?f=m:m(),g.value=r},s=()=>e.readonly||!e.options.length,v=h=>{c||s()||(f=null,b.value=xe,I(h),t("clickOption",e.options[h]))},C=h=>ie(Math.round(-h/e.optionHeight),0,T()-1),S=V(()=>C(g.value)),w=(h,a)=>{const r=Math.abs(h/a);h=g.value+r/.003*(h<0?-1:1);const m=C(h);b.value=+e.swipeDuration,I(m)},_=()=>{c=!1,b.value=0,f&&(f(),f=null)},p=h=>{if(!s()){if(x.start(h),c){const a=Ut(y.value);g.value=Math.min(0,a-P())}b.value=0,o=g.value,i=Date.now(),d=o,f=null}},O=h=>{if(s())return;x.move(h),x.isVertical()&&(c=!0,q(h,!0));const a=ie(o+x.deltaY.value,-(T()*e.optionHeight),e.optionHeight),r=C(a);r!==S.value&&t("scrollInto",e.options[r]),g.value=a;const m=Date.now();m-i>Pe&&(i=m,d=a)},E=()=>{if(s())return;const h=g.value-d,a=Date.now()-i;if(a<Pe&&Math.abs(h)>qt){w(h,a);return}const m=C(g.value);b.value=xe,I(m),setTimeout(()=>{c=!1},0)},B=()=>{const h={height:`${e.optionHeight}px`};return e.options.map((a,r)=>{const m=a[e.fields.text],{disabled:M}=a,K=a[e.fields.value],je={role:"button",style:h,tabindex:M?-1:0,class:[se("item",{disabled:M,selected:K===e.value}),a.className],onClick:()=>v(r)},Ue={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:m};return l("li",je,[n.option?n.option(a,r):l("div",Ue,null)])})};return Me(Ke),oe({stopMomentum:_}),ot(()=>{const h=e.options.findIndex(m=>m[e.fields.value]===e.value),r=-ue(e.options,h)*e.optionHeight;g.value=r}),ee("touchmove",O,{target:u}),()=>l("div",{ref:u,class:se(),onTouchstartPassive:p,onTouchend:E,onTouchcancel:E},[l("ul",{ref:y,style:{transform:`translate3d(0, ${g.value+P()}px, 0)`,transitionDuration:`${b.value}ms`,transitionProperty:b.value?"all":"none"},class:se("wrapper"),onTransitionend:_},[B()])])}});const[Wt]=H("picker-toolbar"),ae={title:String,cancelButtonText:String,confirmButtonText:String},Zt=["cancel","confirm","title","toolbar"],Jt=Object.keys(ae);var Qt=D({name:Wt,props:ae,emits:["confirm","cancel"],setup(e,{emit:t,slots:n}){const c=()=>{if(n.title)return n.title();if(e.title)return l("div",{class:[N("title"),"van-ellipsis"]},[e.title])},o=()=>t("cancel"),i=()=>t("confirm"),d=()=>{const u=e.cancelButtonText||Te("cancel");return l("button",{type:"button",class:[N("cancel"),re],onClick:o},[n.cancel?n.cancel():u])},f=()=>{const u=e.confirmButtonText||Te("confirm");return l("button",{type:"button",class:[N("confirm"),re],onClick:i},[n.confirm?n.confirm():u])};return()=>l("div",{class:N("toolbar")},[n.toolbar?n.toolbar():[d(),c(),f()]])}});const[Xt,Tn]=H("picker-group"),en=Symbol(Xt);$({tabs:X(),activeTab:J(0),nextStepText:String},ae);const tn=$({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:J(44),showToolbar:A,swipeDuration:J(1e3),visibleOptionNum:J(6)},ae),nn=$({},tn,{columns:X(),modelValue:X(),toolbarPosition:Z("top"),columnsFieldNames:Object});var on=D({name:zt,props:nn,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:t,slots:n}){const c=k(),o=k(e.modelValue.slice(0)),{parent:i}=Me(en),{children:d,linkChildren:f}=Le(Ke);f();const u=V(()=>Yt(e.columnsFieldNames)),y=V(()=>at(e.optionHeight)),g=V(()=>Kt(e.columns,u.value)),b=V(()=>{const{columns:a}=e;switch(g.value){case"multiple":return a;case"cascade":return jt(a,u.value,o);default:return[a]}}),x=V(()=>b.value.some(a=>a.length)),T=V(()=>b.value.map((a,r)=>de(a,o.value[r],u.value))),P=V(()=>b.value.map((a,r)=>a.findIndex(m=>m[u.value.value]===o.value[r]))),I=(a,r)=>{if(o.value[a]!==r){const m=o.value.slice(0);m[a]=r,o.value=m}},s=()=>({selectedValues:o.value.slice(0),selectedOptions:T.value,selectedIndexes:P.value}),v=(a,r)=>{I(r,a),g.value==="cascade"&&o.value.forEach((m,M)=>{const K=b.value[M];Ie(K,m,u.value)||I(M,K.length?K[0][u.value.value]:void 0)}),ce(()=>{t("change",$({columnIndex:r},s()))})},C=(a,r)=>{const m={columnIndex:r,currentOption:a};t("clickOption",$(s(),m)),t("scrollInto",m)},S=()=>{d.forEach(r=>r.stopMomentum());const a=s();return ce(()=>{t("confirm",a)}),a},w=()=>t("cancel",s()),_=()=>b.value.map((a,r)=>l(Gt,{value:o.value[r],fields:u.value,options:a,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:y.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:m=>v(m,r),onClickOption:m=>C(m,r),onScrollInto:m=>{t("scrollInto",{currentOption:m,columnIndex:r})}},{option:n.option})),p=a=>{if(x.value){const r={height:`${y.value}px`},m={backgroundSize:`100% ${(a-y.value)/2}px`};return[l("div",{class:N("mask"),style:m},null),l("div",{class:[St,N("frame")],style:r},null)]}},O=()=>{const a=y.value*+e.visibleOptionNum,r={height:`${a}px`};return l("div",{ref:c,class:N("columns"),style:r},[_(),p(a)])},E=()=>{if(e.showToolbar&&!i)return l(Qt,Ae(ye(e,Jt),{onConfirm:S,onCancel:w}),ye(n,Zt))};F(b,a=>{a.forEach((r,m)=>{r.length&&!Ie(r,o.value[m],u.value)&&I(m,Fe(r)[u.value.value])})},{immediate:!0});let B;return F(()=>e.modelValue,a=>{!le(a,o.value)&&!le(a,B)&&(o.value=a.slice(0),B=a.slice(0))},{deep:!0}),F(o,a=>{le(a,e.modelValue)||(B=a.slice(0),t("update:modelValue",B))},{immediate:!0}),ee("touchmove",q,{target:c}),oe({confirm:S,getSelectedOptions:()=>T.value}),()=>{var a,r;return l("div",{class:N()},[e.toolbarPosition==="top"?E():null,e.loading?l(pt,{class:N("loading")},null):null,(a=n["columns-top"])==null?void 0:a.call(n),O(),(r=n["columns-bottom"])==null?void 0:r.call(n),e.toolbarPosition==="bottom"?E():null])}}});const ge=te(on),[an,ln]=H("form"),sn={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:L,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:A,showErrorMessage:A,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var cn=D({name:an,props:sn,emits:["submit","failed"],setup(e,{emit:t,slots:n}){const{children:c,linkChildren:o}=Le(Ot),i=s=>s?c.filter(v=>s.includes(v.name)):c,d=s=>new Promise((v,C)=>{const S=[];i(s).reduce((_,p)=>_.then(()=>{if(!S.length)return p.validate().then(O=>{O&&S.push(O)})}),Promise.resolve()).then(()=>{S.length?C(S):v()})}),f=s=>new Promise((v,C)=>{const S=i(s);Promise.all(S.map(w=>w.validate())).then(w=>{w=w.filter(Boolean),w.length?C(w):v()})}),u=s=>{const v=c.find(C=>C.name===s);return v?new Promise((C,S)=>{v.validate().then(w=>{w?S(w):C()})}):Promise.reject()},y=s=>typeof s=="string"?u(s):e.validateFirst?d(s):f(s),g=s=>{typeof s=="string"&&(s=[s]),i(s).forEach(C=>{C.resetValidation()})},b=()=>c.reduce((s,v)=>(s[v.name]=v.getValidationStatus(),s),{}),x=(s,v)=>{c.some(C=>C.name===s?(C.$el.scrollIntoView(v),!0):!1)},T=()=>c.reduce((s,v)=>(v.name!==void 0&&(s[v.name]=v.formValue.value),s),{}),P=()=>{const s=T();y().then(()=>t("submit",s)).catch(v=>{t("failed",{values:s,errors:v}),e.scrollToError&&v[0].name&&x(v[0].name)})},I=s=>{q(s),P()};return o({props:e}),oe({submit:P,validate:y,getValues:T,scrollToField:x,resetValidation:g,getValidationStatus:b}),()=>{var s;return l("form",{class:ln(),onSubmit:I},[(s=n.default)==null?void 0:s.call(n)])}}});const rn=te(cn);function Ee(e){return typeof e=="function"?e():st(e)}function un(e=!1,t={}){const{truthyValue:n=!0,falsyValue:c=!1}=t,o=lt(e),i=k(e);function d(f){if(arguments.length)return i.value=f,i.value;{const u=Ee(n);return i.value=i.value===u?Ee(c):u,i.value}}return o?d:[i,d]}const dn=D({name:"LocaleSelector",setup(){const{changeLocale:e}=Dt(),t=k(!1),n=ct.map(o=>({text:o.title,value:o.locale})),c=o=>{Y(o),ve(o.selectedValues)&&e(it(o.selectedValues[0])),t.value=!1};return()=>l(ne,null,[l(z,{plain:!0,hairline:!0,square:!0,type:"primary",size:"small",onClick:()=>{t.value=!0}},{default:()=>[U("语言")]}),l(he,{show:t.value,round:!0,position:"bottom"},{default:()=>[l(ge,{columns:n,onConfirm:c,onCancel:()=>{t.value=!1}},null)]})])}}),fn=D({name:"ThemePicker",setup(){const e=$e(),t=k(!1),n=rt.map(o=>({text:o.title,value:o.strategy})),c=o=>{if(Y(o),t.value=!1,ve(o.selectedValues)){const i=ut(o.selectedValues[0]);e.setDarkStrategy(i),e.setDark(be(i)),dt(be(i))}};return()=>l(ne,null,[l(z,{plain:!0,hairline:!0,type:"primary",size:"small",onClick:()=>{t.value=!0}},{default:()=>[U("深色模式")]}),l(he,{show:t.value,round:!0,position:"bottom"},{default:()=>[l(ge,{columns:n,onConfirm:c,onCancel:()=>{t.value=!1}},null)]})])}}),mn=D({name:"ThemeSelector",setup(){const e=$e(),t=k(!1),n=ft.map(o=>({text:o.title,value:o.theme})),c=o=>{Y(o),t.value=!1,ve(o.selectedValues)&&e.setTheme(mt(o.selectedValues[0]))};return me(()=>R(this,null,function*(){Y("Component <<ThemeSelector>> mounted.")})),()=>l(ne,null,[l(z,{plain:!0,hairline:!0,type:"primary",size:"small",onClick:()=>{t.value=!0}},{default:()=>[U("主题")]}),l(he,{show:t.value,round:!0,position:"bottom"},{default:()=>[l(ge,{columns:n,onConfirm:c,onCancel:()=>{t.value=!1}},null)]})])}});function vn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!yt(e)}const In=D({name:"Login",setup(){const{t:e}=vt(),t=ht(),n=gt(),[c,o]=un(!1),i=k(),d=pe(bt),f=pe({username:[{required:!0,message:"Please input username"}],password:[{required:!0,message:"Please input password"}]}),u=()=>R(this,null,function*(){yield i.value.validate(),t.login(d).then(()=>{n.push("/")})});return me(()=>R(this,null,function*(){Y("Page <<Login>> mounted.")})),()=>{let y;return l("div",null,[l(Tt,{title:e("common.title")},null),l("div",{class:"mt-6"},[l(rn,{ref:i},{default:()=>[l(It,{inset:!0},{default:()=>[l(we,{modelValue:d.username,placeholder:e("common.user_field_username"),rules:f.username},{leftIcon:()=>l(Q,null,{default:()=>[l(Ce,{icon:"ion:person-outline"},null)]})}),l(we,{modelValue:d.password,placeholder:e("common.user_field_password"),rules:f.password,type:c?"password":"text"},{leftIcon:()=>l(Q,null,{default:()=>[l(Ce,{icon:"ion:lock-closed-outline"},null)]}),rightIcon:()=>l(Q,{name:c?"closed-eye":"eye",onClick:()=>o(!c)},null)}),l("div",{class:"my-2"},[l(z,{onClick:u,type:"primary",block:!0},vn(y=e("common.button_login"))?y:{default:()=>[y]})])]}),l(Ct,{class:"px-4 pt-4"},{default:()=>[l(Se,{span:"12",class:"text-left"},{default:()=>[l(xt,null,{default:()=>[l(dn,null,null),l(fn,null,null),l(mn,null,null)]})]}),l(Se,{span:"12",class:"text-right"},{default:()=>[l(z,{size:"small"},{default:()=>[U("忘记密码")]}),l(z,{size:"small"},{default:()=>[U("注册")]})]})]})]})])])}}});export{In as default};
