var X=Object.defineProperty;var Q=(e,n,t)=>n in e?X(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var T=(e,n,t)=>(Q(e,typeof n!="symbol"?n+"":n,t),t);var $=(e,n,t)=>new Promise((r,o)=>{var c=i=>{try{a(t.next(i))}catch(u){o(u)}},d=i=>{try{a(t.throw(i))}catch(u){o(u)}},a=i=>i.done?r(i.value):Promise.resolve(i.value).then(c,d);a((t=t.apply(e,n)).next())});import{b as A,d as b,r as y,u as q,e as H,w as N,f as W,g as w,h as Z,i as V,j as g,m as C,k as ee,t as te,n as F,l as U,p as ne,L as I,q as M,s as G,v as ae,x as ie,y as se,z as oe,A as j,o as E,B as Y,C as S,D as m,I as re,E as le,F as ue,c as J,G as de,H as K,a as ce,J as fe,K as ge,M as he,N as me}from"./index-14409827.js";/* empty css              */import{N as pe}from"./index-40871864.js";/* empty css              *//* empty css              */import{C as ve}from"./index-8125aa15.js";import{u as xe}from"./use-tab-status-3441551f.js";import{a as De}from"./announcement-02c33768.js";import"./use-placeholder-21611f5d.js";import"./use-route-c327af44.js";const[Te,_,_e]=A("list"),Se={error:Boolean,offset:C(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:ee("down"),loadingText:String,finishedText:String,immediateCheck:te};var ye=b({name:Te,props:Se,emits:["load","update:error","update:loading"],setup(e,{emit:n,slots:t}){const r=y(e.loading),o=y(),c=y(),d=xe(),a=q(o),i=H(()=>e.scroller||a.value),u=()=>{F(()=>{if(r.value||e.finished||e.disabled||e.error||(d==null?void 0:d.value)===!1)return;const{direction:f}=e,x=+e.offset,v=U(i);if(!v.height||ne(o))return;let k=!1;const z=U(c);f==="up"?k=v.top-z.top<=x:k=z.bottom-v.bottom<=x,k&&(r.value=!0,n("update:loading",!0),n("load"))})},l=()=>{if(e.finished){const f=t.finished?t.finished():e.finishedText;if(f)return g("div",{class:_("finished-text")},[f])}},P=()=>{n("update:error",!1),u()},p=()=>{if(e.error){const f=t.error?t.error():e.errorText;if(f)return g("div",{role:"button",class:_("error-text"),tabindex:0,onClick:P},[f])}},D=()=>{if(r.value&&!e.finished&&!e.disabled)return g("div",{class:_("loading")},[t.loading?t.loading():g(I,{class:_("loading-icon")},{default:()=>[e.loadingText||_e("loading")]})])};return N(()=>[e.loading,e.finished,e.error],u),d&&N(d,f=>{f&&u()}),W(()=>{r.value=e.loading}),w(()=>{e.immediateCheck&&u()}),Z({check:u}),V("scroll",u,{target:i,passive:!0}),()=>{var f;const x=(f=t.default)==null?void 0:f.call(t),v=g("div",{ref:c,class:_("placeholder")},null);return g("div",{ref:o,role:"feed",class:_(),"aria-busy":r.value},[e.direction==="down"?x:v,D(),l(),p(),e.direction==="up"?x:v])}}});const Pe=M(ye),[ke,L,Be]=A("pull-refresh"),O=50,Le=["pulling","loosing","success"],be={disabled:Boolean,modelValue:Boolean,headHeight:C(O),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:ie,successDuration:C(500),animationDuration:C(300)};var ze=b({name:ke,props:be,emits:["change","refresh","update:modelValue"],setup(e,{emit:n,slots:t}){let r;const o=y(),c=y(),d=q(o),a=G({status:"normal",distance:0,duration:0}),i=ae(),u=()=>{if(e.headHeight!==O)return{height:`${e.headHeight}px`}},l=()=>a.status!=="loading"&&a.status!=="success"&&!e.disabled,P=s=>{const h=+(e.pullDistance||e.headHeight);return s>h&&(s<h*2?s=h+(s-h)/2:s=h*1.5+(s-h*2)/4),Math.round(s)},p=(s,h)=>{const B=+(e.pullDistance||e.headHeight);a.distance=s,h?a.status="loading":s===0?a.status="normal":s<B?a.status="pulling":a.status="loosing",n("change",{status:a.status,distance:s})},D=()=>{const{status:s}=a;return s==="normal"?"":e[`${s}Text`]||Be(s)},f=()=>{const{status:s,distance:h}=a;if(t[s])return t[s]({distance:h});const B=[];return Le.includes(s)&&B.push(g("div",{class:L("text")},[D()])),s==="loading"&&B.push(g(I,{class:L("loading")},{default:D})),B},x=()=>{a.status="success",setTimeout(()=>{p(0)},+e.successDuration)},v=s=>{r=oe(d.value)===0,r&&(a.duration=0,i.start(s))},k=s=>{l()&&v(s)},z=s=>{if(l()){r||v(s);const{deltaY:h}=i;i.move(s),r&&h.value>=0&&i.isVertical()&&(se(s),p(P(h.value)))}},R=()=>{r&&i.deltaY.value&&l()&&(a.duration=+e.animationDuration,a.status==="loosing"?(p(+e.headHeight,!0),n("update:modelValue",!0),F(()=>n("refresh"))):p(0))};return N(()=>e.modelValue,s=>{a.duration=+e.animationDuration,s?p(+e.headHeight,!0):t.success||e.successText?x():p(0,!1)}),V("touchmove",z,{target:c}),()=>{var s;const h={transitionDuration:`${a.duration}ms`,transform:a.distance?`translate3d(0,${a.distance}px, 0)`:""};return g("div",{ref:o,class:L()},[g("div",{ref:c,class:L("track"),style:h,onTouchstartPassive:k,onTouchend:R,onTouchcancel:R},[g("div",{class:L("head"),style:u()},[f()]),(s=t.default)==null?void 0:s.call(t)])])}}});const $e=M(ze),Ce=b({__name:"DataList",props:{refreshing:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!1},finished:{type:Boolean,require:!0,default:!1},page:{type:Number,require:!0,default:1},size:{type:Number,require:!0,default:10},list:{type:Array,require:!0,default:()=>[]},offset:{type:Number,default:500},refreshDisabled:{type:Boolean,default:!1},loadDisabled:{type:Boolean,default:!1}},emits:["update:refreshing","update:loading","update:finished","update:isFirstPull","update:page","update:size","getDataList"],setup(e,{emit:n}){let t=n,r=e;const o=H({get:()=>r.loading,set:u=>{t("update:loading",u)}}),c=H({get:()=>r.refreshing,set:u=>{t("update:refreshing",u)}}),d=()=>{r.refreshing&&(t("update:finished",!1),t("update:loading",!1),t("update:page",1)),t("getDataList")};let a;const i=()=>{t("update:refreshing",!0),t("update:loading",!0),a&&clearTimeout(a),a=setTimeout(d,1e3)};return w(()=>$(this,null,function*(){j("Component <<DataList>> mounted.")})),(u,l)=>{const P=Pe,p=ue,D=$e;return E(),Y(D,{"model-value":c.value,"onUpdate:modelValue":l[1]||(l[1]=f=>c.value=f),onRefresh:i,disabled:e.refreshDisabled},{loading:S(()=>[g(p,null,{default:S(()=>[g(m(re),{icon:"ep:loading"})]),_:1})]),default:S(()=>[g(P,{loading:o.value,"onUpdate:loading":l[0]||(l[0]=f=>o.value=f),finished:e.finished,onLoad:d,offset:e.offset},{default:S(()=>[le(u.$slots,"default")]),_:3},8,["loading","finished","offset"])]),_:3},8,["model-value","disabled"])}}}),Ee=b({__name:"announcement-list",props:{items:Array},setup(e){const n=e,t=r=>{ge.push({path:"/announcement/details",query:{id:r}})};return(r,o)=>{const c=ve;return E(!0),J(K,null,de(n.items,d=>(E(),Y(c,{key:d.id,onClick:a=>t(d.id)},{title:S(()=>[ce("p",null,fe(d.title),1)]),_:2},1032,["onClick"]))),128)}}});class He{constructor(){T(this,"refreshing",!1);T(this,"loading",!1);T(this,"finished",!1);T(this,"pagination",{page:0,size:10,total:0});T(this,"items",[])}}const Ne=()=>new He,we=(e,n,t)=>{var r,o,c,d,a,i,u;if((r=n==null?void 0:n.data)!=null&&r.content.length)for(const l of n.data.content)t&&he(t)?e.items.push(t(l)):e.items.push(l);return e.pagination.page=((c=(o=n==null?void 0:n.data)==null?void 0:o.pageable)==null?void 0:c.pageNumber)+1,e.pagination.size=(a=(d=n==null?void 0:n.data)==null?void 0:d.pageable)==null?void 0:a.pageSize,e.pagination.total=(i=n==null?void 0:n.data)==null?void 0:i.totalElements,e.loading=!1,e.refreshing=!1,(u=n==null?void 0:n.data)!=null&&u.last&&(e.finished=!0),e},Re=e=>(e.loading=!0,e.refreshing&&(e.items=[]),{page:e.pagination.page<=0?1:e.pagination.page+1,size:e.pagination.size}),Ue=()=>({initialize:Ne,handleResult:we,handleParams:Re}),Oe=b({__name:"index",setup(e){const{initialize:n,handleResult:t,handleParams:r}=Ue(),o=G(n()),c=y([]),d=()=>$(this,null,function*(){const a=yield De(r(o));a&&(t(o,a),c.value=o.items)});return w(()=>$(this,null,function*(){j("Page <<AnnouncementIndexPage>> mounted.")})),(a,i)=>{const u=pe;return E(),J(K,null,[g(u,{title:"Announcement","left-arrow":"",onClickLeft:i[0]||(i[0]=l=>m(me)())}),g(m(Ce),{finished:m(o).finished,"onUpdate:finished":i[1]||(i[1]=l=>m(o).finished=l),refreshing:m(o).refreshing,"onUpdate:refreshing":i[2]||(i[2]=l=>m(o).refreshing=l),loading:m(o).loading,"onUpdate:loading":i[3]||(i[3]=l=>m(o).loading=l),page:m(o).pagination.page,"onUpdate:page":i[4]||(i[4]=l=>m(o).pagination.page=l),size:m(o).pagination.size,"onUpdate:size":i[5]||(i[5]=l=>m(o).pagination.size=l),onGetDataList:d},{default:S(()=>[g(m(Ee),{items:m(c)},null,8,["items"])]),_:1},8,["finished","refreshing","loading","page","size"])],64)}}});export{Oe as default};
