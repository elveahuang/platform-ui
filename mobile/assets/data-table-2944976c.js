var M=Object.defineProperty;var Y=(e,a,t)=>a in e?M(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t;var x=(e,a,t)=>(Y(e,typeof a!="symbol"?a+"":a,t),t);var w=(e,a,t)=>new Promise((s,u)=>{var g=o=>{try{i(t.next(o))}catch(l){u(l)}},c=o=>{try{i(t.throw(o))}catch(l){u(l)}},i=o=>o.done?s(o.value):Promise.resolve(o.value).then(g,c);i((t=t.apply(e,a)).next())});import{al as O,m as C,d as $,j as L,am as F,U as H,a9 as R,an as G,g as N,p as K,a4 as U,h as f,a6 as E,a7 as X,s as J,ac as V,ao as z,ap as Q,ab as A,y as I,f as W,a1 as Z,q as ee,v as te,aq as ae,l as P,o as ne,b as ie,w as k,u as se,I as oe,O as le,C as re,ar as ue}from"./index-eaaf9806.js";/* empty css              *//* empty css                                                                 *//* empty css              */import{_ as de}from"./_plugin-vue_export-helper-c27b6911.js";const ce=Symbol(),fe=()=>O(ce,null),[ge,D,he]=C("list"),me={error:Boolean,offset:E(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:X("down"),loadingText:String,finishedText:String,immediateCheck:J};var ve=$({name:ge,props:me,emits:["load","update:error","update:loading"],setup(e,{emit:a,slots:t}){const s=L(e.loading),u=L(),g=L(),c=fe(),i=F(u),o=H(()=>e.scroller||i.value),l=()=>{V(()=>{if(s.value||e.finished||e.disabled||e.error||(c==null?void 0:c.value)===!1)return;const{direction:r}=e,p=+e.offset,v=z(o);if(!v.height||Q(u))return;let _=!1;const B=z(g);r==="up"?_=v.top-B.top<=p:_=B.bottom-v.bottom<=p,_&&(s.value=!0,a("update:loading",!0),a("load"))})},h=()=>{if(e.finished){const r=t.finished?t.finished():e.finishedText;if(r)return f("div",{class:D("finished-text")},[r])}},S=()=>{a("update:error",!1),l()},m=()=>{if(e.error){const r=t.error?t.error():e.errorText;if(r)return f("div",{role:"button",class:D("error-text"),tabindex:0,onClick:S},[r])}},T=()=>{if(s.value&&!e.finished&&!e.disabled)return f("div",{class:D("loading")},[t.loading?t.loading():f(A,{class:D("loading-icon")},{default:()=>[e.loadingText||he("loading")]})])};return R(()=>[e.loading,e.finished,e.error],l),c&&R(c,r=>{r&&l()}),G(()=>{s.value=e.loading}),N(()=>{e.immediateCheck&&l()}),K({check:l}),U("scroll",l,{target:o,passive:!0}),()=>{var r;const p=(r=t.default)==null?void 0:r.call(t),v=f("div",{ref:g,class:D("placeholder")},null);return f("div",{ref:u,role:"feed",class:D(),"aria-busy":s.value},[e.direction==="down"?p:v,T(),h(),m(),e.direction==="up"?p:v])}}});const pe=I(ve),[Te,b,xe]=C("pull-refresh"),j=50,De=["pulling","loosing","success"],Se={disabled:Boolean,modelValue:Boolean,headHeight:E(j),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:ee,successDuration:E(500),animationDuration:E(300)};var _e=$({name:Te,props:Se,emits:["change","refresh","update:modelValue"],setup(e,{emit:a,slots:t}){let s;const u=L(),g=L(),c=F(u),i=W({status:"normal",distance:0,duration:0}),o=Z(),l=()=>{if(e.headHeight!==j)return{height:`${e.headHeight}px`}},h=()=>i.status!=="loading"&&i.status!=="success"&&!e.disabled,S=n=>{const d=+(e.pullDistance||e.headHeight);return n>d&&(n<d*2?n=d+(n-d)/2:n=d*1.5+(n-d*2)/4),Math.round(n)},m=(n,d)=>{const y=+(e.pullDistance||e.headHeight);i.distance=n,d?i.status="loading":n===0?i.status="normal":n<y?i.status="pulling":i.status="loosing",a("change",{status:i.status,distance:n})},T=()=>{const{status:n}=i;return n==="normal"?"":e[`${n}Text`]||xe(n)},r=()=>{const{status:n,distance:d}=i;if(t[n])return t[n]({distance:d});const y=[];return De.includes(n)&&y.push(f("div",{class:b("text")},[T()])),n==="loading"&&y.push(f(A,{class:b("loading")},{default:T})),y},p=()=>{i.status="success",setTimeout(()=>{m(0)},+e.successDuration)},v=n=>{s=ae(c.value)===0,s&&(i.duration=0,o.start(n))},_=n=>{h()&&v(n)},B=n=>{if(h()){s||v(n);const{deltaY:d}=o;o.move(n),s&&d.value>=0&&o.isVertical()&&(te(n),m(S(d.value)))}},q=()=>{s&&o.deltaY.value&&h()&&(i.duration=+e.animationDuration,i.status==="loosing"?(m(+e.headHeight,!0),a("update:modelValue",!0),V(()=>a("refresh"))):m(0))};return R(()=>e.modelValue,n=>{i.duration=+e.animationDuration,n?m(+e.headHeight,!0):t.success||e.successText?p():m(0,!1)}),U("touchmove",B,{target:g}),()=>{var n;const d={transitionDuration:`${i.duration}ms`,transform:i.distance?`translate3d(0,${i.distance}px, 0)`:""};return f("div",{ref:u,class:b()},[f("div",{ref:g,class:b("track"),style:d,onTouchstartPassive:_,onTouchend:q,onTouchcancel:q},[f("div",{class:b("head"),style:l()},[r()]),(n=t.default)==null?void 0:n.call(t)])])}}});const ye=I(_e),Pe=$({__name:"DataList",props:{refreshing:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!0},finished:{type:Boolean,require:!0,default:!0},page:{type:Number,require:!0,default:1},size:{type:Number,require:!0,default:10},list:{type:Array,require:!0,default:()=>[]},offset:{type:Number,default:100},refreshDisabled:{type:Boolean,default:!1},loadDisabled:{type:Boolean,default:!1},isFirstPull:{type:Boolean,default:!1}},emits:["update:refreshing","update:loading","update:finished","update:isFirstPull","update:page","update:size","getDataList"],setup(e,{emit:a}){let t=a,s=e;const u=H({get:()=>s.loading,set:l=>{t("update:loading",l)}}),g=H({get:()=>s.refreshing,set:l=>{t("update:refreshing",l)}}),c=()=>{P("onLoad..."),s.refreshing?(P("onLoad...1"),t("update:finished",!1),t("update:loading",!1),t("update:page",1),t("getDataList")):(P("onLoad...2"),t("getDataList"))};let i;const o=()=>{P("onRefresh..."),s.isFirstPull?(t("update:isFirstPull",!1),t("update:refreshing",!1)):(t("update:refreshing",!0),i&&clearTimeout(i),i=setTimeout(c,1e3))};return N(()=>w(this,null,function*(){P("Component <<DataList>> mounted.")})),(l,h)=>{const S=re,m=pe,T=ye;return ne(),ie(T,{"model-value":g.value,"onUpdate:modelValue":h[1]||(h[1]=r=>g.value=r),onRefresh:o,disabled:e.refreshDisabled},{loading:k(()=>[f(S,null,{default:k(()=>[f(se(oe),{icon:"ep:loading"})]),_:1})]),default:k(()=>[f(m,{loading:u.value,"onUpdate:loading":h[0]||(h[0]=r=>u.value=r),finished:e.finished,offset:e.offset,onLoad:c},{default:k(()=>[le(l.$slots,"default",{},void 0,!0)]),_:3},8,["loading","finished","offset"])]),_:3},8,["model-value","disabled"])}}}),ze=de(Pe,[["__scopeId","data-v-3cf2905e"]]);class be{constructor(){x(this,"refreshing",!1);x(this,"loading",!1);x(this,"finished",!1);x(this,"pagination",{page:0,size:10,total:0});x(this,"items",[])}}const Le=()=>new be,Be=(e,a,t)=>{var s,u,g,c,i,o,l;if((s=a==null?void 0:a.data)!=null&&s.content.length)for(const h of a.data.content)t&&ue(t)?e.items.push(t(h)):e.items.push(h);return e.pagination.page=((g=(u=a==null?void 0:a.data)==null?void 0:u.pageable)==null?void 0:g.pageNumber)+1,e.pagination.size=(i=(c=a==null?void 0:a.data)==null?void 0:c.pageable)==null?void 0:i.pageSize,e.pagination.total=(o=a==null?void 0:a.data)==null?void 0:o.totalElements,e.loading=!1,e.refreshing=!1,(l=a==null?void 0:a.data)!=null&&l.last&&(e.finished=!0),e},ke=e=>(e.loading=!0,e.refreshing&&(e.items=[]),{page:e.pagination.page<=0?1:e.pagination.page+1,size:e.pagination.size}),Ce=()=>({initialize:Le,handleResult:Be,handleParams:ke});export{ze as D,Ce as u};
