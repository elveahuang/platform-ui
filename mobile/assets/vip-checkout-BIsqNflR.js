var D=(n,c,o)=>new Promise((r,y)=>{var x=u=>{try{C(o.next(u))}catch(g){y(g)}},_=u=>{try{C(o.throw(u))}catch(g){y(g)}},C=u=>u.done?r(u.value):Promise.resolve(u.value).then(x,_);C((o=o.apply(n,c)).next())});import{e as X,ao as le,aR as re,am as $,aS as ue,al as H,aT as pe,d as z,b as t,U as de,aU as me,af as ve,ae as K,aV as _e,aW as fe,O as be,y as j,m as he,r as T,aX as ge,a5 as ye,a6 as Ce,g as F,o as ke,l as Se,a as m,c as B,w as p,u as l,R as O,F as P,Q as N,$ as Q,a1 as E,H as b,a3 as Te,a0 as xe,V as S,aO as we}from"./index-DxX8PkMD.js";/* empty css              *//* empty css                                                              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{N as Ae}from"./index-BggaeUhM.js";import{C as Be,a as Ie}from"./core.service-B3sU6E5d.js";import{A as W}from"./index-DtTTahM6.js";import{_ as Pe}from"./AppIcon.vue_vue_type_script_setup_true_lang-AtJM_fBw.js";import{v as Le,p as Oe,T as $e,a as Ne}from"./mall-BvM32QsB.js";import{S as Ve}from"./index-Ia-nIM1J.js";import{C as Re}from"./index-Ci5ZyusK.js";import{S as Ue,a as De}from"./index-Br8DD2RI.js";import{I as Fe}from"./index-BN-TTRU8.js";import{C as Ee}from"./index-9vFON4PG.js";import{_ as He}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-id-CrfpJfz8.js";import"./use-tab-status-D54Jq6O7.js";const[Ke,v]=X("action-sheet"),ze=le({},re,{title:String,round:$,actions:ue(),closeIcon:H("cross"),closeable:$,cancelText:String,description:String,closeOnPopstate:$,closeOnClickAction:Boolean,safeAreaInsetBottom:$}),Ge=[...pe,"round","closeOnPopstate","safeAreaInsetBottom"];var Me=z({name:Ke,props:ze,emits:["select","cancel","update:show"],setup(n,{slots:c,emit:o}){const r=e=>o("update:show",e),y=()=>{r(!1),o("cancel")},x=()=>{if(n.title)return t("div",{class:v("header")},[n.title,n.closeable&&t(K,{name:n.closeIcon,class:[v("close"),_e],onClick:y},null)])},_=()=>{if(c.cancel||n.cancelText)return[t("div",{class:v("gap")},null),t("button",{type:"button",class:v("cancel"),onClick:y},[c.cancel?c.cancel():n.cancelText])]},C=e=>{if(e.icon)return t(K,{class:v("item-icon"),name:e.icon},null)},u=(e,f)=>e.loading?t(fe,{class:v("loading-icon")},null):c.action?c.action({action:e,index:f}):[t("span",{class:v("name")},[e.name]),e.subname&&t("div",{class:v("subname")},[e.subname])],g=(e,f)=>{const{color:L,loading:d,callback:w,disabled:A,className:I}=e,V=()=>{A||d||(w&&w(e),n.closeOnClickAction&&r(!1),be(()=>o("select",e,f)))};return t("button",{type:"button",style:{color:L},class:[v("item",{loading:d,disabled:A}),I],onClick:V},[C(e),u(e,f)])},i=()=>{if(n.description||c.description){const e=c.description?c.description():n.description;return t("div",{class:v("description")},[e])}};return()=>t(ve,de({class:v(),position:"bottom","onUpdate:show":r},me(n,Ge)),{default:()=>{var e;return[x(),i(),t("div",{class:v("content")},[n.actions.map(g),(e=c.default)==null?void 0:e.call(c)]),_()]}})}});const Qe=j(Me),[We,h,Xe]=X("submit-bar"),je={tip:String,label:String,price:Number,tipIcon:String,loading:Boolean,currency:H("¥"),disabled:Boolean,textAlign:String,buttonText:String,buttonType:H("danger"),buttonColor:String,suffixLabel:String,placeholder:Boolean,decimalLength:he(2),safeAreaInsetBottom:$};var qe=z({name:We,props:je,emits:["submit"],setup(n,{emit:c,slots:o}){const r=T(),y=ge(r,h),x=()=>{const{price:i,label:e,currency:f,textAlign:L,suffixLabel:d,decimalLength:w}=n;if(typeof i=="number"){const A=(i/100).toFixed(+w).split("."),I=w?`.${A[1]}`:"";return t("div",{class:h("text"),style:{textAlign:L}},[t("span",null,[e||Xe("label")]),t("span",{class:h("price")},[f,t("span",{class:h("price-integer")},[A[0]]),I]),d&&t("span",{class:h("suffix-label")},[d])])}},_=()=>{var i;const{tip:e,tipIcon:f}=n;if(o.tip||e)return t("div",{class:h("tip")},[f&&t(K,{class:h("tip-icon"),name:f},null),e&&t("span",{class:h("tip-text")},[e]),(i=o.tip)==null?void 0:i.call(o)])},C=()=>c("submit"),u=()=>o.button?o.button():t(ye,{round:!0,type:n.buttonType,text:n.buttonText,class:h("button",n.buttonType),color:n.buttonColor,loading:n.loading,disabled:n.disabled,onClick:C},null),g=()=>{var i,e;return t("div",{ref:r,class:[h(),{"van-safe-area-bottom":n.safeAreaInsetBottom}]},[(i=o.top)==null?void 0:i.call(o),_(),t("div",{class:h("bar")},[(e=o.default)==null?void 0:e.call(o),x(),u()])])};return()=>n.placeholder?y(g):g()}});const Je=j(qe),Ye={class:"mx-4"},Ze={class:"flex"},et={class:"flex-none p-4 text-center"},tt={class:"flex-1 py-4"},nt={class:"app-text-primary"},at={class:"vip-item-container"},ot=["onClick"],st=["onClick"],ct=z({__name:"vip-checkout",setup(n){const{user:c,isAuthenticated:o}=Ce(),r=T([]),y=F(()=>r.value.length&&r.value.length>0),x=T(),_=T(0),C=s=>{u.value.swipeTo(s),e.value=0},u=T(),g=s=>{_.value=s},i=F(()=>r.value.at(_.value)),e=T(0),f=(s=0)=>e.value===s?"vip-item vip-item-active":"vip-item",L=(s=0)=>{e.value=s},d=T(!1),w=()=>{d.value=!1},A=()=>{d.value=!1},I=T([]),V=F(()=>{var s,k;return((k=(s=i==null?void 0:i.value)==null?void 0:s.items)==null?void 0:k.at(e.value).price)*100}),q=()=>{d.value=!0},J=(s="")=>{alert(s)};return ke(()=>D(this,null,function*(){Se("Page <<VipOrderCheckout>> mounted."),yield Be.initialize().then(()=>D(this,null,function*(){yield Le().then(s=>{r.value=s.data}),yield Oe().then(s=>{I.value=s.data})}))})),(s,k)=>{var G,M;const Y=Ne,Z=$e,ee=Ae,te=Ve,ne=Fe,R=Re,ae=De,oe=Ue,se=Je,ce=Ee,ie=Qe;return m(),B(P,null,[t(te,null,{default:p(()=>[t(ee,{border:!1,"left-arrow":"",onClickLeft:k[1]||(k[1]=a=>l(xe)())},{title:p(()=>[l(y)?(m(),O(Z,{key:0,ref_key:"vipTypeTabsRef",ref:x,active:l(_),"onUpdate:active":k[0]||(k[0]=a=>Q(_)?_.value=a:null),"line-width":20,onChange:C},{default:p(()=>[(m(!0),B(P,null,N(l(r),a=>(m(),O(Y,{key:a.code},{title:p(()=>[b("div",Ye,S(a.title),1)]),_:2},1024))),128))]),_:1},8,["active"])):E("",!0)]),_:1})]),_:1}),t(l(W)),t(oe,{ref_key:"vipTypeSwipeRef",ref:u,"indicator-color":"white",onChange:g},{default:p(()=>[(m(!0),B(P,null,N(l(r),a=>(m(),O(ae,{key:a.code},{default:p(()=>[l(o)?(m(),O(R,{key:0,inset:""},{default:p(()=>[b("div",Ze,[b("div",et,[t(ne,{round:"",class:"!align-middle",width:"3.2rem",height:"3.2rem",src:l(Ie)},null,8,["src"])]),b("div",tt,[b("div",nt,S(l(c).username)+" - "+S(a.code),1)])])]),_:2},1024)):E("",!0)]),_:2},1024))),128))]),_:1},512),((M=(G=l(i))==null?void 0:G.items)==null?void 0:M.length)>0?(m(),B(P,{key:0},[t(l(W)),b("div",at,[(m(!0),B(P,null,N(l(i).items,(a,U)=>(m(),B("div",{key:a.code,class:we(f(U)),onClick:it=>L(U)},[t(R,{border:!0,inset:"",class:"app-no-margin p-2"},{default:p(()=>[b("div",null,S(a.code),1),b("div",null,S(a.title),1),b("div",null,S(a.listPrice),1),b("div",null,S(a.price),1)]),_:2},1024)],10,ot))),128))])],64)):E("",!0),t(se,{price:l(V),"button-text":s.$t("common.button_renew"),onSubmit:q},{tip:p(()=>[Te("开通会员代表接受会员服务协议")]),_:1},8,["price","button-text"]),t(ie,{show:l(d),"onUpdate:show":k[2]||(k[2]=a=>Q(d)?d.value=a:null),"cancel-text":s.$t("common.button_cancel"),"close-on-click-action":"",closeable:"",onCancel:w,onSelect:A,title:"请选择支付方式"},{default:p(()=>[t(R,{inset:"",class:"!my-4"},{default:p(()=>[(m(!0),B(P,null,N(l(I),a=>(m(),O(ce,{key:a.code,"is-link":""},{icon:p(()=>[t(l(Pe),{icon:a.icon},null,8,["icon"])]),title:p(()=>[b("div",{class:"app-text ml-4",onClick:U=>J(a.code)},S(a.title),9,st)]),_:2},1024))),128))]),_:1})]),_:1},8,["show","cancel-text"])],64)}}}),It=He(ct,[["__scopeId","data-v-9679ad2e"]]);export{It as default};
