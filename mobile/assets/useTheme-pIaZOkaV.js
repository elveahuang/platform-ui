var y=(e,a,n)=>new Promise((r,s)=>{var d=c=>{try{u(n.next(c))}catch(m){s(m)}},f=c=>{try{u(n.throw(c))}catch(m){s(m)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(d,f);u((n=n.apply(e,a)).next())});import{e as A,aE as he,ao as D,x as J,d as X,n as q,b1 as _,aS as L,r as E,f as ge,g as O,an as se,av as ce,K as be,j as ie,b as h,t as re,aV as Z,m as B,am as pe,al as Te,ak as Oe,b3 as ke,C as z,k as G,aW as ye,O as ee,aU as te,U as Se,bp as xe,y as Ce,bq as R,br as we,bs as Ee,bt as V,bu as De}from"./index-aXUBTLoe.js";const[Ie,p,ne]=A("picker"),ue=e=>e.find(a=>!a.disabled)||e[0];function Me(e,a){const n=e[0];if(n){if(Array.isArray(n))return"multiple";if(a.children in n)return"cascade"}return"default"}function $(e,a){a=J(a,0,e.length);for(let n=a;n<e.length;n++)if(!e[n].disabled)return n;for(let n=a-1;n>=0;n--)if(!e[n].disabled)return n;return 0}const ae=(e,a,n)=>a!==void 0&&!!e.find(r=>r[n.value]===a);function Q(e,a,n){const r=e.findIndex(d=>d[n.value]===a),s=$(e,r);return e[s]}function Pe(e,a,n){const r=[];let s={[a.children]:e},d=0;for(;s&&s[a.children];){const f=s[a.children],u=n.value[d];if(s=he(u)?Q(f,u,a):void 0,!s&&f.length){const c=ue(f)[a.value];s=Q(f,c,a)}d++,r.push(f)}return r}function He(e){const{transform:a}=window.getComputedStyle(e),n=a.slice(7,a.length-1).split(", ")[5];return Number(n)}function Ne(e){return D({text:"text",value:"value",children:"children"},e)}const oe=200,le=300,_e=15,[me,W]=A("picker-column"),de=Symbol(me);var Be=X({name:me,props:{value:q,fields:_(Object),options:L(),readonly:Boolean,allowHtml:Boolean,optionHeight:_(Number),swipeDuration:_(q),visibleOptionNum:_(q)},emits:["change","clickOption","scrollInto"],setup(e,{emit:a,slots:n}){let r,s,d,f,u;const c=E(),m=E(),v=E(0),g=E(0),S=ge(),x=()=>e.options.length,H=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,k=i=>{let t=$(e.options,i);const o=-t*e.optionHeight,l=()=>{t>x()-1&&(t=$(e.options,i));const T=e.options[t][e.fields.value];T!==e.value&&a("change",T)};r&&o!==v.value?u=l:l(),v.value=o},b=()=>e.readonly||!e.options.length,K=i=>{r||b()||(u=null,g.value=oe,k(i),a("clickOption",e.options[i]))},C=i=>J(Math.round(-i/e.optionHeight),0,x()-1),N=O(()=>C(v.value)),F=(i,t)=>{const o=Math.abs(i/t);i=v.value+o/.003*(i<0?-1:1);const l=C(i);g.value=+e.swipeDuration,k(l)},I=()=>{r=!1,g.value=0,u&&(u(),u=null)},Y=i=>{if(!b()){if(S.start(i),r){const t=He(m.value);v.value=Math.min(0,t-H())}g.value=0,s=v.value,d=Date.now(),f=s,u=null}},j=i=>{if(b())return;S.move(i),S.isVertical()&&(r=!0,re(i,!0));const t=J(s+S.deltaY.value,-(x()*e.optionHeight),e.optionHeight),o=C(t);o!==N.value&&a("scrollInto",e.options[o]),v.value=t;const l=Date.now();l-d>le&&(d=l,f=t)},M=()=>{if(b())return;const i=v.value-f,t=Date.now()-d;if(t<le&&Math.abs(i)>_e){F(i,t);return}const l=C(v.value);g.value=oe,k(l),setTimeout(()=>{r=!1},0)},w=()=>{const i={height:`${e.optionHeight}px`};return e.options.map((t,o)=>{const l=t[e.fields.text],{disabled:T}=t,P=t[e.fields.value],fe={role:"button",style:i,tabindex:T?-1:0,class:[W("item",{disabled:T,selected:P===e.value}),t.className],onClick:()=>K(o)},ve={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:l};return h("li",fe,[n.option?n.option(t,o):h("div",ve,null)])})};return se(de),ce({stopMomentum:I}),be(()=>{const i=r?Math.floor(-v.value/e.optionHeight):e.options.findIndex(l=>l[e.fields.value]===e.value),t=$(e.options,i),o=-t*e.optionHeight;r&&t<i&&I(),v.value=o}),ie("touchmove",j,{target:c}),()=>h("div",{ref:c,class:W(),onTouchstartPassive:Y,onTouchend:M,onTouchcancel:M},[h("ul",{ref:m,style:{transform:`translate3d(0, ${v.value+H()}px, 0)`,transitionDuration:`${g.value}ms`,transitionProperty:g.value?"all":"none"},class:W("wrapper"),onTransitionend:I},[w()])])}});const[Ve]=A("picker-toolbar"),U={title:String,cancelButtonText:String,confirmButtonText:String},$e=["cancel","confirm","title","toolbar"],Le=Object.keys(U);var Ae=X({name:Ve,props:U,emits:["confirm","cancel"],setup(e,{emit:a,slots:n}){const r=()=>{if(n.title)return n.title();if(e.title)return h("div",{class:[p("title"),"van-ellipsis"]},[e.title])},s=()=>a("cancel"),d=()=>a("confirm"),f=()=>{var c;const m=(c=e.cancelButtonText)!=null?c:ne("cancel");if(!(!n.cancel&&!m))return h("button",{type:"button",class:[p("cancel"),Z],onClick:s},[n.cancel?n.cancel():m])},u=()=>{var c;const m=(c=e.confirmButtonText)!=null?c:ne("confirm");if(!(!n.confirm&&!m))return h("button",{type:"button",class:[p("confirm"),Z],onClick:d},[n.confirm?n.confirm():m])};return()=>h("div",{class:p("toolbar")},[n.toolbar?n.toolbar():[f(),r(),u()]])}});const[Re,Ze]=A("picker-group"),Ue=Symbol(Re);D({tabs:L(),activeTab:B(0),nextStepText:String},U);const Ke=D({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:B(44),showToolbar:pe,swipeDuration:B(1e3),visibleOptionNum:B(6)},U),Fe=D({},Ke,{columns:L(),modelValue:L(),toolbarPosition:Te("top"),columnsFieldNames:Object});var Ye=X({name:Ie,props:Fe,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:a,slots:n}){const r=E(),s=E(e.modelValue.slice(0)),{parent:d}=se(Ue),{children:f,linkChildren:u}=Oe(de);u();const c=O(()=>Ne(e.columnsFieldNames)),m=O(()=>ke(e.optionHeight)),v=O(()=>Me(e.columns,c.value)),g=O(()=>{const{columns:t}=e;switch(v.value){case"multiple":return t;case"cascade":return Pe(t,c.value,s);default:return[t]}}),S=O(()=>g.value.some(t=>t.length)),x=O(()=>g.value.map((t,o)=>Q(t,s.value[o],c.value))),H=O(()=>g.value.map((t,o)=>t.findIndex(l=>l[c.value.value]===s.value[o]))),k=(t,o)=>{if(s.value[t]!==o){const l=s.value.slice(0);l[t]=o,s.value=l}},b=()=>({selectedValues:s.value.slice(0),selectedOptions:x.value,selectedIndexes:H.value}),K=(t,o)=>{k(o,t),v.value==="cascade"&&s.value.forEach((l,T)=>{const P=g.value[T];ae(P,l,c.value)||k(T,P.length?P[0][c.value.value]:void 0)}),ee(()=>{a("change",D({columnIndex:o},b()))})},C=(t,o)=>{const l={columnIndex:o,currentOption:t};a("clickOption",D(b(),l)),a("scrollInto",l)},N=()=>{f.forEach(o=>o.stopMomentum());const t=b();return ee(()=>{a("confirm",t)}),t},F=()=>a("cancel",b()),I=()=>g.value.map((t,o)=>h(Be,{value:s.value[o],fields:c.value,options:t,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:m.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:l=>K(l,o),onClickOption:l=>C(l,o),onScrollInto:l=>{a("scrollInto",{currentOption:l,columnIndex:o})}},{option:n.option})),Y=t=>{if(S.value){const o={height:`${m.value}px`},l={backgroundSize:`100% ${(t-m.value)/2}px`};return[h("div",{class:p("mask"),style:l},null),h("div",{class:[xe,p("frame")],style:o},null)]}},j=()=>{const t=m.value*+e.visibleOptionNum,o={height:`${t}px`};return h("div",{ref:r,class:p("columns"),style:o},[I(),Y(t)])},M=()=>{if(e.showToolbar&&!d)return h(Ae,Se(te(e,Le),{onConfirm:N,onCancel:F}),te(n,$e))};z(g,t=>{t.forEach((o,l)=>{o.length&&!ae(o,s.value[l],c.value)&&k(l,ue(o)[c.value.value])})},{immediate:!0});let w;return z(()=>e.modelValue,t=>{!G(t,s.value)&&!G(t,w)&&(s.value=t.slice(0),w=t.slice(0))},{deep:!0}),z(s,t=>{G(t,e.modelValue)||(w=t.slice(0),a("update:modelValue",w))},{immediate:!0}),ie("touchmove",re,{target:r}),ce({confirm:N,getSelectedOptions:()=>x.value}),()=>{var t,o;return h("div",{class:p()},[e.toolbarPosition==="top"?M():null,e.loading?h(ye,{class:p("loading")},null):null,(t=n["columns-top"])==null?void 0:t.call(n),j(),(o=n["columns-bottom"])==null?void 0:o.call(n),e.toolbarPosition==="bottom"?M():null])}}});const et=Ce(Ye),je=e=>y(void 0,null,function*(){R().setDark(e)}),qe=e=>y(void 0,null,function*(){const a=R();a.setDarkMode(e),a.setDark(we(e))}),tt=()=>({setDark:je,setDarkMode:qe}),ze=e=>y(void 0,null,function*(){V.mode==="legacy"?V.global.locale=e:V.global.locale.value=e}),Ge=e=>y(void 0,null,function*(){V.global.setLocaleMessage(e,yield De(e))}),We=e=>y(void 0,null,function*(){yield R().setLocale(e),yield Ge(e),yield ze(e),yield Ee(e)}),nt=()=>({setLocale:We}),Je=e=>y(void 0,null,function*(){R().setTheme(e)}),at=()=>({setTheme:Je});export{et as P,nt as a,at as b,tt as u};
