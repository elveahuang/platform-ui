var X=Object.defineProperty;var Q=(e,n,t)=>n in e?X(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var D=(e,n,t)=>(Q(e,typeof n!="symbol"?n+"":n,t),t);var E=(e,n,t)=>new Promise((l,o)=>{var c=i=>{try{a(t.next(i))}catch(u){o(u)}},d=i=>{try{a(t.throw(i))}catch(u){o(u)}},a=i=>i.done?l(i.value):Promise.resolve(i.value).then(c,d);a((t=t.apply(e,n)).next())});import{i as W,b as R,d as b,r as y,u as q,e as H,w as A,f as Z,g as N,h as ee,j as V,k as g,m as $,l as te,t as ne,n as F,p as w,q as ae,L as I,s as M,v as j,x as ie,y as se,z as oe,A as le,B as G,o as C,C as Y,D as S,E as m,I as re,F as ue,G as de,c as K,H as ce,J as O,a as fe,K as ge,M as he,N as me,O as pe}from"./index-8cf3448a.js";/* empty css              */import{N as ve}from"./index-75272307.js";/* empty css              *//* empty css              */import{C as xe}from"./index-a0807a33.js";import{a as Te}from"./announcement-453ea1e1.js";import"./use-placeholder-7f0ff041.js";import"./use-route-71f9e7b0.js";const De=Symbol(),_e=()=>W(De,null),[Se,_,ye]=R("list"),Pe={error:Boolean,offset:$(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:te("down"),loadingText:String,finishedText:String,immediateCheck:ne};var ke=b({name:Se,props:Pe,emits:["load","update:error","update:loading"],setup(e,{emit:n,slots:t}){const l=y(e.loading),o=y(),c=y(),d=_e(),a=q(o),i=H(()=>e.scroller||a.value),u=()=>{F(()=>{if(l.value||e.finished||e.disabled||e.error||(d==null?void 0:d.value)===!1)return;const{direction:f}=e,x=+e.offset,v=w(i);if(!v.height||ae(o))return;let k=!1;const z=w(c);f==="up"?k=v.top-z.top<=x:k=z.bottom-v.bottom<=x,k&&(l.value=!0,n("update:loading",!0),n("load"))})},r=()=>{if(e.finished){const f=t.finished?t.finished():e.finishedText;if(f)return g("div",{class:_("finished-text")},[f])}},P=()=>{n("update:error",!1),u()},p=()=>{if(e.error){const f=t.error?t.error():e.errorText;if(f)return g("div",{role:"button",class:_("error-text"),tabindex:0,onClick:P},[f])}},T=()=>{if(l.value&&!e.finished&&!e.disabled)return g("div",{class:_("loading")},[t.loading?t.loading():g(I,{class:_("loading-icon")},{default:()=>[e.loadingText||ye("loading")]})])};return A(()=>[e.loading,e.finished,e.error],u),d&&A(d,f=>{f&&u()}),Z(()=>{l.value=e.loading}),N(()=>{e.immediateCheck&&u()}),ee({check:u}),V("scroll",u,{target:i,passive:!0}),()=>{var f;const x=(f=t.default)==null?void 0:f.call(t),v=g("div",{ref:c,class:_("placeholder")},null);return g("div",{ref:o,role:"feed",class:_(),"aria-busy":l.value},[e.direction==="down"?x:v,T(),r(),p(),e.direction==="up"?x:v])}}});const Be=M(ke),[Le,L,be]=R("pull-refresh"),J=50,ze=["pulling","loosing","success"],Ee={disabled:Boolean,modelValue:Boolean,headHeight:$(J),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:se,successDuration:$(500),animationDuration:$(300)};var $e=b({name:Le,props:Ee,emits:["change","refresh","update:modelValue"],setup(e,{emit:n,slots:t}){let l;const o=y(),c=y(),d=q(o),a=j({status:"normal",distance:0,duration:0}),i=ie(),u=()=>{if(e.headHeight!==J)return{height:`${e.headHeight}px`}},r=()=>a.status!=="loading"&&a.status!=="success"&&!e.disabled,P=s=>{const h=+(e.pullDistance||e.headHeight);return s>h&&(s<h*2?s=h+(s-h)/2:s=h*1.5+(s-h*2)/4),Math.round(s)},p=(s,h)=>{const B=+(e.pullDistance||e.headHeight);a.distance=s,h?a.status="loading":s===0?a.status="normal":s<B?a.status="pulling":a.status="loosing",n("change",{status:a.status,distance:s})},T=()=>{const{status:s}=a;return s==="normal"?"":e[`${s}Text`]||be(s)},f=()=>{const{status:s,distance:h}=a;if(t[s])return t[s]({distance:h});const B=[];return ze.includes(s)&&B.push(g("div",{class:L("text")},[T()])),s==="loading"&&B.push(g(I,{class:L("loading")},{default:T})),B},x=()=>{a.status="success",setTimeout(()=>{p(0)},+e.successDuration)},v=s=>{l=le(d.value)===0,l&&(a.duration=0,i.start(s))},k=s=>{r()&&v(s)},z=s=>{if(r()){l||v(s);const{deltaY:h}=i;i.move(s),l&&h.value>=0&&i.isVertical()&&(oe(s),p(P(h.value)))}},U=()=>{l&&i.deltaY.value&&r()&&(a.duration=+e.animationDuration,a.status==="loosing"?(p(+e.headHeight,!0),n("update:modelValue",!0),F(()=>n("refresh"))):p(0))};return A(()=>e.modelValue,s=>{a.duration=+e.animationDuration,s?p(+e.headHeight,!0):t.success||e.successText?x():p(0,!1)}),V("touchmove",z,{target:c}),()=>{var s;const h={transitionDuration:`${a.duration}ms`,transform:a.distance?`translate3d(0,${a.distance}px, 0)`:""};return g("div",{ref:o,class:L()},[g("div",{ref:c,class:L("track"),style:h,onTouchstartPassive:k,onTouchend:U,onTouchcancel:U},[g("div",{class:L("head"),style:u()},[f()]),(s=t.default)==null?void 0:s.call(t)])])}}});const Ce=M($e),He=b({__name:"DataList",props:{refreshing:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!1},finished:{type:Boolean,require:!0,default:!1},page:{type:Number,require:!0,default:1},size:{type:Number,require:!0,default:10},list:{type:Array,require:!0,default:()=>[]},offset:{type:Number,default:500},refreshDisabled:{type:Boolean,default:!1},loadDisabled:{type:Boolean,default:!1}},emits:["update:refreshing","update:loading","update:finished","update:isFirstPull","update:page","update:size","getDataList"],setup(e,{emit:n}){let t=n,l=e;const o=H({get:()=>l.loading,set:u=>{t("update:loading",u)}}),c=H({get:()=>l.refreshing,set:u=>{t("update:refreshing",u)}}),d=()=>{l.refreshing&&(t("update:finished",!1),t("update:loading",!1),t("update:page",1)),t("getDataList")};let a;const i=()=>{t("update:refreshing",!0),t("update:loading",!0),a&&clearTimeout(a),a=setTimeout(d,1e3)};return N(()=>E(this,null,function*(){G("Component <<DataList>> mounted.")})),(u,r)=>{const P=Be,p=de,T=Ce;return C(),Y(T,{"model-value":c.value,"onUpdate:modelValue":r[1]||(r[1]=f=>c.value=f),onRefresh:i,disabled:e.refreshDisabled},{loading:S(()=>[g(p,null,{default:S(()=>[g(m(re),{icon:"ep:loading"})]),_:1})]),default:S(()=>[g(P,{loading:o.value,"onUpdate:loading":r[0]||(r[0]=f=>o.value=f),finished:e.finished,onLoad:d,offset:e.offset},{default:S(()=>[ue(u.$slots,"default")]),_:3},8,["loading","finished","offset"])]),_:3},8,["model-value","disabled"])}}}),Ae=b({__name:"announcement-list",props:{items:Array},setup(e){const n=e,t=l=>{he.push({path:"/announcement/details",query:{id:l}})};return(l,o)=>{const c=xe;return C(!0),K(O,null,ce(n.items,d=>(C(),Y(c,{key:d.id,onClick:a=>t(d.id)},{title:S(()=>[fe("p",null,ge(d.title),1)]),_:2},1032,["onClick"]))),128)}}});class Ne{constructor(){D(this,"refreshing",!1);D(this,"loading",!1);D(this,"finished",!1);D(this,"pagination",{page:0,size:10,total:0});D(this,"items",[])}}const Ue=()=>new Ne,we=(e,n,t)=>{var l,o,c,d,a,i,u;if((l=n==null?void 0:n.data)!=null&&l.content.length)for(const r of n.data.content)t&&me(t)?e.items.push(t(r)):e.items.push(r);return e.pagination.page=((c=(o=n==null?void 0:n.data)==null?void 0:o.pageable)==null?void 0:c.pageNumber)+1,e.pagination.size=(a=(d=n==null?void 0:n.data)==null?void 0:d.pageable)==null?void 0:a.pageSize,e.pagination.total=(i=n==null?void 0:n.data)==null?void 0:i.totalElements,e.loading=!1,e.refreshing=!1,(u=n==null?void 0:n.data)!=null&&u.last&&(e.finished=!0),e},Re=e=>(e.loading=!0,e.refreshing&&(e.items=[]),{page:e.pagination.page<=0?1:e.pagination.page+1,size:e.pagination.size}),qe=()=>({initialize:Ue,handleResult:we,handleParams:Re}),Xe=b({__name:"index",setup(e){const{initialize:n,handleResult:t,handleParams:l}=qe(),o=j(n()),c=y([]),d=()=>E(this,null,function*(){const a=yield Te(l(o));a&&(t(o,a),c.value=o.items)});return N(()=>E(this,null,function*(){G("Page <<AnnouncementIndexPage>> mounted.")})),(a,i)=>{const u=ve;return C(),K(O,null,[g(u,{title:"Announcement","left-arrow":"",onClickLeft:i[0]||(i[0]=r=>m(pe)())}),g(m(He),{finished:m(o).finished,"onUpdate:finished":i[1]||(i[1]=r=>m(o).finished=r),refreshing:m(o).refreshing,"onUpdate:refreshing":i[2]||(i[2]=r=>m(o).refreshing=r),loading:m(o).loading,"onUpdate:loading":i[3]||(i[3]=r=>m(o).loading=r),page:m(o).pagination.page,"onUpdate:page":i[4]||(i[4]=r=>m(o).pagination.page=r),size:m(o).pagination.size,"onUpdate:size":i[5]||(i[5]=r=>m(o).pagination.size=r),onGetDataList:d},{default:S(()=>[g(m(Ae),{items:m(c)},null,8,["items"])]),_:1},8,["finished","refreshing","loading","page","size"])],64)}}});export{Xe as default};
