var B=(e,t,a)=>new Promise((r,l)=>{var d=c=>{try{v(a.next(c))}catch(g){l(g)}},f=c=>{try{v(a.throw(c))}catch(g){l(g)}},v=c=>c.done?r(c.value):Promise.resolve(c.value).then(d,f);v((a=a.apply(e,t)).next())});import{u as De,s as Me,i as K,l as Ne,c as U,d as He,e as H,f as Z,g as I,n as Y,m as j,h as q,r as w,j as Fe,k as E,o as we,p as ae,w as Ae,q as Ce,t as o,v as le,H as ie,x as z,y as ee,z as $e,A as ke,B as Le,D as J,E as Q,L as Re,F as ce,G as Ue,I as de,J as je,K as Oe,M as Ke,N as Ye,O as ze,P as qe,Q as L,R as oe,S as se,T as R,U as ue,V as Ge,X as xe,Y as Je,Z as Qe,_ as me,$ as We,a0 as Xe,a1 as Pe,a2 as Ze,a3 as et,a4 as tt,a5 as nt,a6 as fe,a7 as ve,a8 as W,a9 as at}from"./index-1f9f59e0.js";import{B as N,F as he,R as lt,C as ge}from"./index-53ddebf5.js";import{N as ot}from"./index-04c11533.js";import{C as st}from"./index-678fa1bb.js";import{S as ut}from"./index-7b923fcc.js";import"./use-route-f0f50797.js";import"./use-placeholder-7ac71bab.js";const rt=e=>B(void 0,null,function*(){K.mode==="legacy"?K.global.locale=e:K.global.locale.value=e}),it=e=>B(void 0,null,function*(){K.global.setLocaleMessage(e,yield Ne(e))}),ct=e=>B(void 0,null,function*(){yield De().setLocale(e),yield it(e),yield rt(e),yield Me(e)}),dt=()=>({changeLocale:ct}),[mt,O,pe]=U("picker"),Ee=e=>e.find(t=>!t.disabled)||e[0];function ft(e,t){const a=e[0];if(a){if(Array.isArray(a))return"multiple";if(t.children in a)return"cascade"}return"default"}function te(e,t){t=Z(t,0,e.length);for(let a=t;a<e.length;a++)if(!e[a].disabled)return a;for(let a=t-1;a>=0;a--)if(!e[a].disabled)return a;return 0}const be=(e,t,a)=>t!==void 0&&!!e.find(r=>r[a.value]===t);function ne(e,t,a){const r=e.findIndex(d=>d[a.value]===t),l=te(e,r);return e[l]}function vt(e,t,a){const r=[];let l={[t.children]:e},d=0;for(;l&&l[t.children];){const f=l[t.children],v=a.value[d];if(l=He(v)?ne(f,v,t):void 0,!l&&f.length){const c=Ee(f)[t.value];l=ne(f,c,t)}d++,r.push(f)}return r}function ht(e){const{transform:t}=window.getComputedStyle(e),a=t.slice(7,t.length-1).split(", ")[5];return Number(a)}function gt(e){return H({text:"text",value:"value",children:"children"},e)}const ye=200,Se=300,pt=15,[Ie,X]=U("picker-column"),Ve=Symbol(Ie);var bt=I({name:Ie,props:{value:Y,fields:j(Object),options:q(),readonly:Boolean,allowHtml:Boolean,optionHeight:j(Number),swipeDuration:j(Y),visibleOptionNum:j(Y)},emits:["change","clickOption","scrollInto"],setup(e,{emit:t,slots:a}){let r,l,d,f,v;const c=w(),g=w(),b=w(0),y=w(0),C=Fe(),x=()=>e.options.length,V=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,k=h=>{const n=te(e.options,h),u=-n*e.optionHeight,i=()=>{const P=e.options[n][e.fields.value];P!==e.value&&t("change",P)};r&&u!==b.value?v=i:i(),b.value=u},s=()=>e.readonly||!e.options.length,m=h=>{r||s()||(v=null,y.value=ye,k(h),t("clickOption",e.options[h]))},p=h=>Z(Math.round(-h/e.optionHeight),0,x()-1),T=E(()=>p(b.value)),S=(h,n)=>{const u=Math.abs(h/n);h=b.value+u/.003*(h<0?-1:1);const i=p(h);y.value=+e.swipeDuration,k(i)},_=()=>{r=!1,y.value=0,v&&(v(),v=null)},F=h=>{if(!s()){if(C.start(h),r){const n=ht(g.value);b.value=Math.min(0,n-V())}y.value=0,l=b.value,d=Date.now(),f=l,v=null}},D=h=>{if(s())return;C.move(h),C.isVertical()&&(r=!0,le(h,!0));const n=Z(l+C.deltaY.value,-(x()*e.optionHeight),e.optionHeight),u=p(n);u!==T.value&&t("scrollInto",e.options[u]),b.value=n;const i=Date.now();i-d>Se&&(d=i,f=n)},A=()=>{if(s())return;const h=b.value-f,n=Date.now()-d;if(n<Se&&Math.abs(h)>pt){S(h,n);return}const i=p(b.value);y.value=ye,k(i),setTimeout(()=>{r=!1},0)},M=()=>{const h={height:`${e.optionHeight}px`};return e.options.map((n,u)=>{const i=n[e.fields.text],{disabled:P}=n,$=n[e.fields.value],Be={role:"button",style:h,tabindex:P?-1:0,class:[X("item",{disabled:P,selected:$===e.value}),n.className],onClick:()=>m(u)},_e={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:i};return o("li",Be,[a.option?a.option(n,u):o("div",_e,null)])})};return we(Ve),ae({stopMomentum:_}),Ae(()=>{const h=e.options.findIndex(i=>i[e.fields.value]===e.value),u=-te(e.options,h)*e.optionHeight;b.value=u}),Ce("touchmove",D,{target:c}),()=>o("div",{ref:c,class:X(),onTouchstartPassive:F,onTouchend:A,onTouchcancel:A},[o("ul",{ref:g,style:{transform:`translate3d(0, ${b.value+V()}px, 0)`,transitionDuration:`${y.value}ms`,transitionProperty:y.value?"all":"none"},class:X("wrapper"),onTransitionend:_},[M()])])}});const[yt]=U("picker-toolbar"),G={title:String,cancelButtonText:String,confirmButtonText:String},St=["cancel","confirm","title","toolbar"],Tt=Object.keys(G);var wt=I({name:yt,props:G,emits:["confirm","cancel"],setup(e,{emit:t,slots:a}){const r=()=>{if(a.title)return a.title();if(e.title)return o("div",{class:[O("title"),"van-ellipsis"]},[e.title])},l=()=>t("cancel"),d=()=>t("confirm"),f=()=>{const c=e.cancelButtonText||pe("cancel");return o("button",{type:"button",class:[O("cancel"),ie],onClick:l},[a.cancel?a.cancel():c])},v=()=>{const c=e.confirmButtonText||pe("confirm");return o("button",{type:"button",class:[O("confirm"),ie],onClick:d},[a.confirm?a.confirm():c])};return()=>o("div",{class:O("toolbar")},[a.toolbar?a.toolbar():[f(),r(),v()]])}});const[Ct,zt]=U("picker-group"),kt=Symbol(Ct);H({tabs:q(),activeTab:z(0),nextStepText:String},G);const Ot=H({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:z(44),showToolbar:ee,swipeDuration:z(1e3),visibleOptionNum:z(6)},G),xt=H({},Ot,{columns:q(),modelValue:q(),toolbarPosition:$e("top"),columnsFieldNames:Object});var Pt=I({name:mt,props:xt,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:t,slots:a}){const r=w(),l=w(e.modelValue.slice(0)),{parent:d}=we(kt),{children:f,linkChildren:v}=ke(Ve);v();const c=E(()=>gt(e.columnsFieldNames)),g=E(()=>Le(e.optionHeight)),b=E(()=>ft(e.columns,c.value)),y=E(()=>{const{columns:n}=e;switch(b.value){case"multiple":return n;case"cascade":return vt(n,c.value,l);default:return[n]}}),C=E(()=>y.value.some(n=>n.length)),x=E(()=>y.value.map((n,u)=>ne(n,l.value[u],c.value))),V=E(()=>y.value.map((n,u)=>n.findIndex(i=>i[c.value.value]===l.value[u]))),k=(n,u)=>{if(l.value[n]!==u){const i=l.value.slice(0);i[n]=u,l.value=i}},s=()=>({selectedValues:l.value.slice(0),selectedOptions:x.value,selectedIndexes:V.value}),m=(n,u)=>{k(u,n),b.value==="cascade"&&l.value.forEach((i,P)=>{const $=y.value[P];be($,i,c.value)||k(P,$.length?$[0][c.value.value]:void 0)}),de(()=>{t("change",H({columnIndex:u},s()))})},p=(n,u)=>{const i={columnIndex:u,currentOption:n};t("clickOption",H(s(),i)),t("scrollInto",i)},T=()=>{f.forEach(u=>u.stopMomentum());const n=s();return de(()=>{t("confirm",n)}),n},S=()=>t("cancel",s()),_=()=>y.value.map((n,u)=>o(bt,{value:l.value[u],fields:c.value,options:n,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:g.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:i=>m(i,u),onClickOption:i=>p(i,u),onScrollInto:i=>{t("scrollInto",{currentOption:i,columnIndex:u})}},{option:a.option})),F=n=>{if(C.value){const u={height:`${g.value}px`},i={backgroundSize:`100% ${(n-g.value)/2}px`};return[o("div",{class:O("mask"),style:i},null),o("div",{class:[je,O("frame")],style:u},null)]}},D=()=>{const n=g.value*+e.visibleOptionNum,u={height:`${n}px`};return o("div",{ref:r,class:O("columns"),style:u},[_(),F(n)])},A=()=>{if(e.showToolbar&&!d)return o(wt,Ue(ce(e,Tt),{onConfirm:T,onCancel:S}),ce(a,St))};J(y,n=>{n.forEach((u,i)=>{u.length&&!be(u,l.value[i],c.value)&&k(i,Ee(u)[c.value.value])})},{immediate:!0});let M;return J(()=>e.modelValue,n=>{!Q(n,l.value)&&!Q(n,M)&&(l.value=n.slice(0),M=n.slice(0))},{deep:!0}),J(l,n=>{Q(n,e.modelValue)||(M=n.slice(0),t("update:modelValue",M))},{immediate:!0}),Ce("touchmove",le,{target:r}),ae({confirm:T,getSelectedOptions:()=>x.value}),()=>{var n,u;return o("div",{class:O()},[e.toolbarPosition==="top"?A():null,e.loading?o(Re,{class:O("loading")},null):null,(n=a["columns-top"])==null?void 0:n.call(a),D(),(u=a["columns-bottom"])==null?void 0:u.call(a),e.toolbarPosition==="bottom"?A():null])}}});const re=Oe(Pt),[Et,It]=U("form"),Vt={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:Y,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:ee,showErrorMessage:ee,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var Bt=I({name:Et,props:Vt,emits:["submit","failed"],setup(e,{emit:t,slots:a}){const{children:r,linkChildren:l}=ke(Ke),d=s=>s?r.filter(m=>s.includes(m.name)):r,f=s=>new Promise((m,p)=>{const T=[];d(s).reduce((_,F)=>_.then(()=>{if(!T.length)return F.validate().then(D=>{D&&T.push(D)})}),Promise.resolve()).then(()=>{T.length?p(T):m()})}),v=s=>new Promise((m,p)=>{const T=d(s);Promise.all(T.map(S=>S.validate())).then(S=>{S=S.filter(Boolean),S.length?p(S):m()})}),c=s=>{const m=r.find(p=>p.name===s);return m?new Promise((p,T)=>{m.validate().then(S=>{S?T(S):p()})}):Promise.reject()},g=s=>typeof s=="string"?c(s):e.validateFirst?f(s):v(s),b=s=>{typeof s=="string"&&(s=[s]),d(s).forEach(p=>{p.resetValidation()})},y=()=>r.reduce((s,m)=>(s[m.name]=m.getValidationStatus(),s),{}),C=(s,m)=>{r.some(p=>p.name===s?(p.$el.scrollIntoView(m),!0):!1)},x=()=>r.reduce((s,m)=>(m.name!==void 0&&(s[m.name]=m.formValue.value),s),{}),V=()=>{const s=x();g().then(()=>t("submit",s)).catch(m=>{t("failed",{values:s,errors:m}),e.scrollToError&&m[0].name&&C(m[0].name)})},k=s=>{le(s),V()};return l({props:e}),ae({submit:V,validate:g,getValues:x,scrollToField:C,resetValidation:b,getValidationStatus:y}),()=>{var s;return o("form",{class:It(),onSubmit:k},[(s=a.default)==null?void 0:s.call(a)])}}});const _t=Oe(Bt);function Te(e){return typeof e=="function"?e():ze(e)}function Dt(e=!1,t={}){const{truthyValue:a=!0,falsyValue:r=!1}=t,l=Ye(e),d=w(e);function f(v){if(arguments.length)return d.value=v,d.value;{const c=Te(a);return d.value=d.value===c?Te(r):c,d.value}}return l?f:[d,f]}const Mt=I({name:"LocaleSelector",setup(){const{changeLocale:e}=dt(),t=w(!1),a=qe.map(l=>({text:l.title,value:l.locale})),r=l=>{R(l),ue(l.selectedValues)&&e(Ge(l.selectedValues[0])),t.value=!1};return()=>o(se,null,[o(N,{plain:!0,hairline:!0,square:!0,type:"primary",size:"small",onClick:()=>{t.value=!0}},{default:()=>[L("语言")]}),o(oe,{show:t.value,round:!0,position:"bottom"},{default:()=>[o(re,{columns:a,onConfirm:r,onCancel:()=>{t.value=!1}},null)]})])}}),Nt=I({name:"ThemePicker",setup(){const e=xe(),t=w(!1),a=Je.map(l=>({text:l.title,value:l.strategy})),r=l=>{if(R(l),t.value=!1,ue(l.selectedValues)){const d=Qe(l.selectedValues[0]);e.setDarkStrategy(d),e.setDark(me(d)),We(me(d))}};return()=>o(se,null,[o(N,{plain:!0,hairline:!0,type:"primary",size:"small",onClick:()=>{t.value=!0}},{default:()=>[L("深色模式")]}),o(oe,{show:t.value,round:!0,position:"bottom"},{default:()=>[o(re,{columns:a,onConfirm:r,onCancel:()=>{t.value=!1}},null)]})])}}),Ht=I({name:"ThemeSelector",setup(){const e=xe(),t=w(!1),a=Xe.map(l=>({text:l.title,value:l.theme})),r=l=>{R(l),t.value=!1,ue(l.selectedValues)&&e.setTheme(Ze(l.selectedValues[0]))};return Pe(()=>B(this,null,function*(){R("Component <<ThemeSelector>> mounted.")})),()=>o(se,null,[o(N,{plain:!0,hairline:!0,type:"primary",size:"small",onClick:()=>{t.value=!0}},{default:()=>[L("主题")]}),o(oe,{show:t.value,round:!0,position:"bottom"},{default:()=>[o(re,{columns:a,onConfirm:r,onCancel:()=>{t.value=!1}},null)]})])}});function Ft(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const qt=I({name:"UserCenterPage",setup(){const{t:e}=et(),t=tt(),a=nt(),[r,l]=Dt(!1),d=w(),f=fe({grant_type:"password",client_id:ve.auth.oauth.clientId,client_secret:ve.auth.oauth.clientSecret,username:"admin",password:"admin"}),v=fe({username:[{required:!0,message:"Please input username"}],password:[{required:!0,message:"Please input password"}]}),c=g=>B(this,null,function*(){try{yield g.validate(),t.login(f).then(()=>{a.push("/")})}catch(b){return}});return Pe(()=>B(this,null,function*(){R("Page - <Login> is mounted.")})),()=>{let g;return o("div",null,[o(ot,{title:e("common.title")},null),o("div",null,[o(_t,{ref:d},{default:()=>[o(st,{inset:!0},{default:()=>[o(he,{modelValue:f.username,placeholder:e("common.user_field_username"),rules:v.username},{leftIcon:()=>o(W,{name:"scan"},null)}),o(he,{modelValue:f.password,placeholder:e("common.user_field_password"),rules:v.password,type:r?"password":"text"},{leftIcon:()=>o(W,{name:"scan"},null),rightIcon:()=>o(W,{name:"scan"},null)}),o("div",{class:"my-2"},[o(N,{onClick:c,type:"primary",block:!0},Ft(g=e("common.button_login"))?g:{default:()=>[g]})])]}),o(lt,{class:"px-4 pt-4"},{default:()=>[o(ge,{span:"12",class:"text-left"},{default:()=>[o(ut,null,{default:()=>[o(Mt,null,null),o(Nt,null,null),o(Ht,null,null)]})]}),o(ge,{span:"12",class:"text-right"},{default:()=>[o(N,{size:"small"},{default:()=>[L("忘记密码")]}),o(N,{size:"small"},{default:()=>[L("注册")]})]})]})]})])])}}});export{qt as default};
