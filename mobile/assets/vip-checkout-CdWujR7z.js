var F=(n,c,o)=>new Promise((r,y)=>{var T=u=>{try{C(o.next(u))}catch(g){y(g)}},_=u=>{try{C(o.throw(u))}catch(g){y(g)}},C=u=>u.done?r(u.value):Promise.resolve(u.value).then(T,_);C((o=o.apply(n,c)).next())});import{e as q,aC as le,b5 as re,aA as $,b6 as ue,az as E,b7 as pe,d as K,b as t,aX as de,b8 as me,at as ve,as as H,b9 as _e,ba as fe,aS as be,y as J,m as he,r as x,bb as ge,aj as ye,al as Ce,g as U,o as ke,l as Se,a as m,c as B,w as p,u as l,ak as N,F as P,a9 as O,ac as M,ae as z,H as b,ag as xe,ad as Te,ah as S,b2 as we}from"./index-BsckSs91.js";/* empty css              *//* empty css                                                              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{N as Ae}from"./index-C1cRV1Vb.js";import{C as Be,a as Ie}from"./core.service-CD_swMQq.js";import{A as X}from"./index-D2VPe6vv.js";import{_ as Pe}from"./AppIcon.vue_vue_type_script_setup_true_lang-BueG8wjr.js";import{v as Le,p as Ne,T as $e,a as Oe}from"./mall-UiM3z2pX.js";import{S as Ve}from"./index-rT_7cQpq.js";import{C as Re}from"./index-CZm3bwEC.js";import{S as De,a as Fe}from"./index-DJeD0buO.js";import{I as Ue}from"./index-DLQV-2Vp.js";import{C as ze}from"./index-BxLYQVbA.js";import{_ as Ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-id-BbSD8eVd.js";import"./use-tab-status-tI1Boim_.js";const[He,v]=q("action-sheet"),Ke=le({},re,{title:String,round:$,actions:ue(),closeIcon:E("cross"),closeable:$,cancelText:String,description:String,closeOnPopstate:$,closeOnClickAction:Boolean,safeAreaInsetBottom:$}),je=[...pe,"round","closeOnPopstate","safeAreaInsetBottom"];var Ge=K({name:He,props:Ke,emits:["select","cancel","update:show"],setup(n,{slots:c,emit:o}){const r=e=>o("update:show",e),y=()=>{r(!1),o("cancel")},T=()=>{if(n.title)return t("div",{class:v("header")},[n.title,n.closeable&&t(H,{name:n.closeIcon,class:[v("close"),_e],onClick:y},null)])},_=()=>{if(c.cancel||n.cancelText)return[t("div",{class:v("gap")},null),t("button",{type:"button",class:v("cancel"),onClick:y},[c.cancel?c.cancel():n.cancelText])]},C=e=>{if(e.icon)return t(H,{class:v("item-icon"),name:e.icon},null)},u=(e,f)=>e.loading?t(fe,{class:v("loading-icon")},null):c.action?c.action({action:e,index:f}):[t("span",{class:v("name")},[e.name]),e.subname&&t("div",{class:v("subname")},[e.subname])],g=(e,f)=>{const{color:L,loading:d,callback:w,disabled:A,className:I}=e,V=()=>{A||d||(w&&w(e),n.closeOnClickAction&&r(!1),be(()=>o("select",e,f)))};return t("button",{type:"button",style:{color:L},class:[v("item",{loading:d,disabled:A}),I],onClick:V},[C(e),u(e,f)])},i=()=>{if(n.description||c.description){const e=c.description?c.description():n.description;return t("div",{class:v("description")},[e])}};return()=>t(ve,de({class:v(),position:"bottom","onUpdate:show":r},me(n,je)),{default:()=>{var e;return[T(),i(),t("div",{class:v("content")},[n.actions.map(g),(e=c.default)==null?void 0:e.call(c)]),_()]}})}});const Me=J(Ge),[Xe,h,qe]=q("submit-bar"),Je={tip:String,label:String,price:Number,tipIcon:String,loading:Boolean,currency:E("¥"),disabled:Boolean,textAlign:String,buttonText:String,buttonType:E("danger"),buttonColor:String,suffixLabel:String,placeholder:Boolean,decimalLength:he(2),safeAreaInsetBottom:$};var Qe=K({name:Xe,props:Je,emits:["submit"],setup(n,{emit:c,slots:o}){const r=x(),y=ge(r,h),T=()=>{const{price:i,label:e,currency:f,textAlign:L,suffixLabel:d,decimalLength:w}=n;if(typeof i=="number"){const A=(i/100).toFixed(+w).split("."),I=w?`.${A[1]}`:"";return t("div",{class:h("text"),style:{textAlign:L}},[t("span",null,[e||qe("label")]),t("span",{class:h("price")},[f,t("span",{class:h("price-integer")},[A[0]]),I]),d&&t("span",{class:h("suffix-label")},[d])])}},_=()=>{var i;const{tip:e,tipIcon:f}=n;if(o.tip||e)return t("div",{class:h("tip")},[f&&t(H,{class:h("tip-icon"),name:f},null),e&&t("span",{class:h("tip-text")},[e]),(i=o.tip)==null?void 0:i.call(o)])},C=()=>c("submit"),u=()=>o.button?o.button():t(ye,{round:!0,type:n.buttonType,text:n.buttonText,class:h("button",n.buttonType),color:n.buttonColor,loading:n.loading,disabled:n.disabled,onClick:C},null),g=()=>{var i,e;return t("div",{ref:r,class:[h(),{"van-safe-area-bottom":n.safeAreaInsetBottom}]},[(i=o.top)==null?void 0:i.call(o),_(),t("div",{class:h("bar")},[(e=o.default)==null?void 0:e.call(o),T(),u()])])};return()=>n.placeholder?y(g):g()}});const We=J(Qe),Ye={class:"mx-4"},Ze={class:"flex"},et={class:"flex-none p-4 text-center"},tt={class:"flex-1 py-4"},nt={class:"app-text-primary"},at={class:"vip-item-container"},ot=["onClick"],st=["onClick"],ct=K({__name:"vip-checkout",setup(n){const{user:c,isAuthenticated:o}=Ce(),r=x([]),y=U(()=>r.value.length&&r.value.length>0),T=x(),_=x(0),C=s=>{u.value.swipeTo(s),e.value=0},u=x(),g=s=>{_.value=s},i=U(()=>r.value.at(_.value)),e=x(0),f=(s=0)=>e.value===s?"vip-item vip-item-active":"vip-item",L=(s=0)=>{e.value=s},d=x(!1),w=()=>{d.value=!1},A=()=>{d.value=!1},I=x([]),V=U(()=>{var s,k;return((k=(s=i==null?void 0:i.value)==null?void 0:s.items)==null?void 0:k.at(e.value).price)*100}),Q=()=>{d.value=!0},W=(s="")=>{alert(s)};return ke(()=>F(this,null,function*(){Se("Page <<VipOrderCheckout>> mounted."),yield Be.initialize().then(()=>F(this,null,function*(){yield Le().then(s=>{r.value=s.data}),yield Ne().then(s=>{I.value=s.data})}))})),(s,k)=>{var j,G;const Y=Oe,Z=$e,ee=Ae,te=Ve,ne=Ue,R=Re,ae=Fe,oe=De,se=We,ce=ze,ie=Me;return m(),B(P,null,[t(te,null,{default:p(()=>[t(ee,{border:!1,"left-arrow":"",onClickLeft:k[1]||(k[1]=a=>l(Te)())},{title:p(()=>[l(y)?(m(),N(Z,{key:0,ref_key:"vipTypeTabsRef",ref:T,active:l(_),"onUpdate:active":k[0]||(k[0]=a=>M(_)?_.value=a:null),"line-width":20,onChange:C},{default:p(()=>[(m(!0),B(P,null,O(l(r),a=>(m(),N(Y,{key:a.code},{title:p(()=>[b("div",Ye,S(a.title),1)]),_:2},1024))),128))]),_:1},8,["active"])):z("",!0)]),_:1})]),_:1}),t(l(X)),t(oe,{ref_key:"vipTypeSwipeRef",ref:u,"indicator-color":"white",onChange:g},{default:p(()=>[(m(!0),B(P,null,O(l(r),a=>(m(),N(ae,{key:a.code},{default:p(()=>[l(o)?(m(),N(R,{key:0,inset:""},{default:p(()=>[b("div",Ze,[b("div",et,[t(ne,{round:"",class:"!align-middle",width:"3.2rem",height:"3.2rem",src:l(Ie)},null,8,["src"])]),b("div",tt,[b("div",nt,S(l(c).username)+" - "+S(a.code),1)])])]),_:2},1024)):z("",!0)]),_:2},1024))),128))]),_:1},512),((G=(j=l(i))==null?void 0:j.items)==null?void 0:G.length)>0?(m(),B(P,{key:0},[t(l(X)),b("div",at,[(m(!0),B(P,null,O(l(i).items,(a,D)=>(m(),B("div",{key:a.code,class:we(f(D)),onClick:it=>L(D)},[t(R,{border:!0,inset:"",class:"app-no-margin p-2"},{default:p(()=>[b("div",null,S(a.code),1),b("div",null,S(a.title),1),b("div",null,S(a.listPrice),1),b("div",null,S(a.price),1)]),_:2},1024)],10,ot))),128))])],64)):z("",!0),t(se,{price:l(V),"button-text":s.$t("common.button_renew"),onSubmit:Q},{tip:p(()=>[xe("开通会员代表接受会员服务协议")]),_:1},8,["price","button-text"]),t(ie,{show:l(d),"onUpdate:show":k[2]||(k[2]=a=>M(d)?d.value=a:null),"cancel-text":s.$t("common.button_cancel"),"close-on-click-action":"",closeable:"",onCancel:w,onSelect:A,title:"请选择支付方式"},{default:p(()=>[t(R,{inset:"",class:"!my-4"},{default:p(()=>[(m(!0),B(P,null,O(l(I),a=>(m(),N(ce,{key:a.code,"is-link":""},{icon:p(()=>[t(l(Pe),{icon:a.icon},null,8,["icon"])]),title:p(()=>[b("div",{class:"app-text ml-4",onClick:D=>W(a.code)},S(a.title),9,st)]),_:2},1024))),128))]),_:1})]),_:1},8,["show","cancel-text"])],64)}}}),It=Ee(ct,[["__scopeId","data-v-9679ad2e"]]);export{It as default};
