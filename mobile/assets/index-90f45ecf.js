import{ay as e,az as t,aA as a,aB as r,aC as l,c as n,ab as s,n as o,$ as i,aD as u,d as c,J as d,r as g,ag as f,B as p,U as v,e as m,aE as h,aF as y,X as b,_ as x,L as w,ai as k,f as S,al as C,F as V,V as M,aG as I,aH as B,p as E,Q as A,a2 as $,i as j,aI as L,w as T,u as z,t as P}from"./index-cb371d87.js";import{c as W,C as F}from"./index-fe35a31d.js";import{u as R}from"./index-d6c258a4.js";function H(e){return Array.isArray(e)?!e.length:0!==e&&!e}function q(e,t){const{message:a}=t;return l(a)?a(e,t):a||""}function D({target:e}){e.composing=!0}function N({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function O(e){return[...e].length}function G(e,t){return[...e].slice(0,t).join("")}const[J,K]=n("field"),Q={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:o,formatter:Function,clearIcon:i("clear"),modelValue:C(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:i("focus"),formatTrigger:i("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}};const U=T(c({name:J,props:s({},W,Q,{rows:o,type:i("text"),rules:Array,autosize:[Boolean,Object],labelWidth:o,labelClass:u,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}}),emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(l,{emit:n,slots:s}){const o=R(),i=d({status:"unvalidated",focused:!1,validateMessage:""}),u=g(),c=g(),C=g(),{parent:T}=f(V),z=()=>{var e;return String(null!=(e=l.modelValue)?e:"")},P=e=>M(l[e])?l[e]:T&&M(T.props[e])?T.props[e]:void 0,W=p((()=>{const e=P("readonly");if(l.clearable&&!e){const e=""!==z(),t="always"===l.clearTrigger||"focus"===l.clearTrigger&&i.focused;return e&&t}return!1})),J=p((()=>C.value&&s.input?C.value():l.modelValue)),Q=e=>e.reduce(((e,t)=>e.then((()=>{if("failed"===i.status)return;let{value:e}=J;if(t.formatter&&(e=t.formatter(e,t)),!function(e,t){if(H(e)){if(t.required)return!1;if(!1===t.validateEmpty)return!0}return!(t.pattern&&!t.pattern.test(String(e)))}(e,t))return i.status="failed",void(i.validateMessage=q(e,t));if(t.validator){if(H(e)&&!1===t.validateEmpty)return;return function(e,t){return new Promise((a=>{const l=t.validator(e,t);r(l)?l.then(a):a(l)}))}(e,t).then((a=>{a&&"string"==typeof a?(i.status="failed",i.validateMessage=a):!1===a&&(i.status="failed",i.validateMessage=q(e,t))}))}}))),Promise.resolve()),U=()=>{i.status="unvalidated",i.validateMessage=""},X=()=>n("endValidate",{status:i.status,message:i.validateMessage}),_=(e=l.rules)=>new Promise((t=>{U(),e?(n("startValidate"),Q(e).then((()=>{"failed"===i.status?(t({name:l.name,message:i.validateMessage}),X()):(i.status="passed",t(),X())}))):t()})),Y=e=>{if(T&&l.rules){const{validateTrigger:t}=T.props,a=I(t).includes(e),r=l.rules.filter((t=>t.trigger?I(t.trigger).includes(e):a));r.length&&_(r)}},Z=(e,t="onChange")=>{const a=e;e=(e=>{var t;const{maxlength:a}=l;if(M(a)&&O(e)>+a){const r=z();if(r&&O(r)===+a)return r;const l=null==(t=u.value)?void 0:t.selectionEnd;if(i.focused&&l){const t=[...e],r=t.length-+a;return t.splice(l-r,r),t.join("")}return G(e,+a)}return e})(e);const r=O(a)-O(e);if("number"===l.type||"digit"===l.type){const t="number"===l.type;e=B(e,t,t)}let s=0;if(l.formatter&&t===l.formatTrigger){const{formatter:t,maxlength:r}=l;if(e=t(e),M(r)&&O(e)>+r&&(e=G(e,+r)),u.value&&i.focused){const{selectionEnd:e}=u.value,r=G(a,e);s=O(t(r))-O(r)}}if(u.value&&u.value.value!==e)if(i.focused){let{selectionStart:t,selectionEnd:a}=u.value;if(u.value.value=e,M(t)&&M(a)){const l=O(e);r?(t-=r,a-=r):s&&(t+=s,a+=s),u.value.setSelectionRange(Math.min(t,l),Math.min(a,l))}}else u.value.value=e;e!==l.modelValue&&n("update:modelValue",e)},ee=e=>{e.target.composing||Z(e.target.value)},te=()=>{var e;return null==(e=u.value)?void 0:e.blur()},ae=()=>{const r=u.value;"textarea"===l.type&&l.autosize&&r&&function(r,l){const n=e();r.style.height="auto";let s=r.scrollHeight;if(a(l)){const{maxHeight:e,minHeight:t}=l;void 0!==e&&(s=Math.min(s,e)),void 0!==t&&(s=Math.max(s,t))}s&&(r.style.height=`${s}px`,t(n))}(r,l.autosize)},re=e=>{i.focused=!0,n("focus",e),x(ae),P("readonly")&&te()},le=e=>{i.focused=!1,Z(z(),"onBlur"),n("blur",e),P("readonly")||(Y("onBlur"),x(ae),L())},ne=e=>n("clickInput",e),se=e=>n("clickLeftIcon",e),oe=e=>n("clickRightIcon",e),ie=p((()=>"boolean"==typeof l.error?l.error:!(!T||!T.props.showError||"failed"!==i.status)||void 0)),ue=p((()=>{const e=P("labelWidth"),t=P("labelAlign");if(e&&"top"!==t)return{width:v(e)}})),ce=e=>{if(13===e.keyCode){T&&T.props.submitOnEnter||"textarea"===l.type||E(e),"search"===l.type&&te()}n("keypress",e)},de=()=>l.id||`${o}-input`,ge=()=>{const e=K("control",[P("inputAlign"),{error:ie.value,custom:!!s.input,"min-height":"textarea"===l.type&&!l.autosize}]);if(s.input)return S("div",{class:e,onClick:ne},[s.input()]);const t={id:de(),ref:u,name:l.name,rows:void 0!==l.rows?+l.rows:void 0,class:e,disabled:P("disabled"),readonly:P("readonly"),autofocus:l.autofocus,placeholder:l.placeholder,autocomplete:l.autocomplete,enterkeyhint:l.enterkeyhint,"aria-labelledby":l.label?`${o}-label`:void 0,onBlur:le,onFocus:re,onInput:ee,onClick:ne,onChange:N,onKeypress:ce,onCompositionend:N,onCompositionstart:D};return"textarea"===l.type?S("textarea",t,null):S("input",$("number"===(a=l.type)?{type:"text",inputmode:"decimal"}:"digit"===a?{type:"tel",inputmode:"numeric"}:{type:a},t),null);var a},fe=()=>{const e=s["right-icon"];if(l.rightIcon||e)return S("div",{class:K("right-icon"),onClick:oe},[e?e():S(A,{name:l.rightIcon,classPrefix:l.iconPrefix},null)])},pe=()=>{if(l.showWordLimit&&l.maxlength){const e=O(z());return S("div",{class:K("word-limit")},[S("span",{class:K("word-num")},[e]),j("/"),l.maxlength])}},ve=()=>{if(T&&!1===T.props.showErrorMessage)return;const e=l.errorMessage||i.validateMessage;if(e){const t=s["error-message"],a=P("errorMessageAlign");return S("div",{class:K("error-message",a)},[t?t({message:e}):e])}},me=()=>[S("div",{class:K("body")},[ge(),W.value&&S(A,{ref:c,name:l.clearIcon,class:K("clear")},null),fe(),s.button&&S("div",{class:K("button")},[s.button()])]),pe(),ve()];return m({blur:te,focus:()=>{var e;return null==(e=u.value)?void 0:e.focus()},validate:_,formValue:J,resetValidation:U,getValidationStatus:()=>i.status}),h(y,{customValue:C,resetValidation:U,validateWithTrigger:Y}),b((()=>l.modelValue),(()=>{Z(z()),U(),Y("onChange"),x(ae)})),w((()=>{Z(z(),l.formatTrigger),x(ae)})),k("touchstart",(e=>{E(e),n("update:modelValue",""),n("clear",e)}),{target:p((()=>{var e;return null==(e=c.value)?void 0:e.$el}))}),()=>{const e=P("disabled"),t=P("labelAlign"),a=(()=>{const e=s["left-icon"];if(l.leftIcon||e)return S("div",{class:K("left-icon"),onClick:se},[e?e():S(A,{name:l.leftIcon,classPrefix:l.iconPrefix},null)])})();return S(F,{size:l.size,class:K({error:ie.value,disabled:e,[`label-${t}`]:t}),center:l.center,border:l.border,isLink:l.isLink,clickable:l.clickable,titleStyle:ue.value,valueClass:K("value"),titleClass:[K("label",[t,{required:l.required}]),l.labelClass],arrowDirection:l.arrowDirection},{icon:a&&"top"!==t?()=>a:null,title:()=>{const e=(()=>{const e=P("labelWidth"),t=P("labelAlign"),a=P("colon")?":":"";return s.label?[s.label(),a]:l.label?S("label",{id:`${o}-label`,for:de(),style:"top"===t&&e?{width:v(e)}:void 0},[l.label+a]):void 0})();return"top"===t?[a,e].filter(Boolean):e||[]},value:me,extra:s.extra})}}})),[X,_]=n("row"),Y=Symbol(X);var Z=c({name:X,props:{tag:i("div"),wrap:P,align:String,gutter:C(0),justify:String},setup(e,{slots:t}){const{children:a,linkChildren:r}=z(Y),l=p((()=>{const e=[[]];let t=0;return a.forEach(((a,r)=>{t+=Number(a.span),t>24?(e.push([r]),t-=24):e[e.length-1].push(r)})),e}));return r({spaces:p((()=>{const t=Number(e.gutter),a=[];return t?(l.value.forEach((e=>{const r=t*(e.length-1)/e.length;e.forEach(((e,l)=>{if(0===l)a.push({right:r});else{const l=t-a[e-1].right,n=r-l;a.push({left:l,right:n})}}))})),a):a}))}),()=>{const{tag:a,wrap:r,align:l,justify:n}=e;return S(a,{class:_({[`align-${l}`]:l,[`justify-${n}`]:n,nowrap:!r})},{default:()=>{var e;return[null==(e=t.default)?void 0:e.call(t)]}})}}});const[ee,te]=n("col");const ae=T(c({name:ee,props:{tag:i("div"),span:C(0),offset:o},setup(e,{slots:t}){const{parent:a,index:r}=f(Y),l=p((()=>{if(!a)return;const{spaces:e}=a;if(e&&e.value&&e.value[r.value]){const{left:t,right:a}=e.value[r.value];return{paddingLeft:t?`${t}px`:null,paddingRight:a?`${a}px`:null}}}));return()=>{const{tag:a,span:r,offset:n}=e;return S(a,{style:l.value,class:te({[r]:r,[`offset-${n}`]:n})},{default:()=>{var e;return[null==(e=t.default)?void 0:e.call(t)]}})}}})),re=T(Z);export{ae as C,U as F,re as R,Q as f};
