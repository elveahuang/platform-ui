var Q=Object.defineProperty;var W=(e,n,t)=>n in e?Q(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var T=(e,n,t)=>(W(e,typeof n!="symbol"?n+"":n,t),t);var z=(e,n,t)=>new Promise((r,o)=>{var c=i=>{try{a(t.next(i))}catch(u){o(u)}},d=i=>{try{a(t.throw(i))}catch(u){o(u)}},a=i=>i.done?r(i.value):Promise.resolve(i.value).then(c,d);a((t=t.apply(e,n)).next())});import{c as V,L as E,M as Z,t as J,d as b,r as y,N as A,O as C,Q as N,R as ee,D as R,a as te,S as q,b as g,T as I,U as w,V as ne,W as F,w as M,n as ae,B as G,X as ie,p as se,Y as oe,E as Y,o as H,Z as O,g as S,h as m,I as re,H as le,l as ue,f as X,_ as de,i as j,G as ce,K as fe,$ as ge,a0 as he,a1 as me}from"./index-fdcc9273.js";/* empty css              */import{N as pe}from"./index-d5e84a44.js";/* empty css              *//* empty css              */import{C as ve}from"./index-c8493220.js";import{u as xe}from"./use-tab-status-3949fd9b.js";import{a as De}from"./announcement-ddcfd923.js";import"./use-placeholder-c9b07a85.js";import"./use-route-82635e43.js";const[Te,_,_e]=V("list"),Se={error:Boolean,offset:E(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:Z("down"),loadingText:String,finishedText:String,immediateCheck:J};var ye=b({name:Te,props:Se,emits:["load","update:error","update:loading"],setup(e,{emit:n,slots:t}){const r=y(e.loading),o=y(),c=y(),d=xe(),a=A(o),i=C(()=>e.scroller||a.value),u=()=>{I(()=>{if(r.value||e.finished||e.disabled||e.error||(d==null?void 0:d.value)===!1)return;const{direction:f}=e,x=+e.offset,v=w(i);if(!v.height||ne(o))return;let k=!1;const $=w(c);f==="up"?k=v.top-$.top<=x:k=$.bottom-v.bottom<=x,k&&(r.value=!0,n("update:loading",!0),n("load"))})},l=()=>{if(e.finished){const f=t.finished?t.finished():e.finishedText;if(f)return g("div",{class:_("finished-text")},[f])}},P=()=>{n("update:error",!1),u()},p=()=>{if(e.error){const f=t.error?t.error():e.errorText;if(f)return g("div",{role:"button",class:_("error-text"),tabindex:0,onClick:P},[f])}},D=()=>{if(r.value&&!e.finished&&!e.disabled)return g("div",{class:_("loading")},[t.loading?t.loading():g(F,{class:_("loading-icon")},{default:()=>[e.loadingText||_e("loading")]})])};return N(()=>[e.loading,e.finished,e.error],u),d&&N(d,f=>{f&&u()}),ee(()=>{r.value=e.loading}),R(()=>{e.immediateCheck&&u()}),te({check:u}),q("scroll",u,{target:i,passive:!0}),()=>{var f;const x=(f=t.default)==null?void 0:f.call(t),v=g("div",{ref:c,class:_("placeholder")},null);return g("div",{ref:o,role:"feed",class:_(),"aria-busy":r.value},[e.direction==="down"?x:v,D(),l(),p(),e.direction==="up"?x:v])}}});const Pe=M(ye),[ke,L,Be]=V("pull-refresh"),K=50,Le=["pulling","loosing","success"],be={disabled:Boolean,modelValue:Boolean,headHeight:E(K),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:ae,successDuration:E(500),animationDuration:E(300)};var $e=b({name:ke,props:be,emits:["change","refresh","update:modelValue"],setup(e,{emit:n,slots:t}){let r;const o=y(),c=y(),d=A(o),a=G({status:"normal",distance:0,duration:0}),i=ie(),u=()=>{if(e.headHeight!==K)return{height:`${e.headHeight}px`}},l=()=>a.status!=="loading"&&a.status!=="success"&&!e.disabled,P=s=>{const h=+(e.pullDistance||e.headHeight);return s>h&&(s<h*2?s=h+(s-h)/2:s=h*1.5+(s-h*2)/4),Math.round(s)},p=(s,h)=>{const B=+(e.pullDistance||e.headHeight);a.distance=s,h?a.status="loading":s===0?a.status="normal":s<B?a.status="pulling":a.status="loosing",n("change",{status:a.status,distance:s})},D=()=>{const{status:s}=a;return s==="normal"?"":e[`${s}Text`]||Be(s)},f=()=>{const{status:s,distance:h}=a;if(t[s])return t[s]({distance:h});const B=[];return Le.includes(s)&&B.push(g("div",{class:L("text")},[D()])),s==="loading"&&B.push(g(F,{class:L("loading")},{default:D})),B},x=()=>{a.status="success",setTimeout(()=>{p(0)},+e.successDuration)},v=s=>{r=oe(d.value)===0,r&&(a.duration=0,i.start(s))},k=s=>{l()&&v(s)},$=s=>{if(l()){r||v(s);const{deltaY:h}=i;i.move(s),r&&h.value>=0&&i.isVertical()&&(se(s),p(P(h.value)))}},U=()=>{r&&i.deltaY.value&&l()&&(a.duration=+e.animationDuration,a.status==="loosing"?(p(+e.headHeight,!0),n("update:modelValue",!0),I(()=>n("refresh"))):p(0))};return N(()=>e.modelValue,s=>{a.duration=+e.animationDuration,s?p(+e.headHeight,!0):t.success||e.successText?x():p(0,!1)}),q("touchmove",$,{target:c}),()=>{var s;const h={transitionDuration:`${a.duration}ms`,transform:a.distance?`translate3d(0,${a.distance}px, 0)`:""};return g("div",{ref:o,class:L()},[g("div",{ref:c,class:L("track"),style:h,onTouchstartPassive:k,onTouchend:U,onTouchcancel:U},[g("div",{class:L("head"),style:u()},[f()]),(s=t.default)==null?void 0:s.call(t)])])}}});const ze=M($e),Ee=b({__name:"DataList",props:{refreshing:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!1},finished:{type:Boolean,require:!0,default:!1},page:{type:Number,require:!0,default:1},size:{type:Number,require:!0,default:10},list:{type:Array,require:!0,default:()=>[]},offset:{type:Number,default:500},refreshDisabled:{type:Boolean,default:!1},loadDisabled:{type:Boolean,default:!1}},emits:["update:refreshing","update:loading","update:finished","update:isFirstPull","update:page","update:size","getDataList"],setup(e,{emit:n}){let t=n,r=e;const o=C({get:()=>r.loading,set:u=>{t("update:loading",u)}}),c=C({get:()=>r.refreshing,set:u=>{t("update:refreshing",u)}}),d=()=>{r.refreshing&&(t("update:finished",!1),t("update:loading",!1),t("update:page",1)),t("getDataList")};let a;const i=()=>{t("update:refreshing",!0),t("update:loading",!0),a&&clearTimeout(a),a=setTimeout(d,1e3)};return R(()=>z(this,null,function*(){Y("Component <<DataList>> mounted.")})),(u,l)=>{const P=Pe,p=ue,D=ze;return H(),O(D,{"model-value":c.value,"onUpdate:modelValue":l[1]||(l[1]=f=>c.value=f),onRefresh:i,disabled:e.refreshDisabled},{loading:S(()=>[g(p,null,{default:S(()=>[g(m(re),{icon:"ep:loading"})]),_:1})]),default:S(()=>[g(P,{loading:o.value,"onUpdate:loading":l[0]||(l[0]=f=>o.value=f),finished:e.finished,onLoad:d,offset:e.offset},{default:S(()=>[le(u.$slots,"default")]),_:3},8,["loading","finished","offset"])]),_:3},8,["model-value","disabled"])}}}),He=b({__name:"announcement-list",props:{items:Array},setup(e){const n=e,t=r=>{ge.push({path:"/announcement/details",query:{id:r}})};return(r,o)=>{const c=ve;return H(!0),X(j,null,de(n.items,d=>(H(),O(c,{key:d.id,onClick:a=>t(d.id)},{title:S(()=>[ce("p",null,fe(d.title),1)]),_:2},1032,["onClick"]))),128)}}});class Ce{constructor(){T(this,"refreshing",!1);T(this,"loading",!1);T(this,"finished",!1);T(this,"pagination",{page:0,size:10,total:0});T(this,"items",[])}}const Ne=()=>new Ce,Re=(e,n,t)=>{var r,o,c,d,a,i,u;if((r=n==null?void 0:n.data)!=null&&r.content.length)for(const l of n.data.content)t&&he(t)?e.items.push(t(l)):e.items.push(l);return e.pagination.page=((c=(o=n==null?void 0:n.data)==null?void 0:o.pageable)==null?void 0:c.pageNumber)+1,e.pagination.size=(a=(d=n==null?void 0:n.data)==null?void 0:d.pageable)==null?void 0:a.pageSize,e.pagination.total=(i=n==null?void 0:n.data)==null?void 0:i.totalElements,e.loading=!1,e.refreshing=!1,(u=n==null?void 0:n.data)!=null&&u.last&&(e.finished=!0),e},Ue=e=>(e.loading=!0,e.refreshing&&(e.items=[]),{page:e.pagination.page<=0?1:e.pagination.page+1,size:e.pagination.size}),we=()=>({initialize:Ne,handleResult:Re,handleParams:Ue}),Ke=b({__name:"index",setup(e){const{initialize:n,handleResult:t,handleParams:r}=we(),o=G(n()),c=y([]),d=()=>z(this,null,function*(){const a=yield De(r(o));a&&(t(o,a),c.value=o.items)});return R(()=>z(this,null,function*(){Y("Page <<AnnouncementIndexPage>> mounted.")})),(a,i)=>{const u=pe;return H(),X(j,null,[g(u,{title:"Announcement","left-arrow":"",onClickLeft:i[0]||(i[0]=l=>m(me)())}),g(m(Ee),{finished:m(o).finished,"onUpdate:finished":i[1]||(i[1]=l=>m(o).finished=l),refreshing:m(o).refreshing,"onUpdate:refreshing":i[2]||(i[2]=l=>m(o).refreshing=l),loading:m(o).loading,"onUpdate:loading":i[3]||(i[3]=l=>m(o).loading=l),page:m(o).pagination.page,"onUpdate:page":i[4]||(i[4]=l=>m(o).pagination.page=l),size:m(o).pagination.size,"onUpdate:size":i[5]||(i[5]=l=>m(o).pagination.size=l),onGetDataList:d},{default:S(()=>[g(m(He),{items:m(c)},null,8,["items"])]),_:1},8,["finished","refreshing","loading","page","size"])],64)}}});export{Ke as default};
