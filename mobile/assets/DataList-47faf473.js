var G=Object.defineProperty;var W=(e,t,a)=>t in e?G(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var x=(e,t,a)=>(W(e,typeof t!="symbol"?t+"":t,a),a);var z=(e,t,a)=>new Promise((r,o)=>{var u=i=>{try{s(a.next(i))}catch(l){o(l)}},g=i=>{try{s(a.throw(i))}catch(l){o(l)}},s=i=>i.done?r(i.value):Promise.resolve(i.value).then(u,g);s((a=a.apply(e,t)).next())});import{aq as X,e as C,m as $,ae as J,L as Q,d as I,r as y,ar as V,f as Z,a4 as H,as as ee,o as O,K as te,i as U,b as f,ah as L,k as R,at as ae,ag as j,x as q,n as ne,D as F,u as se,q as ie,au as oe,av as re,aw as N,ax as le,l as k,a as ce,c as de,w as E,E as fe,O as ue,_ as ge,R as he}from"./index-0f416af7.js";/* empty css              *//* empty css                                                                 *//* empty css              */import{_ as me}from"./_plugin-vue_export-helper-c27b6911.js";const Te=Symbol(),ve=()=>X(Te,null),[xe,p,pe]=C("list"),be={error:Boolean,offset:$(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:J("down"),loadingText:String,finishedText:String,immediateCheck:Q};var De=I({name:xe,props:be,emits:["load","update:error","update:loading"],setup(e,{emit:t,slots:a}){const r=y(e.loading),o=y(),u=y(),g=ve(),s=V(o),i=Z(()=>e.scroller||s.value),l=()=>{L(()=>{if(r.value||e.finished||e.disabled||e.error||(g==null?void 0:g.value)===!1)return;const{direction:d}=e,v=+e.offset,T=R(i);if(!T.height||ae(o))return;let D=!1;const B=R(u);d==="up"?D=T.top-B.top<=v:D=B.bottom-T.bottom<=v,D&&(r.value=!0,t("update:loading",!0),t("load"))})},m=()=>{if(e.finished){const d=a.finished?a.finished():e.finishedText;if(d)return f("div",{class:p("finished-text")},[d])}},b=()=>{t("update:error",!1),l()},h=()=>{if(e.error){const d=a.error?a.error():e.errorText;if(d)return f("div",{role:"button",class:p("error-text"),tabindex:0,onClick:b},[d])}},P=()=>{if(r.value&&!e.finished&&!e.disabled)return f("div",{class:p("loading")},[a.loading?a.loading():f(j,{class:p("loading-icon")},{default:()=>[e.loadingText||pe("loading")]})])};return H(()=>[e.loading,e.finished,e.error],l),g&&H(g,d=>{d&&l()}),ee(()=>{r.value=e.loading}),O(()=>{e.immediateCheck&&l()}),te({check:l}),U("scroll",l,{target:i,passive:!0}),()=>{var d;const v=(d=a.default)==null?void 0:d.call(a),T=f("div",{ref:u,class:p("placeholder")},null);return f("div",{ref:o,role:"feed",class:p(),"aria-busy":r.value},[e.direction==="down"?v:T,P(),m(),h(),e.direction==="up"?v:T])}}});const Se=q(De),[_e,_,ye]=C("pull-refresh"),M=50,Pe=["pulling","loosing","success"],Be={disabled:Boolean,modelValue:Boolean,headHeight:$(M),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:ne,successDuration:$(500),animationDuration:$(300)};var Ee=I({name:_e,props:Be,emits:["change","refresh","update:modelValue"],setup(e,{emit:t,slots:a}){let r;const o=y(),u=y(),g=V(o),s=F({status:"normal",distance:0,duration:0}),i=se(),l=()=>{if(e.headHeight!==M)return{height:`${e.headHeight}px`}},m=()=>s.status!=="loading"&&s.status!=="success"&&!e.disabled,b=n=>{const c=+(e.pullDistance||e.headHeight);return n>c&&(n<c*2?n=c+(n-c)/2:n=c*1.5+(n-c*2)/4),Math.round(n)},h=(n,c)=>{const S=+(e.pullDistance||e.headHeight);s.distance=n,c?s.status="loading":n===0?s.status="normal":n<S?s.status="pulling":s.status="loosing",t("change",{status:s.status,distance:n})},P=()=>{const{status:n}=s;return n==="normal"?"":e[`${n}Text`]||ye(n)},d=()=>{const{status:n,distance:c}=s;if(a[n])return a[n]({distance:c});const S=[];return Pe.includes(n)&&S.push(f("div",{class:_("text")},[P()])),n==="loading"&&S.push(f(j,{class:_("loading")},{default:P})),S},v=()=>{s.status="success",setTimeout(()=>{h(0)},+e.successDuration)},T=n=>{r=oe(g.value)===0,r&&(s.duration=0,i.start(n))},D=n=>{m()&&T(n)},B=n=>{if(m()){r||T(n);const{deltaY:c}=i;i.move(n),r&&c.value>=0&&i.isVertical()&&(ie(n),h(b(c.value)))}},w=()=>{r&&i.deltaY.value&&m()&&(s.duration=+e.animationDuration,s.status==="loosing"?(h(+e.headHeight,!0),t("update:modelValue",!0),L(()=>t("refresh"))):h(0))};return H(()=>e.modelValue,n=>{s.duration=+e.animationDuration,n?h(+e.headHeight,!0):a.success||e.successText?v():h(0,!1)}),U("touchmove",B,{target:u}),()=>{var n;const c={transitionDuration:`${s.duration}ms`,transform:s.distance?`translate3d(0,${s.distance}px, 0)`:""};return f("div",{ref:o,class:_()},[f("div",{ref:u,class:_("track"),style:c,onTouchstartPassive:D,onTouchend:w,onTouchcancel:w},[f("div",{class:_("head"),style:l()},[d()]),(n=a.default)==null?void 0:n.call(a)])])}}});const $e=q(Ee);var ke=/\s/;function He(e){for(var t=e.length;t--&&ke.test(e.charAt(t)););return t}var Ie=/^\s+/;function we(e){return e&&e.slice(0,He(e)+1).replace(Ie,"")}var A=0/0,ze=/^[-+]0x[0-9a-f]+$/i,Re=/^0b[01]+$/i,Ne=/^0o[0-7]+$/i,Ae=parseInt;function Ce(e){if(typeof e=="number")return e;if(re(e))return A;if(N(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=N(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=we(e);var a=Re.test(e);return a||Ne.test(e)?Ae(e.slice(2),a?2:8):ze.test(e)?A:+e}let Y=class{constructor(){x(this,"refreshing",!1);x(this,"loading",!1);x(this,"finished",!1);x(this,"pagination",{page:1,size:10,total:0});x(this,"items",[])}};const K=(e={page:1,size:12})=>{const t=new Y;return e.page>0&&(t.pagination.page=e.page),e.size>0&&(t.pagination.size=e.size),t},Ve=(e,t,a)=>{var r,o,u,g,s,i,l;if((r=t==null?void 0:t.data)!=null&&r.content.length)for(const m of t.data.content)a&&le(a)?e.items.push(a(m)):e.items.push(m);return e.pagination.page=((u=(o=t==null?void 0:t.data)==null?void 0:o.pageable)==null?void 0:u.pageNumber)+1,e.pagination.size=(s=(g=t==null?void 0:t.data)==null?void 0:g.pageable)==null?void 0:s.pageSize,e.pagination.total=Ce((i=t==null?void 0:t.data)==null?void 0:i.totalElements),e.loading=!1,e.refreshing=!1,(l=t==null?void 0:t.data)!=null&&l.last&&(e.finished=!0),e},Oe=e=>(e.loading=!0,e.refreshing&&(e.items=[]),{page:e.pagination.page<=0?1:e.pagination.page+1,size:e.pagination.size}),Ge=()=>({initialize:K,handleResult:Ve,handleParams:Oe}),Ue=I({__name:"DataList",props:{model:{type:Y,require:!0,default:()=>K()},offset:{type:Number,default:100},refreshDisabled:{type:Boolean,default:!1},loadDisabled:{type:Boolean,default:!1}},emits:["getDataList"],setup(e,{emit:t}){const a=t,o=F(e.model),u=()=>{k("onLoad..."),o.refreshing&&(o.pagination.page=1,o.finished=!1,o.loading=!1),a("getDataList")},g=()=>{k("onRefresh..."),u()};return O(()=>z(this,null,function*(){k("Component <<DataList>> mounted.")})),(s,i)=>{const l=he,m=Se,b=$e;return ce(),de(b,{"model-value":o.refreshing,"onUpdate:modelValue":i[1]||(i[1]=h=>o.refreshing=h),onRefresh:g,disabled:e.refreshDisabled},{loading:E(()=>[f(l,null,{default:E(()=>[f(fe(ue),{icon:"ep:loading"})]),_:1})]),default:E(()=>[f(m,{loading:o.loading,"onUpdate:loading":i[0]||(i[0]=h=>o.loading=h),finished:o.finished,offset:e.offset,onLoad:u},{default:E(()=>[ge(s.$slots,"default",{},void 0,!0)]),_:3},8,["loading","finished","offset"])]),_:3},8,["model-value","disabled"])}}}),We=me(Ue,[["__scopeId","data-v-ef0e2366"]]);export{We as D,Ge as u};
