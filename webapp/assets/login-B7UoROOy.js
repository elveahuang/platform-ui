var p=(l,n,r)=>new Promise((f,i)=>{var u=t=>{try{_(r.next(t))}catch(o){i(o)}},c=t=>{try{_(r.throw(t))}catch(o){i(o)}},_=t=>t.done?f(t.value):Promise.resolve(t.value).then(u,c);_((r=r.apply(l,n)).next())});import{v as G,d as S,r as x,o as V,l as C,b as g,f as I,q as e,x as J,c as N,y as w,e as F,w as s,j as d,t as L,h as a,z as O,g as P,F as R,s as U,A as Q,B as W,_ as X,C as Y,a as Z,p as ee,D as ae,G as A,H as te,I as oe,k as D,J as se,K as ne,L as le,M as ce,N as re,O as pe}from"./index-CsZT2JSl.js";/* empty css                *//* empty css                     */import"./el-progress-DSxlkSL8.js";/* empty css                 */import{s as T,_ as ue,A as _e,a as de}from"./el-sub-menu-B-oIS09A.js";/* empty css                                                             *//* empty css                                                             */const ie=l=>G("/api/v1/captcha/code",l),me={class:"flex items-center"},he=S({__name:"CodeCaptcha",props:{width:{type:Number,default:120},height:{type:Number,default:32}},emits:["change"],setup(l,{expose:n,emit:r}){const f=r,i=l,u=x(""),c=()=>p(this,null,function*(){yield ie({}).then(t=>{u.value=t.data.image,f("change",t.data.key)})});return n({refresh:()=>p(this,null,function*(){c().then()})}),V(()=>p(this,null,function*(){C("Component <<Captcha>> mounted."),c().then()})),(t,o)=>{const v=J;return g(),I("div",me,[e(v,{preview:!1,alt:t.$t("common.field_captcha"),width:i.width,height:i.height,src:u.value,onClick:c},null,8,["alt","width","height","src"])])}}}),fe=l=>(Q("data-v-2b0541f5"),l=l(),W(),l),ye={class:"app-layout-header-container"},ge={class:"app-layout-logo"},ve={class:"logo"},we=fe(()=>d("div",{class:"app-layout-nav"},null,-1)),Ce={class:"app-layout-tools"},be={class:"app-layout-content-container"},xe={class:"app-layout-footer-container"},Ee=["innerHTML"],ke=S({__name:"entry",setup(l){const n=N(()=>T.app.getTitle()),r=N(()=>T.app.getCopyright());return V(()=>{C("Component - <<EntryLayout>> is mounted.")}),(f,i)=>{const u=U,c=w("a-layout-header"),_=w("a-layout-content"),t=w("a-layout-footer"),o=w("a-layout");return g(),F(o,{class:"app-layout"},{default:s(()=>[e(c,{class:"app-layout-header"},{default:s(()=>[d("div",ye,[d("div",ge,[d("div",ve,[d("span",null,L(a(n)),1)])]),we,d("div",Ce,[e(u,{size:"middle"},{default:s(()=>[e(a(ue)),e(a(_e)),e(a(de))]),_:1})])])]),_:1}),e(_,{class:"app-layout-content"},{default:s(()=>[d("div",be,[O(f.$slots,"default",{},void 0,!0)])]),_:3}),e(t,{class:"app-layout-footer"},{default:s(()=>[d("div",xe,[(g(!0),I(R,null,P(a(r),(v,E)=>(g(),I("div",{class:"app-text",key:E,innerHTML:v},null,8,Ee))),128))])]),_:1})]),_:3})}}}),Ie=X(ke,[["__scopeId","data-v-2b0541f5"]]),Fe={class:"mt-16 sm:w-full md:w-9/12 lg:w-6/12 xl:w-4/12"},Ue=S({__name:"login",setup(l){const{t:n}=Y(),r=Z(),{login:f,getUserInfo:i}=ee(),{isLoginCaptchaEnabled:u}=ae(),c=x(),_=x(),t=x(!1),o=A(te),v=A({username:[{required:!0,message:n("common.user_field_username_validation_login")}],password:[{required:!0,message:n("common.user_field_password_validation")}],captchaValue:[{required:!0,message:n("common.field_captcha_validation")}]}),E=m=>p(this,null,function*(){C(m)}),q=()=>p(this,null,function*(){yield c.value.validate().then(m=>p(this,null,function*(){console.log(m),t.value=!0,yield f(o).then(()=>p(this,null,function*(){yield i().then(),yield r.push("/").then()})).finally(()=>{o.captchaKey="",o.captchaValue="",t.value=!1,u&&_.value.refresh()})})).catch(m=>{C(m)}).finally(()=>{})}),M=m=>p(this,null,function*(){o.captchaKey=m});return V(()=>p(this,null,function*(){C("Page <<Login>> mounted.")})),(m,h)=>{const k=se,b=ne,$=le,H=w("a-row"),B=ce,K=U,z=re,j=pe;return g(),F(a(Ie),null,{default:s(()=>[d("div",Fe,[e(j,{title:a(n)("common.button_login")},{default:s(()=>[e(z,{ref_key:"form",ref:c,model:a(o),rules:a(v),onFinish:q,onFinishFailed:E},{default:s(()=>[e(b,{name:"username"},{default:s(()=>[e(k,{value:a(o).username,"onUpdate:value":h[0]||(h[0]=y=>a(o).username=y),placeholder:a(n)("common.user_field_username_placeholder_login")},null,8,["value","placeholder"])]),_:1}),e(b,{name:"password"},{default:s(()=>[e(k,{value:a(o).password,"onUpdate:value":h[1]||(h[1]=y=>a(o).password=y),placeholder:a(n)("common.user_field_password_placeholder")},null,8,["value","placeholder"])]),_:1}),a(u)?(g(),F(b,{key:0,name:"captchaValue"},{default:s(()=>[e(H,{wrap:!1},{default:s(()=>[e($,{flex:"auto"},{default:s(()=>[e(k,{value:a(o).captchaValue,"onUpdate:value":h[2]||(h[2]=y=>a(o).captchaValue=y),placeholder:a(n)("common.field_captcha_placeholder")},null,8,["value","placeholder"])]),_:1}),e($,{flex:"none",class:"mx-4"},{default:s(()=>[e(a(he),{ref_key:"captcha",ref:_,onChange:M},null,512)]),_:1})]),_:1})]),_:1})):oe("",!0),e(b,{"wrapper-col":{offset:8,span:12}},{default:s(()=>[e(K,{wrap:""},{default:s(()=>[e(B,{"html-type":"submit",type:"primary",disabled:t.value},{default:s(()=>[D(L(a(n)("common.button_login")),1)]),_:1},8,["disabled"]),e(B,{onClick:h[3]||(h[3]=y=>c.value.resetFields())},{default:s(()=>[D(L(a(n)("common.button_reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])])]),_:1})}}});export{Ue as default};
