var p=(l,n,c)=>new Promise((m,_)=>{var i=t=>{try{u(c.next(t))}catch(o){_(o)}},r=t=>{try{u(c.throw(t))}catch(o){_(o)}},u=t=>t.done?m(t.value):Promise.resolve(t.value).then(i,r);u((c=c.apply(l,n)).next())});import{x as z,d as I,r as C,o as L,l as E,b as g,f as x,q as e,y as H,c as F,s as $,e as k,w as s,j as d,t as N,h as a,z as K,g as P,F as R,v as j,A as G,B as J,C as O,D as Q,G as W,H as X,_ as Y,I as Z,a as ee,p as ae,J as te,K as B,L as oe,M as se,k as ne,N as le,O as ce,P as re,Q as pe,S as de,T as ie,U as ue}from"./index-BwBuRoYu.js";/* empty css                *//* empty css                     *//* empty css                 */import"./el-progress-DIg39a7L.js";import{_ as _e,A as me,a as he}from"./el-sub-menu-Cadgp40x.js";/* empty css                                                                   *//* empty css                                                                   */const fe=l=>z("/api/v1/captcha/code",l),ge={class:"flex items-center"},ye=I({__name:"CodeCaptcha",props:{width:{type:Number,default:120},height:{type:Number,default:32}},emits:["change"],setup(l,{expose:n,emit:c}){const m=c,_=l,i=C(""),r=()=>p(this,null,function*(){yield fe({}).then(t=>{i.value=t.data.image,m("change",t.data.key)})});return n({refresh:()=>p(this,null,function*(){r().then()})}),L(()=>p(this,null,function*(){E("Component <<Captcha>> mounted."),r().then()})),(t,o)=>{const y=H;return g(),x("div",ge,[e(y,{preview:!1,alt:t.$t("common.field_captcha"),width:_.width,height:_.height,src:i.value,onClick:r},null,8,["alt","width","height","src"])])}}}),ve=l=>(W("data-v-9a410d3f"),l=l(),X(),l),we={class:"app-layout-header-container"},Ce={class:"app-layout-logo"},Ee={class:"logo"},Ve=ve(()=>d("div",{class:"app-layout-nav"},null,-1)),be={class:"app-layout-tools"},xe={class:"app-layout-content-container"},ke={class:"app-layout-footer-container"},Ie=["innerHTML"],Le=I({__name:"EntryLayout",setup(l){const n=F(()=>$.app.getTitle()),c=F(()=>$.app.getCopyright());return L(()=>{E("Component - <<EntryLayout>> is mounted.")}),(m,_)=>{const i=j,r=G,u=J,t=O,o=Q;return g(),k(o,{class:"app-layout"},{default:s(()=>[e(r,{class:"app-layout-header"},{default:s(()=>[d("div",we,[d("div",Ce,[d("div",Ee,[d("span",null,N(a(n)),1)])]),Ve,d("div",be,[e(i,null,{default:s(()=>[e(a(_e)),e(a(me)),e(a(he))]),_:1})])])]),_:1}),e(u,{class:"app-layout-content"},{default:s(()=>[d("div",xe,[K(m.$slots,"default",{},void 0,!0)])]),_:3}),e(t,{class:"app-layout-footer"},{default:s(()=>[d("div",ke,[(g(!0),x(R,null,P(a(c),(y,V)=>(g(),x("div",{key:V,class:"app-text",innerHTML:y},null,8,Ie))),128))])]),_:1})]),_:3})}}}),Se=Y(Le,[["__scopeId","data-v-9a410d3f"]]),Ae={class:"mb-36 content-center sm:w-full md:w-9/12 lg:w-6/12 xl:w-4/12"},Fe=d("span",{class:"app-text"},"AAA",-1),He=I({__name:"login",setup(l){const{t:n}=Z(),c=ee(),{login:m,getUserInfo:_}=ae(),{isLoginCaptchaEnabled:i}=te(),r=C(),u=C(),t=C(!1),o=B(oe),y=B({username:[{required:!0,message:n("common.user_field_username_validation_login")}],password:[{required:!0,message:n("common.user_field_password_validation")}],captchaValue:[{required:!0,message:n("common.field_captcha_validation")}]}),V=h=>p(this,null,function*(){E(h)}),S=()=>p(this,null,function*(){yield r.value.validate().then(h=>p(this,null,function*(){console.log(h),t.value=!0,yield m(o).then(()=>p(this,null,function*(){yield _().then(),yield c.push("/").then()})).finally(()=>{o.captchaKey="",o.captchaValue="",t.value=!1,i&&u.value.refresh()})}))}),T=h=>p(this,null,function*(){o.captchaKey=h});return L(()=>p(this,null,function*(){E("Page <<Login>> mounted.")})),(h,f)=>{const b=le,w=ce,A=re,U=pe,D=de,M=ie,q=ue;return g(),k(a(Se),null,{default:s(()=>[d("div",Ae,[e(q,{shadow:"never",header:h.$t("common.button_login")},{default:s(()=>[e(M,{ref_key:"form",ref:r,model:a(o),rules:a(y),onFinish:S,onFinishFailed:V},{default:s(()=>[e(w,{prop:"username"},{default:s(()=>[e(b,{size:"large",modelValue:a(o).username,"onUpdate:modelValue":f[0]||(f[0]=v=>a(o).username=v),placeholder:a(n)("common.user_field_username_placeholder_login")},null,8,["modelValue","placeholder"])]),_:1}),e(w,{prop:"password"},{default:s(()=>[e(b,{size:"large",modelValue:a(o).password,"onUpdate:modelValue":f[1]||(f[1]=v=>a(o).password=v),placeholder:a(n)("common.user_field_password_placeholder")},null,8,["modelValue","placeholder"])]),_:1}),a(i)?(g(),k(w,{key:0,name:"captchaValue"},{default:s(()=>[e(U,{wrap:!1},{default:s(()=>[e(A,{flex:"auto"},{default:s(()=>[e(b,{value:a(o).captchaValue,"onUpdate:value":f[2]||(f[2]=v=>a(o).captchaValue=v),placeholder:a(n)("common.field_captcha_placeholder")},null,8,["value","placeholder"])]),_:1}),e(A,{flex:"none",class:"mx-4"},{default:s(()=>[e(a(ye),{ref_key:"captcha",ref:u,onChange:T},null,512)]),_:1})]),_:1})]),_:1})):se("",!0),e(w,{"wrapper-col":{offset:8,span:12}},{default:s(()=>[Fe,e(D,{size:"large","html-type":"submit",type:"primary",disabled:t.value,class:"w-full",onClick:S},{default:s(()=>[ne(N(a(n)("common.button_login")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["header"])])]),_:1})}}});export{He as default};
