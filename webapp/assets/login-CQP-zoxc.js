var p=(l,n,c)=>new Promise((m,_)=>{var d=t=>{try{i(c.next(t))}catch(o){_(o)}},r=t=>{try{i(c.throw(t))}catch(o){_(o)}},i=t=>t.done?m(t.value):Promise.resolve(t.value).then(d,r);i((c=c.apply(l,n)).next())});import{x as z,d as I,r as C,o as S,l as E,b as g,f as x,q as e,y as H,c as $,s as B,e as k,w as s,j as u,t as A,h as a,z as K,g as P,F as R,v as j,A as G,B as J,C as O,D as Q,G as W,H as X,_ as Y,I as Z,a as ee,p as ae,J as te,K as N,L as oe,M as se,k as ne,N as le,O as ce,P as re,Q as pe,S as de,T as ie,U as ue}from"./index-jaafNWoy.js";/* empty css                *//* empty css                     *//* empty css                 */import"./el-progress-D9ZY9CsG.js";import{_ as _e,A as me,a as he}from"./el-sub-menu-iHwjdLUg.js";/* empty css                                                             *//* empty css                                                             */const fe=l=>z("/api/v1/captcha/code",l),ge={class:"flex items-center"},ye=I({__name:"CodeCaptcha",props:{width:{type:Number,default:120},height:{type:Number,default:32}},emits:["change"],setup(l,{expose:n,emit:c}){const m=c,_=l,d=C(""),r=()=>p(this,null,function*(){yield fe({}).then(t=>{d.value=t.data.image,m("change",t.data.key)})});return n({refresh:()=>p(this,null,function*(){r().then()})}),S(()=>p(this,null,function*(){E("Component <<Captcha>> mounted."),r().then()})),(t,o)=>{const y=H;return g(),x("div",ge,[e(y,{preview:!1,alt:t.$t("common.field_captcha"),width:_.width,height:_.height,src:d.value,onClick:r},null,8,["alt","width","height","src"])])}}}),ve=l=>(W("data-v-e1dc1cdb"),l=l(),X(),l),we={class:"app-layout-header-container"},Ce={class:"app-layout-logo"},Ee={class:"logo"},be=ve(()=>u("div",{class:"app-layout-nav"},null,-1)),Ve={class:"app-layout-tools"},xe={class:"app-layout-content-container"},ke={class:"app-layout-footer-container"},Ie=["innerHTML"],Se=I({__name:"entry",setup(l){const n=$(()=>B.app.getTitle()),c=$(()=>B.app.getCopyright());return S(()=>{E("Component - <<EntryLayout>> is mounted.")}),(m,_)=>{const d=j,r=G,i=J,t=O,o=Q;return g(),k(o,{class:"app-layout"},{default:s(()=>[e(r,{class:"app-layout-header"},{default:s(()=>[u("div",we,[u("div",Ce,[u("div",Ee,[u("span",null,A(a(n)),1)])]),be,u("div",Ve,[e(d,null,{default:s(()=>[e(a(_e)),e(a(me)),e(a(he))]),_:1})])])]),_:1}),e(i,{class:"app-layout-content"},{default:s(()=>[u("div",xe,[K(m.$slots,"default",{},void 0,!0)])]),_:3}),e(t,{class:"app-layout-footer"},{default:s(()=>[u("div",ke,[(g(!0),x(R,null,P(a(c),(y,b)=>(g(),x("div",{key:b,class:"app-text",innerHTML:y},null,8,Ie))),128))])]),_:1})]),_:3})}}}),Fe=Y(Se,[["__scopeId","data-v-e1dc1cdb"]]),Le={class:"mb-36 content-center sm:w-full md:w-9/12 lg:w-6/12 xl:w-4/12"},ze=I({__name:"login",setup(l){const{t:n}=Z(),c=ee(),{login:m,getUserInfo:_}=ae(),{isLoginCaptchaEnabled:d}=te(),r=C(),i=C(),t=C(!1),o=N(oe),y=N({username:[{required:!0,message:n("common.user_field_username_validation_login")}],password:[{required:!0,message:n("common.user_field_password_validation")}],captchaValue:[{required:!0,message:n("common.field_captcha_validation")}]}),b=h=>p(this,null,function*(){E(h)}),F=()=>p(this,null,function*(){yield r.value.validate().then(h=>p(this,null,function*(){console.log(h),t.value=!0,yield m(o).then(()=>p(this,null,function*(){yield _().then(),yield c.push("/").then()})).finally(()=>{o.captchaKey="",o.captchaValue="",t.value=!1,d&&i.value.refresh()})}))}),T=h=>p(this,null,function*(){o.captchaKey=h});return S(()=>p(this,null,function*(){E("Page <<Login>> mounted.")})),(h,f)=>{const V=le,w=ce,L=re,U=pe,D=de,M=ie,q=ue;return g(),k(a(Fe),null,{default:s(()=>[u("div",Le,[e(q,{shadow:"never",header:h.$t("common.button_login")},{default:s(()=>[e(M,{ref_key:"form",ref:r,model:a(o),rules:a(y),onFinish:F,onFinishFailed:b},{default:s(()=>[e(w,{prop:"username"},{default:s(()=>[e(V,{size:"large",modelValue:a(o).username,"onUpdate:modelValue":f[0]||(f[0]=v=>a(o).username=v),placeholder:a(n)("common.user_field_username_placeholder_login")},null,8,["modelValue","placeholder"])]),_:1}),e(w,{prop:"password"},{default:s(()=>[e(V,{size:"large",modelValue:a(o).password,"onUpdate:modelValue":f[1]||(f[1]=v=>a(o).password=v),placeholder:a(n)("common.user_field_password_placeholder")},null,8,["modelValue","placeholder"])]),_:1}),a(d)?(g(),k(w,{key:0,name:"captchaValue"},{default:s(()=>[e(U,{wrap:!1},{default:s(()=>[e(L,{flex:"auto"},{default:s(()=>[e(V,{value:a(o).captchaValue,"onUpdate:value":f[2]||(f[2]=v=>a(o).captchaValue=v),placeholder:a(n)("common.field_captcha_placeholder")},null,8,["value","placeholder"])]),_:1}),e(L,{flex:"none",class:"mx-4"},{default:s(()=>[e(a(ye),{ref_key:"captcha",ref:i,onChange:T},null,512)]),_:1})]),_:1})]),_:1})):se("",!0),e(w,{"wrapper-col":{offset:8,span:12}},{default:s(()=>[e(D,{size:"large","html-type":"submit",type:"primary",disabled:t.value,class:"w-full",onClick:F},{default:s(()=>[ne(A(a(n)("common.button_login")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["header"])])]),_:1})}}});export{ze as default};
