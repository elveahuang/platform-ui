import{W as e,C as t,a,b as i}from"./wework-41ae6092.js";import"./index-fbb6e2f3.js";/* empty css             */class n extends e{async getPhoto(e){return new Promise((async(a,i)=>{if(e.webUseInput||e.source===t.Photos)this.fileInputExperience(e,a);else if(e.source===t.Prompt){let t=document.querySelector("pwa-action-sheet");t||(t=document.createElement("pwa-action-sheet"),document.body.appendChild(t)),t.header=e.promptLabelHeader||"Photo",t.cancelable=!1,t.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],t.addEventListener("onSelection",(async t=>{0===t.detail?this.fileInputExperience(e,a):this.cameraExperience(e,a,i)}))}else this.cameraExperience(e,a,i)}))}async pickImages(e){return new Promise((async e=>{this.multipleFileInputExperience(e)}))}async cameraExperience(e,t,n){if(customElements.get("pwa-camera-modal")){const o=document.createElement("pwa-camera-modal");o.facingMode=e.direction===a.Front?"user":"environment",document.body.appendChild(o);try{await o.componentOnReady(),o.addEventListener("onPhoto",(async a=>{const r=a.detail;null===r?n(new i("User cancelled photos app")):r instanceof Error?n(r):t(await this._getCameraPhoto(r,e)),o.dismiss(),document.body.removeChild(o)})),o.present()}catch(r){this.fileInputExperience(e,t)}}else this.fileInputExperience(e,t)}fileInputExperience(e,i){let n=document.querySelector("#_capacitor-camera-input");const r=()=>{var e;null===(e=n.parentNode)||void 0===e||e.removeChild(n)};n||(n=document.createElement("input"),n.id="_capacitor-camera-input",n.type="file",n.hidden=!0,document.body.appendChild(n),n.addEventListener("change",(t=>{const a=n.files[0];let o="jpeg";if("image/png"===a.type?o="png":"image/gif"===a.type&&(o="gif"),"dataUrl"===e.resultType||"base64"===e.resultType){const t=new FileReader;t.addEventListener("load",(()=>{if("dataUrl"===e.resultType)i({dataUrl:t.result,format:o});else if("base64"===e.resultType){const e=t.result.split(",")[1];i({base64String:e,format:o})}r()})),t.readAsDataURL(a)}else i({webPath:URL.createObjectURL(a),format:o}),r()}))),n.accept="image/*",n.capture=!0,e.source===t.Photos||e.source===t.Prompt?n.removeAttribute("capture"):e.direction===a.Front?n.capture="user":e.direction===a.Rear&&(n.capture="environment"),n.click()}multipleFileInputExperience(e){let t=document.querySelector("#_capacitor-camera-input-multiple");t||(t=document.createElement("input"),t.id="_capacitor-camera-input-multiple",t.type="file",t.hidden=!0,t.multiple=!0,document.body.appendChild(t),t.addEventListener("change",(a=>{const i=[];for(let e=0;e<t.files.length;e++){const a=t.files[e];let n="jpeg";"image/png"===a.type?n="png":"image/gif"===a.type&&(n="gif"),i.push({webPath:URL.createObjectURL(a),format:n})}var n;e({photos:i}),null===(n=t.parentNode)||void 0===n||n.removeChild(t)}))),t.accept="image/*",t.click()}_getCameraPhoto(e,t){return new Promise(((a,i)=>{const n=new FileReader,r=e.type.split("/")[1];"uri"===t.resultType?a({webPath:URL.createObjectURL(e),format:r,saved:!1}):(n.readAsDataURL(e),n.onloadend=()=>{const e=n.result;"dataUrl"===t.resultType?a({dataUrl:e,format:r,saved:!1}):a({base64String:e.split(",")[1],format:r,saved:!1})},n.onerror=e=>{i(e)})}))}async checkPermissions(){if("undefined"==typeof navigator||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch(e){throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}const r=new n;export{r as Camera,n as CameraWeb};
