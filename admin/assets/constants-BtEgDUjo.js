var j=Object.defineProperty,z=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var C=(e,a,t)=>a in e?j(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,f=(e,a)=>{for(var t in a||(a={}))J.call(a,t)&&C(e,t,a[t]);if(U)for(var t of U(a))G.call(a,t)&&C(e,t,a[t]);return e},B=(e,a)=>z(e,$(a));var s=(e,a,t)=>(C(e,typeof a!="symbol"?a+"":a,t),t);var _=(e,a,t)=>new Promise((d,l)=>{var c=m=>{try{p(t.next(m))}catch(h){l(h)}},o=m=>{try{p(t.throw(m))}catch(h){l(h)}},p=m=>m.done?d(m.value):Promise.resolve(m.value).then(c,o);p((t=t.apply(e,a)).next())});import{aO as H,aP as Q,aQ as W,aR as X,aS as Y,aT as K,a6 as I,d as F,G as L,r as T,o as x,l as q,aw as O,e as N,f as A,aU as Z,I as ee,c as te,w as ae,g as ne,aa as se,m as ie,aV as re,aW as oe}from"./index-D6izgmYW.js";import{B as P}from"./el-progress-CCsg546T.js";var w=1/0,le=17976931348623157e292;function de(e){if(!e)return e===0?e:0;if(e=H(e),e===w||e===-w){var a=e<0?-1:1;return a*le}return e===e?e:0}function ce(e){var a=de(e),t=a%1;return a===a?t?a-t:a:0}function pe(e,a){return Q(a,function(t){return e[t]})}function ue(e){return e==null?[]:pe(e,W(e))}var me=Math.max;function fe(e,a,t,d){e=X(e)?e:ue(e),t=t&&!d?ce(t):0;var l=e.length;return t<0&&(t=me(l+t,0)),Y(e)?t<=l&&e.indexOf(a,t)>-1:!!l&&K(e,a,t)>-1}const ye=e=>I("/api/v1/dict/search",e);class he extends P{constructor(){super(...arguments);s(this,"code","");s(this,"title","");s(this,"label","");s(this,"description","");s(this,"source",2);s(this,"children",[])}}class ge{constructor(){s(this,"targetId",0);s(this,"targetType","");s(this,"dictId",0);s(this,"ids",[]);s(this,"items",[]);this.targetId=0,this.targetType="UNSPECIFIED",this.dictId=0,this.ids=[],this.items=[]}}const Te=F({__name:"DictSelect",props:{code:{type:String,required:!0},relation:{type:Object,required:!0,default:{targetId:0,targetType:"UNSPECIFIED",dictId:0,ids:[],items:[]}},multipleInd:{type:Boolean,required:!1,default:!1}},emits:["update:relation"],setup(e,{emit:a}){const t={true:"multiple",false:"combobox"},d=a,l=e,c=L(l.relation),o=L(new he),p=T([]),m=(u,y)=>y.label.toLowerCase().indexOf(u.toLowerCase())>=0,h=u=>_(this,null,function*(){l.multipleInd||(c.ids=[u]),d("update:relation",f({},c))});return x(()=>_(this,null,function*(){q("Component <<DictSelect>> mounted."),yield ye({code:l.code}).then(u=>{var y,E,g,S;c.dictId=(y=u.data)==null?void 0:y.id,c.targetType=(E=u.data)==null?void 0:E.code,u.data&&Object.assign(o,f({},u.data)),p.value=(S=(g=u.data)==null?void 0:g.children)==null?void 0:S.map(v=>({label:v.title,value:String(v.id)})),d("update:relation",f({},c))})})),(u,y)=>{const E=O("a-select");return N(),A(E,{value:c.ids,"onUpdate:value":y[0]||(y[0]=g=>c.ids=g),"show-search":"",mode:t[`${l.multipleInd}`],options:p.value,"filter-option":m,onChange:h},null,8,["value","mode","options"])}}});class V{static upload(a,t={}){return I(this.UPLOAD_FILE_URL,a,{headers:t})}}s(V,"UPLOAD_FILE_URL","/api/v1/attachment/upload");const Ee=e=>I("/api/v1/attachment/search",e),_e={key:0},Ie=ie("div",{class:"ant-upload-text"},"Upload",-1),Ae=F({__name:"file-upload",props:{code:{type:String,required:!0},attachment:{type:Object,required:!1,default:{targetId:0,targetType:"",attachmentType:{multiple:!1},fileList:[]}},action:{type:String,required:!1,default:Z.server+"/api/v1/attachment/upload"},directory:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},multiple:{type:Boolean,required:!1,default:!1},maxCount:{type:Number,required:!1,default:99},maxSize:{type:Number,required:!1,default:10240}},emits:["update:attachment"],setup(e,{emit:a}){var v;const t=a,d=e,l=T(!1),c=T(d.multiple),o=L(d.attachment),p=T(!ee(o.fileList)&&((v=o.fileList)==null?void 0:v.map(n=>JSON.parse(n.extra)))||[]),m=te(()=>c.value?p.value.length<d.maxCount:p.value.length<1),h=n=>_(this,null,function*(){const r=fe(o.attachmentType.fileTypes,n==null?void 0:n.type),i=n.size/1024/1024<d.maxSize;return!r&&message.error(`File type incorrect! should be inside [${o.attachmentType.fileTypes.join(", ")}]`),!i&&message.error(`Image must smaller than ${d.maxSize}MB!`),r&&i}),u=(n,r)=>{const i=new FileReader;i.addEventListener("load",()=>r(i.result)),i.readAsDataURL(n)},y=n=>{if(n.file.status==="uploading"){l.value=!0;return}n.file.status==="done"&&u(n.file.originFileObj,r=>{l.value=!1}),n.file.status==="error"&&(l.value=!1,message.error("upload error"))},E=n=>_(this,null,function*(){const r=new FormData;r.append("targetType",d.code),r.append("attachmentType",d.code),r.append(n.filename,n.file),n.data&&Object.keys(n.data).forEach(i=>{r.append(i,n.data[i])}),V.upload(r).then(i=>{n.onSuccess(i,n.file),o.fileList=p.value.map(b=>B(f({},b.response.data[0]),{extra:JSON.stringify(b)})),t("update:attachment",f({},o))}).catch(i=>{n.onError(i,i,n.file),message.error(n.file.name+i)})}),g=n=>{var r;return o.fileList=(r=p.value.filter(i=>n.uid!==i.uid))==null?void 0:r.map(i=>B(f({},i.response.data[0]),{extra:JSON.stringify(i)})),t("update:attachment",f({},o)),!0},S=n=>{window.open(n.response.data[0].url)};return x(()=>_(this,null,function*(){q("Component <<FileUpload>> mounted."),yield Ee({code:d.code}).then(n=>{var r,i;o.targetType=(r=n.data)==null?void 0:r.code,o.attachmentType=f({},n.data),c.value=(i=o.attachmentType)==null?void 0:i.multipleInd,t("update:attachment",f({},o))})})),(n,r)=>{var R;const i=O("loading-outlined"),b=O("plus-outlined"),k=re;return N(),A(k,{"file-list":p.value,"onUpdate:fileList":r[0]||(r[0]=M=>p.value=M),name:"attachment","list-type":"picture-card",action:e.action,multiple:c.value&&o.attachmentType.multipleInd,"custom-request":E,"before-upload":h,accept:`.${(R=o.attachmentType)==null?void 0:R.ext.join(",.")}`,"on-reject":g,onPreview:S,onRemove:g,onChange:y},{default:ae(()=>[m.value?(N(),ne("div",_e,[l.value?(N(),A(i,{key:0})):(N(),A(b,{key:1})),Ie])):se("",!0)]),_:1},8,["file-list","action","multiple","accept"])}}}),Ce=e=>I("/api/v1/admin/banner/list",e),Be=e=>oe("/api/v1/admin/banner/save",e),Le=e=>I("/api/v1/admin/banner/details",e),Oe=e=>I("/api/v1/admin/banner/delete",e);class D{constructor(){s(this,"targetId",0);s(this,"targetType","");s(this,"attachmentType",new ve);s(this,"fileList",[])}}class ve{constructor(){s(this,"code","");s(this,"multipleInd",!1);s(this,"ext",[]);s(this,"fileTypes",[])}}class Re extends P{constructor(){super(...arguments);s(this,"title","");s(this,"type",new ge);s(this,"cover",new D);s(this,"mobileCover",new D);s(this,"sortOrder",999);s(this,"description","");s(this,"startDatetime","");s(this,"endDatetime","")}}const Ue={UNSPECIFIED:"UNSPECIFIED",USER_AVATAR:"USER_AVATAR",BANNER_COVER:"BANNER_COVER",BANNER_MOBILE_COVER:"BANNER_MOBILE_COVER"},we={UNSPECIFIED:"UNSPECIFIED",BANNER:"BANNER"};export{Re as B,we as S,Te as _,Ue as a,Ae as b,Ce as c,Be as d,Oe as e,Le as f};
