var H=Object.defineProperty;var S=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var z=(l,t,i)=>t in l?H(l,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[t]=i,L=(l,t)=>{for(var i in t||(t={}))K.call(t,i)&&z(l,i,t[i]);if(S)for(var i of S(t))J.call(t,i)&&z(l,i,t[i]);return l};var f=(l,t,i)=>new Promise((C,E)=>{var w=s=>{try{r(i.next(s))}catch(u){E(u)}},v=s=>{try{r(i.throw(s))}catch(u){E(u)}},r=s=>s.done?C(s.value):Promise.resolve(s.value).then(w,v);r((i=i.apply(l,t)).next())});/* empty css             */import{E as Q}from"./overlay-pVe1zR27.js";/* empty css                  *//* empty css               */import{E as W}from"./card-T9bNKV5Z.js";import{u as X,_ as Y,E as Z}from"./checkbox-OwUizrIf.js";/* empty css                   */import{E as x}from"./space-Edq1FNMZ.js";import{E as ee}from"./page-header-wbQOF7zM.js";import{p as h,d as te,q as oe,v as A,r as k,o as ae,l as le,e as P,g as ne,j as o,w as n,k as ie,x as y,t as b,i as d,f as me,y as se,z as re,F as de,A as ue,B as ce}from"./index-A7bhECbp.js";import{E as pe}from"./index-VZb_J77w.js";import{E as _e}from"./index-I0dX4THf.js";import{E as fe,a as ye}from"./index-6Rwy8JEJ.js";import"./vnode-9IcDQY6_.js";import"./refs-Ccqx_-JF.js";import"./event-Bjhng1YN.js";import"./index-7VBiOmgs.js";import"./scroll-22BeMukN.js";import"./strings-DPzeYSee.js";import"./castArray-W7AxUl58.js";const be=l=>h("/api/v1/admin/user/list",l),ve=l=>h("/api/v1/admin/user/details",l),ke=l=>h("/api/v1/admin/user/save",l),Ee=l=>h("/api/v1/admin/user/delete",l),ge={class:"pb-4"},Oe=te({__name:"index",setup(l){const{t}=oe(),{initialize:i,handleResult:C,handleParams:E}=X(),w=[{title:t("common.field_title"),dataIndex:"username",key:"username",width:300,sorter:!0},{title:t("common.field_content"),dataIndex:"displayName",key:"displayName"},{title:t("common.field_last_modified_at"),dataIndex:"lastModifiedAt",key:"lastModifiedAt",sorter:!0},{title:t("common.label_action"),dataIndex:"operation",key:"operation",width:200}],v=A(i(w)),r=k(),s=()=>f(this,null,function*(){yield be(E(v)).then(e=>{C(v,e)})}),u=k(""),c=k(!1),M=k(),g=k(!1),p=A({}),U=A({title:[{required:!0,message:t("common.field_title_validation")}],content:[{required:!0,message:t("common.field_description_validation")}]}),N=e=>f(this,null,function*(){c.value=!0,e&&e>0?(u.value=t("common.announcement_pages_edit_title"),yield ve({id:e}).then(a=>{Object.assign(p,L({},a.data))})):u.value=t("common.announcement_pages_add_title")}),q=()=>{c.value=!1},T=()=>f(this,null,function*(){yield M.value.validate().then(()=>f(this,null,function*(){ke(p).then(e=>{e.code=="200"&&(c.value=!1,r.value.refresh())})}))}),D=(e=0)=>f(this,null,function*(){const a=e>0?[e]:r.value.selectedRowKeys();if(ue(a)){ce({message:"请选择"}).then();return}Ee({ids:a}).then(F=>{F.code=="200"&&(c.value=!1,r.value.refresh())})});return ae(()=>f(this,null,function*(){le("Page <<AnnouncementAdminListPage>> mounted.")})),(e,a)=>{const F=ee,_=pe,I=x,$=Z,V=W,B=_e,R=fe,j=ye,O=Q;return P(),ne(de,null,[o(F,{title:e.$t("common.announcement_management")},null,8,["title"]),o(V,null,{default:n(()=>[ie("div",ge,[o(I,null,{default:n(()=>[o(_,{type:"primary",onClick:a[0]||(a[0]=m=>N(0))},{default:n(()=>[y(b(e.$t("common.button_add")),1)]),_:1}),o(_,{onClick:a[1]||(a[1]=m=>g.value=!d(g))},{default:n(()=>[y(b(d(g)?e.$t("common.label_batch_operation_cancel"):e.$t("common.label_batch_operation")),1)]),_:1}),o(_,{onClick:a[2]||(a[2]=m=>D(0))},{default:n(()=>[y(b(e.$t("common.button_delete")),1)]),_:1})]),_:1})]),o(d(Y),{ref_key:"dataTableRef",ref:r,model:v,"onUpdate:model":a[3]||(a[3]=m=>v=m),onGetDataList:s},{default:n(()=>[d(g)?(P(),me($,{key:0,type:"selection",width:"30",class:"text-center"})):se("",!0),o($,{label:e.$t("common.field_title"),prop:"username"},null,8,["label"]),o($,{label:e.$t("common.field_content"),prop:"displayName"},null,8,["label"]),o($,{fixed:"right",label:e.$t("common.label_action"),width:"200"},{default:n(m=>[o(_,{link:"",type:"primary",size:"small",onClick:G=>N(m.row.id)},{default:n(()=>[y(b(e.$t("common.button_edit")),1)]),_:2},1032,["onClick"]),o(_,{link:"",type:"primary",size:"small",onClick:G=>D(m.row.id)},{default:n(()=>[y(b(e.$t("common.button_delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1}),o(O,{class:"app-modal",modelValue:d(c),"onUpdate:modelValue":a[6]||(a[6]=m=>re(c)?c.value=m:null),title:d(u)},{footer:n(()=>[o(I,null,{default:n(()=>[o(_,{type:"primary",onClick:T},{default:n(()=>[y(b(e.$t("common.button_submit")),1)]),_:1}),o(_,{onClick:q},{default:n(()=>[y(b(e.$t("common.button_cancel")),1)]),_:1})]),_:1})]),default:n(()=>[o(V,null,{default:n(()=>[o(j,{ref_key:"entityForm",ref:M,model:p,rules:U,onFinish:T},{default:n(()=>[o(R,{name:"title",label:e.$t("common.field_title")},{default:n(()=>[o(B,{value:p.username,"onUpdate:value":a[4]||(a[4]=m=>p.username=m),placeholder:d(t)("common.field_title_placeholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),o(R,{name:"content",label:e.$t("common.field_content")},{default:n(()=>[o(B,{value:p.displayName,"onUpdate:value":a[5]||(a[5]=m=>p.displayName=m),placeholder:d(t)("common.field_content_placeholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue","title"])],64)}}});export{Oe as default};
