var me=Object.defineProperty;var Z=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var j=(r,t,d)=>t in r?me(r,t,{enumerable:!0,configurable:!0,writable:!0,value:d}):r[t]=d,x=(r,t)=>{for(var d in t||(t={}))ue.call(t,d)&&j(r,d,t[d]);if(Z)for(var d of Z(t))pe.call(t,d)&&j(r,d,t[d]);return r};var h=(r,t,d)=>new Promise((m,V)=>{var E=p=>{try{_(d.next(p))}catch(D){V(D)}},y=p=>{try{_(d.throw(p))}catch(D){V(D)}},_=p=>p.done?m(p.value):Promise.resolve(p.value).then(E,y);_((d=d.apply(r,t)).next())});import{d as oe,c as M,V as ee,W as fe,X as ce,r as k,Y as _e,e as f,f as $,Z as I,$ as ye,a0 as te,a1 as ae,a2 as ve,a3 as be,a4 as he,a5 as we,a6 as N,l as O,a7 as ge,D as ke,G as B,o as Ve,g as K,k as l,w as n,n as w,t as g,i as s,j as Ee,F,h as De,m as P,I as Te,J as $e,K as Ce,T as Ke,L as Ae,M as Me,N as Fe,O as Pe,a8 as Ne,a9 as Ue,Q as Le,aa as Re,ab as Se,U as He,S as Ie}from"./index-D6izgmYW.js";/* empty css                     *//* empty css                       *//* empty css                 */import"./el-progress-CCsg546T.js";/* empty css                *//* empty css                 */import{A as Be,_ as ze}from"./el-popover-ROniNvD5.js";/* empty css                  */import{u as Oe}from"./data-table-s0SF3upW.js";import{_ as z}from"./Icon.vue_vue_type_script_setup_true_lang-DMJXW0u4.js";import{A as qe}from"./AEditor-DI_6KB7f.js";import"./index.min-B6cT3MHh.js";const Ge=oe({__name:"DateRangePicker",props:{with:{type:Number,required:!1,default:180},type:{type:String,default:"datetime"},from:{type:String,default:""},to:{type:String,default:""}},emits:["update:from","update:to"],setup(r,{emit:t}){const d=t,m=r,V=(u,a)=>m.type==="datetime"?[I(u),I(a)]:m.type==="date"?[ye(u),I(a)]:m.type==="time"?[te(u),te(a)]:[null,null],E=u=>{if(!ae(u)){if(m.type==="datetime")return be(u,"");if(m.type==="date")return he(u,"");if(m.type==="time")return we(u,"")}return""},y=M(()=>m.type==="datetime"?"datetimerange":m.type==="date"?"daterange":m.type==="month"?"monthrange":"datetimerange"),_=M(()=>m.type==="datetime"?ee:m.type==="date"?fe:m.type==="time"?ce:ee),p=M(()=>m.from),D=M(()=>m.to),T=k(V(m.from,m.to)),v=u=>{ae(u)?(d("update:from",""),d("update:to","")):(d("update:from",E(u[0])),d("update:to",E(u[1])))};return _e([p,D],([u,a])=>{T.value=V(u,a)}),(u,a)=>{const U=ve;return f(),$(U,{modelValue:T.value,"onUpdate:modelValue":a[0]||(a[0]=L=>T.value=L),type:y.value,format:_.value,onChange:v},null,8,["modelValue","type","format"])}}}),Je=r=>N("/api/v1/admin/announcement/list",r),Qe=r=>N("/api/v1/admin/announcement/details",r),We=r=>N("/api/v1/admin/announcement/save",r),Xe=r=>N("/api/v1/admin/announcement/delete",r),Ye={id:0,title:"",content:"",description:"",status:0,startDatetime:"",endDatetime:""},Ze=(r,t,d)=>{O(`editorNotEmpty - value : ${t}`),ge(t)?d(new Error(r.message)):d()},je=["innerHTML"],xe={key:0},et={key:1},tt=["innerHTML"],at={class:"app-modal-body"},ot={class:"app-modal-footer"},bt=oe({__name:"index",setup(r){const{t}=ke(),{initialize:d,handleResult:m,handleParams:V}=Oe(),E=[{title:t("common.field_title"),dataKey:"id",key:"id",width:30},{title:t("common.field_title"),dataKey:"title",key:"title",width:360},{title:t("common.field_publish_status"),dataKey:"status",key:"status",width:150},{title:t("common.field_publish_period"),dataKey:"publishPeriod",key:"publishPeriod",width:500},{title:t("common.field_last_modified_at"),dataKey:"lastModifiedAt",key:"lastModifiedAt",width:200},{title:t("common.label_action"),dataKey:"operation",key:"operation",width:160}],y=B(d(E)),_=k(),p=k(!1),D=()=>h(this,null,function*(){yield Je(V(y)).then(i=>{m(y,i)})}),T=k(""),v=k(!1),u=k(),a=B(Ye),U=B({title:[{required:!0,message:t("common.field_title_validation")}],content:[{required:!0,message:t("common.field_description_validation"),validator:Ze}]}),L=()=>{a.id=0,a.title="",a.content="",a.description="",a.status=0,a.startDatetime="",a.endDatetime=""},q=i=>h(this,null,function*(){var o;(o=u.value)==null||o.clearValidate(),i&&i>0?(T.value=t("common.announcement_pages_edit_title"),yield Qe({id:i}).then(c=>{v.value=!0,Object.assign(a,x({},c.data))})):(v.value=!0,T.value=t("common.announcement_pages_add_title"),L())}),le=()=>{v.value=!1},G=()=>h(this,null,function*(){console.log(a),yield u.value.validate(i=>h(this,null,function*(){i?We(a).then(o=>{o.code=="200"&&(v.value=!1,_.value.refresh())}):O("Form Validation Failed.")}))}),R=(i=0)=>h(this,null,function*(){const o=i>0?[i]:_.value.selectedRowKeys();if(Te(o)){$e({message:t("common.label_please_select_one_record")}).then();return}Xe({ids:o}).then(c=>{c.code=="200"&&(v.value=!1,_.value.refresh())})}),S=k(!1),J=k(""),ne=i=>h(this,null,function*(){J.value=i.content,S.value=!0});return Ve(()=>h(this,null,function*(){O("Page <<AnnouncementAdminListPage>> mounted.")})),(i,o)=>{const c=Ce,C=He,ie=Ie,Q=Ke,se=Ae,W=Me,X=Fe,A=Pe,Y=Ne,de=Ue,re=Le;return f(),K(F,null,[l(s(Be),null,{title:n(()=>[w(g(i.$t("common.announcement_management")),1)]),_:1}),l(se,{shadow:"never"},{default:n(()=>[l(s(ze),{ref_key:"dataTableRef",ref:_,model:s(y),"onUpdate:model":o[3]||(o[3]=e=>Ee(y)?y.value=e:null),"row-selection-enabled":p.value,"toolbar-enabled":!0,onGetDataList:D},{toolbar:n(()=>[l(c,{type:"primary",onClick:o[0]||(o[0]=e=>q(0))},{default:n(()=>[w(g(i.$t("common.button_add")),1)]),_:1}),l(c,{onClick:o[1]||(o[1]=e=>p.value=!p.value)},{default:n(()=>[w(g(p.value?i.$t("common.label_batch_operation_cancel"):i.$t("common.label_batch_operation")),1)]),_:1}),l(c,{danger:"",onClick:o[2]||(o[2]=e=>R(0))},{default:n(()=>[w(g(i.$t("common.button_delete")),1)]),_:1})]),body:n(()=>[(f(),K(F,null,De(E,e=>(f(),K(F,null,[e.dataKey==="id"?(f(),K(F,{key:0},[p.value?(f(),$(C,{key:e.dataKey,type:"selection",width:e.width,fixed:"left"},null,8,["width"])):Re("",!0)],64)):e.dataKey==="title"?(f(),$(C,{key:e.dataKey,label:e.title,prop:e.dataKey,width:e.width,fixed:"left"},null,8,["label","prop","width"])):e.dataKey==="publishPeriod"?(f(),$(C,{key:e.dataKey,label:e.title,width:e.width},{default:n(b=>[P("div",{innerHTML:s(Se)(b.row.startDatetime,b.row.endDatetime)},null,8,je)]),_:2},1032,["label","width"])):e.dataKey==="status"?(f(),$(C,{key:e.dataKey,label:e.title,width:e.width},{default:n(b=>[b.row.status?(f(),K("div",xe,g(i.$t("common.field_publish_status_on")),1)):(f(),K("div",et,g(i.$t("common.field_publish_status_off")),1))]),_:2},1032,["label","width"])):e.dataKey==="operation"?(f(),$(C,{key:e.dataKey,label:e.title,fixed:"right"},{default:n(b=>[l(Q,null,{default:n(()=>[l(c,{type:"primary",size:"small",onClick:H=>ne(b.row)},{icon:n(()=>[l(s(z),{icon:"mdi:eye-outline"})]),_:2},1032,["onClick"]),l(c,{type:"primary",size:"small",onClick:H=>q(b.row.id)},{icon:n(()=>[l(s(z),{icon:"ant-design:edit-outlined"})]),_:2},1032,["onClick"]),l(ie,{title:i.$t("common.label_confirm_delete_record"),onConfirm:H=>R(b.row.id)},{reference:n(()=>[l(c,{danger:"",type:"primary",size:"small",onConfirm:H=>R(b.row.id)},{icon:n(()=>[l(s(z),{icon:"ant-design:close-outlined"})]),_:2},1032,["onConfirm"])]),_:2},1032,["title","onConfirm"])]),_:2},1024)]),_:2},1032,["label"])):(f(),$(C,{key:e.dataKey,label:e.title,prop:e.dataKey,width:e.width},null,8,["label","prop","width"]))],64))),64))]),_:1},8,["model","row-selection-enabled"])]),_:1}),l(W,{modelValue:S.value,"onUpdate:modelValue":o[4]||(o[4]=e=>S.value=e),class:"app-modal",title:i.$t("common.label_preview"),"destroy-on-close":""},{default:n(()=>[P("div",{innerHTML:J.value},null,8,tt)]),_:1},8,["modelValue","title"]),l(W,{modelValue:v.value,"onUpdate:modelValue":o[11]||(o[11]=e=>v.value=e),class:"app-modal",title:T.value,"destroy-on-close":""},{footer:n(()=>[P("div",ot,[l(Q,null,{default:n(()=>[l(c,{type:"primary",onClick:G},{default:n(()=>[w(" Confirm ")]),_:1}),l(c,{onClick:le},{default:n(()=>[w(" Cancel ")]),_:1})]),_:1})])]),default:n(()=>[P("div",at,[l(re,{ref_key:"entityForm",ref:u,"label-width":"auto",model:s(a),rules:s(U),onFinish:G},{default:n(()=>[l(A,{prop:"title",label:i.$t("common.field_title")},{default:n(()=>[l(X,{modelValue:s(a).title,"onUpdate:modelValue":o[5]||(o[5]=e=>s(a).title=e),placeholder:s(t)("common.field_title_placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(A,{prop:"content",label:i.$t("common.field_content")},{default:n(()=>[l(s(qe),{value:s(a).content,"onUpdate:value":o[6]||(o[6]=e=>s(a).content=e)},null,8,["value"])]),_:1},8,["label"]),l(A,{prop:"status",label:i.$t("common.field_publish_status")},{default:n(()=>[l(de,{modelValue:s(a).status,"onUpdate:modelValue":o[7]||(o[7]=e=>s(a).status=e)},{default:n(()=>[l(Y,{value:1},{default:n(()=>[w(g(s(t)("common.field_publish_status_finish")),1)]),_:1}),l(Y,{value:0},{default:n(()=>[w(g(s(t)("common.field_publish_status_unfinished")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(A,{label:i.$t("common.field_publish_period")},{default:n(()=>[l(s(Ge),{from:s(a).startDatetime,"onUpdate:from":o[8]||(o[8]=e=>s(a).startDatetime=e),to:s(a).endDatetime,"onUpdate:to":o[9]||(o[9]=e=>s(a).endDatetime=e),type:"datetime"},null,8,["from","to"])]),_:1},8,["label"]),l(A,{prop:"description",label:i.$t("common.field_description")},{default:n(()=>[l(X,{modelValue:s(a).description,"onUpdate:modelValue":o[10]||(o[10]=e=>s(a).description=e),placeholder:s(t)("common.field_description_placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])])]),_:1},8,["modelValue","title"])],64)}}});export{bt as default};
