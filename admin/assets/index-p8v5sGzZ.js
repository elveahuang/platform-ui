var se=Object.defineProperty;var Z=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var j=(d,t,s)=>t in d?se(d,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):d[t]=s,L=(d,t)=>{for(var s in t||(t={}))de.call(t,s)&&j(d,s,t[s]);if(Z)for(var s of Z(t))me.call(t,s)&&j(d,s,t[s]);return d};var v=(d,t,s)=>new Promise((r,h)=>{var $=p=>{try{c(s.next(p))}catch(y){h(y)}},D=p=>{try{c(s.throw(p))}catch(y){h(y)}},c=p=>p.done?r(p.value):Promise.resolve(p.value).then($,D);c((s=s.apply(d,t)).next())});import{d as x,c as C,aq as J,ar as re,as as ue,r as g,ab as pe,e as M,f as ce,at as S,au as fe,av as W,N as X,aw as _e,ax as ye,ay as be,az as ve,Q as F,l as ee,aA as ge,U as he,V as K,o as we,g as B,i as e,j as i,w as n,n as $e,m as w,t as b,k as A,aB as De,F as Te,al as Ve,am as ke,D as Ee,ao as Ce,an as Ae,G as Me,H as Fe,ai as Pe,Y as Re,Z as Ne,aC as Ue,aD as Le,a1 as Se}from"./index-C0tfck0c.js";/* empty css                     *//* empty css                       *//* empty css                 */import"./el-progress-BU8uPaXS.js";/* empty css                *//* empty css                 */import{A as Ke,a as Be}from"./el-popover-DL8uJfeI.js";/* empty css                  */import{u as He}from"./data-table-GhjcTzBQ.js";import{_ as H}from"./Icon.vue_vue_type_script_setup_true_lang-BKRInLXE.js";import{A as Ie}from"./AEditor-DnbyTftz.js";import"./index.min-S2eiII43.js";const ze=x({__name:"DateRangePicker",props:{with:{type:Number,required:!1,default:180},type:{type:String,default:"datetime"},from:{type:String,default:""},to:{type:String,default:""}},emits:["update:from","update:to"],setup(d,{emit:t}){const s=t,r=d,h=(m,f)=>r.type==="datetime"?[S(m),S(f)]:r.type==="date"?[fe(m),S(f)]:r.type==="time"?[W(m),W(f)]:[null,null],$=m=>{if(!X(m)){if(r.type==="datetime")return ye(m,"");if(r.type==="date")return be(m,"");if(r.type==="time")return ve(m,"")}return""},D=C(()=>r.type==="datetime"?"datetimerange":r.type==="date"?"daterange":r.type==="month"?"monthrange":"datetimerange"),c=C(()=>r.type==="datetime"?J:r.type==="date"?re:r.type==="time"?ue:J),p=C(()=>r.from),y=C(()=>r.to),T=g(h(r.from,r.to)),V=m=>{X(m)?(s("update:from",""),s("update:to","")):(s("update:from",$(m[0])),s("update:to",$(m[1])))};return pe([p,y],([m,f])=>{T.value=h(m,f)}),(m,f)=>{const u=_e;return M(),ce(u,{modelValue:T.value,"onUpdate:modelValue":f[0]||(f[0]=P=>T.value=P),type:D.value,format:c.value,onChange:V},null,8,["modelValue","type","format"])}}}),Oe=d=>F("/api/v1/admin/announcement/list",d),qe=d=>F("/api/v1/admin/announcement/details",d),Ge=d=>F("/api/v1/admin/announcement/save",d),Qe=d=>F("/api/v1/admin/announcement/delete",d),Ye={id:0,title:"",content:"",description:"",status:0,startDatetime:"",endDatetime:""},Ze=(d,t,s)=>{ee(`editorNotEmpty - value : ${t}`),ge(t)?s(new Error(d.message)):s()},je=["innerHTML"],Je={key:0},We={key:1},Xe=["innerHTML"],xe={class:"app-modal-body"},et={class:"app-modal-footer"},_t=x({__name:"index",setup(d){const{t}=he(),{initialize:s,handleResult:r,handleParams:h}=He(),D={columns:[{title:t("common.field_title"),dataKey:"id",key:"id",width:30},{title:t("common.field_title"),dataKey:"title",key:"title",width:360},{title:t("common.field_publish_status"),dataKey:"status",key:"status",width:150},{title:t("common.field_publish_period"),dataKey:"publishPeriod",key:"publishPeriod",width:500},{title:t("common.field_last_modified_at"),dataKey:"lastModifiedAt",key:"lastModifiedAt",width:200},{title:t("common.label_action"),dataKey:"operation",key:"operation",width:160}]},c=K(s(D)),p=g(),y=g(!1),T=()=>v(this,null,function*(){console.log("getDataList.getDataList.."),console.log(c),yield Oe(h(c)).then(a=>{r(c,a)})}),V=g(""),m=g(!1),f=g(),u=K({}),P=K({title:[{required:!0,message:t("common.field_title_validation")}],content:[{required:!0,message:t("common.field_description_validation"),validator:Ze}]}),I=a=>v(this,null,function*(){var o;(o=f.value)==null||o.clearValidate(),a&&a>0?(V.value=t("common.announcement_pages_edit_title"),yield qe({id:a}).then(_=>{Object.assign(u,L({},_.data))})):(V.value=t("common.announcement_pages_add_title"),Object.assign(u,L({},Ye))),m.value=!0}),te=()=>{m.value=!1},z=()=>v(this,null,function*(){yield f.value.validate(a=>v(this,null,function*(){a&&Ge(u).then(o=>{o.code=="200"&&(m.value=!1,p.value.refresh())})}))}),R=(a=0)=>v(this,null,function*(){const o=a>0?[a]:p.value.selectedRowKeys();if(Ve(o)){ke({message:t("common.label_please_select_one_record")}).then();return}Qe({ids:o}).then(_=>{_.code=="200"&&(m.value=!1,p.value.refresh())})}),N=g(!1),O=g(""),ae=a=>v(this,null,function*(){O.value=a.content,N.value=!0});return we(()=>v(this,null,function*(){ee("Page <<AnnouncementIndexPage>> mounted.")})),(a,o)=>{const _=Ee,E=Ce,oe=Ae,q=Me,le=Fe,G=Pe,Q=Re,k=Ne,Y=Ue,ne=Le,ie=Se;return M(),B(Te,null,[e(i(Ke),{title:a.$t("common.announcement_management")},null,8,["title"]),e(le,{shadow:"never"},{default:n(()=>[e(i(Be),{ref_key:"dataTableRef",ref:p,model:i(c),"onUpdate:model":o[3]||(o[3]=l=>$e(c)?c.value=l:null),"row-selection-enabled":y.value,"toolbar-enabled":!0,onGetDataList:T},{toolbar:n(()=>[e(_,{type:"primary",onClick:o[0]||(o[0]=l=>I(0))},{default:n(()=>[w(b(a.$t("common.button_add")),1)]),_:1}),e(_,{onClick:o[1]||(o[1]=l=>y.value=!y.value)},{default:n(()=>[w(b(y.value?a.$t("common.label_batch_operation_cancel"):a.$t("common.label_batch_operation")),1)]),_:1}),e(_,{danger:"",onClick:o[2]||(o[2]=l=>R(0))},{default:n(()=>[w(b(a.$t("common.button_delete")),1)]),_:1})]),body:n(()=>[e(E,{prop:"title",label:a.$t("common.field_title"),fixed:"left"},null,8,["label"]),e(E,{label:a.$t("common.field_publish_period"),width:300},{default:n(l=>[A("div",{innerHTML:i(De)(l.row.startDatetime,l.row.endDatetime)},null,8,je)]),_:1},8,["label"]),e(E,{label:a.$t("common.field_publish_status"),width:800},{default:n(l=>[l.row.status?(M(),B("div",Je,b(a.$t("common.field_publish_status_on")),1)):(M(),B("div",We,b(a.$t("common.field_publish_status_off")),1))]),_:1},8,["label"]),e(E,{label:i(t)("common.label_action"),width:200,fixed:"right"},{default:n(l=>[e(q,null,{default:n(()=>[e(_,{type:"primary",size:"small",onClick:U=>ae(l.row)},{icon:n(()=>[e(i(H),{icon:"mdi:eye-outline"})]),_:2},1032,["onClick"]),e(_,{type:"primary",size:"small",onClick:U=>I(l.row.id)},{icon:n(()=>[e(i(H),{icon:"ant-design:edit-outlined"})]),_:2},1032,["onClick"]),e(oe,{title:a.$t("common.label_confirm_delete_record"),onConfirm:U=>R(l.row.id)},{reference:n(()=>[e(_,{danger:"",type:"danger",size:"small",onConfirm:U=>R(l.row.id)},{icon:n(()=>[e(i(H),{icon:"ant-design:close-outlined"})]),_:2},1032,["onConfirm"])]),_:2},1032,["title","onConfirm"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["model","row-selection-enabled"])]),_:1}),e(G,{modelValue:N.value,"onUpdate:modelValue":o[4]||(o[4]=l=>N.value=l),class:"app-modal",title:a.$t("common.label_preview"),"destroy-on-close":""},{default:n(()=>[A("div",{innerHTML:O.value},null,8,Xe)]),_:1},8,["modelValue","title"]),e(G,{modelValue:m.value,"onUpdate:modelValue":o[11]||(o[11]=l=>m.value=l),class:"app-modal",title:V.value,"destroy-on-close":""},{default:n(()=>[A("div",xe,[e(ie,{ref_key:"entityFormRef",ref:f,"label-width":"auto",model:i(u),rules:i(P),onFinish:z},{default:n(()=>[e(k,{prop:"title",label:a.$t("common.field_title")},{default:n(()=>[e(Q,{modelValue:i(u).title,"onUpdate:modelValue":o[5]||(o[5]=l=>i(u).title=l),placeholder:i(t)("common.field_title_placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(k,{prop:"content",label:a.$t("common.field_content")},{default:n(()=>[e(i(Ie),{value:i(u).content,"onUpdate:value":o[6]||(o[6]=l=>i(u).content=l)},null,8,["value"])]),_:1},8,["label"]),e(k,{prop:"status",label:a.$t("common.field_publish_status")},{default:n(()=>[e(ne,{modelValue:i(u).status,"onUpdate:modelValue":o[7]||(o[7]=l=>i(u).status=l)},{default:n(()=>[e(Y,{value:1},{default:n(()=>[w(b(i(t)("common.field_publish_status_finish")),1)]),_:1}),e(Y,{value:0},{default:n(()=>[w(b(i(t)("common.field_publish_status_unfinished")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(k,{label:a.$t("common.field_publish_period")},{default:n(()=>[e(i(ze),{from:i(u).startDatetime,"onUpdate:from":o[8]||(o[8]=l=>i(u).startDatetime=l),to:i(u).endDatetime,"onUpdate:to":o[9]||(o[9]=l=>i(u).endDatetime=l),type:"datetime"},null,8,["from","to"])]),_:1},8,["label"]),e(k,{prop:"description",label:a.$t("common.field_description")},{default:n(()=>[e(Q,{modelValue:i(u).description,"onUpdate:modelValue":o[10]||(o[10]=l=>i(u).description=l),placeholder:i(t)("common.field_description_placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])])]),footer:n(()=>[A("div",et,[e(q,null,{default:n(()=>[e(_,{"native-type":"submit",type:"primary",onClick:z},{default:n(()=>[w(b(a.$t("common.button_submit")),1)]),_:1}),e(_,{"native-type":"reset",onClick:te},{default:n(()=>[w(b(a.$t("common.button_cancel")),1)]),_:1})]),_:1})])]),_:1},8,["modelValue","title"])],64)}}});export{_t as default};
