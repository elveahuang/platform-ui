var W=Object.defineProperty;var S=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var U=(l,e,i)=>e in l?W(l,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[e]=i,z=(l,e)=>{for(var i in e||(e={}))X.call(e,i)&&U(l,i,e[i]);if(S)for(var i of S(e))Y.call(e,i)&&U(l,i,e[i]);return l};var p=(l,e,i)=>new Promise((C,$)=>{var w=d=>{try{u(i.next(d))}catch(v){$(v)}},y=d=>{try{u(i.throw(d))}catch(v){$(v)}},u=d=>d.done?C(d.value):Promise.resolve(d.value).then(w,y);u((i=i.apply(l,e)).next())});/* empty css             */import{E as Z}from"./overlay-LcplVB-4.js";/* empty css                  *//* empty css               */import{E as x}from"./card-bV7lpVxk.js";import{u as ee,_ as te,E as ne}from"./checkbox-AdMhc8ao.js";/* empty css                   */import{E as oe}from"./space-XBnA_Mq5.js";import{d as L,o as N,l as q,e as T,g as j,k as H,m as ae,p as E,q as le,v as M,r as h,j as n,w as a,x as _,t as f,i as m,f as ie,y as se,z as me,F as de,A as re,B as ce}from"./index-XKwGO23d.js";import{_ as ue}from"./_plugin-vue_export-helper-x3n3nnut.js";import{E as pe}from"./index-uqCvPrs1.js";import{E as _e}from"./index-P6wGn45A.js";import{E as fe,a as ve}from"./index-AV11hqKx.js";import"./refs-N0Ci8w-y.js";import"./scroll-xYltU74p.js";import"./castArray-LHqp4vAE.js";const be={class:"app-page-header"},ye={class:"title"},he=L({__name:"index",setup(l){return N(()=>p(this,null,function*(){q("Page <<AppPageHeader>> mounted.")})),(e,i)=>(T(),j("div",be,[H("div",ye,[ae(e.$slots,"title",{},void 0,!0)])]))}}),$e=ue(he,[["__scopeId","data-v-1bd26982"]]),ge=l=>E("/api/v1/admin/announcement/list",l),ke=l=>E("/api/v1/admin/announcement/details",l),Ee=l=>E("/api/v1/admin/announcement/save",l),Ce=l=>E("/api/v1/admin/announcement/delete",l),we={class:"pb-4"},He=L({__name:"index",setup(l){const{t:e}=le(),{initialize:i,handleResult:C,handleParams:$}=ee(),w=[{title:e("common.field_title"),dataIndex:"title",key:"title",width:300,sorter:!0},{title:e("common.field_content"),dataIndex:"content",key:"content"},{title:e("common.field_last_modified_at"),dataIndex:"lastModifiedAt",key:"lastModifiedAt",sorter:!0},{title:e("common.label_action"),dataIndex:"operation",key:"operation",width:200}],y=M(i(w)),u=h(),d=()=>p(this,null,function*(){yield ge($(y)).then(t=>{C(y,t)})}),v=h(""),b=h(!1),D=h(),g=h(!1),r=M({}),O=M({title:[{required:!0,message:e("common.field_title_validation")}],content:[{required:!0,message:e("common.field_description_validation")}]}),I=t=>p(this,null,function*(){b.value=!0,t&&t>0?(v.value=e("common.announcement_pages_edit_title"),yield ke({id:t}).then(o=>{Object.assign(r,z({},o.data))})):v.value=e("common.announcement_pages_add_title")}),G=()=>{b.value=!1},V=()=>p(this,null,function*(){yield D.value.validate().then(()=>p(this,null,function*(){Ee(r).then(t=>{t.code=="200"&&(b.value=!1,u.value.refresh())})}))}),B=(t=0)=>p(this,null,function*(){const o=t>0?[t]:u.value.selectedRowKeys();if(re(o)){ce({message:"请选择"}).then();return}Ce({ids:o}).then(c=>{c.code=="200"&&(b.value=!1,u.value.refresh())})});return N(()=>p(this,null,function*(){q("Page <<AnnouncementAdminListPage>> mounted.")})),(t,o)=>{const c=pe,P=oe,k=ne,R=x,F=_e,A=fe,K=ve,J=Z;return T(),j(de,null,[n(m($e),null,{title:a(()=>[_(f(t.$t("common.announcement_management")),1)]),_:1}),n(R,{shadow:"never"},{default:a(()=>[H("div",we,[n(P,null,{default:a(()=>[n(c,{type:"primary",onClick:o[0]||(o[0]=s=>I(0))},{default:a(()=>[_(f(t.$t("common.button_add")),1)]),_:1}),n(c,{onClick:o[1]||(o[1]=s=>g.value=!m(g))},{default:a(()=>[_(f(m(g)?t.$t("common.label_batch_operation_cancel"):t.$t("common.label_batch_operation")),1)]),_:1}),n(c,{onClick:o[2]||(o[2]=s=>B(0))},{default:a(()=>[_(f(t.$t("common.button_delete")),1)]),_:1})]),_:1})]),n(m(te),{ref_key:"dataTableRef",ref:u,model:y,"onUpdate:model":o[3]||(o[3]=s=>y=s),onGetDataList:d},{default:a(()=>[m(g)?(T(),ie(k,{key:0,type:"selection",width:"30",class:"text-center"})):se("",!0),n(k,{label:t.$t("common.field_title"),prop:"title"},null,8,["label"]),n(k,{label:t.$t("common.field_content"),prop:"content"},null,8,["label"]),n(k,{fixed:"right",label:t.$t("common.label_action"),width:"200"},{default:a(s=>[n(c,{link:"",type:"primary",size:"small",onClick:Q=>I(s.row.id)},{default:a(()=>[_(f(t.$t("common.button_edit")),1)]),_:2},1032,["onClick"]),n(c,{link:"",type:"primary",size:"small",onClick:Q=>B(s.row.id)},{default:a(()=>[_(f(t.$t("common.button_delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1}),n(J,{class:"app-modal",modelValue:m(b),"onUpdate:modelValue":o[7]||(o[7]=s=>me(b)?b.value=s:null),title:m(v)},{footer:a(()=>[n(P,null,{default:a(()=>[n(c,{type:"primary",onClick:V},{default:a(()=>[_(f(t.$t("common.button_submit")),1)]),_:1}),n(c,{onClick:G},{default:a(()=>[_(f(t.$t("common.button_cancel")),1)]),_:1})]),_:1})]),default:a(()=>[n(R,null,{default:a(()=>[n(K,{ref_key:"entityForm",ref:D,model:r,rules:O,onFinish:V},{default:a(()=>[n(A,{name:"title",label:t.$t("common.field_title")},{default:a(()=>[n(F,{value:r.title,"onUpdate:value":o[4]||(o[4]=s=>r.title=s),placeholder:m(e)("common.field_title_placeholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(A,{name:"content",label:t.$t("common.field_content")},{default:a(()=>[n(F,{value:r.content,"onUpdate:value":o[5]||(o[5]=s=>r.content=s),placeholder:m(e)("common.field_content_placeholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(A,{name:"description",label:t.$t("common.field_description")},{default:a(()=>[n(F,{value:r.description,"onUpdate:value":o[6]||(o[6]=s=>r.description=s),placeholder:m(e)("common.field_description_placeholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue","title"])],64)}}});export{He as default};
