var d=(l,s,c)=>new Promise((m,u)=>{var p=e=>{try{i(c.next(e))}catch(_){u(_)}},r=e=>{try{i(c.throw(e))}catch(_){u(_)}},i=e=>e.done?m(e.value):Promise.resolve(e.value).then(p,r);i((c=c.apply(l,s)).next())});import{G as F,d as $,r as w,o as I,l as L,b as g,f as b,h as t,ai as M,c as S,D as B,e as x,w as o,j as n,t as k,i as a,aj as q,F as H,g as A,v as K,x as j,z as G,ak as J,A as P,B as Q,C as R,H as O,a as W,al as X,q as Y,I as N,Q as Z,k as ee,J as ae,K as te,U as oe,L as se,M as ne,am as le}from"./index-BeC3e9Y-.js";/* empty css                *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                                                             */import"./el-progress-Bzk5aJF9.js";/* empty css                        */import{_ as ce,T as re,L as pe}from"./el-menu-item-Bfx5S8T0.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./AppIcon.vue_vue_type_script_setup_true_lang-Ddl_DFWV.js";const de=l=>F("/api/v1/captcha/code",l),ue={class:"flex items-center"},_e=$({__name:"CodeCaptcha",props:{width:{type:Number,default:120},height:{type:Number,default:32}},emits:["change"],setup(l,{expose:s,emit:c}){const m=c,u=l,p=w(""),r=()=>d(this,null,function*(){yield de({}).then(e=>{p.value=e.data.image,m("change",e.data.key)})});return s({refresh:()=>d(this,null,function*(){r().then()})}),I(()=>d(this,null,function*(){L("Component <<Captcha>> mounted."),r().then()})),(e,_)=>{const h=M;return g(),b("div",ue,[t(h,{preview:!1,alt:e.$t("common.field_captcha"),width:u.width,height:u.height,src:p.value,onClick:r},null,8,["alt","width","height","src"])])}}}),me=l=>(Q("data-v-8710b8cf"),l=l(),R(),l),he={class:"app-layout-header-container"},fe={class:"app-layout-logo"},ge={class:"logo"},ye=me(()=>n("div",{class:"app-layout-nav"},null,-1)),ve={class:"app-layout-tools"},we={class:"app-layout-content-container"},Ce={class:"app-layout-footer-container"},Ee=["innerHTML"],Ve=$({__name:"entry",setup(l){const s=S(()=>B.app.getTitle()),c=S(()=>B.app.getCopyright());return I(()=>{L("Component <<EntryLayout>> is mounted.")}),(m,u)=>{const p=K,r=j,i=G,e=J,_=P;return g(),x(_,{class:"app-layout"},{default:o(()=>[t(r,{class:"app-layout-header"},{default:o(()=>[n("div",he,[n("div",fe,[n("div",ge,[n("span",null,k(a(s)),1)])]),ye,n("div",ve,[t(p,null,{default:o(()=>[t(a(ce)),t(a(re)),t(a(pe))]),_:1})])])]),_:1}),t(i,{class:"app-layout-content"},{default:o(()=>[n("div",we,[q(m.$slots,"default",{},void 0,!0)])]),_:3}),t(e,{class:"app-layout-footer"},{default:o(()=>[n("div",Ce,[(g(!0),b(H,null,A(a(c),(h,C)=>(g(),b("div",{class:"app-text",key:C,innerHTML:h},null,8,Ee))),128))])]),_:1})]),_:3})}}}),be=ie(Ve,[["__scopeId","data-v-8710b8cf"]]),xe={class:"mt-16 sm:w-full md:w-9/12 lg:w-6/12 xl:w-4/12"},ke={class:"text-center"},$e={class:"flex w-full"},Ie={class:"flex-auto"},Le={class:"mx-4 flex-none"},je=$({__name:"login",setup(l){const{t:s}=O(),c=W(),{login:m,getUserInfo:u}=X(),{isLoginCaptchaEnabled:p}=Y(),r=w(),i=w(),e=N(le),_=N({username:[{required:!0,message:s("common.user_field_username_validation_login")}],password:[{required:!0,message:s("common.user_field_password_validation")}],captchaValue:[{required:!0,message:s("common.field_captcha_validation")}]}),h=w(!1),C=()=>d(this,null,function*(){yield r.value.validate().then(()=>d(this,null,function*(){h.value=!0,yield m(e).then(()=>d(this,null,function*(){yield u().then(),yield c.push("/").then()})).finally(()=>{e.captchaKey="",e.captchaValue="",h.value=!1,p&&i.value.refresh()})}))}),T=E=>d(this,null,function*(){e.captchaKey=E});return I(()=>d(this,null,function*(){L("Page <<Login>> mounted.")})),(E,f)=>{const V=ae,v=te,U=oe,z=se,D=ne;return g(),x(a(be),null,{default:o(()=>[n("div",xe,[t(D,{shadow:"never"},{header:o(()=>[n("div",ke,k(E.$t("common.user_pages_login_title")),1)]),default:o(()=>[t(z,{ref_key:"form",ref:r,model:a(e),rules:a(_),class:"!m-8 !mb-12"},{default:o(()=>[t(v,{prop:"username"},{default:o(()=>[t(V,{size:"large",modelValue:a(e).username,"onUpdate:modelValue":f[0]||(f[0]=y=>a(e).username=y),placeholder:a(s)("common.user_field_username_placeholder_login")},null,8,["modelValue","placeholder"])]),_:1}),t(v,{prop:"password"},{default:o(()=>[t(V,{type:"password",size:"large",modelValue:a(e).password,"onUpdate:modelValue":f[1]||(f[1]=y=>a(e).password=y),placeholder:a(s)("common.user_field_password_placeholder")},null,8,["modelValue","placeholder"])]),_:1}),a(p)?(g(),x(v,{key:0,prop:"captchaValue"},{default:o(()=>[n("div",$e,[n("div",Ie,[t(V,{size:"large",value:a(e).captchaValue,"onUpdate:value":f[2]||(f[2]=y=>a(e).captchaValue=y),placeholder:a(s)("common.field_captcha_placeholder")},null,8,["value","placeholder"])]),n("div",Le,[t(a(_e),{class:"h-full",ref_key:"captcha",ref:i,onChange:T},null,512)])])]),_:1})):Z("",!0),t(v,{class:"!mt-8"},{default:o(()=>[t(U,{size:"large","html-type":"submit",type:"primary",disabled:h.value,onClick:C,class:"w-full"},{default:o(()=>[ee(k(a(s)("common.button_login")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])]),_:1})}}});export{je as default};
