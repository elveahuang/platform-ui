var ue=Object.defineProperty;var q=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var K=(u,t,r)=>t in u?ue(u,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[t]=r,J=(u,t)=>{for(var r in t||(t={}))de.call(t,r)&&K(u,r,t[r]);if(q)for(var r of q(t))pe.call(t,r)&&K(u,r,t[r]);return u};var y=(u,t,r)=>new Promise((d,T)=>{var $=p=>{try{f(r.next(p))}catch(g){T(g)}},_=p=>{try{f(r.throw(p))}catch(g){T(g)}},f=p=>p.done?d(p.value):Promise.resolve(p.value).then($,_);f((r=r.apply(u,t)).next())});import{d as te,c as Q,r as c,O as ce,P as fe,b as D,e as ae,V as W,W as X,X as _e,Y as ve,Z as R,_ as ye,$ as Y,a0 as Z,a1 as be,a2 as we,a3 as he,G as H,H as ge,I as O,o as ke,l as De,f as P,h as a,w as i,k as C,t as h,i as l,m as Te,Q as B,F as j,j as Ce,a4 as $e,S as Ee,T as Me,U as Ae,v as Fe,M as Pe,N as Ie,J as Ve,K as He,a5 as Ue,a6 as Ne,L as Se,a7 as Le}from"./index-BeC3e9Y-.js";/* empty css                     *//* empty css                       *//* empty css                 *//* empty css                   *//* empty css                */import"./el-progress-Bzk5aJF9.js";/* empty css                  */import{u as Re}from"./data-table-K8IhbJ5d.js";/* empty css                        */import{_ as ee}from"./AppIcon.vue_vue_type_script_setup_true_lang-Ddl_DFWV.js";import{A as Oe}from"./index-Deri3loS.js";import{_ as Be}from"./DataTable.vue_vue_type_script_setup_true_lang-Cg-fagcS.js";import{_ as xe}from"./AEditor.vue_vue_type_script_setup_true_lang-B4QlGX9x.js";import"./index.min-DOEe5jHn.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ze=te({__name:"date-range-picker",props:{with:{type:Number,required:!1,default:360},type:{type:String,default:"datetime"},from:{type:String,default:""},to:{type:String,default:""}},emits:["update:from","update:to"],setup(u,{emit:t}){const r=t,d=u,T=()=>d.type==="datetime"?{hideDisabledOptions:!0,defaultValue:[W("00:00:00","HH:mm:ss"),W("23:59:59","HH:mm:ss")]}:!1,$=m=>m==="datetime"?X:m==="date"?_e:m==="time"?ve:X,_=(m,v)=>d.type==="datetime"?[R(m),R(v)]:d.type==="date"?[ye(m),R(v)]:d.type==="time"?[Y(m),Y(v)]:[null,null],f=m=>{if(!Z(m)){if(d.type==="datetime")return be(m,"");if(d.type==="date")return we(m,"");if(d.type==="time")return he(m,"")}return""},p=Q(()=>d.from),g=Q(()=>d.to),k=c(_(d.from,d.to)),b=c($(d.type)),E=c([!0,!0]),o=c(!0),U=c(T()),N=m=>{Z(m)?(r("update:from",""),r("update:to","")):(r("update:from",f(m[0])),r("update:to",f(m[1])))};return ce([p,g],([m,v])=>{k.value=_(m,v)}),(m,v)=>{const I=fe("a-range-picker");return D(),ae(I,{"allow-clear":o.value,"allow-empty":E.value,value:k.value,"onUpdate:value":v[0]||(v[0]=S=>k.value=S),"show-time":U.value,format:b.value,onChange:N},null,8,["allow-clear","allow-empty","value","show-time","format"])}}}),Ge=u=>H("/api/v1/admin/announcement/list",u),qe=u=>H("/api/v1/admin/announcement/details",u),Ke=u=>H("/api/v1/admin/announcement/save",u),Je=u=>H("/api/v1/admin/announcement/delete",u),Qe={id:0,title:"",content:"",description:"",status:!1,startDatetime:"",endDatetime:""},We=["innerHTML"],Xe={key:0},Ye={key:1},Ze=["innerHTML"],vt=te({__name:"index",setup(u){const{t}=ge(),{initialize:r,handleResult:d,handleParams:T}=Re(),$=[{title:t("common.field_title"),dataIndex:"title",key:"title",width:200,ellipsis:!0,fixed:"left"},{title:t("common.field_publish_status"),dataIndex:"status",key:"status",width:100,ellipsis:!0},{title:t("common.field_publish_period"),dataIndex:"publishPeriod",key:"publishPeriod",width:200,ellipsis:!0},{title:t("common.field_last_modified_at"),dataIndex:"lastModifiedAt",key:"lastModifiedAt",width:100,ellipsis:!0},{title:t("common.label_action"),dataIndex:"operation",key:"operation",width:45,ellipsis:!0,fixed:"right"}],_=O(r($)),f=c(),p=c(!1),g=()=>y(this,null,function*(){yield Ge(T(_)).then(n=>{d(_,n)})}),k=c(""),b=c(!1),E=c(),o=O(Qe),U=O({title:[{required:!0,message:t("common.field_title_validation")}]}),N=()=>{o.id=0,o.title="",o.content="",o.description="",o.status=!1,o.startDatetime="",o.endDatetime=""},m=n=>y(this,null,function*(){var e;(e=E.value)==null||e.clearValidate(),n&&n>0?(k.value=t("common.announcement_pages_edit_title"),yield qe({id:n}).then(w=>{b.value=!0,Object.assign(o,J({},w.data))})):(b.value=!0,k.value=t("common.announcement_pages_add_title"),N())}),v=()=>{b.value=!1},I=()=>y(this,null,function*(){yield E.value.validate().then(()=>y(this,null,function*(){Ke(o).then(n=>{n.code=="200"&&(b.value=!1,f.value.refresh())})}))}),S=(n=0)=>y(this,null,function*(){const e=n>0?[n]:f.value.selectedRowKeys();if(Ee(e)){Me({message:t("common.label_please_select_one_record")}).then();return}Je({ids:e}).then(w=>{w.code=="200"&&(b.value=!1,f.value.refresh())})}),M=c(!1),V=c(""),ne=n=>y(this,null,function*(){V.value=n.content,M.value=!0}),le=()=>y(this,null,function*(){V.value="",M.value=!1}),oe=()=>y(this,null,function*(){V.value="",M.value=!1});return ke(()=>y(this,null,function*(){De("Page <<AnnouncementAdminListPage>> mounted.")})),(n,e)=>{const w=Ae,se=Fe,L=Pe,x=Ie,z=Ve,A=He,G=Ue,ie=Ne,re=Se;return D(),P(j,null,[a(l(Oe),null,{title:i(()=>[C(h(n.$t("common.announcement_management")),1)]),_:1}),a(L,null,{default:i(()=>[a(l(Be),{ref_key:"dataTableRef",ref:f,model:l(_),"onUpdate:model":e[3]||(e[3]=s=>Te(_)?_.value=s:null),onGetDataList:g,"row-selection-enabled":p.value,"tool-bar-enabled":!0},{toolBar:i(()=>[a(w,{type:"primary",onClick:e[0]||(e[0]=s=>m(0))},{default:i(()=>[C(h(n.$t("common.button_add")),1)]),_:1}),a(w,{onClick:e[1]||(e[1]=s=>p.value=!p.value)},{default:i(()=>[C(h(p.value?n.$t("common.label_batch_operation_cancel"):n.$t("common.label_batch_operation")),1)]),_:1}),a(w,{danger:"",onClick:e[2]||(e[2]=s=>S(0))},{default:i(()=>[C(h(n.$t("common.button_delete")),1)]),_:1})]),bodyCell:i(({column:s,record:F})=>[s.dataIndex==="publishPeriod"?(D(),P("div",{key:0,innerHTML:l(Le)(F.startDatetime,F.endDatetime)},null,8,We)):B("",!0),s.dataIndex==="status"?(D(),P(j,{key:1},[F.status?(D(),P("div",Xe,h(n.$t("common.field_publish_status_on")),1)):(D(),P("div",Ye,h(n.$t("common.field_publish_status_off")),1))],64)):B("",!0),s.dataIndex==="operation"?(D(),ae(se,{key:2},{default:i(()=>[a(w,{type:"primary",size:"small",onClick:me=>ne(F)},{icon:i(()=>[a(l(ee),{icon:"mdi:eye-outline"})]),_:2},1032,["onClick"]),a(w,{type:"primary",size:"small",onClick:me=>m(F.id)},{icon:i(()=>[a(l(ee),{icon:"ant-design:edit-outlined"})]),_:2},1032,["onClick"])]),_:2},1024)):B("",!0)]),_:1},8,["model","row-selection-enabled"])]),_:1}),a(x,{class:"app-modal",open:M.value,"onUpdate:open":e[4]||(e[4]=s=>M.value=s),title:n.$t("common.label_preview"),onOk:le,onCancel:oe},{default:i(()=>[a(L,null,{default:i(()=>[Ce("div",{innerHTML:V.value},null,8,Ze)]),_:1})]),_:1},8,["open","title"]),a(x,{class:"app-modal",open:b.value,"onUpdate:open":e[11]||(e[11]=s=>b.value=s),title:k.value,onOk:I,onCancel:v},{default:i(()=>[a(L,null,{default:i(()=>[a(re,$e({ref_key:"entityForm",ref:E,model:l(o),rules:l(U),onFinish:I},{labelCol:{span:4},wrapperCol:{span:16}}),{default:i(()=>[a(A,{name:"title",label:n.$t("common.field_title")},{default:i(()=>[a(z,{value:l(o).title,"onUpdate:value":e[5]||(e[5]=s=>l(o).title=s),placeholder:l(t)("common.field_title_placeholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(A,{name:"content",label:n.$t("common.field_content")},{default:i(()=>[a(l(xe),{value:l(o).content,"onUpdate:value":e[6]||(e[6]=s=>l(o).content=s)},null,8,["value"])]),_:1},8,["label"]),a(A,{name:"status",label:n.$t("common.field_publish_status"),"label-col":{span:4},"wrapper-col":{span:16}},{default:i(()=>[a(ie,{value:l(o).status,"onUpdate:value":e[7]||(e[7]=s=>l(o).status=s)},{default:i(()=>[a(G,{value:!0},{default:i(()=>[C(h(l(t)("common.field_publish_status_finish")),1)]),_:1}),a(G,{value:!1},{default:i(()=>[C(h(l(t)("common.field_publish_status_unfinished")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),a(A,{name:"endDatetime",label:n.$t("common.field_publish_period")},{default:i(()=>[a(l(ze),{from:l(o).startDatetime,"onUpdate:from":e[8]||(e[8]=s=>l(o).startDatetime=s),to:l(o).endDatetime,"onUpdate:to":e[9]||(e[9]=s=>l(o).endDatetime=s)},null,8,["from","to"])]),_:1},8,["label"]),a(A,{name:"description",label:n.$t("common.field_description")},{default:i(()=>[a(z,{value:l(o).description,"onUpdate:value":e[10]||(e[10]=s=>l(o).description=s),placeholder:l(t)("common.field_description_placeholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},16,["model","rules"])]),_:1})]),_:1},8,["open","title"])],64)}}});export{vt as default};
