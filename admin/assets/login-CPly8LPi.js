var i=(l,s,c)=>new Promise((m,u)=>{var p=e=>{try{d(c.next(e))}catch(_){u(_)}},r=e=>{try{d(c.throw(e))}catch(_){u(_)}},d=e=>e.done?m(e.value):Promise.resolve(e.value).then(p,r);d((c=c.apply(l,s)).next())});import{a6 as T,d as k,r as w,o as S,l as I,b as g,f as b,j as t,ac as U,c as L,s as B,e as x,w as o,k as n,t as $,h as a,ad as q,g as z,F as H,x as K,y as P,A as j,ae as G,B as O,C as R,D as J,_ as Q,G as W,a as X,af as Y,q as Z,H as A,ag as ee,a9 as ae,m as te,O as oe,P as se,L as ne,S as le,M as ce}from"./index-DWWmRPTa.js";/* empty css                *//* empty css                     *//* empty css                  *//* empty css                 */import"./el-progress-D9WVLMog.js";/* empty css                 */import{_ as re,A as pe,a as de}from"./el-menu-item-4ZraDx0a.js";/* empty css                                                             *//* empty css                                                             */import"./AppIcon.vue_vue_type_script_setup_true_lang-DYSg23Iu.js";const ie=l=>T("/api/v1/captcha/code",l),ue={class:"flex items-center"},_e=k({__name:"CodeCaptcha",props:{width:{type:Number,default:120},height:{type:Number,default:32}},emits:["change"],setup(l,{expose:s,emit:c}){const m=c,u=l,p=w(""),r=()=>i(this,null,function*(){yield ie({}).then(e=>{p.value=e.data.image,m("change",e.data.key)})});return s({refresh:()=>i(this,null,function*(){r().then()})}),S(()=>i(this,null,function*(){I("Component <<Captcha>> mounted."),r().then()})),(e,_)=>{const h=U;return g(),b("div",ue,[t(h,{preview:!1,alt:e.$t("common.field_captcha"),width:u.width,height:u.height,src:p.value,onClick:r},null,8,["alt","width","height","src"])])}}}),me=l=>(R("data-v-f06bed07"),l=l(),J(),l),he={class:"app-layout-header-container"},fe={class:"app-layout-logo"},ge={class:"logo"},ye=me(()=>n("div",{class:"app-layout-nav"},null,-1)),ve={class:"app-layout-tools"},we={class:"app-layout-content-container"},Ce={class:"app-layout-footer-container"},Ee=["innerHTML"],Ve=k({__name:"entry",setup(l){const s=L(()=>B.app.getTitle()),c=L(()=>B.app.getCopyright());return S(()=>{I("Component <<EntryLayout>> is mounted.")}),(m,u)=>{const p=K,r=P,d=j,e=G,_=O;return g(),x(_,{class:"app-layout"},{default:o(()=>[t(r,{class:"app-layout-header"},{default:o(()=>[n("div",he,[n("div",fe,[n("div",ge,[n("span",null,$(a(s)),1)])]),ye,n("div",ve,[t(p,null,{default:o(()=>[t(a(re)),t(a(pe)),t(a(de))]),_:1})])])]),_:1}),t(d,{class:"app-layout-content"},{default:o(()=>[n("div",we,[q(m.$slots,"default",{},void 0,!0)])]),_:3}),t(e,{class:"app-layout-footer"},{default:o(()=>[n("div",Ce,[(g(!0),b(H,null,z(a(c),(h,C)=>(g(),b("div",{class:"app-text",key:C,innerHTML:h},null,8,Ee))),128))])]),_:1})]),_:3})}}}),be=Q(Ve,[["__scopeId","data-v-f06bed07"]]),xe={class:"mt-16 sm:w-full md:w-9/12 lg:w-6/12 xl:w-4/12"},$e={class:"text-center"},ke={class:"flex w-full"},Se={class:"flex-auto"},Ie={class:"mx-4 flex-none"},Ke=k({__name:"login",setup(l){const{t:s}=W(),c=X(),{login:m,getUserInfo:u}=Y(),{isLoginCaptchaEnabled:p}=Z(),r=w(),d=w(),e=A(ee),_=A({username:[{required:!0,message:s("common.user_field_username_validation_login")}],password:[{required:!0,message:s("common.user_field_password_validation")}],captchaValue:[{required:!0,message:s("common.field_captcha_validation")}]}),h=w(!1),C=()=>i(this,null,function*(){yield r.value.validate().then(()=>i(this,null,function*(){h.value=!0,yield m(e).then(()=>i(this,null,function*(){yield u().then(),yield c.push("/").then()})).finally(()=>{e.captchaKey="",e.captchaValue="",h.value=!1,p&&d.value.refresh()})}))}),N=E=>i(this,null,function*(){e.captchaKey=E});return S(()=>i(this,null,function*(){I("Page <<Login>> mounted.")})),(E,f)=>{const V=oe,v=se,D=ne,F=le,M=ce;return g(),x(a(be),null,{default:o(()=>[n("div",xe,[t(M,{shadow:"never"},{header:o(()=>[n("div",$e,$(E.$t("common.user_pages_login_title")),1)]),default:o(()=>[t(F,{ref_key:"form",ref:r,model:a(e),rules:a(_),class:"!m-8 !mb-12"},{default:o(()=>[t(v,{prop:"username"},{default:o(()=>[t(V,{size:"large",modelValue:a(e).username,"onUpdate:modelValue":f[0]||(f[0]=y=>a(e).username=y),placeholder:a(s)("common.user_field_username_placeholder_login")},null,8,["modelValue","placeholder"])]),_:1}),t(v,{prop:"password"},{default:o(()=>[t(V,{type:"password",size:"large",modelValue:a(e).password,"onUpdate:modelValue":f[1]||(f[1]=y=>a(e).password=y),placeholder:a(s)("common.user_field_password_placeholder")},null,8,["modelValue","placeholder"])]),_:1}),a(p)?(g(),x(v,{key:0,prop:"captchaValue"},{default:o(()=>[n("div",ke,[n("div",Se,[t(V,{size:"large",value:a(e).captchaValue,"onUpdate:value":f[2]||(f[2]=y=>a(e).captchaValue=y),placeholder:a(s)("common.field_captcha_placeholder")},null,8,["value","placeholder"])]),n("div",Ie,[t(a(_e),{class:"h-full",ref_key:"captcha",ref:d,onChange:N},null,512)])])]),_:1})):ae("",!0),t(v,{class:"!mt-8"},{default:o(()=>[t(D,{size:"large","html-type":"submit",type:"primary",disabled:h.value,onClick:C,class:"w-full"},{default:o(()=>[te($(a(s)("common.button_login")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])]),_:1})}}});export{Ke as default};
