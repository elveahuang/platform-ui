var me=Object.defineProperty;var W=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var j=(r,t,d)=>t in r?me(r,t,{enumerable:!0,configurable:!0,writable:!0,value:d}):r[t]=d,x=(r,t)=>{for(var d in t||(t={}))ue.call(t,d)&&j(r,d,t[d]);if(W)for(var d of W(t))pe.call(t,d)&&j(r,d,t[d]);return r};var w=(r,t,d)=>new Promise((m,V)=>{var D=p=>{try{_(d.next(p))}catch(E){V(E)}},y=p=>{try{_(d.throw(p))}catch(E){V(E)}},_=p=>p.done?m(p.value):Promise.resolve(p.value).then(D,y);_((d=d.apply(r,t)).next())});import{d as oe,c as F,aq as ee,ar as fe,as as ce,r as k,ab as _e,e as f,f as $,at as B,au as ye,av as te,N as ae,aw as ve,ax as be,ay as we,az as he,Q as N,l as q,aA as ge,U as ke,V as z,o as Ve,g as K,i as l,w as n,m as h,t as g,j as s,n as De,F as M,h as Ee,X as Te,k as P,aB as $e,al as Ce,am as Ke,D as Ae,ao as Fe,an as Me,G as Pe,H as Ne,ai as Ue,Y as Re,Z as Le,aC as Se,aD as He,a1 as Be}from"./index-D3_r0cba.js";/* empty css                     *//* empty css                       *//* empty css                 */import"./el-progress-3qeBbLjJ.js";/* empty css                *//* empty css                 */import{A as ze,_ as Ie}from"./el-popover-Chqh5Hvn.js";/* empty css                  */import{u as qe}from"./data-table-CYvhiD6o.js";import{_ as I}from"./Icon.vue_vue_type_script_setup_true_lang-DSUqlfA8.js";import{A as Ge}from"./AEditor-BctFRMEJ.js";import"./index.min-C9ZtcG9k.js";const Oe=oe({__name:"DateRangePicker",props:{with:{type:Number,required:!1,default:180},type:{type:String,default:"datetime"},from:{type:String,default:""},to:{type:String,default:""}},emits:["update:from","update:to"],setup(r,{emit:t}){const d=t,m=r,V=(u,a)=>m.type==="datetime"?[B(u),B(a)]:m.type==="date"?[ye(u),B(a)]:m.type==="time"?[te(u),te(a)]:[null,null],D=u=>{if(!ae(u)){if(m.type==="datetime")return be(u,"");if(m.type==="date")return we(u,"");if(m.type==="time")return he(u,"")}return""},y=F(()=>m.type==="datetime"?"datetimerange":m.type==="date"?"daterange":m.type==="month"?"monthrange":"datetimerange"),_=F(()=>m.type==="datetime"?ee:m.type==="date"?fe:m.type==="time"?ce:ee),p=F(()=>m.from),E=F(()=>m.to),T=k(V(m.from,m.to)),v=u=>{ae(u)?(d("update:from",""),d("update:to","")):(d("update:from",D(u[0])),d("update:to",D(u[1])))};return _e([p,E],([u,a])=>{T.value=V(u,a)}),(u,a)=>{const U=ve;return f(),$(U,{modelValue:T.value,"onUpdate:modelValue":a[0]||(a[0]=R=>T.value=R),type:y.value,format:_.value,onChange:v},null,8,["modelValue","type","format"])}}}),Qe=r=>N("/api/v1/admin/announcement/list",r),Xe=r=>N("/api/v1/admin/announcement/details",r),Ye=r=>N("/api/v1/admin/announcement/save",r),Ze=r=>N("/api/v1/admin/announcement/delete",r),Je={id:0,title:"",content:"",description:"",status:0,startDatetime:"",endDatetime:""},We=(r,t,d)=>{q(`editorNotEmpty - value : ${t}`),ge(t)?d(new Error(r.message)):d()},je=["innerHTML"],xe={key:0},et={key:1},tt=["innerHTML"],at={class:"app-modal-body"},ot={class:"app-modal-footer"},bt=oe({__name:"index",setup(r){const{t}=ke(),{initialize:d,handleResult:m,handleParams:V}=qe(),D=[{title:t("common.field_title"),dataKey:"id",key:"id",width:30},{title:t("common.field_title"),dataKey:"title",key:"title",width:360},{title:t("common.field_publish_status"),dataKey:"status",key:"status",width:150},{title:t("common.field_publish_period"),dataKey:"publishPeriod",key:"publishPeriod",width:500},{title:t("common.field_last_modified_at"),dataKey:"lastModifiedAt",key:"lastModifiedAt",width:200},{title:t("common.label_action"),dataKey:"operation",key:"operation",width:160}],y=z(d(D)),_=k(),p=k(!1),E=()=>w(this,null,function*(){yield Qe(V(y)).then(i=>{m(y,i)})}),T=k(""),v=k(!1),u=k(),a=z(Je),U=z({title:[{required:!0,message:t("common.field_title_validation")}],content:[{required:!0,message:t("common.field_description_validation"),validator:We}]}),R=()=>{a.id=0,a.title="",a.content="",a.description="",a.status=0,a.startDatetime="",a.endDatetime=""},G=i=>w(this,null,function*(){var o;(o=u.value)==null||o.clearValidate(),i&&i>0?(T.value=t("common.announcement_pages_edit_title"),yield Xe({id:i}).then(c=>{v.value=!0,Object.assign(a,x({},c.data))})):(v.value=!0,T.value=t("common.announcement_pages_add_title"),R())}),le=()=>{v.value=!1},O=()=>w(this,null,function*(){console.log(a),yield u.value.validate(i=>w(this,null,function*(){i?Ye(a).then(o=>{o.code=="200"&&(v.value=!1,_.value.refresh())}):q("Form Validation Failed.")}))}),L=(i=0)=>w(this,null,function*(){const o=i>0?[i]:_.value.selectedRowKeys();if(Ce(o)){Ke({message:t("common.label_please_select_one_record")}).then();return}Ze({ids:o}).then(c=>{c.code=="200"&&(v.value=!1,_.value.refresh())})}),S=k(!1),Q=k(""),ne=i=>w(this,null,function*(){Q.value=i.content,S.value=!0});return Ve(()=>w(this,null,function*(){q("Page <<AnnouncementAdminListPage>> mounted.")})),(i,o)=>{const c=Ae,C=Fe,ie=Me,X=Pe,se=Ne,Y=Ue,Z=Re,A=Le,J=Se,de=He,re=Be;return f(),K(M,null,[l(s(ze),null,{title:n(()=>[h(g(i.$t("common.announcement_management")),1)]),_:1}),l(se,{shadow:"never"},{default:n(()=>[l(s(Ie),{ref_key:"dataTableRef",ref:_,model:s(y),"onUpdate:model":o[3]||(o[3]=e=>De(y)?y.value=e:null),"row-selection-enabled":p.value,"toolbar-enabled":!0,onGetDataList:E},{toolbar:n(()=>[l(c,{type:"primary",onClick:o[0]||(o[0]=e=>G(0))},{default:n(()=>[h(g(i.$t("common.button_add")),1)]),_:1}),l(c,{onClick:o[1]||(o[1]=e=>p.value=!p.value)},{default:n(()=>[h(g(p.value?i.$t("common.label_batch_operation_cancel"):i.$t("common.label_batch_operation")),1)]),_:1}),l(c,{danger:"",onClick:o[2]||(o[2]=e=>L(0))},{default:n(()=>[h(g(i.$t("common.button_delete")),1)]),_:1})]),body:n(()=>[(f(),K(M,null,Ee(D,e=>(f(),K(M,null,[e.dataKey==="id"?(f(),K(M,{key:0},[p.value?(f(),$(C,{key:e.dataKey,type:"selection",width:e.width,fixed:"left"},null,8,["width"])):Te("",!0)],64)):e.dataKey==="title"?(f(),$(C,{key:e.dataKey,label:e.title,prop:e.dataKey,width:e.width,fixed:"left"},null,8,["label","prop","width"])):e.dataKey==="publishPeriod"?(f(),$(C,{key:e.dataKey,label:e.title,width:e.width},{default:n(b=>[P("div",{innerHTML:s($e)(b.row.startDatetime,b.row.endDatetime)},null,8,je)]),_:2},1032,["label","width"])):e.dataKey==="status"?(f(),$(C,{key:e.dataKey,label:e.title,width:e.width},{default:n(b=>[b.row.status?(f(),K("div",xe,g(i.$t("common.field_publish_status_on")),1)):(f(),K("div",et,g(i.$t("common.field_publish_status_off")),1))]),_:2},1032,["label","width"])):e.dataKey==="operation"?(f(),$(C,{key:e.dataKey,label:e.title,fixed:"right"},{default:n(b=>[l(X,null,{default:n(()=>[l(c,{type:"primary",size:"small",onClick:H=>ne(b.row)},{icon:n(()=>[l(s(I),{icon:"mdi:eye-outline"})]),_:2},1032,["onClick"]),l(c,{type:"primary",size:"small",onClick:H=>G(b.row.id)},{icon:n(()=>[l(s(I),{icon:"ant-design:edit-outlined"})]),_:2},1032,["onClick"]),l(ie,{title:i.$t("common.label_confirm_delete_record"),onConfirm:H=>L(b.row.id)},{reference:n(()=>[l(c,{danger:"",type:"primary",size:"small",onConfirm:H=>L(b.row.id)},{icon:n(()=>[l(s(I),{icon:"ant-design:close-outlined"})]),_:2},1032,["onConfirm"])]),_:2},1032,["title","onConfirm"])]),_:2},1024)]),_:2},1032,["label"])):(f(),$(C,{key:e.dataKey,label:e.title,prop:e.dataKey,width:e.width},null,8,["label","prop","width"]))],64))),64))]),_:1},8,["model","row-selection-enabled"])]),_:1}),l(Y,{modelValue:S.value,"onUpdate:modelValue":o[4]||(o[4]=e=>S.value=e),class:"app-modal",title:i.$t("common.label_preview"),"destroy-on-close":""},{default:n(()=>[P("div",{innerHTML:Q.value},null,8,tt)]),_:1},8,["modelValue","title"]),l(Y,{modelValue:v.value,"onUpdate:modelValue":o[11]||(o[11]=e=>v.value=e),class:"app-modal",title:T.value,"destroy-on-close":""},{footer:n(()=>[P("div",ot,[l(X,null,{default:n(()=>[l(c,{type:"primary",onClick:O},{default:n(()=>[h(" Confirm ")]),_:1}),l(c,{onClick:le},{default:n(()=>[h(" Cancel ")]),_:1})]),_:1})])]),default:n(()=>[P("div",at,[l(re,{ref_key:"entityForm",ref:u,"label-width":"auto",model:s(a),rules:s(U),onFinish:O},{default:n(()=>[l(A,{prop:"title",label:i.$t("common.field_title")},{default:n(()=>[l(Z,{modelValue:s(a).title,"onUpdate:modelValue":o[5]||(o[5]=e=>s(a).title=e),placeholder:s(t)("common.field_title_placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(A,{prop:"content",label:i.$t("common.field_content")},{default:n(()=>[l(s(Ge),{value:s(a).content,"onUpdate:value":o[6]||(o[6]=e=>s(a).content=e)},null,8,["value"])]),_:1},8,["label"]),l(A,{prop:"status",label:i.$t("common.field_publish_status")},{default:n(()=>[l(de,{modelValue:s(a).status,"onUpdate:modelValue":o[7]||(o[7]=e=>s(a).status=e)},{default:n(()=>[l(J,{value:1},{default:n(()=>[h(g(s(t)("common.field_publish_status_finish")),1)]),_:1}),l(J,{value:0},{default:n(()=>[h(g(s(t)("common.field_publish_status_unfinished")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(A,{label:i.$t("common.field_publish_period")},{default:n(()=>[l(s(Oe),{from:s(a).startDatetime,"onUpdate:from":o[8]||(o[8]=e=>s(a).startDatetime=e),to:s(a).endDatetime,"onUpdate:to":o[9]||(o[9]=e=>s(a).endDatetime=e),type:"datetime"},null,8,["from","to"])]),_:1},8,["label"]),l(A,{prop:"description",label:i.$t("common.field_description")},{default:n(()=>[l(Z,{modelValue:s(a).description,"onUpdate:modelValue":o[10]||(o[10]=e=>s(a).description=e),placeholder:s(t)("common.field_description_placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])])]),_:1},8,["modelValue","title"])],64)}}});export{bt as default};
