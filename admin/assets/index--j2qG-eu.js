var H=Object.defineProperty;var S=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var z=(l,t,i)=>t in l?H(l,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[t]=i,L=(l,t)=>{for(var i in t||(t={}))K.call(t,i)&&z(l,i,t[i]);if(S)for(var i of S(t))J.call(t,i)&&z(l,i,t[i]);return l};var f=(l,t,i)=>new Promise((C,E)=>{var w=m=>{try{r(i.next(m))}catch(u){E(u)}},v=m=>{try{r(i.throw(m))}catch(u){E(u)}},r=m=>m.done?C(m.value):Promise.resolve(m.value).then(w,v);r((i=i.apply(l,t)).next())});/* empty css             */import{E as Q}from"./overlay-_fzlEsqS.js";/* empty css                  *//* empty css               */import{E as W}from"./card-YwpeLzBA.js";import{u as X,_ as Y,E as Z}from"./checkbox-2jueuQY4.js";/* empty css                   */import{E as x}from"./space-qJ8hLRLL.js";import{E as ee}from"./page-header-77fqrzII.js";import{v as h,d as te,x as ae,y as A,r as k,o as oe,l as le,e as P,g as ne,j as a,w as n,k as ie,z as y,t as b,i as d,f as se,A as me,B as re,F as de,C as ue,D as ce}from"./index-1eERDVS8.js";import{E as pe}from"./index-0Pr-I1Zm.js";import{E as _e}from"./index-RbQBUUTl.js";import{E as fe,a as ye}from"./index-HLr-aswB.js";import"./refs-wtxWLuy_.js";import"./scroll-0rIFZBf6.js";import"./index-M6hPAqXZ.js";import"./castArray-NLLRJM7M.js";const be=l=>h("/api/v1/admin/user/list",l),ve=l=>h("/api/v1/admin/user/details",l),ke=l=>h("/api/v1/admin/user/save",l),Ee=l=>h("/api/v1/admin/user/delete",l),ge={class:"pb-4"},Ue=te({__name:"index",setup(l){const{t}=ae(),{initialize:i,handleResult:C,handleParams:E}=X(),w=[{title:t("common.field_title"),dataIndex:"username",key:"username",width:300,sorter:!0},{title:t("common.field_content"),dataIndex:"displayName",key:"displayName"},{title:t("common.field_last_modified_at"),dataIndex:"lastModifiedAt",key:"lastModifiedAt",sorter:!0},{title:t("common.label_action"),dataIndex:"operation",key:"operation",width:200}],v=A(i(w)),r=k(),m=()=>f(this,null,function*(){yield be(E(v)).then(e=>{C(v,e)})}),u=k(""),c=k(!1),D=k(),g=k(!1),p=A({}),U=A({title:[{required:!0,message:t("common.field_title_validation")}],content:[{required:!0,message:t("common.field_description_validation")}]}),M=e=>f(this,null,function*(){c.value=!0,e&&e>0?(u.value=t("common.announcement_pages_edit_title"),yield ve({id:e}).then(o=>{Object.assign(p,L({},o.data))})):u.value=t("common.announcement_pages_add_title")}),j=()=>{c.value=!1},N=()=>f(this,null,function*(){yield D.value.validate().then(()=>f(this,null,function*(){ke(p).then(e=>{e.code=="200"&&(c.value=!1,r.value.refresh())})}))}),T=(e=0)=>f(this,null,function*(){const o=e>0?[e]:r.value.selectedRowKeys();if(ue(o)){ce({message:"请选择"}).then();return}Ee({ids:o}).then(F=>{F.code=="200"&&(c.value=!1,r.value.refresh())})});return oe(()=>f(this,null,function*(){le("Page <<AnnouncementAdminListPage>> mounted.")})),(e,o)=>{const F=ee,_=pe,I=x,$=Z,V=W,B=_e,R=fe,q=ye,O=Q;return P(),ne(de,null,[a(F,{title:e.$t("common.announcement_management")},null,8,["title"]),a(V,null,{default:n(()=>[ie("div",ge,[a(I,null,{default:n(()=>[a(_,{type:"primary",onClick:o[0]||(o[0]=s=>M(0))},{default:n(()=>[y(b(e.$t("common.button_add")),1)]),_:1}),a(_,{onClick:o[1]||(o[1]=s=>g.value=!d(g))},{default:n(()=>[y(b(d(g)?e.$t("common.label_batch_operation_cancel"):e.$t("common.label_batch_operation")),1)]),_:1}),a(_,{onClick:o[2]||(o[2]=s=>T(0))},{default:n(()=>[y(b(e.$t("common.button_delete")),1)]),_:1})]),_:1})]),a(d(Y),{ref_key:"dataTableRef",ref:r,model:v,"onUpdate:model":o[3]||(o[3]=s=>v=s),onGetDataList:m},{default:n(()=>[d(g)?(P(),se($,{key:0,type:"selection",width:"30",class:"text-center"})):me("",!0),a($,{label:e.$t("common.field_title"),prop:"username"},null,8,["label"]),a($,{label:e.$t("common.field_content"),prop:"displayName"},null,8,["label"]),a($,{fixed:"right",label:e.$t("common.label_action"),width:"200"},{default:n(s=>[a(_,{link:"",type:"primary",size:"small",onClick:G=>M(s.row.id)},{default:n(()=>[y(b(e.$t("common.button_edit")),1)]),_:2},1032,["onClick"]),a(_,{link:"",type:"primary",size:"small",onClick:G=>T(s.row.id)},{default:n(()=>[y(b(e.$t("common.button_delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1}),a(O,{class:"app-modal",modelValue:d(c),"onUpdate:modelValue":o[6]||(o[6]=s=>re(c)?c.value=s:null),title:d(u)},{footer:n(()=>[a(I,null,{default:n(()=>[a(_,{type:"primary",onClick:N},{default:n(()=>[y(b(e.$t("common.button_submit")),1)]),_:1}),a(_,{onClick:j},{default:n(()=>[y(b(e.$t("common.button_cancel")),1)]),_:1})]),_:1})]),default:n(()=>[a(V,null,{default:n(()=>[a(q,{ref_key:"entityForm",ref:D,model:p,rules:U,onFinish:N},{default:n(()=>[a(R,{name:"title",label:e.$t("common.field_title")},{default:n(()=>[a(B,{value:p.username,"onUpdate:value":o[4]||(o[4]=s=>p.username=s),placeholder:d(t)("common.field_title_placeholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(R,{name:"content",label:e.$t("common.field_content")},{default:n(()=>[a(B,{value:p.displayName,"onUpdate:value":o[5]||(o[5]=s=>p.displayName=s),placeholder:d(t)("common.field_content_placeholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue","title"])],64)}}});export{Ue as default};
