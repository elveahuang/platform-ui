var u=(n,l,c)=>new Promise((m,_)=>{var d=a=>{try{p(c.next(a))}catch(t){_(t)}},r=a=>{try{p(c.throw(a))}catch(t){_(t)}},p=a=>a.done?m(a.value):Promise.resolve(a.value).then(d,r);p((c=c.apply(n,l)).next())});import{G as D,d as k,r as w,o as E,l as V,b as g,f as C,h as s,ai as F,c as I,D as S,j as o,t as b,i as e,w as i,aj as M,F as H,g as K,v as j,B as A,C as G,H as J,a as P,ak as Q,q as R,I as L,e as B,Q as O,k as W,J as X,K as Y,U as Z,L as ee,M as ae,al as te}from"./index-CLSrHFfR.js";/* empty css                *//* empty css                     *//* empty css                  *//* empty css                 */import"./el-progress-DrA7EKYw.js";import{_ as oe,T as se,a as le}from"./el-sub-menu-CmYp08WT.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             *//* empty css                                                             */import"./AppIcon.vue_vue_type_script_setup_true_lang-ClHVUtK5.js";const ce=n=>D("/api/v1/captcha/code",n),re={class:"flex items-center"},ie=k({__name:"CodeCaptcha",props:{width:{type:Number,default:120},height:{type:Number,default:32}},emits:["change"],setup(n,{expose:l,emit:c}){const m=c,_=n,d=w(""),r=()=>u(this,null,function*(){yield ce({}).then(a=>{d.value=a.data.image,m("change",a.data.key)})});return l({refresh:()=>u(this,null,function*(){r().then()})}),E(()=>u(this,null,function*(){V("Component <<Captcha>> mounted."),r().then()})),(a,t)=>{const x=F;return g(),C("div",re,[s(x,{preview:!1,alt:a.$t("common.field_captcha"),width:_.width,height:_.height,src:d.value,onClick:r},null,8,["alt","width","height","src"])])}}}),de=n=>(A("data-v-658e3d19"),n=n(),G(),n),pe={class:"app-layout"},ue={class:"app-layout-header"},_e={class:"app-layout-header-container"},me={class:"app-layout-logo"},he={class:"logo"},fe=de(()=>o("div",{class:"app-layout-nav"},null,-1)),ge={class:"app-layout-tools"},ve={class:"app-layout-content"},ye={class:"app-layout-content-container"},we={class:"app-layout-footer"},Ce={class:"app-layout-footer-container"},Ve=["innerHTML"],xe=k({__name:"entry",setup(n){const l=I(()=>S.app.getTitle()),c=I(()=>S.app.getCopyright());return E(()=>{V("Component <<EntryLayout>> is mounted.")}),(m,_)=>{const d=j;return g(),C("div",pe,[o("div",ue,[o("div",_e,[o("div",me,[o("div",he,[o("span",null,b(e(l)),1)])]),fe,o("div",ge,[s(d,null,{default:i(()=>[s(e(oe)),s(e(se)),s(e(le))]),_:1})])])]),o("div",ve,[o("div",ye,[M(m.$slots,"default",{},void 0,!0)])]),o("div",we,[o("div",Ce,[(g(!0),C(H,null,K(e(c),(r,p)=>(g(),C("div",{class:"app-text",key:p,innerHTML:r},null,8,Ve))),128))])])])}}}),$e=ne(xe,[["__scopeId","data-v-658e3d19"]]),be={class:"mt-16 sm:w-full md:w-9/12 lg:w-6/12 xl:w-4/12"},ke={class:"text-center"},Ee={class:"flex w-full"},Ie={class:"flex-auto"},Se={class:"mx-4 flex-none"},je=k({__name:"login",setup(n){const{t:l}=J(),c=P(),{login:m,getUserInfo:_}=Q(),{isLoginCaptchaEnabled:d}=R(),r=w(),p=w(),a=w(!1),t=L(te),x=L({username:[{required:!0,message:l("common.user_field_username_validation_login")}],password:[{required:!0,message:l("common.user_field_password_validation")}],captchaValue:[{required:!0,message:l("common.field_captcha_validation")}]}),N=()=>u(this,null,function*(){yield r.value.validate().then(h=>u(this,null,function*(){console.log(h),a.value=!0,yield m(t).then(()=>u(this,null,function*(){yield _().then(),yield c.push("/").then()})).finally(()=>{t.captchaKey="",t.captchaValue="",a.value=!1,d&&p.value.refresh()})})).catch(h=>{V(h)}).finally(()=>{})}),T=h=>u(this,null,function*(){t.captchaKey=h});return E(()=>u(this,null,function*(){V("Page <<Login>> mounted.")})),(h,f)=>{const $=X,y=Y,U=Z,q=ee,z=ae;return g(),B(e($e),null,{default:i(()=>[o("div",be,[s(z,null,{header:i(()=>[o("div",ke,b(h.$t("common.user_pages_login_title")),1)]),default:i(()=>[s(q,{ref_key:"form",ref:r,model:e(t),rules:e(x),class:"!m-8 !mb-12"},{default:i(()=>[s(y,{prop:"username"},{default:i(()=>[s($,{size:"large",modelValue:e(t).username,"onUpdate:modelValue":f[0]||(f[0]=v=>e(t).username=v),placeholder:e(l)("common.user_field_username_placeholder_login")},null,8,["modelValue","placeholder"])]),_:1}),s(y,{prop:"password"},{default:i(()=>[s($,{size:"large",modelValue:e(t).password,"onUpdate:modelValue":f[1]||(f[1]=v=>e(t).password=v),placeholder:e(l)("common.user_field_password_placeholder")},null,8,["modelValue","placeholder"])]),_:1}),e(d)?(g(),B(y,{key:0,prop:"captchaValue"},{default:i(()=>[o("div",Ee,[o("div",Ie,[s($,{size:"large",value:e(t).captchaValue,"onUpdate:value":f[2]||(f[2]=v=>e(t).captchaValue=v),placeholder:e(l)("common.field_captcha_placeholder")},null,8,["value","placeholder"])]),o("div",Se,[s(e(ie),{class:"h-full",ref_key:"captcha",ref:p,onChange:T},null,512)])])]),_:1})):O("",!0),s(y,{class:"!mt-8"},{default:i(()=>[s(U,{size:"large","html-type":"submit",type:"primary",disabled:a.value,onClick:N,class:"w-full"},{default:i(()=>[W(b(e(l)("common.button_login")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])]),_:1})}}});export{je as default};
