var ee=Object.defineProperty;var N=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var G=(u,i,s)=>i in u?ee(u,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[i]=s,R=(u,i)=>{for(var s in i||(i={}))te.call(i,s)&&G(u,s,i[s]);if(N)for(var s of N(i))oe.call(i,s)&&G(u,s,i[s]);return u};var f=(u,i,s)=>new Promise((k,w)=>{var H=m=>{try{p(s.next(m))}catch(_){w(_)}},C=m=>{try{p(s.throw(m))}catch(_){w(_)}},p=m=>m.done?k(m.value):Promise.resolve(m.value).then(H,C);p((s=s.apply(u,i)).next())});import{d as le,U as ae,V as U,r as v,o as ne,l as ie,e as P,g as T,k as e,i as t,w as n,j as F,n as y,t as c,m as V,aj as se,F as de,ak as me,al as re,D as ue,am as pe,an as ce,G as _e,H as fe,ai as be,Y as ve,Z as ye,ao as he,ap as we,a1 as $e}from"./index-oE9LyhP1.js";/* empty css                     */import{e as ge,A as Ve,a as ke,b as Ce,c as De,d as Ee,f as Me,g as Ae}from"./validation-BzpbV662.js";/* empty css                 */import"./el-progress-B57OA--b.js";/* empty css                *//* empty css                 *//* empty css                   */import{u as Re}from"./data-table-DX8W42FZ.js";import{_ as L}from"./Icon.vue_vue_type_script_setup_true_lang-Di1TC_oO.js";import{_ as Ue}from"./DateRangePicker.vue_vue_type_script_setup_true_lang-NK1Y2EL8.js";import{A as Pe}from"./AEditor-lSpvMYvp.js";import"./index.min-onUI6r0s.js";const Te=["innerHTML"],Fe={key:0},Le={key:1},He=["innerHTML"],Ke={class:"app-modal-body"},Se={class:"app-modal-footer"},xe=le({__name:"index",setup(u){const{t:i}=ae(),{initialize:s,handleResult:k,handleParams:w}=Re(),C={columns:[{title:i("common.field_title"),dataKey:"title",key:"title",width:360},{title:i("common.field_publish_status"),dataKey:"status",key:"status",width:150},{title:i("common.field_publish_period"),dataKey:"publishPeriod",key:"publishPeriod",width:500},{title:i("common.field_last_modified_at"),dataKey:"lastModifiedAt",key:"lastModifiedAt",width:200},{title:i("common.label_action"),dataKey:"operation",key:"operation",width:160}]},p=U(s(C)),m=v(),_=v(!1),q=()=>f(this,null,function*(){yield Ce(w(p)).then(o=>{k(p,o)})}),D=v(""),b=v(!1),E=v(),d=U({}),Y=U({title:[{required:!0,message:i("common.field_title_validation")}],content:[{required:!0,message:i("common.field_description_validation"),validator:ge}]}),K=o=>f(this,null,function*(){var l;(l=E.value)==null||l.clearValidate(),o&&o>0?(D.value=i("common.announcement_pages_edit_title"),yield De({id:o}).then(r=>{Object.assign(d,R({},r.data))})):(D.value=i("common.announcement_pages_add_title"),Object.assign(d,R({},Ee))),b.value=!0}),Z=()=>{b.value=!1},S=()=>f(this,null,function*(){yield E.value.validate(o=>f(this,null,function*(){o&&Me(d).then(l=>{l.code=="200"&&(b.value=!1,m.value.refresh())})}))}),M=(o=0)=>f(this,null,function*(){const l=o>0?[o]:m.value.selectedRowKeys();if(me(l)){re({message:i("common.label_please_select_one_record")}).then();return}Ae({ids:l}).then(r=>{r.code=="200"&&(b.value=!1,m.value.refresh())})}),$=v(!1),O=v(""),J=o=>f(this,null,function*(){O.value=o.content,$.value=!0});return ne(()=>f(this,null,function*(){ie("Page <<AnnouncementIndexPage>> mounted.")})),(o,l)=>{const r=ue,g=pe,Q=ce,j=_e,W=fe,z=be,B=ve,h=ye,I=he,X=we,x=$e;return P(),T(de,null,[e(t(Ve),{title:o.$t("common.announcement_management")},null,8,["title"]),e(W,{shadow:"never"},{default:n(()=>[e(t(ke),{ref_key:"tableRef",ref:m,modelValue:t(p),"onUpdate:modelValue":l[3]||(l[3]=a=>F(p)?p.value=a:null),"row-selection-enabled":t(_),"toolbar-enabled":!0,onGetDataList:q},{toolbar:n(()=>[e(r,{type:"primary",onClick:l[0]||(l[0]=a=>K(0))},{default:n(()=>[y(c(o.$t("common.button_add")),1)]),_:1}),e(r,{onClick:l[1]||(l[1]=a=>_.value=!t(_))},{default:n(()=>[y(c(t(_)?o.$t("common.label_batch_operation_cancel"):o.$t("common.label_batch_operation")),1)]),_:1}),e(r,{danger:"",onClick:l[2]||(l[2]=a=>M(0))},{default:n(()=>[y(c(o.$t("common.button_delete")),1)]),_:1})]),body:n(()=>[e(g,{prop:"title",label:o.$t("common.field_title"),fixed:"left"},null,8,["label"]),e(g,{label:o.$t("common.field_publish_period"),width:300},{default:n(a=>[V("div",{innerHTML:t(se)(a.row.startDatetime,a.row.endDatetime)},null,8,Te)]),_:1},8,["label"]),e(g,{label:o.$t("common.field_publish_status"),width:800},{default:n(a=>[a.row.status?(P(),T("div",Fe,c(o.$t("common.field_publish_status_on")),1)):(P(),T("div",Le,c(o.$t("common.field_publish_status_off")),1))]),_:1},8,["label"]),e(g,{label:t(i)("common.label_action"),width:200,fixed:"right"},{default:n(a=>[e(j,null,{default:n(()=>[e(r,{type:"primary",size:"small",onClick:A=>J(a.row)},{icon:n(()=>[e(t(L),{icon:"mdi:eye-outline"})]),_:2},1032,["onClick"]),e(r,{type:"primary",size:"small",onClick:A=>K(a.row.id)},{icon:n(()=>[e(t(L),{icon:"ant-design:edit-outlined"})]),_:2},1032,["onClick"]),e(Q,{title:o.$t("common.label_confirm_delete_record"),onConfirm:A=>M(a.row.id)},{reference:n(()=>[e(r,{danger:"",type:"danger",size:"small",onConfirm:A=>M(a.row.id)},{icon:n(()=>[e(t(L),{icon:"ant-design:close-outlined"})]),_:2},1032,["onConfirm"])]),_:2},1032,["title","onConfirm"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["modelValue","row-selection-enabled"])]),_:1}),e(z,{modelValue:t($),"onUpdate:modelValue":l[4]||(l[4]=a=>F($)?$.value=a:null),class:"app-modal",title:o.$t("common.label_preview"),"destroy-on-close":""},{default:n(()=>[V("div",{innerHTML:t(O)},null,8,He)]),_:1},8,["modelValue","title"]),e(z,{modelValue:t(b),"onUpdate:modelValue":l[11]||(l[11]=a=>F(b)?b.value=a:null),class:"app-modal",title:t(D),"destroy-on-close":""},{default:n(()=>[V("div",Ke,[e(x,{ref_key:"formRef",ref:E,"label-width":"auto",model:t(d),rules:t(Y),onFinish:S},{default:n(()=>[e(h,{prop:"title",label:o.$t("common.field_title")},{default:n(()=>[e(B,{modelValue:t(d).title,"onUpdate:modelValue":l[5]||(l[5]=a=>t(d).title=a),placeholder:t(i)("common.field_title_placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(h,{prop:"content",label:o.$t("common.field_content")},{default:n(()=>[e(t(Pe),{value:t(d).content,"onUpdate:value":l[6]||(l[6]=a=>t(d).content=a)},null,8,["value"])]),_:1},8,["label"]),e(h,{prop:"status",label:o.$t("common.field_publish_status")},{default:n(()=>[e(X,{modelValue:t(d).status,"onUpdate:modelValue":l[7]||(l[7]=a=>t(d).status=a)},{default:n(()=>[e(I,{value:1},{default:n(()=>[y(c(t(i)("common.field_publish_status_finish")),1)]),_:1}),e(I,{value:0},{default:n(()=>[y(c(t(i)("common.field_publish_status_unfinished")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(h,{label:o.$t("common.field_publish_period")},{default:n(()=>[e(t(Ue),{from:t(d).startDatetime,"onUpdate:from":l[8]||(l[8]=a=>t(d).startDatetime=a),to:t(d).endDatetime,"onUpdate:to":l[9]||(l[9]=a=>t(d).endDatetime=a),type:"datetime"},null,8,["from","to"])]),_:1},8,["label"]),e(h,{prop:"description",label:o.$t("common.field_description")},{default:n(()=>[e(B,{modelValue:t(d).description,"onUpdate:modelValue":l[10]||(l[10]=a=>t(d).description=a),placeholder:t(i)("common.field_description_placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])])]),footer:n(()=>[V("div",Se,[e(j,null,{default:n(()=>[e(r,{"native-type":"submit",type:"primary",onClick:S},{default:n(()=>[y(c(o.$t("common.button_submit")),1)]),_:1}),e(r,{"native-type":"reset",onClick:Z},{default:n(()=>[y(c(o.$t("common.button_cancel")),1)]),_:1})]),_:1})])]),_:1},8,["modelValue","title"])],64)}}});export{xe as default};
