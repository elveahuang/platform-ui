var p=(l,n,c)=>new Promise((m,_)=>{var d=o=>{try{i(c.next(o))}catch(t){_(t)}},r=o=>{try{i(c.throw(o))}catch(t){_(t)}},i=o=>o.done?m(o.value):Promise.resolve(o.value).then(d,r);i((c=c.apply(l,n)).next())});import{a6 as q,d as k,r as C,o as F,l as V,e as f,g as b,k as a,ac as H,c as S,s as $,f as x,w as s,m as u,t as N,i as e,ad as K,h as R,F as G,x as O,z as P,ae as Q,A as j,B as J,C as W,_ as X,D as Y,a as Z,af as ee,b as ae,G as B,ag as te,a9 as oe,n as se,N as ne,O as le,ah as ce,ai as re,K as pe,Q as de,L as ie}from"./index-B0H9zxQF.js";/* empty css                *//* empty css                     *//* empty css                  *//* empty css               *//* empty css                 */import"./el-progress-SikrDmRt.js";import{_ as ue,A as _e,a as me}from"./sider-menu.vue_vue_type_style_index_0_scoped_8de30ed9_lang-Da_mtyS6.js";/* empty css                                                             *//* empty css                 *//* empty css                                                             */import"./AppIcon.vue_vue_type_script_setup_true_lang-kRdtg8ax.js";const he=l=>q("/api/v1/captcha/code",l),fe={class:"flex items-center"},ge=k({__name:"CodeCaptcha",props:{width:{type:Number,default:120},height:{type:Number,default:32}},emits:["change"],setup(l,{expose:n,emit:c}){const m=c,_=l,d=C(""),r=()=>p(this,null,function*(){yield he({}).then(o=>{d.value=o.data.image,m("change",o.data.key)})});return n({refresh:()=>p(this,null,function*(){r().then()})}),F(()=>p(this,null,function*(){V("Component <<Captcha>> mounted."),r().then()})),(o,t)=>{const g=H;return f(),b("div",fe,[a(g,{preview:!1,alt:o.$t("common.field_captcha"),width:_.width,height:_.height,src:d.value,onClick:r},null,8,["alt","width","height","src"])])}}}),ye=l=>(J("data-v-eb34312a"),l=l(),W(),l),we={class:"app-layout-header-container"},ve={class:"app-layout-logo"},Ce={class:"logo"},Ve=ye(()=>u("div",{class:"app-layout-nav"},null,-1)),Ee={class:"app-layout-tools"},be={class:"app-layout-content-container"},xe={class:"app-layout-footer-container"},ke=["innerHTML"],Fe=k({__name:"entry",setup(l){const n=S(()=>$.app.getTitle()),c=S(()=>$.app.getCopyright());return F(()=>{V("Component <<EntryLayout>> is mounted.")}),(m,_)=>{const d=O,r=P,i=Q,o=j;return f(),x(o,{class:"app-layout app-layout-entry"},{default:s(()=>[a(d,{class:"app-layout-header"},{default:s(()=>[u("div",we,[u("div",ve,[u("div",Ce,[u("span",null,N(e(n)),1)])]),Ve,u("div",Ee,[a(e(ue)),a(e(_e)),a(e(me))])])]),_:1}),a(r,{class:"app-layout-content"},{default:s(()=>[u("div",be,[K(m.$slots,"default",{},void 0,!0)])]),_:3}),a(i,{class:"app-layout-footer"},{default:s(()=>[u("div",xe,[(f(!0),b(G,null,R(e(c),(t,g)=>(f(),b("div",{key:g,class:"app-text",innerHTML:t},null,8,ke))),128))])]),_:1})]),_:3})}}}),Ie=X(Fe,[["__scopeId","data-v-eb34312a"]]),Le={class:"mb-36 content-center sm:w-full md:w-9/12 lg:w-6/12 xl:w-4/12"},Re=k({__name:"login",setup(l){const{t:n}=Y(),c=Z(),{login:m,getUserInfo:_}=ee(),{isLoginCaptchaEnabled:d}=ae(),r=C(),i=C(),o=C(!1),t=B(te),g=B({username:[{required:!0,message:n("common.user_field_username_validation_login")}],password:[{required:!0,message:n("common.user_field_password_validation")}],captchaValue:[{required:!0,message:n("common.field_captcha_validation")}]}),A=y=>p(this,null,function*(){V(y)}),I=()=>p(this,null,function*(){yield r.value.validate().then(()=>p(this,null,function*(){yield m(t).then(()=>p(this,null,function*(){yield _().then(),yield c.push("/").then()})).finally(()=>{t.captchaKey="",t.captchaValue="",o.value=!1,d&&i.value.refresh()})}))}),z=y=>p(this,null,function*(){t.captchaKey=y});return F(()=>p(this,null,function*(){V("Page <<Login>> mounted.")})),(y,h)=>{const E=ne,v=le,L=ce,D=re,T=pe,U=de,M=ie;return f(),x(e(Ie),null,{default:s(()=>[u("div",Le,[a(M,{shadow:"never",header:y.$t("common.button_login")},{default:s(()=>[a(U,{ref_key:"form",ref:r,model:e(t),rules:e(g),onFinish:I,onFinishFailed:A},{default:s(()=>[a(v,{prop:"username"},{default:s(()=>[a(E,{size:"large",modelValue:e(t).username,"onUpdate:modelValue":h[0]||(h[0]=w=>e(t).username=w),placeholder:e(n)("common.user_field_username_placeholder_login")},null,8,["modelValue","placeholder"])]),_:1}),a(v,{prop:"password"},{default:s(()=>[a(E,{size:"large",modelValue:e(t).password,"onUpdate:modelValue":h[1]||(h[1]=w=>e(t).password=w),placeholder:e(n)("common.user_field_password_placeholder")},null,8,["modelValue","placeholder"])]),_:1}),e(d)?(f(),x(v,{key:0,name:"captchaValue"},{default:s(()=>[a(D,{wrap:!1},{default:s(()=>[a(L,{flex:"auto"},{default:s(()=>[a(E,{size:"large",modelValue:e(t).captchaValue,"onUpdate:modelValue":h[2]||(h[2]=w=>e(t).captchaValue=w),placeholder:e(n)("common.field_captcha_placeholder")},null,8,["modelValue","placeholder"])]),_:1}),a(L,{flex:"none",class:"mx-4"},{default:s(()=>[a(e(ge),{ref_key:"captcha",ref:i,onChange:z},null,512)]),_:1})]),_:1})]),_:1})):oe("",!0),a(v,null,{default:s(()=>[a(T,{size:"large","html-type":"submit",type:"primary",disabled:o.value,class:"w-full",onClick:I},{default:s(()=>[se(N(e(n)("common.button_login")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["header"])])]),_:1})}}});export{Re as default};
