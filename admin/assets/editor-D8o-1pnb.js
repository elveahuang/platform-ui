var I=Object.defineProperty;var O=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var b=(n,t,e)=>t in n?I(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,q=(n,t)=>{for(var e in t||(t={}))L.call(t,e)&&b(n,e,t[e]);if(O)for(var e of O(t))R.call(t,e)&&b(n,e,t[e]);return n};var r=(n,t,e)=>new Promise((o,s)=>{var c=a=>{try{i(e.next(a))}catch(u){s(u)}},d=a=>{try{i(e.throw(a))}catch(u){s(u)}},i=a=>a.done?o(a.value):Promise.resolve(a.value).then(c,d);i((e=e.apply(n,t)).next())});import{d as g,q as j,c as T,r as P,am as $,O as S,a0 as E,b9 as k,o as y,l as h,ar as x,b as p,f as _,j as v,aN as A,I as N,aQ as D,aq as U,at as V,i as l,as as w,aK as H,bh as z,ap as K,F as Q,g as G,e as J,bi as W,a4 as X,t as Y,h as f}from"./index-CLSrHFfR.js";import{g as Z,a as tt,_ as B}from"./AEditor.vue_vue_type_script_setup_true_lang-DZ6SUN7K.js";import{Q as et,E as nt}from"./index.min-hz8sJWr_.js";const ot={class:"editor"},st=g({__name:"QEditor",props:{options:{type:Object,default(){return{}}},value:{type:String,default:""}},emits:["update:value"],setup(n,{emit:t}){const e=n,{locale:o}=j(),s=T(()=>o),c=P(),d=T(()=>e.value),i=$(),a=m=>r(this,null,function*(){const C={};i.value=new et(c.value,Z(A(C,m)))}),u=()=>r(this,null,function*(){E(i.value)});return S(d,m=>{!E(i.value)&&!k(i.value.getSemanticHTML(),m)&&(i.value.getText(),i.value.focus(),i.value.setText(m))}),S(s,m=>{}),y(()=>r(this,null,function*(){h("Component <<QuillEditor>> mounted."),yield a(e.options).then()})),x(()=>r(this,null,function*(){h("Component <<QuillEditor>> onBeforeUnmount."),yield u().then()})),(m,C)=>(p(),_("div",ot,[v("div",{class:"quill-editor",ref_key:"editorRef",ref:c},null,512)]))}});function M(n){return z((t,e)=>({get(){return t(),n},set(o){n=o,requestAnimationFrame(()=>{requestAnimationFrame(()=>{e()})})}}))}class F extends nt{constructor(t={}){return super(t),this.vueRenderers=N(new Map),this.contentComponent=null,this.reactiveState=M(this.view.state),this.reactiveExtensionStorage=M(this.extensionStorage),this.on("transaction",()=>{this.reactiveState.value=this.view.state,this.reactiveExtensionStorage.value=this.extensionStorage}),D(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(t,e){super.registerPlugin(t,e),this.reactiveState.value=this.view.state}unregisterPlugin(t){super.unregisterPlugin(t),this.reactiveState.value=this.view.state}}const it=g({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(n){const t=P(),e=K();return U(()=>{const o=n.editor;o&&o.options.element&&t.value&&V(()=>{if(!t.value||!o.options.element.firstChild)return;const s=l(t.value);t.value.append(...o.options.element.childNodes),o.contentComponent=e.ctx._,o.setOptions({element:s}),o.createNodeViews()})}),x(()=>{const o=n.editor;if(!o||(o.isDestroyed||o.view.setProps({nodeViews:{}}),o.contentComponent=null,!o.options.element.firstChild))return;const s=document.createElement("div");s.append(...o.options.element.childNodes),o.setOptions({element:s})}),{rootEl:t}},render(){const n=[];return this.editor&&this.editor.vueRenderers.forEach(t=>{const e=w(H,{to:t.teleportElement,key:t.id},w(t.component,q({ref:t.id},t.props)));n.push(e)}),w("div",{ref:t=>{this.rootEl=t}},...n)}}),at={class:"editor-menu"},rt=g({__name:"TipTapMenu",props:{editor:{type:F,default:null}},setup(n){const t=n,e=N([{icon:"bold",title:"Bold",action:()=>t.editor.chain().focus().toggleBold().run(),isActive:()=>t.editor.isActive("bold")},{icon:"italic",title:"Italic",action:()=>t.editor.chain().focus().toggleItalic().run(),isActive:()=>t.editor.isActive("italic")}]),o=()=>r(this,null,function*(){});return y(()=>r(this,null,function*(){h("Component <<TipTapEditor>> mounted."),yield o().then()})),(s,c)=>(p(),_("div",at,[v("div",null,[(p(!0),_(Q,null,G(e,(d,i)=>(p(),J(l(ct),W(X({key:i},d)),null,16))),128))])]))}}),ct=g({__name:"TipTapMenuItem",props:{icon:{type:String,required:!0},title:{type:String,required:!0},action:{type:Function,required:!0,default:()=>{}},isActive:{type:Function,default:()=>{}}},setup(n){return(t,e)=>(p(),_("a",null,Y(n.title),1))}}),ut={class:"editor"},lt=g({__name:"TEditor",props:{options:{type:Object,default(){return{}}},value:{type:String,default:""}},emits:["update:value"],setup(n,{emit:t}){const e=t,o=n,s=$(),c=T(()=>o.value),d=a=>r(this,null,function*(){const u={content:c.value,onUpdate:()=>{e("update:value",s.value.getHTML())}};s.value=new F(tt(A(u,a)))}),i=()=>r(this,null,function*(){E(s.value)||s.value.destroy()});return S(c,a=>{!E(s.value)&&!k(s.value.getHTML(),a)&&s.value.setOptions({content:a})}),y(()=>r(this,null,function*(){h("Component <<TipTapEditor>> onMounted."),yield d(o.options).then()})),x(()=>r(this,null,function*(){h("Component <<TipTapEditor>> onBeforeUnmount."),yield i().then()})),(a,u)=>(p(),_("div",ut,[f(l(rt)),f(l(it),{editor:s.value},null,8,["editor"])]))}}),dt={class:"m-6"},pt={class:"m-6"},mt={class:"m-6"},vt={class:"m-6"},Et=g({__name:"editor",setup(n){return y(()=>r(this,null,function*(){h("Page <<EditorDemoPage>> mounted.")})),(t,e)=>(p(),_(Q,null,[v("div",dt,[f(l(B))]),v("div",pt,[f(l(B))]),v("div",mt,[f(l(st))]),v("div",vt,[f(l(lt))])],64))}});export{Et as default};
