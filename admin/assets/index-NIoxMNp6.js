var ue=Object.defineProperty;var Q=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable;var x=(e,a,s)=>a in e?ue(e,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[a]=s,ee=(e,a)=>{for(var s in a||(a={}))pe.call(a,s)&&x(e,s,a[s]);if(Q)for(var s of Q(a))fe.call(a,s)&&x(e,s,a[s]);return e};var w=(e,a,s)=>new Promise((m,V)=>{var D=p=>{try{_(s.next(p))}catch(E){V(E)}},y=p=>{try{_(s.throw(p))}catch(E){V(E)}},_=p=>p.done?m(p.value):Promise.resolve(p.value).then(D,y);_((s=s.apply(e,a)).next())});import{d as ne,c as M,V as te,W as ce,X as _e,r as k,Y as ye,b as f,e as $,Z as z,$ as be,a0 as ae,a1 as oe,a2 as he,a3 as we,a4 as ve,a5 as ge,a6 as P,l as q,G as ke,H as O,o as Ve,f as K,j as l,w as i,m as v,t as g,h as d,i as De,F as A,g as Ee,k as N,J as Te,K as $e,L as Ce,x as Ke,M as Fe,N as Me,O as Ae,P as Ne,a7 as Pe,a8 as Se,S as Ue,a9 as Le,aa as Re,U as He,T as ze}from"./index-C_ikakZ-.js";/* empty css                     *//* empty css                       *//* empty css                 */import"./el-progress-CXVSEooI.js";/* empty css                *//* empty css                 */import{A as Oe,_ as Be}from"./el-popover-DkZ4LjPU.js";/* empty css                  */import{u as Ie}from"./data-table-CYaIEU3l.js";import{_ as B}from"./AppIcon.vue_vue_type_script_setup_true_lang-DAT1zrnq.js";import{_ as qe}from"./AEditor.vue_vue_type_script_setup_true_lang-DIMvlOEx.js";import"./index.min-6ZF2XBhi.js";const Ge=ne({__name:"DateRangePicker",props:{with:{type:Number,required:!1,default:180},type:{type:String,default:"datetime"},from:{type:String,default:""},to:{type:String,default:""}},emits:["update:from","update:to"],setup(e,{emit:a}){const s=a,m=e,V=(u,o)=>m.type==="datetime"?[z(u),z(o)]:m.type==="date"?[be(u),z(o)]:m.type==="time"?[ae(u),ae(o)]:[null,null],D=u=>{if(!oe(u)){if(m.type==="datetime")return we(u,"");if(m.type==="date")return ve(u,"");if(m.type==="time")return ge(u,"")}return""},y=M(()=>m.type==="datetime"?"datetimerange":m.type==="date"?"daterange":m.type==="month"?"monthrange":"datetimerange"),_=M(()=>m.type==="datetime"?te:m.type==="date"?ce:m.type==="time"?_e:te),p=M(()=>m.from),E=M(()=>m.to),T=k(V(m.from,m.to)),b=u=>{oe(u)?(s("update:from",""),s("update:to","")):(s("update:from",D(u[0])),s("update:to",D(u[1])))};return ye([p,E],([u,o])=>{T.value=V(u,o)}),(u,o)=>{const S=he;return f(),$(S,{modelValue:T.value,"onUpdate:modelValue":o[0]||(o[0]=U=>T.value=U),type:y.value,format:_.value,onChange:b},null,8,["modelValue","type","format"])}}}),je=e=>P("/api/v1/admin/announcement/list",e),Je=e=>P("/api/v1/admin/announcement/details",e),We=e=>P("/api/v1/admin/announcement/save",e),Xe=e=>P("/api/v1/admin/announcement/delete",e),Ye={id:0,title:"",content:"",description:"",status:0,startDatetime:"",endDatetime:""},Ze=e=>!!e&&e.constructor===Symbol,Qe=e=>!!(e&&e.constructor&&e.call&&e.apply),I=e=>{try{return Number(e)===e}catch(a){return!1}},xe=e=>Object.prototype.toString.call(e)==="[object Date]",et=e=>{if(e===!0||e===!1||e==null)return!0;if(I(e))return e===0;if(xe(e))return isNaN(e.getTime());if(Qe(e)||Ze(e))return!1;const a=e.length;if(I(a))return a===0;const s=e.size;return I(s)?s===0:Object.keys(e).length===0},tt=(e,a,s)=>{q(`editorNotEmpty - value : ${a}`),et(a)?s(new Error(e.message)):s()},at=["innerHTML"],ot={key:0},nt={key:1},lt=["innerHTML"],it={class:"app-modal-body"},st={class:"app-modal-footer"},kt=ne({__name:"index",setup(e){const{t:a}=ke(),{initialize:s,handleResult:m,handleParams:V}=Ie(),D=[{title:a("common.field_title"),dataKey:"id",key:"id",width:30},{title:a("common.field_title"),dataKey:"title",key:"title",width:360},{title:a("common.field_publish_status"),dataKey:"status",key:"status",width:150},{title:a("common.field_publish_period"),dataKey:"publishPeriod",key:"publishPeriod",width:500},{title:a("common.field_last_modified_at"),dataKey:"lastModifiedAt",key:"lastModifiedAt",width:200},{title:a("common.label_action"),dataKey:"operation",key:"operation",width:160}],y=O(s(D)),_=k(),p=k(!1),E=()=>w(this,null,function*(){yield je(V(y)).then(r=>{m(y,r)})}),T=k(""),b=k(!1),u=k(),o=O(Ye),S=O({title:[{required:!0,message:a("common.field_title_validation")}],content:[{required:!0,message:a("common.field_description_validation"),validator:tt}]}),U=()=>{o.id=0,o.title="",o.content="",o.description="",o.status=0,o.startDatetime="",o.endDatetime=""},G=r=>w(this,null,function*(){var n;(n=u.value)==null||n.clearValidate(),r&&r>0?(T.value=a("common.announcement_pages_edit_title"),yield Je({id:r}).then(c=>{b.value=!0,Object.assign(o,ee({},c.data))})):(b.value=!0,T.value=a("common.announcement_pages_add_title"),U())}),le=()=>{b.value=!1},j=()=>w(this,null,function*(){console.log(o),yield u.value.validate(r=>w(this,null,function*(){r?We(o).then(n=>{n.code=="200"&&(b.value=!1,_.value.refresh())}):q("Form Validation Failed.")}))}),L=(r=0)=>w(this,null,function*(){const n=r>0?[r]:_.value.selectedRowKeys();if(Te(n)){$e({message:a("common.label_please_select_one_record")}).then();return}Xe({ids:n}).then(c=>{c.code=="200"&&(b.value=!1,_.value.refresh())})}),R=k(!1),J=k(""),ie=r=>w(this,null,function*(){J.value=r.content,R.value=!0});return Ve(()=>w(this,null,function*(){q("Page <<AnnouncementAdminListPage>> mounted.")})),(r,n)=>{const c=Ce,C=He,se=ze,W=Ke,re=Fe,X=Me,Y=Ae,F=Ne,Z=Pe,de=Se,me=Ue;return f(),K(A,null,[l(d(Oe),null,{title:i(()=>[v(g(r.$t("common.announcement_management")),1)]),_:1}),l(re,{shadow:"never"},{default:i(()=>[l(d(Be),{ref_key:"dataTableRef",ref:_,model:d(y),"onUpdate:model":n[3]||(n[3]=t=>De(y)?y.value=t:null),"row-selection-enabled":p.value,"toolbar-enabled":!0,onGetDataList:E},{toolbar:i(()=>[l(c,{type:"primary",onClick:n[0]||(n[0]=t=>G(0))},{default:i(()=>[v(g(r.$t("common.button_add")),1)]),_:1}),l(c,{onClick:n[1]||(n[1]=t=>p.value=!p.value)},{default:i(()=>[v(g(p.value?r.$t("common.label_batch_operation_cancel"):r.$t("common.label_batch_operation")),1)]),_:1}),l(c,{danger:"",onClick:n[2]||(n[2]=t=>L(0))},{default:i(()=>[v(g(r.$t("common.button_delete")),1)]),_:1})]),body:i(()=>[(f(),K(A,null,Ee(D,t=>(f(),K(A,null,[t.dataKey==="id"?(f(),K(A,{key:0},[p.value?(f(),$(C,{key:t.dataKey,type:"selection",width:t.width,fixed:"left"},null,8,["width"])):Le("",!0)],64)):t.dataKey==="title"?(f(),$(C,{key:t.dataKey,label:t.title,prop:t.dataKey,width:t.width,fixed:"left"},null,8,["label","prop","width"])):t.dataKey==="publishPeriod"?(f(),$(C,{key:t.dataKey,label:t.title,width:t.width},{default:i(h=>[N("div",{innerHTML:d(Re)(h.row.startDatetime,h.row.endDatetime)},null,8,at)]),_:2},1032,["label","width"])):t.dataKey==="status"?(f(),$(C,{key:t.dataKey,label:t.title,width:t.width},{default:i(h=>[h.row.status?(f(),K("div",ot,g(r.$t("common.field_publish_status_on")),1)):(f(),K("div",nt,g(r.$t("common.field_publish_status_off")),1))]),_:2},1032,["label","width"])):t.dataKey==="operation"?(f(),$(C,{key:t.dataKey,label:t.title,fixed:"right"},{default:i(h=>[l(W,null,{default:i(()=>[l(c,{type:"primary",size:"small",onClick:H=>ie(h.row)},{icon:i(()=>[l(d(B),{icon:"mdi:eye-outline"})]),_:2},1032,["onClick"]),l(c,{type:"primary",size:"small",onClick:H=>G(h.row.id)},{icon:i(()=>[l(d(B),{icon:"ant-design:edit-outlined"})]),_:2},1032,["onClick"]),l(se,{title:r.$t("common.label_confirm_delete_record"),onConfirm:H=>L(h.row.id)},{reference:i(()=>[l(c,{danger:"",type:"primary",size:"small",onConfirm:H=>L(h.row.id)},{icon:i(()=>[l(d(B),{icon:"ant-design:close-outlined"})]),_:2},1032,["onConfirm"])]),_:2},1032,["title","onConfirm"])]),_:2},1024)]),_:2},1032,["label"])):(f(),$(C,{key:t.dataKey,label:t.title,prop:t.dataKey,width:t.width},null,8,["label","prop","width"]))],64))),64))]),_:1},8,["model","row-selection-enabled"])]),_:1}),l(X,{modelValue:R.value,"onUpdate:modelValue":n[4]||(n[4]=t=>R.value=t),class:"app-modal",title:r.$t("common.label_preview"),"destroy-on-close":""},{default:i(()=>[N("div",{innerHTML:J.value},null,8,lt)]),_:1},8,["modelValue","title"]),l(X,{modelValue:b.value,"onUpdate:modelValue":n[11]||(n[11]=t=>b.value=t),class:"app-modal",title:T.value,"destroy-on-close":""},{footer:i(()=>[N("div",st,[l(W,null,{default:i(()=>[l(c,{type:"primary",onClick:j},{default:i(()=>[v(" Confirm ")]),_:1}),l(c,{onClick:le},{default:i(()=>[v(" Cancel ")]),_:1})]),_:1})])]),default:i(()=>[N("div",it,[l(me,{ref_key:"entityForm",ref:u,"label-width":"auto",model:d(o),rules:d(S),onFinish:j},{default:i(()=>[l(F,{prop:"title",label:r.$t("common.field_title")},{default:i(()=>[l(Y,{modelValue:d(o).title,"onUpdate:modelValue":n[5]||(n[5]=t=>d(o).title=t),placeholder:d(a)("common.field_title_placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(F,{prop:"content",label:r.$t("common.field_content")},{default:i(()=>[l(d(qe),{value:d(o).content,"onUpdate:value":n[6]||(n[6]=t=>d(o).content=t)},null,8,["value"])]),_:1},8,["label"]),l(F,{prop:"status",label:r.$t("common.field_publish_status")},{default:i(()=>[l(de,{modelValue:d(o).status,"onUpdate:modelValue":n[7]||(n[7]=t=>d(o).status=t)},{default:i(()=>[l(Z,{value:1},{default:i(()=>[v(g(d(a)("common.field_publish_status_finish")),1)]),_:1}),l(Z,{value:0},{default:i(()=>[v(g(d(a)("common.field_publish_status_unfinished")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(F,{label:r.$t("common.field_publish_period")},{default:i(()=>[l(d(Ge),{from:d(o).startDatetime,"onUpdate:from":n[8]||(n[8]=t=>d(o).startDatetime=t),to:d(o).endDatetime,"onUpdate:to":n[9]||(n[9]=t=>d(o).endDatetime=t),type:"datetime"},null,8,["from","to"])]),_:1},8,["label"]),l(F,{prop:"description",label:r.$t("common.field_description")},{default:i(()=>[l(Y,{modelValue:d(o).description,"onUpdate:modelValue":n[10]||(n[10]=t=>d(o).description=t),placeholder:d(a)("common.field_description_placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])])]),_:1},8,["modelValue","title"])],64)}}});export{kt as default};
