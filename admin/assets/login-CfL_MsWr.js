var i=(p,n,c)=>new Promise((h,d)=>{var _=t=>{try{u(c.next(t))}catch(a){d(a)}},r=t=>{try{u(c.throw(t))}catch(a){d(a)}},u=t=>t.done?h(t.value):Promise.resolve(t.value).then(_,r);u((c=c.apply(p,n)).next())});import{d as V,r as b,o as I,l as w,b as g,f as L,h as o,c as S,v as N,e as k,w as s,j as l,t as F,i as e,aN as E,F as A,g as D,q as H,s as M,z as K,a as P,aO as j,n as G,A as O,C as R,k as J,G as Q,aP as W}from"./index-BWAumHw1.js";import"./ThemeDropdown.vue_vue_type_style_index_0_scoped_8799785f_lang-iZ5X_zze.js";import{c as X,T as Y,d as Z,L as ee,b as te,e as ae,_ as oe}from"./ThemeDropdown-CWHJISC8.js";import{_ as se}from"./index-r6rWPyER.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{g as le}from"./captcha-BmoHlwNC.js";import{_ as ce}from"./index-D9Q_4jgw.js";/* empty css                                                             *//* empty css                                                             */import{I as re}from"./index-BE3Ni51I.js";import{_ as ie,F as pe}from"./index-CDLsN4DR.js";import{C as _e}from"./index-BLPW2dzv.js";import"./index-PnqdNQiM.js";import"./shallowequal-BP1mD28w.js";import"./RightOutlined-wRorRGkG.js";import"./LeftOutlined-C-PRzZ2E.js";import"./AppIcon.vue_vue_type_script_setup_true_lang-Cm94PNYg.js";import"./index-lzc8NZBh.js";import"./dropdown-C8b389Wg.js";import"./move-BZGAag-9.js";import"./useFlexGapSupport-Dhr3OBH1.js";import"./css-CjeDAR7Q.js";import"./useMergedState-Ba0T7Ln8.js";import"./EyeOutlined-23VZN_dd.js";import"./index-BsWNj1OP.js";import"./Col-C4xE7HFk.js";import"./responsiveObserve-CvSw2skB.js";import"./isMobile-DTq5YDvJ.js";const ue={class:"flex items-center"},me=V({__name:"CodeCaptcha",props:{width:{type:Number,default:120},height:{type:Number,default:32}},emits:["change"],setup(p,{expose:n,emit:c}){const h=c,d=p,_=b(""),r=()=>i(this,null,function*(){yield le({}).then(t=>{_.value=t.data.image,h("change",t.data.key)})});return n({refresh:()=>i(this,null,function*(){r().then()})}),I(()=>i(this,null,function*(){w("Component <<Captcha>> mounted."),r().then()})),(t,a)=>{const y=ce;return g(),L("div",ue,[o(y,{preview:!1,alt:t.$t("common.field_captcha"),width:d.width,height:d.height,src:_.value,onClick:r},null,8,["alt","width","height","src"])])}}}),de=p=>(H("data-v-0ced4c8f"),p=p(),M(),p),he={class:"app-layout-header-container"},fe={class:"app-layout-logo"},ge={class:"logo"},ye=de(()=>l("div",{class:"app-layout-nav"},null,-1)),ve={class:"app-layout-tools"},we={class:"app-layout-content-container"},Ce={class:"app-layout-footer-container"},be=["innerHTML"],xe=V({__name:"entry",setup(p){const n=S(()=>N.app.getTitle()),c=S(()=>N.app.getCopyright());return I(()=>{w("Component - <<EntryLayout>> is mounted.")}),(h,d)=>{const _=se,r=ee,u=te,t=ae,a=oe;return g(),k(a,{class:"app-layout"},{default:s(()=>[o(r,{class:"app-layout-header"},{default:s(()=>[l("div",he,[l("div",fe,[l("div",ge,[l("span",null,F(e(n)),1)])]),ye,l("div",ve,[o(_,{size:"middle"},{default:s(()=>[o(e(X)),o(e(Y)),o(e(Z))]),_:1})])])]),_:1}),o(u,{class:"app-layout-content"},{default:s(()=>[l("div",we,[E(h.$slots,"default",{},void 0,!0)])]),_:3}),o(t,{class:"app-layout-footer"},{default:s(()=>[l("div",Ce,[(g(!0),L(A,null,D(e(c),(y,x)=>(g(),L("div",{class:"app-text",key:x,innerHTML:y},null,8,be))),128))])]),_:1})]),_:3})}}}),$e=ne(xe,[["__scopeId","data-v-0ced4c8f"]]),Le={class:"mt-16 sm:w-full md:w-9/12 lg:w-6/12 xl:w-4/12"},ke={class:"text-center"},Fe={class:"flex w-full"},Ve={class:"flex-auto"},Ie={class:"mx-4 flex-none"},nt=V({__name:"login",setup(p){const{t:n}=K(),c=P(),{login:h,getUserInfo:d}=j(),{isLoginCaptchaEnabled:_}=G(),r=b(),u=b(),t=b(!1),a=O(W),y={username:[{required:!0,message:n("common.user_field_username_validation_login")}],password:[{required:!0,message:n("common.user_field_password_validation")}],captchaValue:[{required:!0,message:n("common.field_captcha_validation")}]},x=m=>i(this,null,function*(){w(m)}),z=()=>i(this,null,function*(){yield r.value.validate().then(m=>i(this,null,function*(){console.log(m),t.value=!0,yield h(a).then(()=>i(this,null,function*(){yield d().then(),yield c.push("/").then()})).finally(()=>{a.captchaKey="",a.captchaValue="",t.value=!1,_&&u.value.refresh()})})).catch(m=>{w(m)}).finally(()=>{})}),B=m=>i(this,null,function*(){a.captchaKey=m});return I(()=>i(this,null,function*(){w("Page <<Login>> mounted.")})),(m,f)=>{const $=re,C=ie,T=Q,U=pe,q=_e;return g(),k(e($e),null,{default:s(()=>[l("div",Le,[o(q,null,{title:s(()=>[l("div",ke,F(m.$t("common.user_pages_login_title")),1)]),default:s(()=>[o(U,{ref_key:"form",ref:r,model:e(a),rules:y,onFinish:z,onFinishFailed:x,class:"!m-8 !mb-12"},{default:s(()=>[o(C,{name:"username"},{default:s(()=>[o($,{size:"large",value:e(a).username,"onUpdate:value":f[0]||(f[0]=v=>e(a).username=v),placeholder:e(n)("common.user_field_username_placeholder_login")},null,8,["value","placeholder"])]),_:1}),o(C,{name:"password"},{default:s(()=>[o($,{size:"large",value:e(a).password,"onUpdate:value":f[1]||(f[1]=v=>e(a).password=v),placeholder:e(n)("common.user_field_password_placeholder")},null,8,["value","placeholder"])]),_:1}),e(_)?(g(),k(C,{key:0,name:"captchaValue"},{default:s(()=>[l("div",Fe,[l("div",Ve,[o($,{size:"large",value:e(a).captchaValue,"onUpdate:value":f[2]||(f[2]=v=>e(a).captchaValue=v),placeholder:e(n)("common.field_captcha_placeholder")},null,8,["value","placeholder"])]),l("div",Ie,[o(e(me),{class:"h-full",ref_key:"captcha",ref:u,onChange:B},null,512)])])]),_:1})):R("",!0),o(C,{class:"!mt-8"},{default:s(()=>[o(T,{size:"large","html-type":"submit",type:"primary",disabled:t.value,class:"w-full"},{default:s(()=>[J(F(e(n)("common.button_login")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1})}}});export{nt as default};
